(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{108:function(t,e,a){"use strict";(function(t){a.d(e,"d",(function(){return i})),a.d(e,"f",(function(){return o})),a.d(e,"b",(function(){return n})),a.d(e,"a",(function(){return l})),a.d(e,"c",(function(){return d})),a.d(e,"e",(function(){return c}));var r=[];function s(){if(t(this).blur(),!t(this).hasClass("disabled"))for(var e of r)e(this)}function i(){t(".numeric-keypad .touch-keypad-value").each((function(){t(this).removeClass("disabled"),t(this).removeClass("btn-secondary"),t(this).addClass("btn-outline-secondary")}))}function o(){t(".touch-keypad").css("display","flex"),adjustMargin()}function n(){t(".touch-keypad").css("display",""),adjustMargin()}function l(t){return"function"==typeof t&&(r.push(t),!0)}function d(t){if("function"!=typeof t)return!1;var e=r.indexOf(t);return-1!==e&&(r.splice(e,1),!0)}function c(e){t(".numeric-keypad .touch-keypad-value").each((function(){var a=t(this).html();e[a]?(t(this).removeClass("disabled"),t(this).removeClass("btn-secondary"),t(this).addClass("btn-outline-secondary")):(t(this).addClass("disabled"),t(this).addClass("btn-secondary"),t(this).removeClass("btn-outline-secondary")),delete e[a]}));var a=Object.keys(e);a.sort((function(t,e){return t.charCodeAt(0)-e.charCodeAt(0)}));var r="";for(var i of a)r+='<button type="button" class="btn btn-outline-secondary py-3 touch-keypad-key touch-keypad-value">'+i+"</button>";t(".letter-keypad").html(r),t(".letter-keypad .touch-keypad-value").on("click",s)}t(".touch-keypad-function-done").on("click",s),t(".touch-keypad-function-backspace").on("click",s),t(".touch-keypad-value").on("click",s)}).call(this,a(0))},53:function(t,e,a){"use strict";a.r(e),function(t){a.d(e,"enable",(function(){return j})),a.d(e,"disable",(function(){return q}));var r,s,i,o,n,l,d,c,u=a(19),p=a(7),v=a(8),g=a(9),h=a(20),b=a(2),f=a(4),m=a(16),y=a(15),w=a(108),C=a(6),I=a(11),k=a(1),x=!1,N=!1,S=!1;function z(){w.b()}function B(e){t(".gtw-providersort-provider").each((function(){var a=t(this).attr("gtw-provider");t(e+" .route-selection[gtw-provider='"+a+"']").length>0?t(this).css("display",""):t(this).css("display","none")}))}function T(){var e=t("#search-transit-text").val();var a,r,s,i,o,n=p.getAllRoutes(),l=e.length,d=[],c=!1;if(0===l){var u;for(var g of(c=!0,console.log("No query input."),o=Date.now(),n))for(r=p.getProvider(g.provider),a=0;a<g.paths.length;a++)u=(s=g.paths[a])[s.length-1],i=v.getStopById(u),d.push({provider:r,route:g,lastStop:i,bound:a});console.log("AllRoutesArrayBuild used "+(Date.now()-o)+" ms")}else{var h;o=Date.now();var b,f,y,C=[];for(a=0;a<n.length;a++)if((N=m.localizedKey(n[a],"routeName")).length>=l)for(h=0;h<n[a].paths.length;h++)C.push({value:N.substr(0,l),routeIndex:a,pathIndex:h});console.log("SearchRoutesArrayBuild used "+(Date.now()-o)+" ms"),o=Date.now(),C.sort((function(t,e){return t.value.localeCompare(e.value)})),console.log("SortArray used "+(Date.now()-o)+" ms");var I=0,k=C.length-1;for(o=Date.now();I<k;)f=C[b=Math.floor((I+k)/2)],0===(y=e.localeCompare(f.value))?k=b:y>0?I=b+1:k=b-1;if(console.log("Search used "+(Date.now()-o)+" ms"),C[I].value===e){var x;for(o=Date.now(),a=I;a<C.length&&(x=C[a]).value===e;a++)g=n[x.routeIndex],r=p.getProvider(g.provider),s=g.paths[x.pathIndex],i=v.getStopById(s[s.length-1]),d.push({provider:r,route:n[x.routeIndex],lastStop:i,bound:x.pathIndex});console.log("Found list build used "+(Date.now()-o)+" ms")}}var N,S='<ul class="list-group">';o=Date.now();var z={};for(a=0;a<d.length;a++){if(N=m.localizedKey(d[a].route,"routeName"),e.length<N.length)z[N.charAt(e.length)]=!0;c||(S+='<li class="list-group-item list-group-item-action d-flex align-items-center route-selection" gtw-provider="'+d[a].provider.id+'" gtw-route-id="'+d[a].route.routeId+'" gtw-bound="'+d[a].bound+'">    <div class="d-flex flex-column route-id">        <div>'+m.localizedKey(d[a].provider,"name")+"</div>        <div>"+N+"</div>    </div>    <div><b>"+t.i18n("transit-eta-to")+":</b> "+m.localizedKey(d[a].lastStop,"stopName")+"</div></li>")}console.log("HTML build used "+(Date.now()-o)+" ms"),S+="</ul>",t(".all-route-list").html(S),w.e(z),t(".all-route-list .route-selection").on("mouseenter",E),t(".all-route-list .route-selection").on("click",_),B(".all-route-list"),adjustMargin()}function A(){t(".gtw-providersort").removeClass("btn-primary"),t(".gtw-providersort-all").addClass("btn-primary"),t(".route-selection").attr("style","")}function P(){z(),t("#search-transit-text").val(""),S=!1,t("#button-cancel-search").addClass("btn-light"),t("#button-cancel-search").addClass("disabled"),t("#button-cancel-search").removeClass("btn-danger"),t("#button-cancel-search").html('<i class="fas fa-search"></i>'),t(".nearby-route-list").css("display","flex"),t(".all-route-list").css("display","none"),k.h(y.a()),k.j(16),k.f(),k.g(),A(),B(".nearby-route-list"),w.d()}function K(t,e){var a,r,s,i=t.paths[e],o=[];for(s=0;s<i.length;s++)a={lat:(r=v.getStopById(i[s])).lat,lng:r.lng},o.push(a),k.a(a,{title:r.stopName,label:""+(s+1)});k.b(o,"#FF0000",2)}function _(){I.b(),z(),k.f(),k.g();var e=p.getProvider(t(this).attr("gtw-provider")).getRouteById(t(this).attr("gtw-route-id")),a=v.getStopById(t(this).attr("gtw-stop-id")),r=t(this).attr("gtw-bound");if(!a){var i,o,n=y.a(),l=e.paths[r],d=!1,c=!1;for(var u of l)i=v.getStopById(u),o=f.c(i.lat,i.lng,n.lat,n.lng),(!d||!c||o<d)&&(d=o,c=i);console.log(d),d<=2&&(a=c)}!function e(a,r,i=!1,o=!1){var n='<div class="row" style="padding: 2%;"><div class="timeline-centered">';var l=a.paths[r];var d;var c;for(c=0;c<l.length;c++)d=v.getStopById(l[c]),n+='<article class="timeline-entry" stop-id="'+d.stopId+'" stop-index="'+c+'">    <div class="timeline-entry-inner">        <div class="timeline-icon bg-light">            '+(c+1)+'        </div>        <div class="timeline-label">            <h2><button style="padding: 0px;" class="btn btn-link" stop-id="'+d.stopId+'">'+m.localizedKey(d,"stopName")+"</button></h2>            <p></p>        </div>    </div></article>";n+="</div></div>";t(".half-map-container").html(n);t(".half-map-container button").on("click",(function(){var s=v.getStopById(t(this).attr("stop-id"));s&&e(a,r,s)}));var u=p.getProvider(a.provider);var h=l[l.length-1];n='<ul class="list-group"><li class="list-group-item d-flex align-items-center route-selection">    <div class="d-flex flex-column route-id">        <div>'+m.localizedKey(u,"name")+"</div>        <div>"+m.localizedKey(a,"routeName")+"</div>    </div>    <div><b>"+t.i18n("transit-eta-to")+":</b> "+m.localizedKey(v.getStopById(h),"stopName")+"</div></li></ul>";t(".half-map-tab-panel").html(n);adjustMargin();if(i){var b=screen.width>=768?".desktop":".mobile",y=t(b+" .timeline-entry[stop-id='"+i.stopId+"']"),w=y.children().children(".timeline-icon");w.removeClass("bg-light"),w.addClass("bg-primary"),o&&y[0].scrollIntoView();var C={lat:i.lat,lng:i.lng};k.h(C),k.j(18),clearInterval(s);var I=function(){!function(e,a,r){var s=t(".timeline-entry[stop-id='"+r.stopId+"'] p"),i="<p><u>"+t.i18n("transit-eta")+'</u></p><table class="table stop-eta">',o=g.fetchEta({provider:e.provider,etaProviders:e.etaProviders,routeId:e.routeId,selectedPath:parseInt(a),stopId:r.stopId});o?(i+='<tr class="table-dark">    <td colspan="4"><div class="spinner-border spinner-border-sm" role="status"></div> '+t.i18n("transit-eta-retrieving-data")+"</td></tr>",o.then((function(e){var a=e.options,r="",s=t(".timeline-entry[stop-id='"+a.stopId+"'] p table tbody");if(e.code&&-2===e.code)r+='<tr class="table-dark">    <td colspan="4">'+t.i18n("transit-eta-no-eta-providers")+"</td></tr>";else if(!e.schedules||e.code&&-1===e.code)r+='<tr class="table-dark">    <td colspan="4">'+t.i18n("transit-eta-no-data-received")+"</td></tr>";else if(0===e.schedules.length)r+='<tr class="table-dark">    <td colspan="4">'+t.i18n("transit-eta-no-schedules-pending")+"</td></tr>";else{var i=!1;for(var o of e.schedules){var n=Math.floor((o.time-o.serverTime)/1e3/60),l='<tr class="table-';l+=n>=20?"secondary":n>=15?"info":n>=10?"success":n>=5?"warning":n>=1?"danger":"dark",!i&&n>0&&(i=!0,l+=" active"),l+='">';var d=g.getProvider(o.provider);if(!d)return void console.error("Error: Could not find TransitEta provider to get localized names: "+o.provider);var c=4;if(a.etaProviders.length>1&&(l+="<td>"+m.localizedKey(d,"name")+"</td>",c--),void 0!==o.msg&&void 0===o.time)l+='<td colspan="'+c+'">'+o.msg+"</td>";else{l+="<td>",void 0!==o.msg&&(l+=o.msg),void 0!==o.time&&(void 0!==o.msg&&(l+="<br />"),l+=n>0?t.i18n("transit-eta-minutes",n):t.i18n("transit-eta-arrived-left")),l+="</td><td",void 0===o.isLive&&(l+=' colspan="2"'),l+=">";var u=new Date(o.time);void 0!==o.time?l+=f.b(u.getHours())+":"+f.b(u.getMinutes()):l+="---",l+="</td>",void 0!==o.isLive&&(o.isLive?l+='<td><span style="color: red; float: right; font-size: 10px;"><i class="fa fa-circle"></i> '+t.i18n("transit-eta-live")+"</span></td>":l+='<td><span style="font-size: 10px; float: right; font-style: italic;">'+t.i18n("transit-eta-scheduled")+"</span></td>")}r+=l+="</tr>"}}s.html(r)})).catch((function(e,a){t(".timeline-entry[stop-id='"+e.stopId+"'] p table tbody").html('<tr class="table-danger"><td colspan="4">'+t.i18n("transit-eta-error-fetching-eta")+"</td></tr>")}))):i+='<tr class="table-dark">    <td colspan="4">'+t.i18n("transit-eta-route-not-available")+"</td></tr>";i+="</table>",s.html(i)}(a,r,i)};I(),s=setInterval(I,3e4)}}(e,r,a,!0),K(e,r)}function E(){k.f(),k.g();var e=p.getProvider(t(this).attr("gtw-provider")).getRouteById(t(this).attr("gtw-route-id")),a=v.getStopById(t(this).attr("gtw-stop-id")),r=t(this).attr("gtw-bound");if(K(e,r),a){var s={lat:a.lat,lng:a.lng};k.h(s),k.j(18)}else{var i,o=e.paths[r],n=[];for(var l of o)i=v.getStopById(l),n.push({lat:parseFloat(i.lat),lng:parseFloat(i.lng)});k.c(n)}}function D(){var e=h.c.length;if(e>0){t(".request-progress-panel").fadeIn(500);var a=n;(!a||e>a)&&(a=n=e),t(".request-progress-panel .progress-bar").html(t.i18n("transit-eta-requesting-data",a-e,a)),t(".request-progress-panel .progress-bar").css("width",Math.floor((a-e)/a*100)+"%")}else n=0,t(".request-progress-panel .progress-bar").css("width","100%"),t(".request-progress-panel").fadeOut(500,(function(){t(".request-progress-panel .progress-bar").css("width","0%")}));for(var r of o){g.fetchEta({provider:r.route.provider,etaProviders:r.route.etaProviders,routeId:r.route.routeId,selectedPath:r.bound,stopId:r.stop.stopId}).then((function(e){var a="",r=e.options,s=t('.nearby-route-list .route-selection[gtw-provider="'+r.provider+'"][gtw-route-id="'+r.routeId+'"][gtw-bound="'+r.selectedPath+'"][gtw-stop-id="'+r.stopId+'"]');s.removeClass("list-group-item-secondary"),s.removeClass("list-group-item-info"),s.removeClass("list-group-item-success"),s.removeClass("list-group-item-warning"),s.removeClass("list-group-item-danger"),s.removeClass("list-group-item-light"),s.removeClass("list-group-item-dark");var i="btn-secondary";if(!e||!e.schedules||e.code&&e.code<0)a=t.i18n("transit-eta-route-not-available-short"),s.addClass("list-group-item-light");else if(0===e.schedules.length)a=t.i18n("transit-eta-no-schedules-pending-short"),s.addClass("list-group-item-light");else{var o=e.schedules[0],n=Math.floor((o.time-o.serverTime)/1e3/60),l="";if(l=n>=20?"secondary":n>=15?"info":n>=10?"success":n>=5?"warning":n>=1?"danger":"dark",s.addClass("list-group-item-"+l),void 0!==o.msg)a=o.msg.length>20?t.i18n("transit-eta-transit-notice"):o.msg,i="badge-warning";else void 0!==o.time&&(void 0!==o.msg&&(a+="<br />"),i="badge-primary",n>0?a+=t.i18n("transit-eta-minutes",n):(a+=t.i18n("transit-eta-arrived-left",n),i="badge-dark"),void 0!==o.isLive&&(a+='<br /><span style="font-size: 10px; position: absolute; top: 16px; right: 16px; ',o.isLive?a+='color: red;"><i class="fa fa-circle"></i> '+t.i18n("transit-eta-live")+"</span>":a+='color: black; font-style: italic;">'+t.i18n("transit-eta-scheduled")+"</span>"))}var d=s.children(".transit-eta");d.removeClass("badge-primary"),d.removeClass("badge-secondary"),d.removeClass("badge-warning"),d.removeClass("badge-danger"),d.removeClass("badge-dark"),d.addClass(i),d.html(a)})).catch((function(e,a){var r=t('.nearby-route-list .route-selection[gtw-provider="'+e.provider+'"][gtw-route-id="'+e.routeId+'"][gtw-bound="'+e.selectedPath+'"][gtw-stop-id="'+e.stopId+'"]');r.removeClass("list-group-item-secondary"),r.removeClass("list-group-item-info"),r.removeClass("list-group-item-success"),r.removeClass("list-group-item-warning"),r.removeClass("list-group-item-danger"),r.removeClass("list-group-item-light"),r.removeClass("list-group-item-dark"),r.addClass("list-group-item-light");var s=r.children(".transit-eta");s.removeClass("badge-primary"),s.removeClass("badge-secondary"),s.removeClass("badge-warning"),s.removeClass("badge-danger"),s.removeClass("badge-dark"),s.addClass("badge-danger"),s.html(t.i18n("transit-eta-error-fetching-eta-short"))}))}}function M(){clearInterval(i);var e=y.a(),a=e.lat,r=e.lng;x=a,N=r;var s=b.get("min_nearby_transit_range",200)/1e3,n=v.getAllStopsNearby(a,r,s,!0,!0);if(0===n.length){var l=s;do{l+=.05,n=v.getAllStopsNearby(a,r,l,!0,!0)}while(0===n.length&&l<10);l>=10?t(".tab-panel").append('<div class="alert alert-danger alert-dismissable"><button type="button" class="close" data-dismiss="alert" aria-hidden="true" >&#215;</button>No routes are found in 10 km range.</div>'):t(".tab-panel").append('<div class="alert alert-warning alert-dismissable"><button type="button" class="close" data-dismiss="alert" aria-hidden="true" >&#215;</button>'+t.i18n("transit-eta-no-routes-found-nearby-extended-range",1e3*s,Math.ceil(1e3*l))+"</div>")}var d,c,g,h,f,w=b.get("max_nearby_transit_to_display",20);for(var C of(o=[],n)){if(o.length>=w)break;var I=u.c(C.stop);for(var k of I)o.push({route:k.route,bound:k.bound,stop:C.stop,distance:C.distance})}for(var z of(d='<div class="row item-list nearby-route-list"'+(S?' style="display: none"':"")+'><ul class="list-group">',o))h=(g=z.route.paths[z.bound])[g.length-1],c=Math.round(1e3*z.distance),f=p.getProvider(z.route.provider),d+='    <li class="list-group-item list-group-item-action d-flex justify-content-between align-items-center route-selection" gtw-provider="'+z.route.provider+'" gtw-route-id="'+z.route.routeId+'" gtw-stop-id="'+z.stop.stopId+'" gtw-bound="'+z.bound+'">        <div class="d-flex flex-column route-id">            <div>'+m.localizedKey(f,"name")+"</div>            <div>"+m.localizedKey(z.route,"routeName")+'</div>        </div>        <div class="d-flex flex-column stop-info mr-auto">            <div>                <b>'+t.i18n("transit-eta-to")+":</b> <small>"+m.localizedKey(v.getStopById(h),"stopName")+"</small></div>            <div>                "+m.localizedKey(z.stop,"stopName")+" ("+c+t.i18n("transit-eta-metres")+')            </div>        </div>        <span class="badge badge-primary badge-pill transit-eta">'+t.i18n("transit-eta-retrieving")+"</span>    </li>";d+='</ul></div><div class="row item-list all-route-list"></div>',t(".content-panel-container").html(d),t(".nearby-route-list .route-selection").on("mouseenter",E),t(".nearby-route-list .route-selection").on("mouseleave",(function(){})),t(".nearby-route-list .route-selection").on("click",_),B(".nearby-route-list"),D(),i=setInterval(D,3e4)}function j(){h.a(),g.clearCache(),w.a(l=function(e){var a;if(t(e).hasClass("touch-keypad-function-done"))z(),adjustMargin();else if(t(e).hasClass("touch-keypad-function-backspace"))a=t("#search-transit-text").val(),t("#search-transit-text").val(a.slice(0,-1)),T();else if(t(e).hasClass("touch-keypad-value")){var r=t(e).html();a=t("#search-transit-text").val(),t("#search-transit-text").val(a+r),T()}}),C.b(C.a.EVENT_UI_BACK,d=function(){S&&w.f(),clearInterval(s)}),C.b(C.a.EVENT_LOCATION_CHANGE,c=function(){if(x&&N){var t=y.a();f.c(t.lat,t.lng,x,N)>.125&&(console.log("Location moved 125 m away. Finding new nearby routes."),M())}});var e=p.getProviders();if(e.length>0){var a='<div class="hori-scroll btn-group">    <button type="button" class="btn btn-primary gtw-providersort gtw-providersort-all"><i class="fa fa-reply-all"></i><br />'+t.i18n("transit-eta-sort-all")+"</button>";for(var i of e){var o="";o=i.type===TransitType.BUS?"fa-bus":i.type===TransitType.TRAIN?"fa-train":"fa-question",a+=' <button type="button" class="btn btn-default gtw-providersort gtw-providersort-provider" gtw-provider="'+i.id+'"><i class="fa '+o+'"></i><br />'+m.localizedKey(i,"name")+"</button>"}a+="</div>",t(".tab-panel").append(a);var n='<div class="input-group mb-3" style="margin-top: 16px;">    <input type="text" class="form-control" placeholder="'+t.i18n("transit-eta-placeholder-search-for-transit")+'" aria-label="'+t.i18n("transit-eta-placeholder-search-for-transit")+'" aria-describedby="search-transit-icon" id="search-transit-text" readonly/>    <div class="input-group-append">        <button class="btn btn-light disabled" type="button" id="button-cancel-search"><i class="fas fa-search"></i></button>    </div></div>';t(".tab-panel").append(n);t(".tab-panel").append('<div class="request-progress-panel">    <div class="progress bg-white">        <div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" style="width: 0%;"></div>    </div></div>'),t(".gtw-providersort").on("click",(function(){if(!t(this).hasClass("btn-primary"))if(t(this).hasClass("gtw-providersort-all"))A();else{t(".gtw-providersort").removeClass("btn-primary");var e=t(this).attr("gtw-provider");t(this).addClass("btn-primary"),t(".gtw-providersort-provider:not([gtw-provider='"+e+"'])").addClass("btn-default"),t(".route-selection[gtw-provider='"+e+"']").attr("style",""),t(".route-selection:not([gtw-provider='"+e+"'])").attr("style","display: none!important")}})),t("#button-cancel-search").on("click",(function(){t(this).hasClass("disabled")||P()}));t("#search-transit-text").on("click",(function(){w.f(),S=!0,t("#button-cancel-search").removeClass("btn-light"),t("#button-cancel-search").removeClass("disabled"),t("#button-cancel-search").addClass("btn-danger"),t("#button-cancel-search").html('<i class="fas fa-times"></i>'),t(".nearby-route-list").css("display","none"),t(".all-route-list").css("display","flex"),k.h(y.a()),k.j(16),k.f(),k.g(),T(),A(),B(".all-route-list")})),t("#search-transit-text").on("input",(function(){clearTimeout(r),r=setTimeout((function(){T()}),500)})),M()}else t(".tab-panel").html('<br /><div class="alert alert-danger" role="alert"><i class="fas fa-exclamation-triangle"></i> '+t.i18n("transit-eta-no-plugins-providing-transit-data")+"</div>")}function q(){w.c(l),C.d(C.a.EVENT_UI_BACK,d),C.d(C.a.EVENT_LOCATION_CHANGE,c),clearTimeout(r),clearInterval(i),clearInterval(s),r=!1,i=!1}window.t=v}.call(this,a(0))}}]);
//# sourceMappingURL=1.ebaa9e2532102a1f5288.js.map
{"version":3,"sources":["webpack:///./src/gtw-map-googlemap.js"],"names":["markerInc","markers","lockedMarkers","infoWindowInc","infoWindows","polylineInc","polylines","lockedPolylines","map","init","Promise","resolve","reject","$","html","window","initMap","darkModeMapType","google","maps","Map","document","getElementById","center","zoom","disableDefaultUI","StyledMapType","elementType","stylers","color","featureType","mapTypes","set","checkIfDarkMode","TrafficLayer","setMap","addListener","EVENT_MAP_CENTER_CHANGED","getCenter","apiKey","googleMapApiKey","location","origin","startsWith","console","warn","element","createElement","src","head","appendChild","setDarkMode","dark","setMapTypeId","matchMedia","matches","setCenter","coords","lat","lng","setZoom","addMarker","position","options","onClickFunc","marker","Marker","label","undefined","title","icon","setMarkerPosition","markerId","setPosition","getMarker","lockMarker","indexOf","push","unlockMarker","i","splice","removeMarker","includes","removeAllMarkers","key","parseInt","addInfoWindow","content","open","egetMarker","infowindow","InfoWindow","addPolyline","strokeColor","strokeWeight","strokeOpacity","geodesic","polyline","Polyline","path","lockPolyline","polylineId","unlockPolyline","removePolyline","removeAllPolylines","fitBounds","bounds","out","LatLngBounds","bound","extend"],"mappings":"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","file":"2.88e41c598c7ef0d8829d.js","sourcesContent":["//GTW Map source code\r\n\r\nimport config from './gtw-config';\r\nimport * as loc from './gtw-location';\r\nimport * as Event from './gtw-event';\r\n\r\nvar markerInc = 1;\r\nvar markers = {};\r\nvar lockedMarkers = [];\r\n\r\nvar infoWindowInc = 1;\r\nvar infoWindows = {};\r\n\r\nvar polylineInc = 1;\r\nvar polylines = {};\r\nvar lockedPolylines = [];\r\n\r\nexport var map = false;\r\n\r\nexport function init() {\r\n    return new Promise((resolve, reject) => {\r\n        $(\"#gtw-map\").html(\"<div id=\\\"gmap\\\" style=\\\"width: 100%; height: 100%;\\\"></div>\");\r\n\r\n        //Required callback function from the API\r\n        window.initMap = function () {\r\n            map = new google.maps.Map(document.getElementById(\"gmap\"), {\r\n                center: loc.getCurrentPosition(),\r\n                zoom: 12,\r\n                disableDefaultUI: true\r\n            });\r\n            initDarkMode();\r\n            checkIfDarkMode();\r\n\r\n            var trafficLayer = new google.maps.TrafficLayer();\r\n            trafficLayer.setMap(map);\r\n\r\n            map.addListener(\"center_changed\", function () {\r\n                Event.dispatchEvent(Event.EVENTS.EVENT_MAP_CENTER_CHANGED, getCenter());\r\n            });\r\n\r\n            resolve();\r\n            delete window.initMap;\r\n        };\r\n\r\n        var apiKey = config.googleMapApiKey;\r\n\r\n        if (!window.location.origin || window.location.origin === \"\" || window.location.origin !== \"https://www.gotowhere.ga\" || window.location.origin === \"file://\" || window.location.origin.startsWith(\"http://localhost\") || window.location.origin.startsWith(\"https://localhost\")) {\r\n            apiKey = \"\";\r\n            console.warn(\"gtw-map-googlemap: You are running the application in local/no-origin mode. The API key has been removed now.\");\r\n        }\r\n\r\n        var element = document.createElement(\"script\");\r\n        element.src = \"https://maps.googleapis.com/maps/api/js?callback=initMap&key=\" + apiKey;\r\n        document.head.appendChild(element);\r\n    });\r\n}\r\n\r\nfunction initDarkMode() {\r\n    var darkModeMapType = new google.maps.StyledMapType([\r\n        { elementType: 'geometry', stylers: [{ color: '#242f3e' }] },\r\n        { elementType: 'labels.text.stroke', stylers: [{ color: '#242f3e' }] },\r\n        { elementType: 'labels.text.fill', stylers: [{ color: '#746855' }] },\r\n        {\r\n            featureType: 'administrative.locality',\r\n            elementType: 'labels.text.fill',\r\n            stylers: [{ color: '#d59563' }]\r\n        },\r\n        {\r\n            featureType: 'poi',\r\n            elementType: 'labels.text.fill',\r\n            stylers: [{ color: '#d59563' }]\r\n        },\r\n        {\r\n            featureType: 'poi.park',\r\n            elementType: 'geometry',\r\n            stylers: [{ color: '#263c3f' }]\r\n        },\r\n        {\r\n            featureType: 'poi.park',\r\n            elementType: 'labels.text.fill',\r\n            stylers: [{ color: '#6b9a76' }]\r\n        },\r\n        {\r\n            featureType: 'road',\r\n            elementType: 'geometry',\r\n            stylers: [{ color: '#38414e' }]\r\n        },\r\n        {\r\n            featureType: 'road',\r\n            elementType: 'geometry.stroke',\r\n            stylers: [{ color: '#212a37' }]\r\n        },\r\n        {\r\n            featureType: 'road',\r\n            elementType: 'labels.text.fill',\r\n            stylers: [{ color: '#9ca5b3' }]\r\n        },\r\n        {\r\n            featureType: 'road.highway',\r\n            elementType: 'geometry',\r\n            stylers: [{ color: '#746855' }]\r\n        },\r\n        {\r\n            featureType: 'road.highway',\r\n            elementType: 'geometry.stroke',\r\n            stylers: [{ color: '#1f2835' }]\r\n        },\r\n        {\r\n            featureType: 'road.highway',\r\n            elementType: 'labels.text.fill',\r\n            stylers: [{ color: '#f3d19c' }]\r\n        },\r\n        {\r\n            featureType: 'transit',\r\n            elementType: 'geometry',\r\n            stylers: [{ color: '#2f3948' }]\r\n        },\r\n        {\r\n            featureType: 'transit.station',\r\n            elementType: 'labels.text.fill',\r\n            stylers: [{ color: '#d59563' }]\r\n        },\r\n        {\r\n            featureType: 'water',\r\n            elementType: 'geometry',\r\n            stylers: [{ color: '#17263c' }]\r\n        },\r\n        {\r\n            featureType: 'water',\r\n            elementType: 'labels.text.fill',\r\n            stylers: [{ color: '#515c6d' }]\r\n        },\r\n        {\r\n            featureType: 'water',\r\n            elementType: 'labels.text.stroke',\r\n            stylers: [{ color: '#17263c' }]\r\n        }\r\n    ]);\r\n    map.mapTypes.set(\"dark_mode\", darkModeMapType);\r\n}\r\n\r\nexport function setDarkMode(dark) {\r\n    if (dark) {\r\n        map.setMapTypeId(\"dark_mode\");\r\n    } else {\r\n        map.setMapTypeId(\"roadmap\");\r\n    }\r\n}\r\n\r\nexport function checkIfDarkMode() {\r\n    var darkMode = window.matchMedia && window.matchMedia(\"(prefers-color-scheme: dark)\").matches;\r\n    setDarkMode(darkMode);\r\n}\r\n\r\nexport function setCenter(coords) {\r\n    return map.setCenter(coords);\r\n}\r\n\r\nexport function getCenter() {\r\n    var center = map.getCenter();\r\n    return {\r\n        lat: center.lat(),\r\n        lng: center.lng()\r\n    };\r\n}\r\n\r\nexport function setZoom(zoom) {\r\n    return map.setZoom(zoom);\r\n}\r\n\r\nexport function addMarker(position, options, onClickFunc) {\r\n    var marker = new google.maps.Marker({\r\n        position: position,\r\n        label: options ? options.label : undefined,\r\n        title: options ? options.title : undefined,\r\n        icon: options? options.icon : undefined,\r\n        map: map\r\n    });\r\n    markers[markerInc] = marker;\r\n\r\n    if (onClickFunc) {\r\n        marker.addListener(\"click\", function () {\r\n            onClickFunc();\r\n        });\r\n    }\r\n\r\n    return markerInc++;\r\n}\r\n\r\nexport function setMarkerPosition(markerId, position) {\r\n    if (!markerId || !markers[markerId]) {\r\n        return false;\r\n    }\r\n    markers[markerId].setPosition(position);\r\n}\r\n\r\nexport function getMarker(markerId) {\r\n    if (!markerId || !markers[markerId]) {\r\n        return false;\r\n    }\r\n    return markers[markerId];\r\n}\r\n\r\nexport function lockMarker(markerId) {\r\n    if (!markerId || !markers[markerId]) {\r\n        return false;\r\n    }\r\n    if (lockedMarkers.indexOf(markerId) === -1) {\r\n        lockedMarkers.push(markerId);\r\n    }\r\n    return true;\r\n}\r\n\r\nexport function unlockMarker(markerId) {\r\n    var i = lockedMarkers.indexOf(markerId);\r\n    if (i === -1) {\r\n        return false;\r\n    }\r\n    lockedMarkers.splice(i, 1);\r\n    return true;\r\n}\r\n\r\nexport function removeMarker(markerId) {\r\n    if (!markerId || !markers[markerId]) {\r\n        return false;\r\n    }\r\n    if (lockedMarkers.includes(markerId)) {\r\n        return false;\r\n    }\r\n    markers[markerId].setMap(null);\r\n    delete markers[markerId];\r\n    return true;\r\n}\r\n\r\nexport function removeAllMarkers() {\r\n    for (var key in markers) {\r\n        if (!lockedMarkers.includes(parseInt(key))) {\r\n            markers[key].setMap(null);\r\n        }\r\n    }\r\n    markers = {};\r\n    return true;\r\n}\r\n\r\nexport function addInfoWindow(markerId, content, open = false) {\r\n    var marker = egetMarker(markerId);\r\n    if (!marker) {\r\n        return false;\r\n    }\r\n\r\n    var infowindow = new google.maps.InfoWindow({\r\n        content: content\r\n    });\r\n\r\n    marker.addListener(\"click\", function () {\r\n        infowindow.open(map, marker);\r\n    });\r\n\r\n    if (open) {\r\n        infowindow.open(map, marker);\r\n    }\r\n\r\n    infoWindows[infoWindowInc] = infowindow;\r\n    return infoWindowInc++;\r\n}\r\n\r\nexport function addPolyline(coords, strokeColor, strokeWeight, strokeOpacity = 1.0, geodesic = true) {\r\n    var polyline = new google.maps.Polyline({\r\n        path: coords,\r\n        geodesic: geodesic,\r\n        strokeColor: strokeColor,\r\n        strokeOpacity: strokeOpacity,\r\n        strokeWeight: strokeWeight\r\n    });\r\n\r\n    polyline.setMap(map);\r\n\r\n    polylines[polylineInc] = polyline;\r\n    return polylineInc++;\r\n}\r\n\r\nexport function lockPolyline(polylineId) {\r\n    if (!polyline || !polylines[polylineId]) {\r\n        return false;\r\n    }\r\n    if (lockedPolylines.indexOf(polylineId) === -1) {\r\n        lockedPolylines.push(polylineId);\r\n    }\r\n    return true;\r\n}\r\n\r\nexport function unlockPolyline(polylineId) {\r\n    var i = lockedPolylines.indexOf(polylineId);\r\n    if (i === -1) {\r\n        return false;\r\n    }\r\n    lockedPolylines.splice(i, 1);\r\n    return true;\r\n}\r\n\r\nexport function removePolyline(polylineId) {\r\n    if (!polylineId || !polylines[polylineId]) {\r\n        return false;\r\n    }\r\n    if (lockedPolylines.includes(polylineId)) {\r\n        return false;\r\n    }\r\n    polylines[polylineId].setMap(null);\r\n    delete polylines[polylineId];\r\n    return true;\r\n}\r\n\r\nexport function removeAllPolylines() {\r\n    for (var key in polylines) {\r\n        if (!lockedPolylines.includes(key)) {\r\n            polylines[key].setMap(null);\r\n        }\r\n    }\r\n    polylines = {};\r\n    return true;\r\n}\r\n\r\nexport function fitBounds(bounds) {\r\n    var out = new google.maps.LatLngBounds();\r\n    for (var bound of bounds) {\r\n        out.extend(bound);\r\n    }\r\n    map.fitBounds(out);\r\n}"],"sourceRoot":""}
{"version":3,"sources":["webpack:///./src/gtw-map-googlemap.js"],"names":["markerInc","markers","lockedMarkers","infoWindowInc","infoWindows","polylineInc","polylines","lockedPolylines","map","init","Promise","resolve","reject","$","html","window","initMap","darkModeMapType","google","maps","Map","document","getElementById","center","zoom","disableDefaultUI","StyledMapType","elementType","stylers","color","featureType","mapTypes","set","checkIfDarkMode","addListener","EVENT_MAP_CENTER_CHANGED","getCenter","apiKey","googleMapApiKey","location","origin","startsWith","console","warn","element","createElement","src","head","appendChild","setDarkMode","dark","setMapTypeId","matchMedia","matches","setCenter","coords","lat","lng","setZoom","addMarker","position","options","onClickFunc","marker","Marker","label","undefined","title","icon","setMarkerPosition","markerId","setPosition","getMarker","lockMarker","indexOf","push","unlockMarker","i","splice","removeMarker","includes","setMap","removeAllMarkers","key","parseInt","addInfoWindow","content","open","egetMarker","infowindow","InfoWindow","addPolyline","strokeColor","strokeWeight","strokeOpacity","geodesic","polyline","Polyline","path","lockPolyline","polylineId","unlockPolyline","removePolyline","removeAllPolylines","fitBounds","bounds","out","LatLngBounds","bound","extend"],"mappings":"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","file":"2.c8de809bc4c96f83297e.js","sourcesContent":["//GTW Map source code\r\n\r\nimport config from './gtw-config';\r\nimport * as loc from './gtw-location';\r\nimport * as Event from './gtw-event';\r\n\r\nvar markerInc = 1;\r\nvar markers = {};\r\nvar lockedMarkers = [];\r\n\r\nvar infoWindowInc = 1;\r\nvar infoWindows = {};\r\n\r\nvar polylineInc = 1;\r\nvar polylines = {};\r\nvar lockedPolylines = [];\r\n\r\nexport var map = false;\r\n\r\nexport function init() {\r\n    return new Promise((resolve, reject) => {\r\n        $(\"#gtw-map\").html(\"<div id=\\\"gmap\\\" style=\\\"width: 100%; height: 100%;\\\"></div>\");\r\n\r\n        //Required callback function from the API\r\n        window.initMap = function () {\r\n            map = new google.maps.Map(document.getElementById(\"gmap\"), {\r\n                center: loc.getCurrentPosition(),\r\n                zoom: 12,\r\n                disableDefaultUI: true\r\n            });\r\n            initDarkMode();\r\n            checkIfDarkMode();\r\n\r\n            map.addListener(\"center_changed\", function () {\r\n                Event.dispatchEvent(Event.EVENTS.EVENT_MAP_CENTER_CHANGED, getCenter());\r\n            });\r\n\r\n            resolve();\r\n            delete window.initMap;\r\n        };\r\n\r\n        var apiKey = config.googleMapApiKey;\r\n\r\n        if (!window.location.origin || window.location.origin === \"\" || window.location.origin !== \"https://www.gotowhere.ga\" || window.location.origin === \"file://\" || window.location.origin.startsWith(\"http://localhost\") || window.location.origin.startsWith(\"https://localhost\")) {\r\n            apiKey = \"\";\r\n            console.warn(\"gtw-map-googlemap: You are running the application in local/no-origin mode. The API key has been removed now.\");\r\n        }\r\n\r\n        var element = document.createElement(\"script\");\r\n        element.src = \"https://maps.googleapis.com/maps/api/js?callback=initMap&key=\" + apiKey;\r\n        document.head.appendChild(element);\r\n    });\r\n}\r\n\r\nfunction initDarkMode() {\r\n    var darkModeMapType = new google.maps.StyledMapType([\r\n        { elementType: 'geometry', stylers: [{ color: '#242f3e' }] },\r\n        { elementType: 'labels.text.stroke', stylers: [{ color: '#242f3e' }] },\r\n        { elementType: 'labels.text.fill', stylers: [{ color: '#746855' }] },\r\n        {\r\n            featureType: 'administrative.locality',\r\n            elementType: 'labels.text.fill',\r\n            stylers: [{ color: '#d59563' }]\r\n        },\r\n        {\r\n            featureType: 'poi',\r\n            elementType: 'labels.text.fill',\r\n            stylers: [{ color: '#d59563' }]\r\n        },\r\n        {\r\n            featureType: 'poi.park',\r\n            elementType: 'geometry',\r\n            stylers: [{ color: '#263c3f' }]\r\n        },\r\n        {\r\n            featureType: 'poi.park',\r\n            elementType: 'labels.text.fill',\r\n            stylers: [{ color: '#6b9a76' }]\r\n        },\r\n        {\r\n            featureType: 'road',\r\n            elementType: 'geometry',\r\n            stylers: [{ color: '#38414e' }]\r\n        },\r\n        {\r\n            featureType: 'road',\r\n            elementType: 'geometry.stroke',\r\n            stylers: [{ color: '#212a37' }]\r\n        },\r\n        {\r\n            featureType: 'road',\r\n            elementType: 'labels.text.fill',\r\n            stylers: [{ color: '#9ca5b3' }]\r\n        },\r\n        {\r\n            featureType: 'road.highway',\r\n            elementType: 'geometry',\r\n            stylers: [{ color: '#746855' }]\r\n        },\r\n        {\r\n            featureType: 'road.highway',\r\n            elementType: 'geometry.stroke',\r\n            stylers: [{ color: '#1f2835' }]\r\n        },\r\n        {\r\n            featureType: 'road.highway',\r\n            elementType: 'labels.text.fill',\r\n            stylers: [{ color: '#f3d19c' }]\r\n        },\r\n        {\r\n            featureType: 'transit',\r\n            elementType: 'geometry',\r\n            stylers: [{ color: '#2f3948' }]\r\n        },\r\n        {\r\n            featureType: 'transit.station',\r\n            elementType: 'labels.text.fill',\r\n            stylers: [{ color: '#d59563' }]\r\n        },\r\n        {\r\n            featureType: 'water',\r\n            elementType: 'geometry',\r\n            stylers: [{ color: '#17263c' }]\r\n        },\r\n        {\r\n            featureType: 'water',\r\n            elementType: 'labels.text.fill',\r\n            stylers: [{ color: '#515c6d' }]\r\n        },\r\n        {\r\n            featureType: 'water',\r\n            elementType: 'labels.text.stroke',\r\n            stylers: [{ color: '#17263c' }]\r\n        }\r\n    ]);\r\n    map.mapTypes.set(\"dark_mode\", darkModeMapType);\r\n}\r\n\r\nexport function setDarkMode(dark) {\r\n    if (dark) {\r\n        map.setMapTypeId(\"dark_mode\");\r\n    } else {\r\n        map.setMapTypeId(\"roadmap\");\r\n    }\r\n}\r\n\r\nexport function checkIfDarkMode() {\r\n    var darkMode = window.matchMedia && window.matchMedia(\"(prefers-color-scheme: dark)\").matches;\r\n    setDarkMode(darkMode);\r\n}\r\n\r\nexport function setCenter(coords) {\r\n    return map.setCenter(coords);\r\n}\r\n\r\nexport function getCenter() {\r\n    var center = map.getCenter();\r\n    return {\r\n        lat: center.lat(),\r\n        lng: center.lng()\r\n    };\r\n}\r\n\r\nexport function setZoom(zoom) {\r\n    return map.setZoom(zoom);\r\n}\r\n\r\nexport function addMarker(position, options, onClickFunc) {\r\n    var marker = new google.maps.Marker({\r\n        position: position,\r\n        label: options ? options.label : undefined,\r\n        title: options ? options.title : undefined,\r\n        icon: options? options.icon : undefined,\r\n        map: map\r\n    });\r\n    markers[markerInc] = marker;\r\n\r\n    if (onClickFunc) {\r\n        marker.addListener(\"click\", function () {\r\n            onClickFunc();\r\n        });\r\n    }\r\n\r\n    return markerInc++;\r\n}\r\n\r\nexport function setMarkerPosition(markerId, position) {\r\n    if (!markerId || !markers[markerId]) {\r\n        return false;\r\n    }\r\n    markers[markerId].setPosition(position);\r\n}\r\n\r\nexport function getMarker(markerId) {\r\n    if (!markerId || !markers[markerId]) {\r\n        return false;\r\n    }\r\n    return markers[markerId];\r\n}\r\n\r\nexport function lockMarker(markerId) {\r\n    if (!markerId || !markers[markerId]) {\r\n        return false;\r\n    }\r\n    if (lockedMarkers.indexOf(markerId) === -1) {\r\n        lockedMarkers.push(markerId);\r\n    }\r\n    return true;\r\n}\r\n\r\nexport function unlockMarker(markerId) {\r\n    var i = lockedMarkers.indexOf(markerId);\r\n    if (i === -1) {\r\n        return false;\r\n    }\r\n    lockedMarkers.splice(i, 1);\r\n    return true;\r\n}\r\n\r\nexport function removeMarker(markerId) {\r\n    if (!markerId || !markers[markerId]) {\r\n        return false;\r\n    }\r\n    if (lockedMarkers.includes(markerId)) {\r\n        return false;\r\n    }\r\n    markers[markerId].setMap(null);\r\n    delete markers[markerId];\r\n    return true;\r\n}\r\n\r\nexport function removeAllMarkers() {\r\n    for (var key in markers) {\r\n        if (!lockedMarkers.includes(parseInt(key))) {\r\n            markers[key].setMap(null);\r\n        }\r\n    }\r\n    markers = {};\r\n    return true;\r\n}\r\n\r\nexport function addInfoWindow(markerId, content, open = false) {\r\n    var marker = egetMarker(markerId);\r\n    if (!marker) {\r\n        return false;\r\n    }\r\n\r\n    var infowindow = new google.maps.InfoWindow({\r\n        content: content\r\n    });\r\n\r\n    marker.addListener(\"click\", function () {\r\n        infowindow.open(map, marker);\r\n    });\r\n\r\n    if (open) {\r\n        infowindow.open(map, marker);\r\n    }\r\n\r\n    infoWindows[infoWindowInc] = infowindow;\r\n    return infoWindowInc++;\r\n}\r\n\r\nexport function addPolyline(coords, strokeColor, strokeWeight, strokeOpacity = 1.0, geodesic = true) {\r\n    var polyline = new google.maps.Polyline({\r\n        path: coords,\r\n        geodesic: geodesic,\r\n        strokeColor: strokeColor,\r\n        strokeOpacity: strokeOpacity,\r\n        strokeWeight: strokeWeight\r\n    });\r\n\r\n    polyline.setMap(map);\r\n\r\n    polylines[polylineInc] = polyline;\r\n    return polylineInc++;\r\n}\r\n\r\nexport function lockPolyline(polylineId) {\r\n    if (!polyline || !polylines[polylineId]) {\r\n        return false;\r\n    }\r\n    if (lockedPolylines.indexOf(polylineId) === -1) {\r\n        lockedPolylines.push(polylineId);\r\n    }\r\n    return true;\r\n}\r\n\r\nexport function unlockPolyline(polylineId) {\r\n    var i = lockedPolylines.indexOf(polylineId);\r\n    if (i === -1) {\r\n        return false;\r\n    }\r\n    lockedPolylines.splice(i, 1);\r\n    return true;\r\n}\r\n\r\nexport function removePolyline(polylineId) {\r\n    if (!polylineId || !polylines[polylineId]) {\r\n        return false;\r\n    }\r\n    if (lockedPolylines.includes(polylineId)) {\r\n        return false;\r\n    }\r\n    polylines[polylineId].setMap(null);\r\n    delete polylines[polylineId];\r\n    return true;\r\n}\r\n\r\nexport function removeAllPolylines() {\r\n    for (var key in polylines) {\r\n        if (!lockedPolylines.includes(key)) {\r\n            polylines[key].setMap(null);\r\n        }\r\n    }\r\n    polylines = {};\r\n    return true;\r\n}\r\n\r\nexport function fitBounds(bounds) {\r\n    var out = new google.maps.LatLngBounds();\r\n    for (var bound of bounds) {\r\n        out.extend(bound);\r\n    }\r\n    map.fitBounds(out);\r\n}"],"sourceRoot":""}
(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{106:function(t,a,e){"use strict";e.r(a),function(t){e.d(a,"enable",(function(){return J})),e.d(a,"disable",(function(){return W}));e(9);var i,s,r,n,l,o,d,c,p,u,g=e(33),v=e(43),h=e(7),f=e(8),m=e(32),y=e(30),b=e(225),w=e(5),_=e(21),C=e(2),k=e(6),x=!1,T=!1,E=!1;function O(){b.d()}function I(a){t(".gtw-providersort-provider").each((function(){var e=t(this).attr("data-gtw-package"),i=t(this).attr("data-gtw-provider"),s=t(this).attr("data-gtw-agency");t(a+" .route-selection"+("[data-gtw-package='"+e+"'][data-gtw-provider='"+i+"'][data-gtw-agency='"+s+"']")).length>0?t(this).css("display",""):t(this).css("display","none")}))}var q,D=["monday","tuesday","wednesday","thursday","friday","saturday","sunday"],N=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],U=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"];function M(t){var a,e,i={};for(a=0;a<D.length;a++)i[D[a]]=0;for(a=0;a<t.length;a++)for(e=0;e<D.length;e++)i[D[e]]|=t[a][D[e]];return i}function A(a,e=!1){if(a.monday&&a.tuesday&&a.wednesday&&a.thursday&&a.friday&&a.saturday&&a.sunday)return!!e&&t.i18n("transit-calendar-from-monday-to-sunday-dates");if(a.monday&&a.tuesday&&a.wednesday&&a.thursday&&a.friday&&a.saturday)return t.i18n("transit-calendar-from-monday-to-saturday"+(e?"-dates":""));if(a.monday&&a.tuesday&&a.wednesday&&a.thursday&&a.friday)return t.i18n("transit-calendar-from-monday-to-friday"+(e?"-dates":""));if(a.monday&&a.tuesday&&a.wednesday&&a.thursday)return t.i18n("transit-calendar-from-monday-to-thursday"+(e?"-dates":""));if(a.saturday&&a.sunday)return t.i18n("transit-calendar-from-saturday-to-sunday"+(e?"-dates":""));if(a.saturday)return t.i18n("transit-calendar-on-saturday"+(e?"-dates":""));if(a.sunday)return t.i18n("transit-calendar-on-sunday"+(e?"-dates":""));var i,s="";for(i=0;i<D.length;i++)s+=a[D[i]]?N[i].substr(0,1):".";return s}async function K(){var a=setTimeout((function(){t(".loading-overlay").fadeIn(500)}),500);b.g({}),b.b();var e,i=t("#search-transit-text").val();var s='<ul class="list-group">';if(0===i.length)e=await k.g(i.length,1,!0);else{var r,n,l,o,d,c,p,u,g,v,h,f,y,w,_,C,x,T,E=await k.r(i),O={};e=[];for(r=0;r<E.length;r++){if(g=(p=E[r]).route_id,o=m.localizedKey(p,"route_short_name"),C=p.package,x=p.provider,T=p.agency_id,i.length<o.length){var q=o.substr(i.length,1);e.includes(q)||e.push(q)}for(u=await k.f(C,x,T),d=await k.o(C,x,g),_=[],y=[],n=0;n<d.length;n++)w=(c=d[n]).path_id,f=c.service_id,_.includes(w)||_.push(w),y.includes(f)||y.push(f);for(n=0;n<_.length;n++){w=_[n],s+='<li class="list-group-item list-group-item-action d-flex align-items-center route-selection"  data-gtw-package="'+C+'" data-gtw-provider="'+x+'" data-gtw-agency="'+T+'" data-gtw-route-id="'+p.route_id+'" data-gtw-path-id="'+w+'">    <div class="d-flex flex-column route-id">        <div>'+m.localizedKey(u,"agency_short_name")+"</div>        <div>"+o+'</div>    </div>    <div class="d-flex flex-column stop-info mr-auto">',h=await k.n(C,x,w),v=await k.m(C,x,h[h.length-1].stop_id),s+="        <div><b>"+t.i18n("transit-eta-to")+":</b> "+k.t(u.agency_id,m.localizedKey(v,"stop_name"))+"</div>";var D=[];for(l=0;l<y.length;l++)O[f=y[l]]||(O[f]=await k.h(C,x,f)),D.push(O[f]);s+="<div>";var N=!1;h[0].stop_id===v.stop_id&&(N=!0,s+='<span class="badge badge-secondary">'+t.i18n("transit-circular-path")+"</span>");var U=A(M(D));U&&(N&&(s+=" ",N=!1),s+='<span class="badge badge-secondary">'+U+"</span>"),s+="        </div>    </div></li>"}}}s+="</ul>",t(".all-route-list").html(s),console.log(e);var K={};for(var j of e)K[j]=!0;console.log(K),b.g(K),b.c(),t(".all-route-list .route-selection").on("mouseenter",R),t(".all-route-list .route-selection").on("click",S),I(".all-route-list"),clearTimeout(a),t(".loading-overlay").fadeOut(500),adjustMargin()}function j(){t(".gtw-providersort").removeClass("btn-primary"),t(".gtw-providersort-all").addClass("btn-primary"),t(".route-selection").attr("style","")}function z(){t(".all-route-list").html(""),O(),t("#search-transit-text").val(""),E=!1,t("#button-cancel-search").addClass("btn-light"),t("#button-cancel-search").addClass("disabled"),t("#button-cancel-search").removeClass("btn-danger"),t("#button-cancel-search").html('<i class="fas fa-search"></i>'),t(".nearby-route-list").css("display","flex"),t(".all-route-list").css("display","none"),C.g(y.a()),C.i(16),C.e(),C.f(),j(),I(".nearby-route-list"),b.f()}async function S(){var a=t(this).attr("data-gtw-package"),e=t(this).attr("data-gtw-provider"),i=t(this).attr("data-gtw-agency"),s=t(this).attr("data-gtw-route-id"),r=t(this).attr("data-gtw-path-id"),n=t(this).attr("data-gtw-stop-id"),l=await k.n(a,e,r);if(!n&&y.d()){var o,d,c=y.a(),p=!1,u=!1;for(var g of l)o=await k.m(a,e,g.stop_id),d=f.c(o.stop_lat,o.stop_lon,c.lat,c.lng),(!p||!u||d<p)&&(p=d,u=o);console.log(p),p<=2&&(n=u.stop_id)}var v=setTimeout((function(){t(".loading-overlay").fadeIn(500)}),500);C.e(),C.f(),await async function(a,e,i,s,r,n,l=!1,o=!1){var d,c,p,u=await k.n(a,e,r),g=await k.k(a,e,s),v=await k.f(a,e,i),h=u[u.length-1],f=await k.m(a,e,h.stop_id),y=await k.o(a,e,s),b={};for(L=0;L<y.length;L++)if(r===y[L].path_id)for(var w of(c=y[L].trip_id,O=y[L].service_id,b[O]||(b[O]={calendar:await k.h(a,e,O),freqs:[]}),d=b[O],await k.j(a,e,c))){for(var _ of(p=!1,d.freqs))if(_.start_time===w.start_time&&_.end_time===w.end_time&&_.headway_secs===w.headway_secs){p=!0;break}p||d.freqs.push(w)}var x='<ul class="list-group"><li class="list-group-item d-flex align-items-center route-selection">    <div class="d-flex flex-column route-id">        <div>'+m.localizedKey(v,"agency_short_name")+"</div>        <div>"+m.localizedKey(g,"route_short_name")+'</div>    </div>    <div class="d-flex flex-column stop-info mr-auto">        <div><b>'+t.i18n("transit-eta-to")+":</b> "+k.t(i,m.localizedKey(f,"stop_name"))+"</div><div>",T=!1;u[0].stop_id===f.stop_id&&(T=!0,x+='<span class="badge badge-secondary">'+t.i18n("transit-circular-path")+"</span>");var E=[];for(var O in b)E.push(b[O].calendar);var I,q=A(M(E));q&&(T&&(x+=" ",T=!1),x+='<span class="badge badge-secondary">'+q+"</span>");for(x+='</div></div></li></ul><ul class="nav nav-pills nav-fill m-2" role="tablist" id="pills-route-list-tab">    <li class="nav-item">        <a class="nav-link active" id="pills-route-tab" data-toggle="pill" href="#pills-route" role="tab" aria-controls="pills-route" aria-selected="true">'+t.i18n("transit-route-tab-route-list")+'</a>    </li>    <li class="nav-item">        <a class="nav-link" id="pills-timetable-tab" data-toggle="pill" href="#pills-timetable" role="tab" aria-controls="pills-timetable" aria-selected="false">'+t.i18n("transit-route-tab-timetable")+'</a>    </li>    <li class="nav-item">        <a class="nav-link disabled" id="pills-other-routes-tab" data-toggle="pill" href="#pills-other-routes" role="tab" aria-controls="pills-other-routes" aria-selected="false">'+t.i18n("transit-route-tab-other-routes")+"</a>    </li></ul>",t(".half-map-tab-panel").html(x),x='<div class="tab-content" id="pills-route-list-tabContent">    <div class="tab-pane fade show active" id="pills-route" role="tabpanel" aria-labelledby="pills-route-tab">        <div class="row" style="padding: 2%;">            <div class="timeline-centered">',L=0;L<u.length;L++)I=await k.m(a,e,u[L].stop_id),x+='<article class="timeline-entry" data-gtw-package="'+a+'" data-gtw-provider="'+e+'" data-gtw-agency="'+i+'" data-gtw-route-id="'+s+'" data-gtw-path-id="'+r+'" data-gtw-stop-id="'+I.stop_id+'">    <div class="timeline-entry-inner">        <div class="timeline-icon bg-light">            '+(L+1)+'        </div>        <div class="timeline-label">            <h2><button style="padding: 0px;" class="btn btn-link" data-gtw-package="'+a+'" data-gtw-provider="'+e+'" data-gtw-agency="'+i+'" data-gtw-route-id="'+s+'" data-gtw-path-id="'+r+'" data-gtw-stop-id="'+I.stop_id+'" data-gtw-stop-sequence="'+u[L].stop_sequence+'" data-gtw-stop-index="'+L+'">'+k.t(i,m.localizedKey(I,"stop_name"))+'</button></h2>            <p class="stop-eta-info"></p>        </div>    </div></article>';x+='            </div>        </div>    </div>    <div class="tab-pane fade" id="pills-timetable" role="tabpanel" aria-labelledby="pills-timetable-tab">';var D,N='<ul class="nav nav-pills nav-fill mb-3" id="calendar-tab" role="tablist">',K='<div class="tab-content" id="calendar-tabContent">',j=new Date,z={},S=!1;for(var O in b){var R=1===b[O].calendar[U[j.getDay()]];z[O]=R,S|=R}var L=0;for(var O in b){var H,F;if(d=b[O],D=A(d.calendar,!0),S?(F=z[O],H=F):(F=!1,H=0===L),N+='<li class="nav-item">    <a class="nav-link'+(H?" active":"")+'" id="calendar-'+O+'-tab" data-toggle="pill" href="#calendar-'+O+'" role="tab" aria-controls="calendar-'+O+'" aria-selected="'+(H?"true":"false")+'">'+(F?'<i class="fas fa-hourglass-half"></i> ':"")+D+"</a></li>",K+='<div class="tab-pane fade'+(H?" show active":"")+'" id="calendar-'+O+'" role="tabpanel" aria-labelledby="calendar-'+O+'-tab">    <table class="table">        <thead class="thead-light">            <tr>                <th scope="col" colspan="'+(F&&S?"4":"3")+'">'+t.i18n("transit-calendar-header-timeslot")+'</th>                <th scope="col">'+t.i18n("transit-calendar-header-headway-min")+"</th>            </tr>        </thead>        <tbody>",L++,d.freqs.length>0)for(var w of d.freqs){var P=Math.round(w.headway_secs/60);K+="            <tr>",F&&S&&(k.p(w)?K+='                <td><i class="fas fa-hourglass-half"></i></td>':K+="                <td></td>"),K+="                <td>"+w.start_time+"</td>                <td>-</td>                <td>"+w.end_time+"</td>                <td>"+P+"</td>            </tr>"}else K+='                <td colspan="4">'+t.i18n("transit-eta-no-timetable")+"</td>            </tr>";K+="        </tbody>    </table></div>"}x+=(N+="</ul>")+K+'    </div>    <div class="tab-pane fade" id="pills-other-routes" role="tabpanel" aria-labelledby="pills-other-routes-tab">',x+="</div></div>",t(".half-map-container").html(x),t(".half-map-container button").on("click",(function(){var a=t(this).attr("data-gtw-package"),e=t(this).attr("data-gtw-provider"),i=t(this).attr("data-gtw-agency"),s=t(this).attr("data-gtw-route-id"),r=t(this).attr("data-gtw-path-id"),n=t(this).attr("data-gtw-stop-id");V(a,e,i,s,r,u,n)})),t(".nav-pills[role='tablist'] .nav-item a").on("click",(function(){var a=t(this).parent().parent().attr("id"),e=a.lastIndexOf("-tab"),i=a.substr(0,e)+"-tabContent",s=t(this).attr("aria-controls");t(".tab-content[id='"+i+"']").children(".tab-pane").each((function(){var a=t(this).attr("id");a!==s?(t(this).removeClass("show"),t(this).removeClass("active")):(t(this).addClass("show"),t(this).addClass("active"),a.startsWith("calendar-")||t(this)[0].scrollIntoView())}))})),o&&await async function(t){var a,e,i,s=[];for(i=0;i<t.length;i++)a={lat:(e=await k.m(t[i].package,t[i].provider,t[i].stop_id)).stop_lat,lng:e.stop_lon},s.push(a),C.a(a,{title:e.stop_name,label:""+(i+1)});C.b(s,"#FF0000",2)}(u);adjustMargin()}(a,e,i,s,r,0,!0,!0),_.b(),O(),await V(a,e,i,s,r,l,n),clearTimeout(v),t(".loading-overlay").fadeOut(500)}function R(){console.warn("TODO: Preview route")}async function V(a,e,i,r,n,l,o){var d=screen.width>=768?".desktop":".mobile",c=t(d+" .timeline-entry[data-gtw-stop-id='"+o+"']"),p=t(d+" .timeline-entry:not([data-gtw-stop-id='"+o+"'])"),u=c.children(".timeline-entry-inner").children(".timeline-icon"),v=c.children(".timeline-entry-inner").children(".timeline-icon");if(u.removeClass("bg-light"),u.addClass("bg-primary"),v.addClass("bg-light"),v.removeClass("bg-primary"),p.children(".timeline-entry-inner").children(".timeline-label").children("p").html(""),scroll){var h=c[0];void 0===h&&(h=t(d+" .timeline-entry")[0]),h.scrollIntoView()}if(o){var y=await k.f(a,e,i),b=await k.k(a,e,r),w=await k.i(a,e,b.route_id),x=await k.m(a,e,o),T={lat:x.stop_lat,lng:x.stop_lon};C.g(T),C.i(18),async function(a,e,i,r,n){if(H)return;H=!0;var l=t(".timeline-entry[data-gtw-stop-id='"+n.stop_id+"'] .stop-eta-info"),o="<u>"+t.i18n("transit-eta")+'</u> <div class="spinner-border spinner-border-sm eta-loading-spinner" role="status"></div><table class="table stop-eta">    <tr class="table-dark">        <td colspan="4"><div class="spinner-border spinner-border-sm" role="status"></div> '+t.i18n("transit-eta-retrieving-data")+"</td>    </tr></table>";l.html(o),q=!1,async function(a,e,i,s,r){var n=t(".timeline-entry[data-gtw-stop-id='"+s+"'] p table tbody"),l=await k.l(a,e,i,r),o=-1;for(p=0;p<l.length;p++)if(k.p(l[p])){o=p;break}var d="";if(-1!==o)for(var c=o+3>=l.length?l.length:o+3,p=o;p<c;p++){var u=Math.round(l[p].headway_secs/60),g=k.u(l[p].start_time);d+='<tr class="table-secondary'+(p==o?" active":"")+'">    <td>'+t.i18n("transit-eta-every-minutes",u)+'</td>    <td colspan="2">'+f.b(g.getHours())+":"+f.b(g.getMinutes())+"</td></tr>"}else 0===l.length?d+='<tr class="table-dark">    <td colspan="4">'+t.i18n("transit-eta-no-timetable")+"</td></tr>":d+='<tr class="table-dark">    <td colspan="4">'+t.i18n("transit-eta-not-in-service")+"</td></tr>";q||n.html(d)}(e.package,e.provider,e.route_id,n.stop_id,r[0].path_id),clearInterval(s);var d=function(){!async function(a,e,i,s,r){if(L)return;L=!0,t(".eta-loading-spinner").css("display","");try{var n=await g.fetchEta({etaProviders:a.agency_id.split("+"),agency:a,route:e,trip:i,stopTimes:s,stop:r});t(".stop-eta-msg").remove(),t(".eta-loading-spinner").css("display","none"),console.log(n);var l=n.options,o="";t(".timeline-entry[data-gtw-stop-id='"+l.stop.stop_id+"'] .stop-eta-info table tbody");if(-2===n.code){var d='<p class="stop-eta-msg">*'+t.i18n("transit-eta-no-eta-providers")+"</p>";t(".timeline-entry[data-gtw-stop-id='"+l.stop.stop_id+"'] .stop-eta-info").append(d)}else if(-1===n.code||n.feeds&&0===n.feeds.length){d='<p class="stop-eta-msg">*'+t.i18n("transit-eta-no-data-received")+"</p>";t(".timeline-entry[data-gtw-stop-id='"+l.stop.stop_id+"'] .stop-eta-info").append(d)}else{var c=[],p=[];for(var u of n.feeds)for(var v of u.entity){var h=v.tripUpdate;if(h){var y=h.timestamp?h.timestamp:u.header.timestamp;p.push({timestamp:y,entity:v})}v.alert&&c.push(v.alert)}if(c.length>0){var b="";b=1===c.length?'<div class="stop-eta-msg alert alert-warning"><i class="fas fa-exclamation-triangle"></i> <b>'+m.translatedString(c[0].headerText)+"</b></div>":'<div class="stop-eta-msg alert alert-warning"><i class="fas fa-exclamation-triangle"></i> <b>'+t.i18n("transit-eta-alerts-affecting-stop",c.length)+'</b> <button class="btn btn-link view-alert-btn">'+t.i18n("transit-eta-view-alerts-affecting-stop")+"</button></div>",t(".timeline-entry[data-gtw-stop-id='"+l.stop.stop_id+"'] .stop-eta-info").prepend(b),t(".view-alert-btn").on("click",(function(){_.d("viewgtfsalerts",c)}))}if(0===p.length){d='<p class="stop-eta-msg">*'+t.i18n("transit-eta-no-schedules-pending")+"</p>";t(".timeline-entry[data-gtw-stop-id='"+l.stop.stop_id+"'] .stop-eta-info").append(d)}else{o="";var w=!1;for(var C of p){var k=C.entity.tripUpdate.stopTimeUpdate;if(k&&k.length>0)for(var x of k)if(!x.scheduleRelationship||"SCHEDULED"===x.scheduleRelationship){var T;x.departure?T=x.departure.time:x.arrival&&(T=x.arrival.time);var E=Math.floor((T-C.timestamp)/1e3/60);d='<tr class="table-';d+=E>=20?"secondary":E>=15?"info":E>=10?"success":E>=5?"warning":E>=1?"danger":"dark",!w&&E>0&&(w=!0,d+=" active"),d+='">';C.entity.vehicle&&C.entity.vehicle.vehicle&&C.entity.vehicle.vehicle.label&&(d+="<td>"+C.entity.vehicle.vehicle.label+"</td>"),d+="<td>",d+=E>0?t.i18n("transit-eta-minutes",E):t.i18n("transit-eta-arrived-left"),d+="</td><td",d+=' colspan="2"',d+=">";var O=new Date(T);d+=f.b(O.getHours())+":"+f.b(O.getMinutes()),d+="</td>",o+=d+="</tr>"}}t(".timeline-entry[data-gtw-stop-id='"+l.stop.stop_id+"'] .stop-eta-info table tbody").html(o),q=!0}}}catch(a){t(".eta-loading-spinner").css("display","none");d='<p class="text-danger stop-eta-msg">*'+t.i18n("transit-eta-error-fetching-eta")+"</p>";t(".timeline-entry[data-gtw-stop-id='"+r.stop_id+"'] .stop-eta-info").append(d)}L=!1}(a,e,i,r,n)};d(),s=setInterval(d,3e4),H=!1}(y,b,w,l,x)}}var L=!1;var H=!1;function F(){var a=v.b.length;if(a>0){t(".request-progress-panel").fadeIn(500);var e=l;(!e||a>e)&&(e=l=a),t(".request-progress-panel .progress-bar").html(t.i18n("transit-eta-requesting-data",e-a,e)),t(".request-progress-panel .progress-bar").css("width",Math.floor((e-a)/e*100)+"%")}else l=0,t(".request-progress-panel .progress-bar").css("width","100%"),t(".request-progress-panel").fadeOut(500,(function(){t(".request-progress-panel .progress-bar").css("width","0%")}));for(var i of n){k.get;g.fetchEta({etaProviders:i.route.agency_id.split("+"),agency:i.agency,route:i.route,trip:i.trip,stop:i.stop,stopTimes:i.path}).then((function(a){var e="",i=a.options,s=t('.nearby-route-list .route-selection[data-gtw-package="'+i.agency.package+'"][data-gtw-provider="'+i.agency.provider+'"][data-gtw-agency="'+i.agency.agency_id+'"][data-gtw-route-id="'+i.route.route_id+'"][data-gtw-path-id="'+i.trip.path_id+'"][data-gtw-stop-id="'+i.stop.stop_id+'"]');s.removeClass("list-group-item-secondary"),s.removeClass("list-group-item-info"),s.removeClass("list-group-item-success"),s.removeClass("list-group-item-warning"),s.removeClass("list-group-item-danger"),s.removeClass("list-group-item-light"),s.removeClass("list-group-item-dark");var r="btn-secondary";if(a.code<0)e=t.i18n("transit-eta-route-not-available-short"),s.addClass("list-group-item-light");else if(0===a.feeds.length)e=t.i18n("transit-eta-no-feed-received"),s.addClass("list-group-item-light");else{var n=[];for(var l of a.feeds)for(var o of l.entity){var d=o.tripUpdate;if(d){var c=d.timestamp?d.timestamp:l.header.timestamp;n.push({timestamp:c,tripUpdate:d})}}if(0===n.length)e=t.i18n("transit-eta-no-schedules-pending-short"),s.addClass("list-group-item-light");else{var p=n[0],u=p.tripUpdate.stopTimeUpdate;if(u&&u.length>0){var g=u[0];if(g.scheduleRelationship&&"SCHEDULED"!==g.scheduleRelationship)console.log("NODATA");else{var v;g.departure?v=g.departure.time:g.arrival&&(v=g.arrival.time);var h=Math.floor((v-p.timestamp)/1e3/60),f="";f=h>=20?"secondary":h>=15?"info":h>=10?"success":h>=5?"warning":h>=1?"danger":"dark",s.addClass("list-group-item-"+f),r="badge-primary",h>0?e+=t.i18n("transit-eta-minutes",h):(e+=t.i18n("transit-eta-arrived-left",h),r="badge-dark")}}else console.log("Cancelled")}}var m=s.children(".transit-eta");m.removeClass("badge-primary"),m.removeClass("badge-secondary"),m.removeClass("badge-warning"),m.removeClass("badge-danger"),m.removeClass("badge-dark"),m.addClass(r),m.html(e)})).catch((function(a,e){var i=t('.nearby-route-list .route-selection[data-gtw-package="'+a.agency.package+'"][data-gtw-provider="'+a.agency.provider+'"][data-gtw-agency="'+a.agency.agency_id+'"][data-gtw-route-id="'+a.route.route_id+'"][data-gtw-path-id="'+a.trip.path_id+'"][data-gtw-stop-id="'+a.stop.stop_id+'"]');i.removeClass("list-group-item-secondary"),i.removeClass("list-group-item-info"),i.removeClass("list-group-item-success"),i.removeClass("list-group-item-warning"),i.removeClass("list-group-item-danger"),i.removeClass("list-group-item-light"),i.removeClass("list-group-item-dark"),i.addClass("list-group-item-light");var s=i.children(".transit-eta");s.removeClass("badge-primary"),s.removeClass("badge-secondary"),s.removeClass("badge-warning"),s.removeClass("badge-danger"),s.removeClass("badge-dark"),s.addClass("badge-danger"),s.html(t.i18n("transit-eta-error-fetching-eta-short"))}))}}async function P(){clearInterval(r);var a=y.a(),e=a.lat,i=a.lng;x=e,T=i;var s=h.get("min_nearby_transit_range",200)/1e3,l=Date.now(),o=await k.q(e,i,s,!0);if(0===o.length){var d=s;do{d+=.05,o=await k.q(e,i,d,!0,!0)}while(0===o.length&&d<10);d>=10?t(".tab-panel").append('<div class="alert alert-danger alert-dismissable"><button type="button" class="close" data-dismiss="alert" aria-hidden="true" >&#215;</button>'+t.i18n("transit-eta-no-routes-found-10-km")+"</div>"):t(".tab-panel").append('<div class="alert alert-warning alert-dismissable"><button type="button" class="close" data-dismiss="alert" aria-hidden="true" >&#215;</button>'+t.i18n("transit-eta-no-routes-found-nearby-extended-range",1e3*s,Math.ceil(1e3*d))+"</div>")}console.log("Used: "+(Date.now()-l)),l=Date.now();var c,p=h.get("max_nearby_transit_to_display",20);for(var u of(n=[],console.log(o),o)){if(n.length>=p)break;var g,v=(g=u.stop).package,f=g.provider,b=await k.s(v,f,g.stop_id);for(var w in b.trips){var _=b.trips[w],C=await k.f(v,f,b.routes[w].agency_id),E=await k.n(v,f,_.path_id);n.push({agency:C,route:b.routes[w],trip:_,stop:g,stopTime:b.stopTimes[_.path_id],path:E,distance:u.distance})}}console.log("Used: "+(Date.now()-l)),l=Date.now(),n.sort((t,a)=>t.distance-a.distance),console.log("Used: "+(Date.now()-l)),l=Date.now(),console.log(n);var O='<ul class="list-group">';for(var q of n)c=Math.round(1e3*q.distance),C=await k.f(q.route.package,q.route.provider,q.route.agency_id),g=await k.m(q.stopTime.package,q.stopTime.provider,q.stopTime.stop_id),O+='    <li class="list-group-item list-group-item-action d-flex justify-content-between align-items-center route-selection" data-gtw-package="'+q.route.package+'" data-gtw-provider="'+q.route.provider+'" data-gtw-agency="'+q.route.agency_id+'" data-gtw-route-id="'+q.route.route_id+'" data-gtw-path-id="'+q.trip.path_id+'" data-gtw-stop-id="'+q.stopTime.stop_id+'" data-gtw-stop-seq="'+q.stopTime.stop_sequence+'">        <div class="d-flex flex-column route-id">            <div>'+m.localizedKey(C,"agency_short_name")+"</div>            <div>"+m.localizedKey(q.route,"route_short_name")+'</div>        </div>        <div class="d-flex flex-column stop-info mr-auto">            <div>                '+k.t(C.agency_id,m.localizedKey(g,"stop_name"))+" ("+c+t.i18n("transit-eta-metres")+')            </div>        </div>        <span class="badge badge-primary badge-pill transit-eta">'+t.i18n("transit-eta-retrieving")+"</span>    </li>";O+="</ul>",t(".nearby-route-list").html(O),console.log("Used: "+(Date.now()-l)),t(".nearby-route-list .route-selection").on("mouseenter",R),t(".nearby-route-list .route-selection").on("mouseleave",(function(){})),t(".nearby-route-list .route-selection").on("click",S),I(".nearby-route-list"),F(),r=setInterval(F,3e4)}function B(){var a='<div class="d-flex justify-content-center w-100">    <div class="text-center">        <div class="spinner-grow m-5" style="width: 3rem; height: 3rem;"></div>        <div>'+t.i18n("transit-searching-nearby-routes")+"</div>    </div></div>";t(".nearby-route-list").html(a),P()}function G(a){console.log(a);var e='<div class="d-flex justify-content-center w-100">    <div class="text-center text-dark">        <i class="fas fa-exclamation-triangle m-5" style="width: 3rem; height: 3rem;"></i>        <div class="ml-3 mr-3">'+(1===a.code?t.i18n("location-error-user-denied-location"):2===a.code||3===a.code?t.i18n("location-error-could-not-get-location"):t.i18n("location-error-unknown",a.message))+"</div>    </div></div>";t(".nearby-route-list").html(e)}async function J(){v.a(),g.clearCache(),b.a(o=function(a){var e;if(t(a).hasClass("touch-keypad-function-done"))O(),adjustMargin();else if(t(a).hasClass("touch-keypad-function-backspace"))e=t("#search-transit-text").val(),t("#search-transit-text").val(e.slice(0,-1)),K();else if(t(a).hasClass("touch-keypad-value")){var i=t(a).html();e=t("#search-transit-text").val(),t("#search-transit-text").val(e+i),K()}}),w.b(w.a.EVENT_UI_BACK,d=function(){E&&b.h(),clearInterval(s)}),w.b(w.a.EVENT_LOCATION_ERROR,u=function(t){G(t)}),w.b(w.a.EVENT_LOCATION_SUCCESS,p=function(){B()}),w.b(w.a.EVENT_LOCATION_CHANGE,c=function(){if(x&&T){var t=y.a();f.c(t.lat,t.lng,x,T)>.125&&(console.log("Location moved 125 m away. Finding new nearby routes."),P())}});var a=await k.e();if(a.length>0){var e='<div class="hori-scroll btn-group">    <button type="button" class="btn btn-primary gtw-providersort gtw-providersort-all"><i class="fa fa-reply-all"></i><br />'+t.i18n("transit-eta-sort-all")+"</button>";for(var r of a){e+=' <button type="button" class="btn btn-default gtw-providersort gtw-providersort-provider" data-gtw-package="'+r.package+'" data-gtw-provider="'+r.provider+'" data-gtw-agency="'+r.agency_id+'"><i class="fa fa-bus"></i><br />'+m.localizedKey(r,"agency_short_name")+"</button>"}e+="</div>",t(".tab-panel").append(e);var n='<div class="input-group mb-3" style="margin-top: 16px;">    <input type="text" class="form-control" placeholder="'+t.i18n("transit-eta-placeholder-search-for-transit")+'" aria-label="'+t.i18n("transit-eta-placeholder-search-for-transit")+'" aria-describedby="search-transit-icon" id="search-transit-text" readonly/>    <div class="input-group-append">        <button class="btn btn-light disabled" type="button" id="button-cancel-search"><i class="fas fa-search"></i></button>    </div></div>';t(".tab-panel").append(n);t(".tab-panel").append('<div class="request-progress-panel">    <div class="progress bg-white">        <div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" style="width: 0%;"></div>    </div></div>'),t(".gtw-providersort").on("click",(function(){if(!t(this).hasClass("btn-primary"))if(t(this).hasClass("gtw-providersort-all"))j();else{t(".gtw-providersort").removeClass("btn-primary");var a=t(this).attr("data-gtw-package"),e=t(this).attr("data-gtw-provider"),i=t(this).attr("data-gtw-agency");t(this).addClass("btn-primary");var s="[data-gtw-package='"+a+"'][data-gtw-provider='"+e+"'][data-gtw-agency='"+i+"']";t(".gtw-providersort-provider:not("+s+")").addClass("btn-default"),t(".route-selection"+s).attr("style",""),t(".route-selection:not("+s+")").attr("style","display: none!important")}})),t("#button-cancel-search").on("click",(function(){t(this).hasClass("disabled")||z()}));t("#search-transit-text").on("click",(function(){b.h(),E=!0,t("#button-cancel-search").removeClass("btn-light"),t("#button-cancel-search").removeClass("disabled"),t("#button-cancel-search").addClass("btn-danger"),t("#button-cancel-search").html('<i class="fas fa-times"></i>'),t(".nearby-route-list").css("display","none"),t(".all-route-list").css("display","flex"),C.g(y.a()),C.i(16),C.e(),C.f(),K(),j(),I(".all-route-list")})),t("#search-transit-text").on("input",(function(){clearTimeout(i),i=setTimeout((function(){K()}),500)}));if(t(".content-panel-container").html('<div class="row item-list nearby-route-list"></div><div class="row item-list all-route-list"></div>'),y.c())G(y.b());else if(y.d())B();else{var l='<div class="d-flex justify-content-center w-100">    <div class="text-center">        <div class="spinner-grow m-5" style="width: 3rem; height: 3rem;"></div>        <div>'+t.i18n("transit-locating-your-location")+"</div>    </div></div>";t(".nearby-route-list").html(l)}}else t(".tab-panel").html('<br /><div class="alert alert-danger" role="alert"><i class="fas fa-exclamation-triangle"></i> '+t.i18n("transit-eta-no-plugins-providing-transit-data")+"</div>")}function W(){b.e(o),w.d(w.a.EVENT_UI_BACK,d),w.d(w.a.EVENT_LOCATION_ERROR,u),w.d(w.a.EVENT_LOCATION_SUCCESS,p),w.d(w.a.EVENT_LOCATION_CHANGE,c),clearTimeout(i),clearInterval(r),clearInterval(s),i=!1,r=!1}}.call(this,e(0))},225:function(t,a,e){"use strict";(function(t){e.d(a,"f",(function(){return r})),e.d(a,"h",(function(){return n})),e.d(a,"d",(function(){return l})),e.d(a,"a",(function(){return o})),e.d(a,"e",(function(){return d})),e.d(a,"c",(function(){return c})),e.d(a,"b",(function(){return p})),e.d(a,"g",(function(){return u}));var i=[];function s(){if(t(this).blur(),!t(this).hasClass("disabled"))for(var a of i)a(this)}function r(){t(".numeric-keypad .touch-keypad-value").each((function(){t(this).removeClass("disabled"),t(this).removeClass("btn-secondary"),t(this).addClass("btn-outline-secondary")}))}function n(){t(".touch-keypad").css("display","flex"),adjustMargin()}function l(){t(".touch-keypad").css("display",""),adjustMargin()}function o(t){return"function"==typeof t&&(i.push(t),!0)}function d(t){if("function"!=typeof t)return!1;var a=i.indexOf(t);return-1!==a&&(i.splice(a,1),!0)}function c(){t(".touch-keypad-function").removeClass("disabled")}function p(){t(".touch-keypad-function").addClass("disabled")}function u(a){t(".numeric-keypad .touch-keypad-value").each((function(){var e=t(this).html();a[e]?(t(this).removeClass("disabled"),t(this).removeClass("btn-secondary"),t(this).addClass("btn-outline-secondary")):(t(this).addClass("disabled"),t(this).addClass("btn-secondary"),t(this).removeClass("btn-outline-secondary")),delete a[e]}));var e=Object.keys(a);e.sort((function(t,a){return t.charCodeAt(0)-a.charCodeAt(0)}));var i="";for(var r of e)i+='<button type="button" class="btn btn-outline-secondary py-3 touch-keypad-key touch-keypad-value">'+r+"</button>";t(".letter-keypad").html(i),t(".letter-keypad .touch-keypad-value").on("click",s)}t(".touch-keypad-function-done").on("click",s),t(".touch-keypad-function-backspace").on("click",s),t(".touch-keypad-value").on("click",s)}).call(this,e(0))}}]);
//# sourceMappingURL=1.b0607d4c05ac9047aba0.js.map
{"version":3,"sources":["webpack:///./src/gtw-map.js","webpack:///./src/gtw-lang.js","webpack:///./src/gtw-settings.js","webpack:///./src/gtw-citydata-transit-stops.js","webpack:///./src/gtw-misc.js","webpack:///./src/gtw-citydata-transit-routes.js","webpack:///./src/gtw-pluginloader.js","webpack:///./src/gtw-db.js","webpack:///./src/gtw-citydata-transit-eta.js","webpack:///./src/gtw-location.js","webpack:///./src/gtw-requestlimiter.js","webpack:///./src/gtw-cors.js","webpack:///./src/gtw-citydata-transit.js","webpack:///./src/gtw-ui.js","webpack:///./src/gtw-config.js","webpack:///./src/app.js","webpack:///./node_modules/@wikimedia/jquery.i18n/src sync ^\\.\\/.*$","webpack:///./src/style.css?9819","webpack:///./src/style.css","webpack:///./src/timeline.css?025a","webpack:///./src/timeline.css","webpack:///./src/plugins lazy ^\\.\\/.*$ namespace object","webpack:///./src lazy ^\\.\\/gtw\\-map\\-.*$ namespace object","webpack:///./src/ui lazy ^\\.\\/.*\\-header\\.html$ namespace object","webpack:///./src/ui lazy ^\\.\\/.*\\-body\\.html$ namespace object","webpack:///./src/ui lazy ^\\.\\/.*\\-footer\\.html$ namespace object","webpack:///./src/gtw-log.js"],"names":["map","init","Promise","resolve","reject","mapApi","then","m","setCenter","coords","setZoom","zoom","addMarker","position","title","label","removeAllMarkers","addPolyline","strokeColor","strokeWeight","strokeOpacity","geodesic","removeAllPolylines","fitBounds","bounds","languages","localizedKey","localizedObject","key","langKey","getLanguage","localeKey","getLocale","enKey","split","changeLanguage","locale","found","x","$","i18n","load","done","SETTINGS_STORAGE_KEY","getDefaultSettings","type","name","desc","def","checkfunc","val","locales","parseInt","Number","isNaN","startsWith","endsWith","json","get","set","localStorage","t","getItem","save","j","JSON","parse","setItem","stringify","providers","registerProvider","id","provider","fetchDatabase","isDatabaseUpdateNeeded","Error","db","getStop","stopId","this","i","stops","length","getStopById","getStops","stop","push","unregisterProvider","splice","getProviders","getProvider","fetchAllDatabase","pc","proms","catch","all","p","needs","version","needed","console","error","data","getAllStops","allStops","concat","getAllStopsNearby","lat","lng","range","sorted","d","distance","sort","a","b","geoDistance","lat1","lon1","lat2","lon2","c","Math","cos","asin","sqrt","allProgress","progress_cb","fillZero","number","similarity","s1","s2","longer","shorter","longerLength","toLowerCase","costs","Array","lastValue","newValue","charAt","min","editDistance","parseFloat","getRoute","routeId","routes","getRouteById","getRoutes","route","getAllRoutes","allRoutes","plugins","installedPlugins","install","pkg","autoSave","plugin","isInstalled","uninstall","getPlugin","window","pluginsStr","warn","installedPlugin","info","status","msg","mod","onload","dbPromise","open","log","request","indexedDB","onupgradeneeded","event","target","result","objectStoreNames","contains","createObjectStore","keyPath","onsuccess","onerror","putPluginStorage","tx","transaction","store","objectStore","clone","Object","assign","put","package","complete","getPluginStorage","getTransitRoutesByProvider","putTransitRoutes","routeName","etaProviders","paths","getTransitStopsByProvider","putTransitStops","stopName","addr","getTransitReferenceByProvider","putTransitReference","undefined","cache","clearCache","timeDifference","hr","fetchEta","opt","count","providerId","selectedPath","cached","now","Date","lastFetched","scheObj","schedules","options","sche","serverTime","time","out","getTime","err","values","value","code","getCache","ERROR_NOT_SUPPORTED","ERROR_NO_ACCESS","currentPosition","requestLocationAccess","successFunc","errorFunc","navigator","geolocation","getCurrentPosition","latitude","longitude","watchPosition","onPositionChangeSuccess","onPositionChangeError","enableHighAccuracy","timeout","maximumAge","alert","requests","duration","running","queue","func","args","TypeError","start","dispatch","next","shift","apply","setTimeout","clear","CORS_PROTOCOL","domains","register","domain","allowCors","config","extractHost","url","includes","indexOf","last","substring","isCors","host","location","before","callback","Cors","Settings","statusText","headers","proxy","index","sindex","first","second","third","getStopIndex","path","searchRoutesOfStop","bound","TransitType","BUS","MINIBUS","TRAM","TRAIN","FERRY","document","ready","on","showModal","hasClass","removeClass","tab","attr","addClass","showTab","clearInterval","timers","showPanel","fromSearch","showTouchKeypad","searchTimeout","vars","modalTimers","adjustMargin","keys","css","smartWizard","useURLhash","showStepURLhash","html","lang","byRegion","region","regionOptionsHtml","removeAttr","byCategory","pluginKey","category","calcInstallCount","categoryCount","node","totalCount","allCount","categoryKey","each","prop","installCountNode","pluginHtml","closedApi","fullName","change","checked","pkgs","errors","reload","gettingStarted","hideTouchKeypad","searchRoutes","skipCheck","lastStop","rp","pp","sp","sim","providerName","routeNameIncludes","searchList","max","search","availableKeypads","letter","charCodeAt","letterKeypadHtml","mouseClickTouchKeypadValue","mouseEnterPreviewRoute","mouseClickSelectRoute","mouseenter","clearSearch","layout","timer","modalClearUp","backdrop","keyboard","default","modal","loadModalLayout","scripts","hideModal","clearUp","drawRouteOnMap","pos","dbStop","searchText","parent","showRouteList","scroll","lastStopId","screen","width","icon","children","scrollIntoView","targetPos","content","h","active","schedule","eta","floor","colspan","isLive","getHours","getMinutes","showStopEta","setInterval","sstop","latlngs","ver","errorPlugins","errSummary","checksum","packageJson","pkey","author","github","statusMsg","categoryTabHtml","categoryTabContentHtml","allHtml","tabNode","tabContentNode","total","pluginJson","append","setting","requestLen","fadeIn","fadeOut","allNearbyRoutes","text","badgeClass","calcEta","badge","buttonScroll","iprovider","image","searchField","allNearbyStops","testRange","ceil","maxNearbyBusDisplay","stopResult","routeResults","routeResult","round","slice","clearTimeout","googleMapApiKey","jQuery","req","forEach","module","addEventListener","serviceWorker","registration","registrationError","__headerTexts","__stopHeaderAnimation","__headerAnimation","resize","nph","height","hh","dh","defs","promise","progress","lastVer","errPlugins","animate","opacity","webpackContext","webpackContextResolve","__webpack_require__","o","e","exports","locals","webpackAsyncContext","ids","maxEntries","logEntries","jsTrace","trace","jsDebug","debug","jsInfo","jsWarn","jsError","printObject","toConsole","level","toLogger","tag","lastMsg","lastTag","lastLevel","lastTime","levelName","className","toLocaleString","toast","prepend","remove","animation","autohide","delay","showToast","pmsg"],"mappings":"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","file":"app.7ddbb563d18d40cddc6d.js","sourcesContent":["//GTW Map source code\r\n\r\nimport config from './gtw-config';\r\n\r\nexport var map = false;\r\n\r\nexport function init() {\r\n    return new Promise((resolve, reject) => {\r\n        import(\"./gtw-map-\" + config.mapApi).then(function (m) {\r\n            map = m;\r\n            map.init().then(function () {\r\n                resolve();\r\n            });\r\n        });\r\n    });\r\n}\r\n\r\nexport function setCenter(coords) {\r\n    return map.setCenter(coords);\r\n}\r\n\r\nexport function setZoom(zoom) {\r\n    return map.setZoom(zoom);\r\n}\r\n\r\nexport function addMarker(position, title, label) {\r\n    return map.addMarker(position, title, label);\r\n}\r\n\r\nexport function removeMarker(markerId) {\r\n    return map.removeMarker(markerId);\r\n}\r\n\r\nexport function removeAllMarkers() {\r\n    return map.removeAllMarkers();\r\n}\r\n\r\nexport function addInfoWindow(markerId, content, open = false) {\r\n    return map.addInfoWindow(markerId, content, open);\r\n}\r\n\r\nexport function addPolyline(coords, strokeColor, strokeWeight, strokeOpacity = 1.0, geodesic = true) {\r\n    return map.addPolyline(coords, strokeColor, strokeWeight, strokeOpacity, geodesic);\r\n}\r\n\r\nexport function removePolyline(polylineId) {\r\n    return map.removePolyline(polylineId);\r\n}\r\n\r\nexport function removeAllPolylines() {\r\n    return map.removeAllPolylines();\r\n}\r\n\r\nexport function fitBounds(bounds) {\r\n    return map.fitBounds(bounds);\r\n}","// GTW Language\r\n\r\nimport * as Settings from './gtw-settings';\r\n\r\nexport const languages = {\r\n    \"en\": \"English\",\r\n    \"zh\": \"\\u7e41\\u9ad4\\u4e2d\\u6587\"\r\n};\r\n\r\nexport function localizedKey(localizedObject, key) {\r\n    var lang = getLanguage();\r\n    var locale = getLocale();\r\n\r\n    var langKey = key + \"_\" + lang;\r\n    var localeKey = key + \"_\" + locale;\r\n    var enKey = key + \"_en\";\r\n\r\n    if (localizedObject[langKey]) {\r\n        return localizedObject[langKey];\r\n    }\r\n\r\n    if (localizedObject[localeKey]) {\r\n        return localizedObject[localeKey];\r\n    }\r\n\r\n    if (localizedObject[enKey]) {\r\n        return localizedObject[enKey];\r\n    }\r\n\r\n    if (localizedObject[key]) {\r\n        return localizedObject[key];\r\n    }\r\n\r\n    return false;\r\n}\r\n\r\nexport function getLanguage() {\r\n    return Settings.get(\"preferred_language\", \"en\");\r\n};\r\n\r\nexport function getLocale() {\r\n    return Settings.get(\"preferred_language\", \"en\").split(\"-\")[0];\r\n};\r\n\r\nexport function changeLanguage(locale) {\r\n    var found = false;\r\n    for (var x in languages) {\r\n        if (locale === x) {\r\n            found = true;\r\n            break;\r\n        }\r\n    }\r\n    if (!found) {\r\n        return false;\r\n    }\r\n\r\n    Settings.set(\"preferred_language\", locale);\r\n    Settings.save();\r\n    $.i18n().locale = locale;\r\n    return $.i18n().load(\"i18n/\" + locale + \".json\", locale).done(function () {\r\n        $(\"body\").i18n();\r\n    });\r\n}","//GTW Settings\r\n\r\nconst SETTINGS_STORAGE_KEY = \"gtw-settings\";\r\n\r\nconst VALUE_TYPES = {\r\n    number: \"number\",\r\n    string: \"string\",\r\n    boolean: \"boolean\"\r\n};\r\n\r\nexport function getDefaultSettings() {\r\n    return [\r\n        {\r\n            key: \"preferred_language\",\r\n            type: \"string\",\r\n            name: $.i18n(\"settings-key-preferred-language\"),\r\n            desc: $.i18n(\"settings-key-preferred-language-desc\"),\r\n            def: \"en\",\r\n            checkfunc: function (val) {\r\n                var locales = require(\"./gtw-lang\").languages;\r\n                var found = false;\r\n                for (var locale in locales) {\r\n                    if (locale === val) {\r\n                        found = true;\r\n                        break;\r\n                    }\r\n                }\r\n                return found;\r\n            }\r\n        },\r\n        {\r\n            key: \"show_debug_msg\",\r\n            type: \"boolean\",\r\n            name: $.i18n(\"settings-key-show-debug-msg\"),\r\n            desc: $.i18n(\"settings-key-show-debug-msg-desc\"),\r\n            def: false\r\n        },\r\n        {\r\n            key: \"min_nearby_transit_range\",\r\n            type: \"number\",\r\n            name: $.i18n(\"settings-key-min-nearby-transit-search-range\"),\r\n            desc: $.i18n(\"settings-key-min-nearby-transit-search-range-desc\"),\r\n            def: 200,\r\n            checkfunc: function (val) {\r\n                var x = parseInt(val);\r\n                return !Number.isNaN(x) && x < 10000;\r\n            }\r\n        },\r\n        {\r\n            key: \"max_nearby_transit_to_display\",\r\n            type: \"number\",\r\n            name: $.i18n(\"settings-key-max-nearby-transit-to-be-displayed\"),\r\n            desc: $.i18n(\"settings-key-max-nearby-transit-to-be-displayed-desc\"),\r\n            def: 20,\r\n            checkfunc: function (val) {\r\n                var x = parseInt(val);\r\n                return !Number.isNaN(x) && x < 100;\r\n            }\r\n        },\r\n        {\r\n            key: \"use_cors_proxy\",\r\n            type: \"boolean\",\r\n            name: $.i18n(\"settings-key-use-cors-proxy\"),\r\n            desc: $.i18n(\"settings-key-use-cors-proxy-desc\"),\r\n            def: true\r\n        },\r\n        {\r\n            key: \"cors_proxy_server\",\r\n            type: \"string\",\r\n            name: $.i18n(\"settings-key-cors-proxy-server\"),\r\n            desc: $.i18n(\"settings-key-cors-proxy-server-desc\"),\r\n            def: \"https://cp1.gotowhere.ga/\",\r\n            checkfunc: function (val) {\r\n                return val.startsWith(\"https://\") && val.endsWith(\"/\")\r\n            }\r\n        },\r\n        {\r\n            key: \"cors_check_bypass\",\r\n            type: \"boolean\",\r\n            name: $.i18n(\"settings-key-cors-check-bypass\"),\r\n            desc: $.i18n(\"settings-key-cors-check-bypass-desc\"),\r\n            def: false\r\n        }\r\n    ];\r\n}\r\n\r\nexport var json = {};\r\n\r\nexport function get(key, def = false) {\r\n    var val = json[key];\r\n    if (typeof val === 'undefined') {\r\n        return def;\r\n    }\r\n    return val;\r\n}\r\n\r\nexport function set(key, val) {\r\n    json[key] = val;\r\n    return true;\r\n}\r\n\r\nexport function load() {\r\n    if (!localStorage) {\r\n        return false;\r\n    }\r\n    var t = localStorage.getItem(SETTINGS_STORAGE_KEY);\r\n\r\n    if (!t) {\r\n        return save();\r\n    }\r\n\r\n    var j = JSON.parse(t);\r\n\r\n    if (!j) {\r\n        return false;\r\n    }\r\n\r\n    json = j;\r\n    return true;\r\n}\r\n\r\nexport function save() {\r\n    if (!localStorage) {\r\n        return false;\r\n    }\r\n    localStorage.setItem(SETTINGS_STORAGE_KEY, JSON.stringify(json));\r\n    return true;\r\n}","//City Data: Transit Stops\r\n\r\nimport * as Misc from './gtw-misc';\r\nimport * as Database from './gtw-db';\r\n\r\nvar providers = [];\r\n\r\nexport function registerProvider(type, id, name, provider) {\r\n    if (!provider.fetchDatabase || typeof provider.fetchDatabase !== \"function\" ||\r\n        !provider.isDatabaseUpdateNeeded || typeof provider.isDatabaseUpdateNeeded !== \"function\") {\r\n        throw new Error(\"Error: \" + name + \" does not contain fetchDatabase or isDatabaseUpdateNeeded function!\");\r\n    }\r\n\r\n    provider.type = type;\r\n    provider.id = id;\r\n\r\n    if (typeof name === \"object\") {\r\n        provider[\"name\"] = name[\"default\"];\r\n        for (var key in name) {\r\n            provider[\"name_\" + key] = name[key];\r\n        }\r\n    } else {\r\n        provider.name = name;\r\n    }\r\n\r\n    provider.db = false;\r\n\r\n    provider.getStop = function (stopId) {\r\n        if (!this.db) {\r\n            return false;\r\n        }\r\n        var i;\r\n        for (i = 0; i < this.db.stops.length; i++) {\r\n            if (this.db.stops[i].stopId === stopId) {\r\n                return this.db.stops[i];\r\n            }\r\n        }\r\n        return false;\r\n    };\r\n\r\n    provider.getStopById = function (stopId) {\r\n        var stops = this.getStops();\r\n        for (var stop of stops) {\r\n            if (stop.stopId === stopId) {\r\n                return stop;\r\n            }\r\n        }\r\n        return false;\r\n    };\r\n\r\n    provider.getStops = function () {\r\n        return this.db ? this.db.stops : [];\r\n    };\r\n\r\n    providers.push(provider);\r\n}\r\n\r\nexport function unregisterProvider(id) {\r\n    var found = -1;\r\n    for (var i = 0; i < providers.length; i++) {\r\n        if (providers[i].id === id) {\r\n            found = i;\r\n        }\r\n    }\r\n    providers.splice(found, 1);\r\n}\r\n\r\nexport function getProviders() {\r\n    return providers;\r\n}\r\n\r\nexport function getProvider(id) {\r\n    for (var provider of providers) {\r\n        if (provider.id === id) {\r\n            return provider;\r\n        }\r\n    }\r\n    return false;\r\n}\r\n\r\nexport function fetchAllDatabase(pc) {\r\n    return new Promise((resolve, reject) => {\r\n        var proms = [];\r\n        for (var provider of providers) {\r\n            proms.push(Database.getTransitStopsByProvider(provider.id).then(function (db) {\r\n                if (!db) {\r\n                    return;\r\n                }\r\n                var TransitStops = require(\"./gtw-citydata-transit-stops\");\r\n                var provider = TransitStops.getProvider(db.provider);\r\n                if (provider) {\r\n                    provider.db = db;\r\n                }\r\n            }).catch(reject));\r\n        }\r\n        Promise.all(proms).then(function () {\r\n            var needs = {};\r\n            var proms = [];\r\n            var p;\r\n            for (var provider of providers) {\r\n                if (provider.db) {\r\n                    p = new Promise((resolve, reject) => {\r\n                        provider.isDatabaseUpdateNeeded(resolve, reject, provider.db.version);\r\n                    });\r\n                    p.then(function (needed) {\r\n                        needs[provider.id] = needed;\r\n                    }).catch(function () {\r\n                        console.error(\"Error: Database check update for \" + provider.id + \" failed!\");\r\n                        needs[provider.id] = false;\r\n                    });\r\n                    proms.push(p);\r\n                } else {\r\n                    needs[provider.id] = true;\r\n                }\r\n            }\r\n            Promise.all(proms).then(function () {\r\n                var proms = [];\r\n                var p;\r\n                for (var provider of providers) {\r\n                    if (needs[provider.id]) {\r\n                        p = new Promise((resolve, reject) => {\r\n                            provider.fetchDatabase(resolve, reject);\r\n                        });\r\n                        p.then(function (data) {\r\n                            const { type, provider, stops, version } = data;\r\n\r\n                            if (!type || !provider || !stops || !version) {\r\n                                console.error(\"Error: Returned stops database is in wrong structure for \" + (provider ? provider : \"unknown provider\") + \".\");\r\n                                return;\r\n                            }\r\n\r\n                            var db = {\r\n                                type: type,\r\n                                provider: provider,\r\n                                stops: stops,\r\n                                version: version\r\n                            };\r\n\r\n                            var TransitStops = require(\"./gtw-citydata-transit-stops\");\r\n                            var providerObj = TransitStops.getProvider(data.provider);\r\n                            providerObj.db = db;\r\n\r\n                            return Database.putTransitStops(db);\r\n                        });\r\n                        proms.push(p);\r\n                    }\r\n                }\r\n                Misc.allProgress(proms, pc).then(resolve).catch(reject);\r\n            });\r\n        }).catch(reject);\r\n    });\r\n}\r\n\r\nexport function getAllStops() {\r\n    var allStops = [];\r\n    for (var provider of providers) {\r\n        if (provider) {\r\n            var stops = provider.getStops();\r\n            if (stops && stops.length > 0) {\r\n                allStops = allStops.concat(stops);\r\n            }\r\n        }\r\n    }\r\n    return allStops;\r\n}\r\n\r\nexport function getAllStopsNearby(lat, lng, range, sorted = true) {\r\n    var allStops = getAllStops();\r\n    var stops = [];\r\n    var stop;\r\n    var d;\r\n    for (var i = 0; i < allStops.length; i++) {\r\n        stop = allStops[i];\r\n        d = Misc.geoDistance(lat, lng, stop.lat, stop.lng);\r\n        if (d <= range) {\r\n            stops.push({\r\n                stop: stop,\r\n                distance: d\r\n            });\r\n        }\r\n    }\r\n\r\n    if (sorted) {\r\n        stops.sort(function (a, b) {\r\n            if (a.distance < b.distance) {\r\n                return -1;\r\n            } else if (a.distance > b.distance) {\r\n                return 1;\r\n            } else {\r\n                return 0;\r\n            }\r\n        });\r\n    }\r\n\r\n    return stops;\r\n}\r\n\r\nexport function getStopById(stopId) {\r\n    var allStops = getAllStops();\r\n    var i;\r\n    for (i = 0; i < allStops.length; i++) {\r\n        if (stopId === allStops[i].stopId) {\r\n            return allStops[i];\r\n        }\r\n    }\r\n    return false;\r\n}","//GTW Misc\r\n\r\nexport function geoDistance(lat1, lon1, lat2, lon2) {\r\n    var p = 0.017453292519943295;    // Math.PI / 180\r\n    var c = Math.cos;\r\n    var a = 0.5 - c((lat2 - lat1) * p) / 2 +\r\n        c(lat1 * p) * c(lat2 * p) *\r\n        (1 - c((lon2 - lon1) * p)) / 2;\r\n\r\n    return 12742 * Math.asin(Math.sqrt(a)); // 2 * R; R = 6371 km\r\n}\r\n\r\nexport function allProgress(proms, progress_cb) {\r\n    let d = 0;\r\n    progress_cb(0);\r\n    for (const p of proms) {\r\n        p.then(() => {\r\n            d++;\r\n            progress_cb((d * 100) / proms.length);\r\n        });\r\n    }\r\n    return Promise.all(proms);\r\n}\r\n\r\nexport function isSamePropertyValueInArray(array, name, value) {\r\n    for (var object of array) {\r\n        if (object[name] === value) {\r\n            return true;\r\n        }\r\n    }\r\n    return false;\r\n}\r\n\r\nexport function fillZero(number) {\r\n    return number < 10 ? (\"0\" + number) : number;\r\n}\r\n\r\nexport function similarity(s1, s2) {\r\n    var longer = s1;\r\n    var shorter = s2;\r\n    if (s1.length < s2.length) {\r\n        longer = s2;\r\n        shorter = s1;\r\n    }\r\n    var longerLength = longer.length;\r\n    if (longerLength == 0) {\r\n        return 1.0;\r\n    }\r\n    return (longerLength - editDistance(longer, shorter)) / parseFloat(longerLength);\r\n}\r\n\r\nexport function editDistance(s1, s2) {\r\n    s1 = s1.toLowerCase();\r\n    s2 = s2.toLowerCase();\r\n\r\n    var costs = new Array();\r\n    for (var i = 0; i <= s1.length; i++) {\r\n        var lastValue = i;\r\n        for (var j = 0; j <= s2.length; j++) {\r\n            if (i == 0)\r\n                costs[j] = j;\r\n            else {\r\n                if (j > 0) {\r\n                    var newValue = costs[j - 1];\r\n                    if (s1.charAt(i - 1) != s2.charAt(j - 1))\r\n                        newValue = Math.min(Math.min(newValue, lastValue),\r\n                            costs[j]) + 1;\r\n                    costs[j - 1] = lastValue;\r\n                    lastValue = newValue;\r\n                }\r\n            }\r\n        }\r\n        if (i > 0)\r\n            costs[s2.length] = lastValue;\r\n    }\r\n    return costs[s2.length];\r\n}","//City Data: Transit Routes\r\n\r\nimport * as Misc from './gtw-misc';\r\nimport * as Database from './gtw-db';\r\n\r\nvar providers = [];\r\n\r\nexport function registerProvider(type, id, name, provider) {\r\n    if (!provider.fetchDatabase || typeof provider.fetchDatabase !== \"function\" ||\r\n        !provider.isDatabaseUpdateNeeded || typeof provider.isDatabaseUpdateNeeded !== \"function\") {\r\n        throw new Error(\"Error: \" + name + \" does not contain fetchDatabase or isDatabaseUpdateNeeded function!\");\r\n    }\r\n\r\n    provider.type = type;\r\n    provider.id = id;\r\n\r\n    if (typeof name === \"object\") {\r\n        provider[\"name\"] = name[\"default\"];\r\n        for (var key in name) {\r\n            provider[\"name_\" + key] = name[key];\r\n        }\r\n    } else {\r\n        provider.name = name;\r\n    }\r\n\r\n    provider.db = false;\r\n\r\n    provider.getRoute = function (routeId) {\r\n        if (!this.db) {\r\n            return false;\r\n        }\r\n        var i;\r\n        for (i = 0; i < this.db.routes.length; i++) {\r\n            if (this.db.routes[i].routeId === routeId) {\r\n                return this.db.routes[i];\r\n            }\r\n        }\r\n        return false;\r\n    };\r\n\r\n    provider.getRouteById = function (routeId) {\r\n        var routes = this.getRoutes();\r\n        for (var route of routes) {\r\n            if (route.routeId === routeId) {\r\n                return route;\r\n            }\r\n        }\r\n        return false;\r\n    };\r\n\r\n    provider.getRoutes = function () {\r\n        return this.db ? this.db.routes : [];\r\n    };\r\n\r\n    providers.push(provider);\r\n}\r\n\r\nexport function unregisterProvider(id) {\r\n    var found = -1;\r\n    for (var i = 0; i < providers.length; i++) {\r\n        if (providers[i].id === id) {\r\n            found = i;\r\n        }\r\n    }\r\n    providers.splice(found, 1);\r\n}\r\n\r\nexport function getProviders() {\r\n    return providers;\r\n}\r\n\r\nexport function getProvider(id) {\r\n    for (var provider of providers) {\r\n        if (provider.id === id) {\r\n            return provider;\r\n        }\r\n    }\r\n    return false;\r\n}\r\n\r\nexport function fetchAllDatabase(pc) {\r\n    return new Promise((resolve, reject) => {\r\n        var proms = [];\r\n        for (var provider of providers) {\r\n            proms.push(Database.getTransitRoutesByProvider(provider.id).then(function (db) {\r\n                if (!db) {\r\n                    return;\r\n                }\r\n                var TransitRoutes = require(\"./gtw-citydata-transit-routes\");\r\n                var provider = TransitRoutes.getProvider(db.provider);\r\n                if (provider) {\r\n                    provider.db = db;\r\n                }\r\n            }).catch(reject));\r\n        }\r\n        Promise.all(proms).then(function () {\r\n            var needs = {};\r\n            var proms = [];\r\n            var p;\r\n            for (var provider of providers) {\r\n                if (provider.db) {\r\n                    p = new Promise((resolve, reject) => {\r\n                        provider.isDatabaseUpdateNeeded(resolve, reject, provider.db.version);\r\n                    });\r\n                    p.then(function (needed) {\r\n                        needs[provider.id] = needed;\r\n                    }).catch(function () {\r\n                        console.error(\"Error: Database check update for \" + provider.id + \" failed!\");\r\n                        needs[provider.id] = false;\r\n                    });\r\n                    proms.push(p);\r\n                } else {\r\n                    needs[provider.id] = true;\r\n                }\r\n            }\r\n            Promise.all(proms).then(function () {\r\n                var proms = [];\r\n                var p;\r\n                for (var provider of providers) {\r\n                    if (needs[provider.id]) {\r\n                        p = new Promise((resolve, reject) => {\r\n                            provider.fetchDatabase(resolve, reject);\r\n                        });\r\n                        p.then(function (data) {\r\n                            const { type, provider, routes, version } = data;\r\n\r\n                            if (!type || !provider || !routes || !version) {\r\n                                console.error(\"Error: Returned routes database is in wrong structure for \" + (provider ? provider : \"unknown provider\") + \".\");\r\n                                return;\r\n                            }\r\n\r\n                            var db = {\r\n                                type: type,\r\n                                provider: provider,\r\n                                routes: routes,\r\n                                version: version\r\n                            };\r\n\r\n                            var TransitRoutes = require(\"./gtw-citydata-transit-routes\");\r\n                            var providerObj = TransitRoutes.getProvider(data.provider);\r\n                            providerObj.db = db;\r\n\r\n                            return Database.putTransitRoutes(db);\r\n                        });\r\n                        proms.push(p);\r\n                    }\r\n                }\r\n                Misc.allProgress(proms, pc).then(resolve).catch(reject);\r\n            });\r\n        }).catch(reject);\r\n    });\r\n}\r\n\r\nexport function getAllRoutes() {\r\n    var allRoutes = [];\r\n    for (var provider of providers) {\r\n        if (provider) {\r\n            var routes = provider.getRoutes();\r\n            if (routes && routes.length > 0) {\r\n                allRoutes = allRoutes.concat(routes);\r\n            }\r\n        }\r\n    }\r\n    return allRoutes;\r\n}\r\n\r\nexport function getRouteById(routeId) {\r\n    var allRoutes = getAllRoutes();\r\n    var i;\r\n    for (i = 0; i < allRoutes.length; i++) {\r\n        if (routeId === allRoutes[i].routeId) {\r\n            return allRoutes[i];\r\n        }\r\n    }\r\n    return false;\r\n}","// GTW Plugin Loader\r\n\r\nimport * as Misc from './gtw-misc';\r\nimport repos from './plugins/repository.json';\r\n\r\nexport var plugins = {};\r\n\r\nexport var installedPlugins = [];\r\n\r\nexport function install(pkg, autoSave) {\r\n    if (isInstalled(pkg)) {\r\n        return false;\r\n    }\r\n    installedPlugins.push(pkg);\r\n    if (autoSave !== false){\r\n        save();\r\n    }\r\n    return true;\r\n}\r\n\r\nexport function uninstall(pkg, autoSave){\r\n    var i;\r\n    for (i = 0; i < installedPlugins.length; i++){\r\n        if (installedPlugins[i] === pkg){\r\n            installedPlugins.splice(i, 1);\r\n            if (autoSave !== false) {\r\n                save();\r\n            }\r\n            return true;\r\n        }\r\n    }\r\n    return false;\r\n}\r\n\r\nexport function getPlugin(pkg) {\r\n    return plugins[pkg];\r\n}\r\n\r\nexport function isInstalled(pkg) {\r\n    for (var plugin of installedPlugins){\r\n        if (plugin === pkg){\r\n            return true;\r\n        }\r\n    }\r\n    return false;\r\n}\r\n\r\nexport function save() {\r\n    var localStorage = window.localStorage;\r\n    localStorage.setItem(\"gtw-plugins\", JSON.stringify(installedPlugins));\r\n    return true;\r\n}\r\n\r\nexport function load(pc) {\r\n    if (!localStorage){\r\n        console.error(\"Error: LocalStorage is not supported in this browser.\");\r\n        return;\r\n    }\r\n\r\n    var pluginsStr = localStorage.getItem(\"gtw-plugins\");\r\n\r\n    if (pluginsStr) {\r\n        installedPlugins = JSON.parse(pluginsStr);\r\n    }\r\n    \r\n    if (!installedPlugins || typeof installedPlugins.length !== \"number\"){\r\n        console.warn(\"Warning: Installed plugins JSON string is invalid. Resetting as empty.\");\r\n        save();\r\n    }\r\n    \r\n    var p;\r\n    var proms = [];\r\n    for (var installedPlugin of installedPlugins) {\r\n        const info = {\r\n            \"package\": installedPlugin,\r\n            status: 1,\r\n            msg: \"Not Enabled\"\r\n        };\r\n\r\n        if (repos[installedPlugin]){\r\n            proms.push(new Promise((resolve, reject) => {\r\n                import(\"./plugins/\" + installedPlugin).then(function(mod) {\r\n                    var msg;\r\n                    if (!mod) {\r\n                        msg = $.i18n(\"plugin-error-no-module-returned\", pkg);\r\n                        console.error(msg);\r\n                        info.status = -2;\r\n                        info.msg = msg;\r\n                    } else if (!mod.onload || typeof mod.onload !== \"function\") {\r\n                        msg = $.i18n(\"plugin-error-no-onload-function\", pkg);\r\n                        console.error(msg);\r\n                        info.status = -3;\r\n                        info.msg = msg;\r\n                    } else {\r\n                        var promise = new Promise((resolve, reject) => {\r\n                            var status = mod.onload();\r\n                            if (status instanceof Promise) {\r\n                                status.then(resolve).catch(reject);\r\n                            } else {\r\n                                resolve(status);\r\n                            }\r\n                        });\r\n                        promise.then(function (status) {\r\n                            if (status) {\r\n                                info.status = 0;\r\n                                delete info.msg;\r\n                            } else {\r\n                                var msg = $.i18n(\"plugin-error-onload-function-error\", pkg);\r\n                                console.error(msg);\r\n                                info.status = -4;\r\n                                info.msg = msg;\r\n                            }\r\n                            resolve();\r\n                        }).catch(reject);\r\n                    }\r\n                });\r\n            }));\r\n        } else {\r\n            info.status = -1;\r\n            info.msg = \"This plugin is not available in this version of GoToWhere.\";\r\n        }\r\n        plugins[installedPlugin] = info;\r\n    }\r\n    return Misc.allProgress(proms, pc);\r\n}","//GTW Database\r\n\r\nvar dbPromise = false;\r\n\r\nexport function open() {\r\n    return dbPromise = new Promise((resolve, reject) => {\r\n        if (!('indexedDB' in window)) {\r\n            console.log('This browser doesn\\'t support IndexedDB');\r\n            return false;\r\n        }\r\n        var request = indexedDB.open(\"gotowhere-db\", 1);\r\n        request.onupgradeneeded = function (event) {\r\n            var db = event.target.result;\r\n            //Schema v1\r\n            console.log(\"Creating DB schema\");\r\n            if (!db.objectStoreNames.contains(\"transitRoutes\")) {\r\n                db.createObjectStore(\"transitRoutes\", { keyPath: 'provider' });\r\n            }\r\n            if (!db.objectStoreNames.contains(\"transitStops\")) {\r\n                db.createObjectStore(\"transitStops\", { keyPath: 'provider' });\r\n            }\r\n            if (!db.objectStoreNames.contains(\"transitReference\")) {\r\n                db.createObjectStore(\"transitReference\", { keyPath: 'provider' });\r\n            }\r\n            if (!db.objectStoreNames.contains(\"pluginStorage\")) {\r\n                db.createObjectStore(\"pluginStorage\", { keyPath: 'package' });\r\n            }\r\n        };\r\n        request.onsuccess = function (event) {\r\n            resolve(request.result);\r\n        };\r\n        request.onerror = reject;\r\n    });\r\n};\r\n\r\nexport function query(func) {\r\n    if (typeof func === \"function\") {\r\n        return dbPromise.then(func);\r\n    }\r\n};\r\n\r\nexport function putPluginStorage(pkg, data) {\r\n    return dbPromise.then(function (db) {\r\n        var tx = db.transaction(\"pluginStorage\", \"readwrite\");\r\n        var store = tx.objectStore(\"pluginStorage\");\r\n        var clone = Object.assign({}, data);\r\n        store.put({\r\n            package: pkg,\r\n            data: clone\r\n        });\r\n        return tx.complete;\r\n    });\r\n};\r\n\r\nexport function getPluginStorage(pkg) {\r\n    return new Promise((resolve, reject) => {\r\n        dbPromise.then(function (db) {\r\n            var tx = db.transaction(\"pluginStorage\", \"readonly\");\r\n            var store = tx.objectStore(\"pluginStorage\");\r\n            var request = store.get(pkg);\r\n            request.onsuccess = function () {\r\n                resolve(request.result ? request.result.data : false);\r\n            };\r\n            request.onerror = reject;\r\n        });\r\n    });\r\n}\r\n\r\nexport function getTransitRoutesByProvider(provider) {\r\n    return new Promise((resolve, reject) => {\r\n        dbPromise.then(function (db) {\r\n            var tx = db.transaction(\"transitRoutes\", \"readonly\");\r\n            var store = tx.objectStore(\"transitRoutes\");\r\n            var request = store.get(provider);\r\n            request.onsuccess = function () {\r\n                resolve(request.result);\r\n            };\r\n            request.onerror = reject;\r\n        });\r\n    });\r\n}\r\n\r\nexport function putTransitRoutes(db) {\r\n    const { type, provider, routes, version } = db;\r\n    if (!type || !provider || !routes || !version) {\r\n        console.error(\"Error: Invalid routes database structure from \" + (provider ? provider : \"unknown provider\") + \".\");\r\n        return false;\r\n    }\r\n    for (var route of routes) {\r\n        const { type, provider, routeId, routeName, etaProviders, paths } = route;\r\n        if (!type || !provider || !routeId || !routeName || !etaProviders || !paths || !etaProviders.length || !paths.length) {\r\n            console.error(\"Error: Invalid database route structure from \" + (db.provider ? db.provider : \"unknown provider\") + \".\");\r\n            return false;\r\n        }\r\n    }\r\n    var clone = Object.assign({}, db);\r\n    return dbPromise.then(function (db) {\r\n        var tx = db.transaction(\"transitRoutes\", \"readwrite\");\r\n        var store = tx.objectStore(\"transitRoutes\");\r\n        store.put(clone);\r\n        return tx.complete;\r\n    });\r\n}\r\n\r\nexport function getTransitStopsByProvider(provider) {\r\n    return new Promise((resolve, reject) => {\r\n        dbPromise.then(function (db) {\r\n            var tx = db.transaction(\"transitStops\", \"readonly\");\r\n            var store = tx.objectStore(\"transitStops\");\r\n            var request = store.get(provider);\r\n            request.onsuccess = function () {\r\n                resolve(request.result);\r\n            };\r\n            request.onerror = reject;\r\n        });\r\n    });\r\n}\r\n\r\nexport function putTransitStops(db) {\r\n    const { type, provider, stops, version } = db;\r\n    if (!type || !provider || !stops || !version) {\r\n        console.error(\"Error: Invalid stops database structure from \" + (provider ? provider : \"unknown provider\") + \".\");\r\n        return false;\r\n    }\r\n    for (var stop of stops) {\r\n        const { type, provider, stopId, stopName, addr, lat, lng } = stop;\r\n        if (!type || !provider || !stopId || !stopName || !addr || !lat || !lng || typeof lat !== \"number\" || typeof lng !== \"number\") {\r\n            console.error(\"Error: Invalid database stop structure from \" + (db.provider ? db.provider : \"unknown provider\") + \".\");\r\n            return false;\r\n        }\r\n    }\r\n    var clone = Object.assign({}, db);\r\n    return dbPromise.then(function (db) {\r\n        var tx = db.transaction(\"transitStops\", \"readwrite\");\r\n        var store = tx.objectStore(\"transitStops\");\r\n        store.put(clone);\r\n        return tx.complete;\r\n    });\r\n}\r\n\r\nexport function getTransitReferenceByProvider(provider) {\r\n    return new Promise((resolve, reject) => {\r\n        dbPromise.then(function (db) {\r\n            var tx = db.transaction(\"transitReference\", \"readonly\");\r\n            var store = tx.objectStore(\"transitReference\");\r\n            var request = store.get(provider);\r\n            request.onsuccess = function () {\r\n                resolve(request.result);\r\n            };\r\n            request.onerror = reject;\r\n        });\r\n    });\r\n}\r\n\r\nexport function putTransitReference(db) {\r\n    const { type, provider, routes, stops, version } = db;\r\n    if (!type || !provider || !routes || !stops || !version) {\r\n        console.error(\"Error: Invalid reference database structure from \" + (provider ? provider : \"unknown provider\") + \".\");\r\n        return false;\r\n    }\r\n    for (var route of routes) {\r\n        const { type, provider, routeId, routeName, etaProviders, paths } = route;\r\n        if (!type || !provider || !routeId || !routeName || !etaProviders || !paths || !etaProviders.length) { //|| !paths.length) {\r\n            console.error(\"Error: Invalid reference database route structure from \" + (db.provider ? db.provider : \"unknown provider\") + \".\");\r\n            return false;\r\n        }\r\n    }\r\n    for (var stop of stops) {\r\n        const { type, provider, stopId, stopName, addr, lat, lng } = stop;\r\n        if (!type || !provider || !stopId || !stopName || !addr || lat === undefined || lng === undefined || typeof lat !== \"number\" || typeof lng !== \"number\") {\r\n            console.error(\"Error: Invalid reference database stop structure from \" + (db.provider ? db.provider : \"unknown provider\") + \".\");\r\n            return false;\r\n        }\r\n    }\r\n    var clone = Object.assign({}, db);\r\n    return dbPromise.then(function (db) {\r\n        var tx = db.transaction(\"transitReference\", \"readwrite\");\r\n        var store = tx.objectStore(\"transitReference\");\r\n        store.put(clone);\r\n        return tx.complete;\r\n    });\r\n}","//City Data: Transit ETA\r\nimport * as Misc from './gtw-misc';\r\nimport * as Database from './gtw-db';\r\n\r\nvar providers = [];\r\n\r\nvar cache = {};\r\n\r\nexport function clearCache() {\r\n    cache = {};\r\n}\r\n\r\nexport function timeDifference(a, b) {\r\n    var x = a.hr * 60 + a.min;\r\n    var y = b.hr * 60 + b.min;\r\n    return x - y;\r\n}\r\n\r\nexport function registerProvider(type, id, name, provider) {\r\n    if (!provider.fetchEta || typeof provider.fetchEta !== \"function\" ||\r\n        !provider.fetchDatabase || typeof provider.fetchDatabase !== \"function\" ||\r\n        !provider.isDatabaseUpdateNeeded || typeof provider.isDatabaseUpdateNeeded !== \"function\") {\r\n        throw new Error(\"Error: \" + id + \" does not contain fetchEta, fetchDatabase or isDatabaseUpdateNeeded function!\");\r\n    }\r\n\r\n    provider.type = type;\r\n    provider.id = id;\r\n    provider.db = false;\r\n\r\n    if (typeof name === \"object\") {\r\n        provider[\"name\"] = name[\"default\"];\r\n        for (var key in name) {\r\n            provider[\"name_\" + key] = name[key];\r\n        }\r\n    } else {\r\n        provider.name = name;\r\n    }\r\n\r\n    provider.getRoute = function (routeId) {\r\n        if (!this.db) {\r\n            return false;\r\n        }\r\n        var i;\r\n        for (i = 0; i < this.db.routes.length; i++) {\r\n            if (this.db.routes[i].routeId === routeId) {\r\n                return this.db.routes[i];\r\n            }\r\n        }\r\n        return false;\r\n    };\r\n\r\n    provider.getRouteById = function (routeId) {\r\n        var routes = this.getRoutes();\r\n        for (var route of routes) {\r\n            if (route.routeId === routeId) {\r\n                return route;\r\n            }\r\n        }\r\n        return false;\r\n    };\r\n\r\n    provider.getRoutes = function () {\r\n        return this.db ? this.db.routes : [];\r\n    };\r\n\r\n    provider.getStop = function (stopId) {\r\n        if (!this.db) {\r\n            return false;\r\n        }\r\n        var i;\r\n        for (i = 0; i < this.db.stops.length; i++) {\r\n            if (this.db.stops[i].stopId === stopId) {\r\n                return this.db.stops[i];\r\n            }\r\n        }\r\n        return false;\r\n    };\r\n\r\n    provider.getStopById = function (stopId) {\r\n        var stops = this.getStops();\r\n        for (var stop of stops) {\r\n            if (stop.stopId === stopId) {\r\n                return stop;\r\n            }\r\n        }\r\n        return false;\r\n    };\r\n\r\n    provider.getStops = function () {\r\n        return this.db ? this.db.stops : [];\r\n    };\r\n\r\n    providers.push(provider);\r\n}\r\n\r\nexport function unregisterProvider(id) {\r\n    var found = -1;\r\n    for (var i = 0; i < providers.length; i++) {\r\n        if (providers[i].id === id) {\r\n            found = i;\r\n        }\r\n    }\r\n    providers.splice(found, 1);\r\n}\r\n\r\nexport function getProviders() {\r\n    return providers;\r\n}\r\n\r\nexport function getProvider(id) {\r\n    for (var provider of providers) {\r\n        if (provider.id === id) {\r\n            return provider;\r\n        }\r\n    }\r\n    return false;\r\n}\r\n\r\nexport function fetchAllDatabase(pc) {\r\n    return new Promise((resolve, reject) => {\r\n        var proms = [];\r\n        for (var provider of providers) {\r\n            proms.push(Database.getTransitReferenceByProvider(provider.id).then(function (db) {\r\n                if (!db) {\r\n                    return;\r\n                }\r\n                var TransitEta = require('./gtw-citydata-transit-eta.js');\r\n                var provider = TransitEta.getProvider(db.provider);\r\n                if (provider) {\r\n                    provider.db = db;\r\n                }\r\n            }).catch(reject));\r\n        }\r\n        Promise.all(proms).then(function () {\r\n            var needs = {};\r\n            var proms = [];\r\n            var p;\r\n            for (const provider of providers) {\r\n                if (provider.db) {\r\n                    console.log(\"has db \" + provider.id);\r\n                    p = new Promise((resolve, reject) => {\r\n                        provider.isDatabaseUpdateNeeded(resolve, reject, provider.db.version);\r\n                    });\r\n                    p.then(function (needed) {\r\n                        console.log(\"update: \" + provider.id + \" \" + needed);\r\n                        needs[provider.id] = needed;\r\n                    }).catch(function () {\r\n                        console.error(\"Error: Database check update for \" + provider.id + \" failed!\");\r\n                        needs[provider.id] = false;\r\n                    });\r\n                    proms.push(p);\r\n                } else {\r\n                    console.log(\"No db found for \" + provider.id);\r\n                    needs[provider.id] = true;\r\n                }\r\n            }\r\n            Promise.all(proms).then(function () {\r\n                var proms = [];\r\n                var p;\r\n                console.log(needs);\r\n                for (const provider of providers) {\r\n                    if (needs[provider.id]) {\r\n                        p = new Promise((resolve, reject) => {\r\n                            provider.fetchDatabase(resolve, reject);\r\n                        });\r\n                        p.then(function (data) {\r\n                            const { type, provider, routes, stops, version } = data;\r\n\r\n                            if (!type || !provider || !routes || !stops || !version) {\r\n                                console.error(\"Error: Returned reference database is in wrong structure for \" + (provider ? provider : \"unknown provider\") + \".\");\r\n                                return;\r\n                            }\r\n\r\n                            var db = {\r\n                                type: type,\r\n                                provider: provider,\r\n                                routes: routes,\r\n                                stops: stops,\r\n                                version: version\r\n                            };\r\n\r\n                            var TransitEta = require('./gtw-citydata-transit-eta.js');\r\n                            var providerObj = TransitEta.getProvider(data.provider);\r\n                            providerObj.db = db;\r\n\r\n                            return Database.putTransitReference(db);\r\n                        });\r\n                        proms.push(p);\r\n                    }\r\n                }\r\n                Misc.allProgress(proms, pc).then(resolve).catch(reject);\r\n            });\r\n        }).catch(reject);\r\n    });\r\n}\r\n\r\nexport function fetchEta(opt) {\r\n    return new Promise((resolve, reject) => {\r\n        var proms = [];\r\n        var count = 0;\r\n        for (var providerId of opt.etaProviders) {\r\n            proms.push(new Promise((resolve, reject) => {\r\n                var provider = getProvider(providerId);\r\n\r\n                if (!provider) {\r\n                    resolve();\r\n                    console.log(\"Could not find registered Transit ETA provider with name \\\"\" + providerId + \"\\\"\");\r\n                    return;\r\n                }\r\n\r\n                count++;\r\n\r\n                var key = providerId + \"-\" + opt.routeId + \"-\" + opt.selectedPath + \"-\" + opt.stopId;\r\n                var cached = cache[key];\r\n                var now = new Date();\r\n\r\n                if (cached && (now - cached.lastFetched) > 30000) {\r\n                    cached = false;\r\n                    delete cache[key];\r\n                }\r\n\r\n                if (!cached) {\r\n                    var global = this;\r\n                    var p = new Promise((resolve, reject) => {\r\n                        provider.fetchEta(resolve, reject, opt);\r\n                    });\r\n                    p.then(function (scheObj) {\r\n                        if (!scheObj) {\r\n                            resolve(false);\r\n                            return;\r\n                        }\r\n\r\n                        const { schedules, options } = scheObj;\r\n                        if (!schedules || !options) {\r\n                            console.error(\"Error: Plugin returned a TransitSchedule object with invalid structure.\");\r\n                            reject(opt, \"Invalid TransitSchedule structure\");\r\n                            return;\r\n                        }\r\n\r\n                        for (var sche of schedules) {\r\n                            if (sche.type === undefined || sche.provider === undefined || sche.serverTime === undefined || sche.msg === undefined && sche.time === undefined || isNaN(parseInt(sche.serverTime))) {\r\n                                console.error(\"Error: Plugin returned a TransitSchedule object with invalid schedules.\");\r\n                                reject(opt, \"Invalid TransitSchedule schedules\");\r\n                                return;\r\n                            }\r\n                        }\r\n\r\n                        var time = new Date();\r\n\r\n                        var out = {\r\n                            schedules: schedules,\r\n                            options: options\r\n                        };\r\n\r\n                        cache[key] = {\r\n                            lastFetched: time.getTime(),\r\n                            data: out\r\n                        };\r\n\r\n                        resolve(out);\r\n                    }).catch(function (err) {\r\n                        reject(opt, err);\r\n                    });\r\n                } else {\r\n                    resolve(cached.data);\r\n                }\r\n            }));\r\n        }\r\n        Promise.all(proms).then(function (values) {\r\n            if (count > 0) {\r\n                var schedules = [];\r\n                for (var value of values) {\r\n                    if (value && value.schedules) {\r\n                        schedules = schedules.concat(value.schedules);\r\n                    }\r\n                }\r\n                schedules.sort(function (a, b) {\r\n                    if (!a.time) {\r\n                        return 1;\r\n                    } else if (!b.time) {\r\n                        return -1;\r\n                    }\r\n                    return a.time - b.time;\r\n                });\r\n                resolve({\r\n                    schedules: schedules,\r\n                    options: opt,\r\n                    code: 0\r\n                })\r\n            } else if (opt.etaProviders && opt.etaProviders.length > 0) {\r\n                resolve({\r\n                    code: -2,\r\n                    options: opt\r\n                });\r\n            } else {\r\n                resolve({\r\n                    code: -1,\r\n                    options: opt\r\n                });\r\n            }\r\n        }).catch(reject);\r\n    });\r\n}\r\n\r\nexport function getCache() {\r\n    return cache;\r\n}","//GTW Location Manager\r\n\r\nimport * as Map from './gtw-map';\r\n\r\nconst LOCATION_MANAGER_CONVENTION_KEY = \"openeta-location-convention\";\r\n\r\nconst CONVENTION_ASK_EVERYTIME = \"CONVENTION_ASK_EVERYTIME\";\r\nconst CONVENTION_CUSTOM_LOCATION = \"CONVENTION_CUSTOM_LOCATION\";\r\nconst CONVENTION_ASK_LOCATION_ACCESS = \"CONVENTION_ASK_LOCATION_ACCESS\";\r\nconst CONVENTION_DIRECT_LOCATION_ACCESS = \"CONVENTION_DIRECT_LOCATION_ACCESS\";\r\nconst ERROR_NOT_SUPPORTED = 0;\r\nconst ERROR_NO_ACCESS = 1;\r\n\r\nexport var watchId = 0;\r\n\r\nexport var currentPosition = { lat: 22.2952296, lng: 114.1766577 };\r\n\r\nexport function getConvention() {\r\n    var localStorage = window.localStorage;\r\n    if (!localStorage || !localStorage.getItem(LOCATION_MANAGER_CONVENTION_KEY)) {\r\n        return CONVENTION_ASK_EVERYTIME;\r\n    }\r\n    return localStorage.getItem(LOCATION_MANAGER_CONVENTION_KEY);\r\n}\r\n\r\nexport function setConvention(convention) {\r\n    var localStorage = window.localStorage;\r\n    if (!localStorage) {\r\n        return;\r\n    }\r\n    localStorage.setItem(LOCATION_MANAGER_CONVENTION_KEY, convention);\r\n}\r\n\r\nexport function requestLocationAccess(successFunc = function () { }, errorFunc = function () { }) {\r\n    if (!navigator.geolocation) {\r\n        errorFunc(ERROR_NOT_SUPPORTED);\r\n        return;\r\n    }\r\n\r\n    var global = this;\r\n\r\n    navigator.geolocation.getCurrentPosition(function (position) {\r\n        currentPosition = {\r\n            lat: position.coords.latitude,\r\n            lng: position.coords.longitude\r\n        };\r\n\r\n        Map.setCenter(currentPosition);\r\n        Map.setZoom(16);\r\n\r\n        watchId = navigator.geolocation.watchPosition(\r\n            onPositionChangeSuccess,\r\n            onPositionChangeError,\r\n            {\r\n                enableHighAccuracy: false,\r\n                timeout: 5000,\r\n                maximumAge: 0\r\n            }\r\n        );\r\n        successFunc(currentPosition);\r\n    }, function () {\r\n        errorFunc(ERROR_NO_ACCESS);\r\n    }, { timeout: 5000 });\r\n}\r\n\r\nexport function getCurrentPosition() {\r\n    return currentPosition;\r\n}\r\n\r\nexport function onPositionChangeSuccess(position) {\r\n    currentPosition = {\r\n        lat: position.coords.latitude,\r\n        lng: position.coords.longitude\r\n    };\r\n}\r\n\r\nexport function onPositionChangeError(error) {\r\n    alert(\"TODO: Handle Position error!\")\r\n}","//GTW Request Limiter\r\n\r\nexport var requests = [];\r\n\r\nexport var duration = 500;\r\n\r\nexport var running = false;\r\n\r\nexport function queue(func, args) {\r\n    if (typeof func !== \"function\") {\r\n        throw new TypeError(\"The variable must be a 'function'.\");\r\n    }\r\n    requests.push([func, args]);\r\n    return func;\r\n}\r\n\r\nexport function stack(func, args) {\r\n    if (typeof func !== \"function\") {\r\n        throw new TypeError(\"The variable must be a 'function'.\");\r\n    }\r\n    requests.unshift([func, args]);\r\n    return func;\r\n}\r\n\r\nexport function start() {\r\n    if (running) {\r\n        return;\r\n    }\r\n\r\n    running = true;\r\n    dispatch();\r\n}\r\n\r\nexport function dispatch() {\r\n    var next = requests.shift();\r\n    var global = this;\r\n\r\n    if (next && typeof next[0] === 'function') {\r\n        next[0].apply(null, next[1]);\r\n    }\r\n\r\n    if (running) {\r\n        setTimeout(function () {\r\n            dispatch();\r\n        }, duration);\r\n    }\r\n}\r\n\r\nexport function stop() {\r\n    running = false;\r\n}\r\n\r\nexport function clear() {\r\n    requests = [];\r\n}","//GTW CORS Handling\r\n\r\nimport xhook from 'xhook';\r\n\r\nconst CORS_PROTOCOL = \"https://\";\r\n\r\nexport var domains = {};\r\n\r\nexport function register(domain, allowCors = false) {\r\n    var config = {};\r\n    config.allowCors = allowCors;\r\n    domains[domain] = config;\r\n}\r\n\r\nxhook.before(function (request, callback) {\r\n    var Cors = require(\"./gtw-cors\");\r\n    var Settings = require(\"./gtw-settings\");\r\n\r\n    if (Settings.get(\"cors_check_bypass\", false)) {\r\n        callback();\r\n        return;\r\n    }\r\n\r\n    var cors = Cors.isCors(request.url);\r\n\r\n    if (cors) {\r\n        var host = Cors.extractHost(request.url);\r\n\r\n        if (!host || host === \"\" || host === \"___local___\") {\r\n            callback();\r\n            return;\r\n        }\r\n\r\n        var config = Cors.domains[host];\r\n        if (!config) {\r\n            console.error(\"gtw-cors: The request to \\\"\" + host + \"\\\" was dropped, because this cross-domain host was not registered before performing AJAX.\");\r\n            callback({\r\n                status: 403,\r\n                statusText: 'The request is dropped by GoToWhere because this host was not registered before performing AJAX.',\r\n                headers: {}\r\n            });\r\n            return;\r\n        }\r\n\r\n        if (config.allowCors) {\r\n            callback();\r\n            return;\r\n        }\r\n\r\n        if (Settings.get(\"use_cors_proxy\", true)) {\r\n            var proxy = Settings.get(\"cors_proxy_server\", \"https://cp1.gotowhere.ga/\");\r\n            if (proxy.startsWith(\"https://\") && proxy.endsWith(\"/\")) {\r\n                var index = request.url.indexOf(\"http://\");\r\n                var sindex = request.url.indexOf(\"https://\");\r\n                if (index !== -1 && sindex === -1) {\r\n                    request.url = proxy + request.url.substring(index + 7);\r\n                } else if (index === -1 && sindex !== -1) {\r\n                    request.url = proxy + request.url.substring(sindex + 8);\r\n                } else {\r\n                    console.error(\"gtw-cors: Invalid URL: \" + request.url);\r\n                    callback({\r\n                        status: 403,\r\n                        statusText: 'Invalid URL: ' + request.url,\r\n                        headers: {}\r\n                    });\r\n                    return;\r\n                }\r\n            } else {\r\n                console.error(\"gtw-cors: The provided CORS Proxy server is invalid! Please check if the server URL in the settings is correct!\");\r\n                callback({\r\n                    status: 403,\r\n                    statusText: 'The provided CORS Proxy server is invalid! Please check if the server URL in the settings is correct!.',\r\n                    headers: {}\r\n                });\r\n                return;\r\n            }\r\n        } else {\r\n            console.error(\"gtw-cors: The request was dropped because there are no proxy available to handle CORS requests.\");\r\n            callback({\r\n                status: 403,\r\n                statusText: 'The request was dropped because there are no proxy available to handle CORS requests.',\r\n                headers: {}\r\n            });\r\n            return;\r\n        }\r\n    }\r\n\r\n    callback();\r\n});\r\n\r\nexport function extractHost(url) {\r\n    if (!url.includes(\"://\")) {\r\n        return \"___local___\";\r\n    } else if (url.startsWith(\"file://\")) {\r\n        return \"___file___\";\r\n    }\r\n    var i = url.indexOf(\"://\");\r\n    var last = url.substring(i + 3);\r\n\r\n    i = last.indexOf(\"/\");\r\n    if (i === -1) {\r\n        i = last.length();\r\n    }\r\n    return last.substring(0, i);\r\n}\r\n\r\nexport function isCors(url) {\r\n    if (!url.startsWith(CORS_PROTOCOL)) {\r\n        return true;\r\n    }\r\n\r\n    var host = extractHost(url);\r\n\r\n    if (domains[host]) {\r\n        var config = domains[host];\r\n        if (config.allowCors) {\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n\r\n    return window.location.host !== host;\r\n}","//City Data: Transit (Misc functions)\r\nimport * as TransitRoutes from './gtw-citydata-transit-routes';\r\nimport * as TransitStops from './gtw-citydata-transit-stops';\r\nimport * as TransitEta from './gtw-citydata-transit-eta';\r\n\r\nwindow.TransitType = {\r\n    BUS: \"bus\",\r\n    MINIBUS: \"minibus\",\r\n    TRAM: \"tram\",\r\n    TRAIN: \"train\",\r\n    FERRY: \"ferry\"\r\n};\r\n\r\nexport function getAllRoutes() {\r\n    return TransitRoutes.getAllRoutes();\r\n}\r\n\r\nexport function getAllStops() {\r\n    return TransitStops.getAllStops();\r\n}\r\n\r\nexport function fetchAllDatabase (pc) {\r\n    var proms = [];\r\n    var first = 0;\r\n    var second = 0;\r\n    var third = 0;\r\n    proms.push(TransitRoutes.fetchAllDatabase(function (p) {\r\n        first = p;\r\n        pc((first + second + third) / 3);\r\n    }));\r\n    proms.push(TransitStops.fetchAllDatabase(function (p) {\r\n        second = p;\r\n        pc((first + second + third) / 3);\r\n    }));\r\n    proms.push(TransitEta.fetchAllDatabase(function (p) {\r\n        third = p;\r\n        pc((first + second + third) / 3);\r\n    }));\r\n    return Promise.all(proms);\r\n}\r\n\r\nexport function getStopIndex(route, stop, selectedPath) {\r\n    if (selectedPath < 0 || selectedPath >= route.paths.length) {\r\n        return -1;\r\n    }\r\n    var path = route.paths[selectedPath];\r\n    for (var i = 0; i < path.length; i++) {\r\n        var stopId = path[i];\r\n        if (stop.stopId === stopId) {\r\n            return i;\r\n        }\r\n    }\r\n    return -1;\r\n}\r\n\r\nexport function searchRoutesOfStop(stop) {\r\n    var out = [];\r\n\r\n    var allRoutes = getAllRoutes();\r\n    for (var route of allRoutes) {\r\n        var paths = route.paths;\r\n        for (var i = 0; i < paths.length; i++) {\r\n            var path = paths[i];\r\n            for (var stopId of path) {\r\n                if (stop.stopId === stopId) {\r\n                    out.push({\r\n                        route: route,\r\n                        bound: i\r\n                    });\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    return out;\r\n}\r\n\r\nexport function getRoutesOfStop(stop) {\r\n    var result = searchRoutesOfStop(stop);\r\n\r\n    return result.map(function (value, index) {\r\n        return value[0];\r\n    });\r\n}","//GTW UI\r\n\r\nimport * as Transit from './gtw-citydata-transit';\r\nimport * as TransitRoutes from './gtw-citydata-transit-routes';\r\nimport * as TransitStops from './gtw-citydata-transit-stops';\r\nimport * as TransitEta from './gtw-citydata-transit-eta';\r\nimport * as Map from './gtw-map';\r\nimport * as Settings from './gtw-settings';\r\nimport * as RequestLimiter from './gtw-requestlimiter';\r\nimport * as PluginLoader from './gtw-pluginloader';\r\nimport * as Loc from './gtw-location';\r\nimport * as Misc from './gtw-misc';\r\nimport * as Lang from './gtw-lang';\r\nimport repos from './plugins/repository.json';\r\nimport cates from './plugins/categories.json';\r\n\r\n$(document).ready(function () {\r\n    $(\".header-links-plugins\").on(\"click\", function () {\r\n        showModal(\"pluginmanager\");\r\n    });\r\n    $(\".header-links-settings\").on(\"click\", function () {\r\n        showModal(\"settings\");\r\n    });\r\n    $(\".header-links-about\").on(\"click\", function () {\r\n        showModal(\"about\");\r\n    });\r\n});\r\n\r\n$(\".ui-tab\").on(\"click\", function () {\r\n    if ($(this).hasClass(\"btn-primary\")) {\r\n        return;\r\n    }\r\n    $(\".ui-tab\").removeClass(\"btn-primary\");\r\n    $(\".ui-tab\").removeClass(\"btn-link\");\r\n\r\n    var tab = $(this).attr(\"gtw-tab\");\r\n    $(this).addClass(\"btn-primary\");\r\n\r\n    $(\".ui-tab:not([gtw-tab='\" + tab + \"'])\").addClass(\"btn-link\");\r\n\r\n    showTab(tab);\r\n});\r\n\r\n$(\".ui-half-map-back-btn\").on(\"click\", function () {\r\n    clearInterval(timers[\"stopEtaUpdate\"]);\r\n    Map.setCenter(Loc.getCurrentPosition());\r\n    Map.setZoom(16);\r\n    Map.removeAllMarkers();\r\n    Map.removeAllPolylines();\r\n    showPanel();\r\n    \r\n    if (fromSearch) {\r\n        showTouchKeypad();\r\n    }\r\n});\r\n\r\nvar currentTab = \"transitEta\";\r\n\r\nvar vars = {};\r\n\r\nvar modalVars = {};\r\n\r\nvar timers = {};\r\n \r\nvar modalTimers = [];\r\n\r\nvar searchTimeout;\r\n\r\nvar installCount = 0;\r\n\r\nvar fromSearch = false;\r\n\r\nexport function init() {\r\n    showTab(\"transitEta\");\r\n    adjustMargin();\r\n    showPanel();\r\n\r\n    if (Object.keys(PluginLoader.plugins).length === 0) {\r\n        gettingStarted();\r\n    }\r\n}\r\n\r\nvar gettingStarted_reposJson = {};\r\n\r\nexport function showTouchKeypad() {\r\n    $(\"#search-transit-text\").removeAttr(\"readonly\");\r\n    $(\".touch-keypad\").css(\"display\", \"flex\");\r\n    adjustMargin();\r\n}\r\n\r\nexport function hideTouchKeypad() {\r\n    $(\"#search-transit-text\").attr(\"readonly\", \"\");\r\n    $(\".touch-keypad\").css(\"display\", \"\");\r\n    adjustMargin();\r\n}\r\n\r\nexport function showSearchRoutes() {\r\n    $(\"#button-cancel-search\").removeClass(\"btn-light\");\r\n    $(\"#button-cancel-search\").removeClass(\"disabled\");\r\n    $(\"#button-cancel-search\").addClass(\"btn-danger\");\r\n    $(\"#button-cancel-search\").html(\"<i class=\\\"fas fa-times\\\"></i>\");\r\n\r\n    $(\".nearby-route-list\").css(\"display\", \"none\");\r\n    $(\".all-route-list\").css(\"display\", \"flex\");\r\n    Map.setCenter(Loc.getCurrentPosition());\r\n    Map.setZoom(16);\r\n    Map.removeAllMarkers();\r\n    Map.removeAllPolylines();\r\n    searchRoutes(true);\r\n}\r\n\r\nexport function hideSearchRoutes() {\r\n    $(\"#button-cancel-search\").addClass(\"btn-light\");\r\n    $(\"#button-cancel-search\").addClass(\"disabled\");\r\n    $(\"#button-cancel-search\").removeClass(\"btn-danger\");\r\n    $(\"#button-cancel-search\").html(\"<i class=\\\"fas fa-search\\\"></i>\");\r\n\r\n    $(\".nearby-route-list\").css(\"display\", \"flex\");\r\n    $(\".all-route-list\").css(\"display\", \"none\");\r\n}\r\n\r\nexport function searchRoutes(skipCheck) {\r\n    var val = $(\"#search-transit-text\").val();\r\n    if (!skipCheck && (!val || val === \"\")) {\r\n        clearSearch();\r\n        return;\r\n    }\r\n\r\n    var routes = TransitRoutes.getAllRoutes();\r\n    var lastStop;\r\n    var stopId;\r\n    var provider;\r\n    var path;\r\n    var rp;\r\n    var pp;\r\n    var sp;\r\n    var i;\r\n    var sim;\r\n    var routeName;\r\n    var providerName;\r\n    var stopName;\r\n    var routeNameIncludes;\r\n\r\n    var searchList = [];\r\n\r\n    for (var route of routes) {\r\n        for (i = 0; i < route.paths.length; i++) {\r\n            path = route.paths[i];\r\n            stopId = path[path.length - 1];\r\n            provider = TransitRoutes.getProvider(route.provider);\r\n            lastStop = TransitStops.getStopById(stopId);\r\n\r\n            routeName = Lang.localizedKey(route, \"routeName\");\r\n            providerName = Lang.localizedKey(provider, \"name\");\r\n            stopName = Lang.localizedKey(lastStop, \"stopName\");\r\n\r\n            rp = Misc.similarity(routeName, val);\r\n            pp = Misc.similarity(providerName, val);\r\n            sp = Misc.similarity(stopName, val);\r\n            routeNameIncludes = routeName.includes(val);\r\n\r\n            if (!routeNameIncludes && rp < 0.3 && pp < 0.3 && sp < 0.3) {\r\n                continue;\r\n            }\r\n\r\n            sim = Math.max(rp, pp, sp);\r\n\r\n            searchList.push({\r\n                provider: provider,\r\n                route: route,\r\n                bound: i,\r\n                lastStop: lastStop,\r\n                sim: sim,\r\n                routeNameIncludes: routeNameIncludes\r\n            });\r\n        }\r\n    }\r\n\r\n    searchList.sort(function (a, b) {\r\n        return b.sim - a.sim;\r\n    });\r\n\r\n    var html = \"<ul class=\\\"list-group\\\">\";\r\n\r\n    var search;\r\n    var j;\r\n    var availableKeypads = {};\r\n    for (i = 0; i < searchList.length; i++) {\r\n        search = searchList[i];\r\n        routeName = Lang.localizedKey(search.route, \"routeName\");\r\n\r\n        if (search.routeNameIncludes && val.length < routeName.length) {\r\n            var letter = routeName.charAt(val.length);\r\n            availableKeypads[letter] = true;\r\n        }\r\n\r\n        if (i <= 20) {\r\n            html +=\r\n                \"<li class=\\\"list-group-item list-group-item-action d-flex align-items-center route-selection\\\" gtw-provider=\\\"\" + search.provider.id + \"\\\" gtw-route-id=\\\"\" + search.route.routeId + \"\\\" gtw-bound=\\\"\" + search.bound + \"\\\">\" +\r\n                \"    <div class=\\\"d-flex flex-column route-id\\\">\" +\r\n                \"        <div>\" + Lang.localizedKey(search.provider, \"name\") + \"</div>\" +\r\n                \"        <div>\" + routeName + \"</div>\" +\r\n                \"    </div>\" +\r\n                \"    <div><b>\" + $.i18n(\"transit-eta-to\") + \"</b> \" + Lang.localizedKey(search.lastStop, \"stopName\") + \"</div>\" +\r\n                \"</li>\";\r\n        }\r\n    }\r\n\r\n    html += \"</ul>\";\r\n    $(\".all-route-list\").html(html);\r\n\r\n    $(\".numeric-keypad .touch-keypad-value\").each(function () {\r\n        var val = $(this).html();\r\n        if (!availableKeypads[val]) {\r\n            $(this).addClass(\"disabled\");\r\n            $(this).addClass(\"btn-light\");\r\n            $(this).removeClass(\"btn-outline-secondary\");\r\n        } else {\r\n            $(this).removeClass(\"disabled\");\r\n            $(this).removeClass(\"btn-light\");\r\n            $(this).addClass(\"btn-outline-secondary\");\r\n            delete availableKeypads[val];\r\n        }\r\n    });\r\n\r\n    var keys = Object.keys(availableKeypads);\r\n    keys.sort(function (a, b) {\r\n        return a.charCodeAt(0) - b.charCodeAt(0);\r\n    });\r\n\r\n    var letterKeypadHtml = \"\";\r\n    for (var key of keys) {\r\n        letterKeypadHtml += \"<button type=\\\"button\\\" class=\\\"btn btn-outline-secondary py-3 touch-keypad-value\\\">\" + key + \"</button>\";\r\n    }\r\n    $(\".letter-keypad\").html(letterKeypadHtml);\r\n\r\n    $(\".letter-keypad .touch-keypad-value\").on(\"click\", mouseClickTouchKeypadValue);\r\n\r\n    $(\".all-route-list .route-selection\").on(\"mouseenter\", mouseEnterPreviewRoute);\r\n    $(\".all-route-list .route-selection\").on(\"click\", mouseClickSelectRoute);\r\n\r\n    $(\".all-route-list .route-selection:nth-child(1)\").mouseenter();\r\n}\r\n\r\nexport function clearSearch() {\r\n    hideTouchKeypad();\r\n    $(\"#search-transit-text\").val(\"\");\r\n    $(\"#button-cancel-search\").addClass(\"btn-light\");\r\n    $(\"#button-cancel-search\").addClass(\"disabled\");\r\n    $(\"#button-cancel-search\").removeClass(\"btn-danger\");\r\n    $(\"#button-cancel-search\").html(\"<i class=\\\"fas fa-search\\\"></i>\");\r\n\r\n    $(\".nearby-route-list\").css(\"display\", \"flex\");\r\n    $(\".all-route-list\").css(\"display\", \"none\");\r\n    Map.setCenter(Loc.getCurrentPosition());\r\n    Map.setZoom(16);\r\n    Map.removeAllMarkers();\r\n    Map.removeAllPolylines();\r\n\r\n    $(\".numeric-keypad .touch-keypad-value\").each(function () {\r\n        $(this).removeClass(\"disabled\");\r\n        $(this).removeClass(\"btn-light\");\r\n        $(this).addClass(\"btn-outline-secondary\");\r\n    });\r\n}\r\n\r\nexport function gettingStarted() {\r\n    $(\".header nav\").css(\"display\", \"none\");\r\n    $(\"#gettingStartedWizard\").smartWizard({\r\n        useURLhash: false,\r\n        showStepURLhash: false\r\n    });\r\n    $(\".top-panel\").css(\"display\", \"none\");\r\n    $(\".content-panel-container\").css(\"display\", \"none\");\r\n    $(\".getting-started-panel\").css(\"display\", \"block\");\r\n\r\n    var html = \"\";\r\n    for (var lang in Lang.languages) {\r\n        html += \"<option value=\\\"\" + lang + \"\\\">\" + Lang.languages[lang] + \" (\" + lang + \")</option>\";\r\n    }\r\n    $(\"#langSelect\").html(html);\r\n    $(\"#langSelect\").on(\"change\", function () {\r\n        Lang.changeLanguage($(this).val());\r\n    });\r\n\r\n    var byRegion = {};\r\n    for (var key in repos) {\r\n        if (!byRegion[repos[key].region]) {\r\n            byRegion[repos[key].region] = [];\r\n        }\r\n        byRegion[repos[key].region].push(repos[key]);\r\n    }\r\n\r\n    $(\"#regionSelect\").html(\"\");\r\n    var regionOptionsHtml = \"<option value=\\\"notselected\\\">-- \" + $.i18n(\"getting-started-wizard-step-plugins-select\") + \" --</option>\";\r\n    for (var region in byRegion) {\r\n        regionOptionsHtml += \"<option value=\\\"\" + region + \"\\\"> \" + region + \"</option>\";\r\n    }\r\n    $(\"#regionSelect\").removeAttr(\"disabled\");\r\n    $(\"#regionSelect\").html(regionOptionsHtml);\r\n\r\n    var byCategory = {};\r\n    for (var pluginKey in repos) {\r\n        if (!byCategory[repos[pluginKey].category]) {\r\n            byCategory[repos[pluginKey].category] = [];\r\n        }\r\n        byCategory[repos[pluginKey].category].push(repos[pluginKey]);\r\n    }\r\n\r\n    var calcInstallCount = function () {\r\n        var totalCount = 0;\r\n        var categoryCount;\r\n        var node;\r\n        var allCount = 0;\r\n        var category;\r\n\r\n        for (var categoryKey in byCategory) {\r\n            category = cates[categoryKey];\r\n\r\n            categoryCount = 0;\r\n            $(\".plugin-switch[category-id='\" + category.id + \"']\").each(function () {\r\n                if ($(this).prop(\"checked\")) {\r\n                    categoryCount++;\r\n                }\r\n            });\r\n            node = $(\".category-btn[category-id='\" + category.id + \"']\");\r\n            node.html(node.attr(\"category-name\") + \" (\" + categoryCount + \"/\" + byCategory[categoryKey].length + \")\");\r\n            totalCount += categoryCount;\r\n            allCount += byCategory[categoryKey].length;\r\n        }\r\n\r\n        $(\"#pluginsToInstallCount\").html($.i18n(\"getting-started-wizard-step-plugins-install-count\", totalCount, allCount));\r\n        $(\"#installCount\").html($.i18n(\"getting-started-wizard-step-finish-press-button\", totalCount));\r\n        $(\".need-to-install\").css(\"display\", totalCount > 0 ? \"none\" : \"block\");\r\n        if (totalCount > 0) {\r\n            $(\"#getStartedBtn\").removeClass(\"disabled\");\r\n        } else {\r\n            $(\"#getStartedBtn\").addClass(\"disabled\");\r\n        }\r\n    };\r\n\r\n    $(\"#regionSelect\").on(\"change\", function () {\r\n        var val = $(this).val();\r\n        var node = $(\"#pluginsToInstallAccordion\");\r\n        var installCountNode = $(\"#pluginsToInstallCount\");\r\n        if (val === \"notselected\") {\r\n            node.html(\"\");\r\n            installCountNode.html(\"\");\r\n            calcInstallCount();\r\n            return;\r\n        }\r\n\r\n        var html = \"\";\r\n        var pluginHtml;\r\n        var category;\r\n        for (var categoryKey in byCategory) {\r\n            category = cates[categoryKey];\r\n\r\n            installCount = 0;\r\n            pluginHtml = \"\";\r\n            for (var plugin of byCategory[categoryKey]) {\r\n                pluginHtml +=\r\n                    \"            <div class=\\\"custom-control custom-switch\\\">\" +\r\n                    \"                <input type=\\\"checkbox\\\" class=\\\"custom-control-input plugin-switch\" + (plugin.closedApi ? \" plugin-closed-api\" : \"\") + \"\\\" category-id=\\\"\" + category.id + \"\\\" package=\\\"\" + plugin.package + \"\\\" id=\\\"switch-\" + plugin.package + \"\\\"\" + (plugin.closedApi ? \"\" : \"checked\") + \">\" +\r\n                    \"                <label class=\\\"custom-control-label\\\" for=\\\"switch-\" + plugin.package + \"\\\">\" + plugin.fullName;\r\n                if (plugin.closedApi) {\r\n                    pluginHtml +=\r\n                        \"<br /><i class=\\\"fas fa-exclamation-triangle\\\"></i> \" + $.i18n(\"getting-started-wizard-step-plugins-closed-api\");\r\n                }\r\n                pluginHtml +=\r\n                    \"</label>\" +\r\n                    \"            </div>\"\r\n                    ;\r\n            }\r\n\r\n            html +=\r\n                \"<div class=\\\"card\\\">\" +\r\n                \"    <div class=\\\"card-header\\\" id=\\\"category-\" + category.id + \"-heading\\\">\" +\r\n                \"        <h2 class=\\\"mb-0\\\">\" +\r\n                \"            <button class=\\\"btn btn-link category-btn\\\" type=\\\"button\\\" data-toggle=\\\"collapse\\\" data-target=\\\"#collapse-category-\" + category.id + \"\\\" aria-expanded=\\\"true\\\" aria-controls=\\\"collapse-category-\" + category.id + \"\\\" category-id=\\\"\" + category.id + \"\\\" category-name=\\\"\" + category.name + \"\\\">\" + category.name + \"</button>\" +\r\n                \"        </h2>\" +\r\n                \"    </div>\" +\r\n                \"    <div id=\\\"collapse-category-\" + category.id + \"\\\" class=\\\"collapse\\\" aria-labelledby=\\\"category-\" + category.id + \"-heading\\\" data-parent=\\\"#pluginsToInstallAccordion\\\">\" +\r\n                \"        <div class=\\\"card-body\\\">\" + pluginHtml +\r\n                \"        </div>\" +\r\n                \"    </div>\" +\r\n                \"</div>\"\r\n                ;\r\n        }\r\n        node.html(html);\r\n        calcInstallCount();\r\n\r\n        $(\".plugin-closed-api\").change(function () {\r\n            if (this.checked) {\r\n                showModal(\"pluginclosedapi\", $(this), calcInstallCount);\r\n                //$(this).prop(\"checked\", returnVal);\r\n            }\r\n        });\r\n\r\n        $(\".plugin-switch\").change(function () {\r\n            calcInstallCount();\r\n        });\r\n\r\n        $(\"#getStartedBtn\").on(\"click\", function () {\r\n            if ($(this).hasClass(\"disabled\")) {\r\n                return;\r\n            }\r\n\r\n            $(\"#gettingStartedWizard\").css(\"display\", \"none\");\r\n            $(\".getting-started-progress-panel\").css(\"display\", \"block\");\r\n\r\n            var pkgs = [];\r\n            $(\".plugin-switch\").each(function () {\r\n                if ($(this).prop(\"checked\")) {\r\n                    var pkg = $(this).attr(\"package\");\r\n                    pkgs.push(pkg);\r\n                }\r\n            });\r\n            var errors = [];\r\n            var p;\r\n            for (var pkg of pkgs) {\r\n                PluginLoader.install(pkg);\r\n            }\r\n            $(\"#gs-plugin-progress\").css(\"width\", \"100%\");\r\n\r\n            if (errors.length === 0) {\r\n                setTimeout(function () {\r\n                    window.location.reload();\r\n                }, 500);\r\n                return;\r\n            }\r\n\r\n            $(\".getting-started-progress-panel\").css(\"display\", \"none\");\r\n            $(\".getting-started-plugin-error-panel\").css(\"display\", \"block\");\r\n\r\n            var html = \"<p>\" + $.i18n(\"getting-started-error-plugin-network-error\") + \"</p><button class=\\\"btn btn-block btn-warning\\\" onclick=\\\"window.location.reload()\\\" type=\\\"button\\\">\" + $.i18n(\"getting-started-error-refresh-btn\") + \"</button><hr /><p><b>\" + $.i18n(\"getting-started-error-affected-plugins\") + \"</b><br />\";\r\n            var i;\r\n            for (i = 0; i < errors.length; i++) {\r\n                html += errors[i];\r\n                if (i !== errors.length - 1) {\r\n                    html += \", \";\r\n                }\r\n            }\r\n            html += \"</p>\";\r\n\r\n            $(\".getting-started-plugin-error-panel .desc\").html(html);\r\n        });\r\n    });\r\n}\r\n\r\nexport function clearUp() {\r\n    Map.setCenter(Loc.getCurrentPosition());\r\n    Map.setZoom(16);\r\n    Map.removeAllMarkers();\r\n    Map.removeAllPolylines();\r\n\r\n    vars = {};\r\n    for (var key in timers) {\r\n        clearInterval(timers[key]);\r\n    }\r\n    timers = [];\r\n    $(\".tab-panel\").html(\"\");\r\n    $(\".content-panel-container\").html(\"\");\r\n}\r\n\r\nexport function modalClearUp() {\r\n    modalVars = {};\r\n    for (var timer of modalTimers) {\r\n        clearInterval(timer);\r\n    }\r\n}\r\n\r\nexport function showModal(layout, ...args) {\r\n    //nowUi = layout;\r\n    //previousUi = 0;\r\n    modalClearUp();\r\n    modalVars = {};\r\n\r\n    loadModalLayout(layout, true).then(function () {\r\n        $(\".modal\").i18n();\r\n        if (typeof scripts[layout] === \"function\") {\r\n            scripts[layout].apply(this, args);\r\n        }\r\n    });\r\n}\r\n\r\nexport function loadModalLayout(layout, options = {}) {\r\n    const key = \"modal-\" + layout;\r\n\r\n    if (options === true) {\r\n        options = {};\r\n        options.backdrop = \"static\";\r\n        options.keyboard = false;\r\n    }\r\n    \r\n    var proms = [];\r\n    proms.push(import(`./ui/${key}-header.html`).then(function (mod) {\r\n        $(\".modal-header\").html(mod.default);\r\n    }));\r\n    proms.push(import(`./ui/${key}-body.html`).then(function (mod) {\r\n        $(\".modal-body\").html(mod.default);\r\n    }));\r\n    proms.push(import(`./ui/${key}-footer.html`).then(function (mod) {\r\n        $(\".modal-footer\").html(mod.default);\r\n    }));\r\n\r\n    var p = Promise.all(proms);\r\n    p.then(function () {\r\n        $(\".modal\").modal(options);\r\n    });\r\n    return p;\r\n}\r\n\r\nexport function hideModal() {\r\n    $(\".modal\").modal(\"hide\");\r\n}\r\n\r\nexport function isModalShown() {\r\n    return ($(\".modal\").data('bs.modal') || {})._isShown;\r\n}\r\n\r\nexport function showTab(tab) {\r\n    clearUp();\r\n    currentTab = tab;\r\n    scripts[tab]();\r\n}\r\n\r\nexport function showPanel() {\r\n    $(\".content-panel-container\").css(\"display\", \"inline-block\");\r\n    $(\".top-panel\").css(\"display\", \"block\");\r\n    $(\".header nav\").removeClass(\"gtw-half-map\");\r\n\r\n    $(\"body\").removeClass(\"gtw-half-map\");\r\n    $(\"#gtw-map\").removeClass(\"gtw-half-map\");\r\n    $(\".map-overlay\").removeClass(\"gtw-half-map\");\r\n    $(\".half-map-panel\").removeClass(\"gtw-half-map\");\r\n    $(\".half-map-container\").removeClass(\"gtw-half-map\");\r\n\r\n    //$(\".header nav\").addClass(\"bg-dark\");\r\n    //$(\".half-map-panel\").css(\"display\", \"none\");\r\n    //$(\".top-panel\").css(\"display\", \"block\");\r\n    //$(\".half-map-container\").css(\"display\", \"none\");\r\n    //$(\".map-overlay\").fadeIn(500);\r\n    adjustMargin();\r\n}\r\n\r\nexport function hidePanel() {\r\n    $(\".top-panel\").css(\"display\", \"none\");\r\n    $(\".content-panel-container\").css(\"display\", \"none\");\r\n    $(\".header nav\").addClass(\"gtw-half-map\");\r\n\r\n    //$(\"body\").addClass(\"gtw-half-map\");\r\n    $(\"#gtw-map\").addClass(\"gtw-half-map\");\r\n    $(\".map-overlay\").addClass(\"gtw-half-map\");\r\n    $(\".half-map-panel\").addClass(\"gtw-half-map\");\r\n    $(\".half-map-container\").addClass(\"gtw-half-map\");\r\n\r\n    //$(\".half-map-panel\").css(\"display\", \"block\");\r\n    //$(\".half-map-container\").css(\"display\", \"block\");\r\n    //$(\".header nav\").removeClass(\"bg-dark\");\r\n    //$(\".map-overlay\").fadeOut(500);\r\n    adjustMargin();\r\n}\r\n\r\nexport function drawRouteOnMap(route, bound) {\r\n    var path = route.paths[bound];\r\n\r\n    var coords = [];\r\n    var pos;\r\n    var dbStop;\r\n    var i;\r\n    for (i = 0; i < path.length; i++) {\r\n        dbStop = TransitStops.getStopById(path[i]);\r\n        pos = { lat: dbStop.lat, lng: dbStop.lng };\r\n        coords.push(pos);\r\n        Map.addMarker(pos, dbStop.stopName, \"\" + (i + 1));\r\n    }\r\n\r\n    Map.addPolyline(coords, \"#FF0000\", 2);\r\n}\r\n\r\nfunction mouseClickTouchKeypadValue() {\r\n    if ($(this).hasClass(\"disabled\")) {\r\n        return;\r\n    }\r\n    var val = $(this).html();\r\n    var searchText = $(\"#search-transit-text\").val();\r\n    $(\"#search-transit-text\").val(searchText + val);\r\n    searchRoutes();\r\n}\r\n\r\nfunction mouseClickSelectRoute() {\r\n    fromSearch = $(this).parent().parent().hasClass(\"all-route-list\");\r\n\r\n    hidePanel();\r\n    hideTouchKeypad();\r\n\r\n    Map.removeAllMarkers();\r\n    Map.removeAllPolylines();\r\n\r\n    var provider = TransitRoutes.getProvider($(this).attr(\"gtw-provider\"));\r\n    var route = provider.getRouteById($(this).attr(\"gtw-route-id\"));\r\n    var stop = TransitStops.getStopById($(this).attr(\"gtw-stop-id\"));\r\n    var bound = $(this).attr(\"gtw-bound\");\r\n\r\n    showRouteList(route, bound, stop, true);\r\n    drawRouteOnMap(route, bound);\r\n}\r\n\r\nfunction mouseEnterPreviewRoute() {\r\n    Map.removeAllMarkers();\r\n    Map.removeAllPolylines();\r\n    var provider = TransitRoutes.getProvider($(this).attr(\"gtw-provider\"));\r\n    var route = provider.getRouteById($(this).attr(\"gtw-route-id\"));\r\n    var sstop = TransitStops.getStopById($(this).attr(\"gtw-stop-id\"));\r\n    var bound = $(this).attr(\"gtw-bound\");\r\n    drawRouteOnMap(route, bound);\r\n\r\n    if (sstop) {\r\n        var targetPos = { lat: sstop.lat, lng: sstop.lng };\r\n        Map.setCenter(targetPos);\r\n        Map.setZoom(18);\r\n    } else {\r\n        var path = route.paths[bound];\r\n\r\n        var latlngs = [];\r\n        var stop;\r\n        for (var stopId of path) {\r\n            stop = TransitStops.getStopById(stopId);\r\n            latlngs.push({ lat: parseFloat(stop.lat), lng: parseFloat(stop.lng) });\r\n        }\r\n        Map.fitBounds(latlngs);\r\n    }\r\n}\r\n\r\nexport function showRouteList(route, bound, stop = false, scroll = false) {\r\n    var html = \"<div class=\\\"row\\\" style=\\\"padding: 2%;\\\"><div class=\\\"timeline-centered\\\">\";\r\n    var path = route.paths[bound];\r\n    var dbStop;\r\n    var i;\r\n    for (i = 0; i < path.length; i++) {\r\n        dbStop = TransitStops.getStopById(path[i]);\r\n        html +=\r\n            \"<article class=\\\"timeline-entry\\\" stop-id=\\\"\" + dbStop.stopId + \"\\\" stop-index=\\\"\" + i + \"\\\">\" +\r\n            \"    <div class=\\\"timeline-entry-inner\\\">\" +\r\n            \"        <div class=\\\"timeline-icon bg-light\\\">\" +\r\n            \"            \" + (i + 1) +\r\n            \"        </div>\" +\r\n            \"        <div class=\\\"timeline-label\\\">\" +\r\n            \"            <h2><button style=\\\"padding: 0px;\\\" class=\\\"btn btn-link\\\" stop-id=\\\"\" + dbStop.stopId + \"\\\">\" + Lang.localizedKey(dbStop, \"stopName\") + \"</button></h2>\" +\r\n            \"            <p></p>\" +\r\n            \"        </div>\" +\r\n            \"    </div>\" +\r\n            \"</article>\"\r\n            ;\r\n    }\r\n    html += \"</div></div>\";\r\n    $(\".half-map-container\").html(html);\r\n\r\n    $(\".half-map-container button\").on(\"click\", function () {\r\n        var x = TransitStops.getStopById($(this).attr(\"stop-id\"));\r\n        if (x) {\r\n            showRouteList(route, bound, x);\r\n        }\r\n    });\r\n\r\n    var provider = TransitRoutes.getProvider(route.provider);\r\n    var lastStopId = path[path.length - 1];\r\n    html =\r\n        \"<ul class=\\\"list-group\\\"><li class=\\\"list-group-item d-flex align-items-center route-selection\\\">\" +\r\n        \"    <div class=\\\"d-flex flex-column route-id\\\">\" +\r\n        \"        <div>\" + Lang.localizedKey(provider, \"name\") + \"</div>\" +\r\n        \"        <div>\" + Lang.localizedKey(route, \"routeName\") + \"</div>\" +\r\n        \"    </div>\" +\r\n        \"    <div><b>\" + $.i18n(\"transit-eta-to\") + \":</b> \" + Lang.localizedKey(TransitStops.getStopById(lastStopId), \"stopName\") + \"</div>\" +\r\n        \"</li></ul>\"\r\n        ;\r\n    $(\".half-map-tab-panel\").html(html);\r\n\r\n    adjustMargin();\r\n    if (stop) {\r\n        var parent = screen.width >= 768 ? \".desktop\" : \".mobile\";\r\n\r\n        var node = $(parent + \" .timeline-entry[stop-id='\" + stop.stopId + \"']\");\r\n\r\n        var icon = node.children().children(\".timeline-icon\");\r\n        icon.removeClass(\"bg-light\");\r\n        icon.addClass(\"bg-primary\");\r\n\r\n        if (scroll) {\r\n            node[0].scrollIntoView();\r\n        }\r\n\r\n        var targetPos = { lat: stop.lat, lng: stop.lng };\r\n\r\n        Map.setCenter(targetPos);\r\n        Map.setZoom(18);\r\n\r\n        clearInterval(timers[\"stopEtaUpdate\"]);\r\n        var func = function () {\r\n            showStopEta(route, bound, stop);\r\n        };\r\n        func();\r\n        timers[\"stopEtaUpdate\"] = setInterval(func, 30000);\r\n    }\r\n}\r\n\r\nexport function showStopEta(route, bound, stop) {\r\n    var node = $(\".timeline-entry[stop-id='\" + stop.stopId + \"'] p\");\r\n\r\n    var content =\r\n        \"<p><u>\" + $.i18n(\"transit-eta\") + \"</u></p>\" +\r\n        \"<table class=\\\"table stop-eta\\\">\"\r\n        ;\r\n\r\n    var p = TransitEta.fetchEta({\r\n        provider: route.provider,\r\n        etaProviders: route.etaProviders,\r\n        routeId: route.routeId,\r\n        selectedPath: parseInt(bound),\r\n        stopId: stop.stopId\r\n    });\r\n    if (!p) {\r\n        content +=\r\n            \"<tr class=\\\"table-dark\\\">\" +\r\n            \"    <td colspan=\\\"4\\\">\" + $.i18n(\"transit-eta-route-not-available\") + \"</td>\" +\r\n            //\"    <td>---</td>\" +\r\n            \"</tr>\"\r\n            ;\r\n    } else {\r\n        content +=\r\n            \"<tr class=\\\"table-dark\\\">\" +\r\n            \"    <td colspan=\\\"4\\\"><div class=\\\"spinner-border spinner-border-sm\\\" role=\\\"status\\\"></div> \" + $.i18n(\"transit-eta-retrieving-data\") + \"</td>\" +\r\n            \"</tr>\";\r\n        p.then(function (data) {\r\n            var h = data.options;\r\n            var content = \"\";\r\n            var node = $(\".timeline-entry[stop-id='\" + h.stopId + \"'] p table tbody\");\r\n            if (data.code && data.code === -2) {\r\n                content +=\r\n                    \"<tr class=\\\"table-dark\\\">\" +\r\n                    \"    <td colspan=\\\"4\\\">\" + $.i18n(\"transit-eta-no-eta-providers\") + \"</td>\" +\r\n                    //\"    <td>---</td>\" +\r\n                    \"</tr>\"\r\n                    ;\r\n            } else if (!data.schedules || data.code && data.code === -1) {\r\n                content +=\r\n                    \"<tr class=\\\"table-dark\\\">\" +\r\n                    \"    <td colspan=\\\"4\\\">\" + $.i18n(\"transit-eta-no-data-received\") + \"</td>\" +\r\n                    //\"    <td>---</td>\" +\r\n                    \"</tr>\"\r\n                    ;\r\n            } else if (data.schedules.length === 0) {\r\n                content +=\r\n                    \"<tr class=\\\"table-dark\\\">\" +\r\n                    \"    <td colspan=\\\"4\\\">\" + $.i18n(\"transit-eta-no-schedules-pending\") + \"</td>\" +\r\n                    //\"    <td>---</td>\" +\r\n                    \"</tr>\"\r\n                    ;\r\n            } else {\r\n                var active = false;\r\n                for (var schedule of data.schedules) {\r\n                    var eta = Math.floor((schedule.time - schedule.serverTime) / 1000 / 60);\r\n\r\n                    var html = \"<tr class=\\\"table-\";\r\n\r\n                    if (eta >= 20) {\r\n                        html += \"secondary\";\r\n                    } else if (eta >= 15) {\r\n                        html += \"info\";\r\n                    } else if (eta >= 10) {\r\n                        html += \"success\";\r\n                    } else if (eta >= 5) {\r\n                        html += \"warning\";\r\n                    } else if (eta >= 1) {\r\n                        html += \"danger\";\r\n                    } else {\r\n                        html += \"dark\";\r\n                    }\r\n\r\n                    if (!active && eta > 0) {\r\n                        active = true;\r\n                        html += \" active\";\r\n                    }\r\n\r\n                    html += \"\\\">\";\r\n\r\n                    //TODO: isOutdated\r\n\r\n                    var provider = TransitEta.getProvider(schedule.provider);\r\n                    if (!provider) {\r\n                        console.error(\"Error: Could not find TransitEta provider to get localized names: \" + schedule.provider);\r\n                        return;\r\n                    }\r\n\r\n                    var colspan = 4;\r\n\r\n                    if (h.etaProviders.length > 1) {\r\n                        html += \"<td>\" + Lang.localizedKey(provider, \"name\") + \"</td>\";\r\n                        colspan--;\r\n                    }\r\n\r\n                    if (schedule.msg !== undefined && schedule.time === undefined) {\r\n                        html += \"<td colspan=\\\"\" + colspan + \"\\\">\" + schedule.msg + \"</td>\";\r\n                    } else {\r\n                        html += \"<td>\";\r\n                        if (schedule.msg !== undefined) {\r\n                            html += schedule.msg;\r\n                        }\r\n                        if (schedule.time !== undefined) {\r\n                            if (schedule.msg !== undefined) {\r\n                                html += \"<br />\";\r\n                            }\r\n                            if (eta > 0) {\r\n                                html += $.i18n(\"transit-eta-minutes\", eta);\r\n                            } else {\r\n                                html += $.i18n(\"transit-eta-arrived-left\");\r\n                            }\r\n                        }\r\n\r\n                        html += \"</td><td\";\r\n\r\n                        if (schedule.isLive === undefined) {\r\n                            html += \" colspan=\\\"2\\\"\";\r\n                        }\r\n\r\n                        html += \">\";\r\n\r\n                        var time = new Date(schedule.time);\r\n\r\n                        if (schedule.time !== undefined) {\r\n                            html += Misc.fillZero(time.getHours()) + \":\" + Misc.fillZero(time.getMinutes());\r\n                        } else {\r\n                            html += \"---\";\r\n                        }\r\n\r\n                        html += \"</td>\";\r\n\r\n                        if (schedule.isLive !== undefined) {\r\n                            if (schedule.isLive) {\r\n                                html += \"<td><span style=\\\"color: red; float: right; font-size: 10px;\\\"><i class=\\\"fa fa-circle\\\"></i> \" + $.i18n(\"transit-eta-live\") + \"</span></td>\";\r\n                            } else {\r\n                                html += \"<td><span style=\\\"font-size: 10px; float: right; font-style: italic;\\\">\" + $.i18n(\"transit-eta-scheduled\") + \"</span></td>\";\r\n                            }\r\n                        }\r\n                    }\r\n\r\n                    //TODO: Features\r\n\r\n                    html += \"</tr>\";\r\n                    content += html;\r\n                }\r\n            }\r\n            node.html(content);\r\n        }).catch(function (options, err) {\r\n            var node = $(\".timeline-entry[stop-id='\" + options.stopId + \"'] p table tbody\");\r\n            node.html(\"<tr class=\\\"table-danger\\\"><td colspan=\\\"4\\\">\" + $.i18n(\"transit-eta-error-fetching-eta\") + \"</td></tr>\");\r\n        });\r\n    }\r\n\r\n    content += \"</table>\";\r\n\r\n    node.html(content);\r\n}\r\n\r\nexport var scripts = {\r\n    \"updated\": function (ver) {\r\n        $(\"#updated-header\").html($.i18n(\"updated-header\", ver));\r\n        $(\"#updated-desc\").html($.i18n(\"updated-desc\", ver));\r\n        import(\"./changelog.txt\").then(function (mod) {\r\n            $(\"#updated-changelog\").html(mod.default);\r\n        });\r\n    },\r\n    \"pluginclosedapi\": function (node, func) {\r\n        $(\"#plugin-closed-api-confirm-yes\").on(\"click\", function () {\r\n            func();\r\n            hideModal();\r\n        });\r\n        $(\"#plugin-closed-api-confirm-no\").on(\"click\", function () {\r\n            node.prop(\"checked\", false);\r\n            func();\r\n            hideModal();\r\n        });\r\n    },\r\n    \"errorplugins\": function (errorPlugins) {\r\n        var node = $(\"#errorPluginsAccordion\");\r\n        var html = \"\";\r\n        var errSummary;\r\n        for (var plugin of errorPlugins) {\r\n            if (plugin.status === -1) {\r\n                errSummary = $.i18n(\"error-plugins-summary-plugin-not-available\") + \" (\" + plugin.status + \")\";\r\n            } else if (plugin.status >= -2 && plugin.status <= -4) {\r\n                errSummary = $.i18n(\"error-plugins-summary-plugin-load\") + \" (\" + plugin.status + \")\";\r\n            } else {\r\n                errSummary = $.i18n(\"error-plugins-summary-unknown-status-code\") + \" (\" + plugin.status + \")\";\r\n            }\r\n            html +=\r\n                \"<div class=\\\"card\\\">\" +\r\n                \"    <div class=\\\"card-header\\\" id=\\\"err-\" + plugin.package + \"-heading\\\">\" +\r\n                \"        <h2 class=\\\"mb-0\\\">\" +\r\n                \"            <button class=\\\"btn btn-link\\\" type=\\\"button\\\" data-toggle=\\\"collapse\\\" data-target=\\\"#collapse-err-\" + plugin.package + \"\\\" aria-expanded=\\\"true\\\" aria-controls=\\\"collapse-err-\" + plugin.package + \"\\\">\" + plugin.package + \": \" + errSummary + \"</button>\" +\r\n                \"        </h2>\" +\r\n                \"    </div>\" +\r\n                \"    <div id=\\\"collapse-err-\" + plugin.package + \"\\\" class=\\\"collapse\\\" aria-labelledby=\\\"err-\" + plugin.package + \"-heading\\\" data-parent=\\\"#errorPluginsAccordion\\\">\" +\r\n                \"        <div class=\\\"card-body\\\">\"\r\n                ;\r\n\r\n            html += \"<p><b>\" + $.i18n(\"error-plugins-message\") + \"</b><br/>\" + plugin.msg + \"</p>\";\r\n            html += \"<p><b>\" + $.i18n(\"error-plugins-solutions\") + \"</b><br/>\";\r\n\r\n            if (plugin.status === -1) {\r\n                html += $.i18n(\"error-plugins-solution-plugin-not-available\");\r\n            } else if (plugin.status >= -4 && plugin.status <= -2) {\r\n                html += $.i18n(\"error-plugins-solution-plugin-load\", plugin.status);\r\n            } else {\r\n                html += $.i18n(\"error-plugins-solution-unknown-status-code\", plugin.status);\r\n            }\r\n            html += \"</p>\";\r\n\r\n            html +=\r\n                \"        </div>\" +\r\n                \"    </div>\" +\r\n                \"</div>\"\r\n                ;\r\n        }\r\n        node.html(html);\r\n\r\n        $(\".error-plugin-accept-checksum-btn\").on(\"click\", function () {\r\n            var pkg = $(this).attr(\"package\");\r\n\r\n            var plugin = PluginLoader.plugins[pkg];\r\n            if (!pkg) {\r\n                console.error(\"Error: Accept checksum failed! Plugin \\\"\" + pkg + \"\\\" not found!\");\r\n                return;\r\n            }\r\n\r\n            var info = plugin.info;\r\n            PluginLoader.install(info.package, info.checksum, info.version);\r\n            window.location.reload();\r\n        });\r\n    },\r\n    \"viewplugin\": function (pkg) {\r\n        $(\".modal .close\").on(\"click\", function () {\r\n            showModal(\"pluginmanager\");\r\n        });\r\n\r\n        var packageJson = 0;\r\n        for (var pkey in repos) {\r\n            if (pkey === pkg) {\r\n                packageJson = repos[pkey];\r\n                break;\r\n            }\r\n        }\r\n\r\n        if (!packageJson) {\r\n            $(\".modal-body\").html($.i18n(\"view-plugin-repos-cannot-find-package\"));\r\n            return;\r\n        }\r\n\r\n        var html = \"\";\r\n\r\n        if (packageJson.closedApi) {\r\n            html += \"<div class=\\\"alert alert-warning\\\" role=\\\"alert\\\"><i class=\\\"fas fa-exclamation-triangle\\\"></i> \" + $.i18n(\"plugin-closed-api-warning\") + \"</div>\";\r\n        }\r\n\r\n        html += \"<h3>\" + $.i18n(\"view-plugin-details\") + \"</h3>\";\r\n        html += \"<hr />\";\r\n        html += \"<p>\" + $.i18n(\"view-plugin-details-name\") + \": \" + packageJson.name + \"<br />\";\r\n        html += $.i18n(\"view-plugin-details-fullname\") + \": \" + packageJson.fullName + \"<br />\";\r\n        html += $.i18n(\"view-plugin-details-author\") + \": \" + packageJson.author + \"<br />\";\r\n        html += $.i18n(\"view-plugin-details-version\") + \": \" + packageJson.version + \"<br />\";\r\n        html += $.i18n(\"view-plugin-details-github\") + \": <a href=\\\"\" + packageJson.github + \"\\\" target=\\\"_blank\\\">\" + packageJson.github + \"</a><br />\";\r\n        html += $.i18n(\"view-plugin-details-package\") + \": \" + packageJson.package + \"<br />\";\r\n        html += $.i18n(\"view-plugin-details-description\") + \": \" + packageJson.desc + \"</p>\";\r\n\r\n        html += \"<h3>\" + $.i18n(\"view-plugin-installation\") + \"</h3>\";\r\n        html += \"<hr />\";\r\n\r\n        var json = PluginLoader.getPlugin(packageJson.package);\r\n\r\n        var statusMsg = \"<span class=\\\"font-weight-bold \";\r\n        if (!json) {\r\n            statusMsg += \"text-info\\\">\" + $.i18n(\"view-plugin-installation-not-installed\");\r\n        } else if (json.status === -1) {\r\n            statusMsg += \"text-danger\\\">\" + $.i18n(\"view-plugin-installation-plugin-not-available\");\r\n        } else if (json.status === 0) {\r\n            statusMsg += \"text-success\\\">\" + $.i18n(\"view-plugin-installation-installed-running\");\r\n        } else if (json.status === 1) {\r\n            statusMsg += \"text-secondary\\\">\" + $.i18n(\"view-plugin-installation-not-enabled\");\r\n        } else if (json.status <= -2 && json.status >= -4) {\r\n            statusMsg += \"text-danger\\\">\" + $.i18n(\"view-plugin-installation-plugin-load-errors\", json.status);\r\n        } else {\r\n            statusMsg += \"text-secondary\\\">\" + $.i18n(\"view-plugin-installation-unknown-status-code\", json.status);\r\n        }\r\n        statusMsg += \"</span>\";\r\n\r\n        html += \"<p>\" + $.i18n(\"view-plugin-installation-status\") + \": \" + statusMsg + \"<br />\";\r\n\r\n        if (json && json.msg) {\r\n            html += $.i18n(\"view-plugin-installation-message\") + \": \" + json.msg + \"</p>\";\r\n        }\r\n\r\n        html += \"<hr />\";\r\n\r\n        if (json) {\r\n            html += \"<button type=\\\"button\\\" class=\\\"btn btn-danger ui-btn-viewplugin-uninstall\\\">\" + $.i18n(\"view-plugin-installation-uninstall-and-restart-btn\") + \"</button>\";\r\n        } else {\r\n            html += \"<button type=\\\"button\\\" class=\\\"btn btn-success ui-btn-viewplugin-install\\\">\" + $.i18n(\"view-plugin-installation-install-and-restart-btn\") + \"</button>\";\r\n        }\r\n\r\n        $(\".modal-body\").html(html);\r\n\r\n        $(\".ui-btn-viewplugin-install\").on(\"click\", function () {\r\n            PluginLoader.install(packageJson.package);\r\n            window.location.reload();\r\n        });\r\n\r\n        $(\".ui-btn-viewplugin-uninstall\").on(\"click\", function () {\r\n            PluginLoader.uninstall(packageJson.package);\r\n            window.location.reload();\r\n        });\r\n    },\r\n\r\n    \"pluginmanager\": function () {\r\n        var html = \"<p>\" + $.i18n(\"plugin-manager-loading\") + \"</p>\";\r\n\r\n        $(\"#nav-all\").html(html);\r\n        $(\"#nav-installed\").html(html);\r\n        $(\"#nav-transit\").html(html);\r\n        $(\"#nav-libraries\").html(html);\r\n        $(\"#nav-others\").html(html);\r\n\r\n        var byCategory = {};\r\n        for (var pluginKey in repos) {\r\n            if (!byCategory[repos[pluginKey].category]) {\r\n                byCategory[repos[pluginKey].category] = [];\r\n            }\r\n            byCategory[repos[pluginKey].category].push(repos[pluginKey]);\r\n        }\r\n\r\n        var allHtml = \"<div class=\\\"list-group\\\">\";\r\n        var tabNode = $(\"#nav-tab\");\r\n        var tabContentNode = $(\"#nav-tabContent\");\r\n        var pluginHtml;\r\n        var categoryTabHtml;\r\n        var categoryTabContentHtml;\r\n        var category;\r\n        var total = 0;\r\n        for (var categoryKey in byCategory) {\r\n            category = cates[categoryKey];\r\n\r\n            total += byCategory[categoryKey].length;\r\n            categoryTabHtml = \"<a class=\\\"nav-item nav-link\\\" id=\\\"nav-\" + category.id + \"-tab\\\" data-toggle=\\\"tab\\\" href=\\\"#nav-\" + category.id + \"\\\" role=\\\"tab\\\" aria-controls=\\\"nav-\" + category.id + \"\\\" aria-selected=\\\"true\\\">\" + category.name + \" (\" + byCategory[categoryKey].length + \")</a>\";\r\n            categoryTabContentHtml = \"<div class=\\\"tab-pane fade\\\" id=\\\"nav-\" + category.id + \"\\\" role=\\\"tabpanel\\\" aria-labelledby=\\\"nav-\" + category.id + \"-tab\\\"><div class=\\\"list-group\\\">\";\r\n\r\n            for (var pluginJson of byCategory[categoryKey]) {\r\n                pluginHtml = \"<a href=\\\"#\\\" class=\\\"list-group-item list-group-item-action ui-pluginmanager-view-plugin\\\" package=\\\"\" + pluginJson.package + \"\\\">\";\r\n                pluginHtml += \"    <div class=\\\"d-flex w-100 justify-content-between\\\">\";\r\n                pluginHtml += \"        <h5 class=\\\"mb-1\\\">\" + pluginJson.fullName + \"</h5>\";\r\n                pluginHtml += \"        <small>\" + pluginJson.version + \"</small>\";\r\n                pluginHtml += \"    </div>\";\r\n                pluginHtml += \"    <p class=\\\"mb-1\\\">\" + pluginJson.desc + \"</p>\";\r\n                pluginHtml += \"    <small>By \" + pluginJson.author + \"</small>\";\r\n                pluginHtml += \"</a>\";\r\n                categoryTabContentHtml += pluginHtml;\r\n                allHtml += pluginHtml;\r\n            }\r\n            categoryTabContentHtml += \"</div></div>\";\r\n            tabNode.append(categoryTabHtml);\r\n            tabContentNode.append(categoryTabContentHtml);\r\n        }\r\n\r\n        $(\"#nav-all-tab\").html($.i18n(\"plugin-manager-tab-all\") + \" (\" + total + \")\");\r\n        $(\"#nav-all\").html(allHtml);\r\n\r\n        $(\".ui-pluginmanager-view-plugin\").on(\"click\", function () {\r\n            showModal(\"viewplugin\", $(this).attr(\"package\"));\r\n        });\r\n    },\r\n\r\n    \"settings\": function () {\r\n        var html = \"\";\r\n\r\n        var val;\r\n        for (var setting of Settings.getDefaultSettings()) {\r\n            val = Settings.get(setting.key, setting.def);\r\n            html +=\r\n                \"<div class=\\\"form-group\\\">\" +\r\n                \"    <label><b>\" + setting.name + \":</b><p>\" + setting.desc + \"</p></label>\";\r\n            if (setting.type === \"boolean\") {\r\n                html += \"    <select class=\\\"form-control\\\" id=\\\"gtw-settings-\" + setting.key + \"\\\">\";\r\n                if (val) {\r\n                    html +=\r\n                        \"        <option value=\\\"yes\\\" selected>\" + $.i18n(\"settings-option-yes\") + \"</option>\" +\r\n                        \"        <option value=\\\"no\\\">\" + $.i18n(\"settings-option-no\") + \"</option>\";\r\n                } else {\r\n                    html +=\r\n                        \"        <option value=\\\"yes\\\">\" + $.i18n(\"settings-option-yes\") + \"</option>\" +\r\n                        \"        <option value=\\\"no\\\" selected>\" + $.i18n(\"settings-option-no\") + \"</option>\";\r\n                }\r\n                html += \"    </select>\";\r\n            } else {\r\n                html += \"    <input class=\\\"form-control\\\" id=\\\"gtw-settings-\" + setting.key + \"\\\" type=\\\"\";\r\n                if (setting.type === \"number\") {\r\n                    html += \"number\";\r\n                } else {\r\n                    html += \"text\";\r\n                }\r\n                html += \"\\\" value=\\\"\" + val + \"\\\"/>\";\r\n            }\r\n            html += \"</div>\";\r\n\r\n        }\r\n\r\n        html +=\r\n            \"<input type=\\\"button\\\" class=\\\"btn btn-success ui-btn-settings-save ui-btn-settings-save-close\\\" value=\\\"\" + $.i18n(\"settings-save-and-close-btn\") + \"\\\"/> \" +\r\n            \"<input type=\\\"button\\\" class=\\\"btn btn-default ui-btn-settings-save\\\" value=\\\"\" + $.i18n(\"settings-apply-btn\") + \"\\\"/>\";\r\n\r\n        $(\".modal-body\").html(html);\r\n\r\n        $(\".ui-btn-settings-save\").on(\"click\", function () {\r\n            var val;\r\n            var out;\r\n            for (var setting of Settings.getDefaultSettings()) {\r\n                val = $(\"#gtw-settings-\" + setting.key).val();\r\n                if (setting.type === \"boolean\") {\r\n                    out = val === \"yes\";\r\n                } else if (setting.type === \"number\") {\r\n                    out = parseInt(val);\r\n                } else {\r\n                    out = val;\r\n                }\r\n                if (setting.checkfunc && !setting.checkfunc(out)) {\r\n                    alert($.i18n(\"settings-invalid-value\", setting.name));\r\n                    return;\r\n                }\r\n                Settings.set(setting.key, out);\r\n            }\r\n            Settings.save();\r\n\r\n            if ($(this).hasClass(\"ui-btn-settings-save-close\")) {\r\n                hideModal();\r\n            }\r\n        });\r\n    },\r\n\r\n    \"transitEtaUpdateUi\": function () {\r\n        var requestLen = RequestLimiter.requests.length;\r\n        if (requestLen > 0) {\r\n            $(\".request-progress-panel\").fadeIn(500);\r\n\r\n            var max = vars[\"maxRequest\"];\r\n            if (!max || requestLen > max) {\r\n                max = vars[\"maxRequest\"] = requestLen;\r\n            }\r\n\r\n            $(\".request-progress-panel .progress-bar\").html($.i18n(\"transit-eta-requesting-data\", max - requestLen, max));\r\n            //$(\".request-progress-panel .progress-bar\").html(Math.floor((max - requestLen) / max * 100) + \"%\");\r\n            $(\".request-progress-panel .progress-bar\").css(\"width\", Math.floor((max - requestLen) / max * 100) + \"%\");\r\n        } else {\r\n            vars[\"maxRequest\"] = 0;\r\n            $(\".request-progress-panel .progress-bar\").css(\"width\", \"100%\");\r\n            $(\".request-progress-panel\").fadeOut(500, function () {\r\n                $(\".request-progress-panel .progress-bar\").css(\"width\", \"0%\");\r\n            });\r\n        }\r\n        var allNearbyRoutes = vars[\"allNearbyRoutes\"];\r\n        //var h;\r\n        for (var result of allNearbyRoutes) {\r\n            var p = TransitEta.fetchEta({\r\n                provider: result.route.provider,\r\n                etaProviders: result.route.etaProviders,\r\n                routeId: result.route.routeId,\r\n                selectedPath: result.bound,\r\n                stopId: result.stop.stopId\r\n            });\r\n            p.then(function (eta) {\r\n                var text = \"\";\r\n                var h = eta.options;\r\n\r\n                var node = $(\".nearby-route-list .route-selection[gtw-provider=\\\"\" + h.provider + \"\\\"][gtw-route-id=\\\"\" + h.routeId + \"\\\"][gtw-bound=\\\"\" + h.selectedPath + \"\\\"][gtw-stop-id=\\\"\" + h.stopId + \"\\\"]\");\r\n\r\n                node.removeClass(\"list-group-item-secondary\");\r\n                node.removeClass(\"list-group-item-info\");\r\n                node.removeClass(\"list-group-item-success\");\r\n                node.removeClass(\"list-group-item-warning\");\r\n                node.removeClass(\"list-group-item-danger\");\r\n                node.removeClass(\"list-group-item-light\");\r\n                node.removeClass(\"list-group-item-dark\");\r\n\r\n                var badgeClass = \"btn-secondary\";\r\n\r\n                if (!eta || !eta.schedules || eta.code && eta.code < 0) {\r\n                    text = $.i18n(\"transit-eta-route-not-available-short\");\r\n                    node.addClass(\"list-group-item-light\");\r\n                } else if (eta.schedules.length === 0) {\r\n                    text = $.i18n(\"transit-eta-no-schedules-pending-short\");\r\n                    node.addClass(\"list-group-item-light\");\r\n                } else {\r\n                    var schedule = eta.schedules[0];\r\n\r\n                    var calcEta = Math.floor((schedule.time - schedule.serverTime) / 1000 / 60);\r\n\r\n                    var css = \"\";\r\n\r\n                    if (calcEta >= 20) {\r\n                        css = \"secondary\";\r\n                    } else if (calcEta >= 15) {\r\n                        css = \"info\";\r\n                    } else if (calcEta >= 10) {\r\n                        css = \"success\";\r\n                    } else if (calcEta >= 5) {\r\n                        css = \"warning\";\r\n                    } else if (calcEta >= 1) {\r\n                        css = \"danger\";\r\n                    } else {\r\n                        css = \"dark\";\r\n                    }\r\n                    node.addClass(\"list-group-item-\" + css);\r\n\r\n                    //TODO: isOutdated\r\n\r\n                    if (schedule.msg !== undefined) {\r\n                        var msg = schedule.msg;\r\n                        if (msg.length > 20) {\r\n                            text = $.i18n(\"transit-eta-transit-notice\");\r\n                        } else {\r\n                            text = schedule.msg;\r\n                        }\r\n                        badgeClass = \"badge-warning\";\r\n                    } else if (schedule.time !== undefined) {\r\n                        if (schedule.msg !== undefined) {\r\n                            text += \"<br />\";\r\n                        }\r\n\r\n                        badgeClass = \"badge-primary\";\r\n                        if (calcEta > 0) {\r\n                            text += $.i18n(\"transit-eta-minutes\", calcEta);\r\n                        } else {\r\n                            text += $.i18n(\"transit-eta-arrived-left\", calcEta);\r\n                            badgeClass = \"badge-dark\";\r\n                        }\r\n\r\n                        if (schedule.isLive !== undefined) {\r\n                            text += \"<br /><span style=\\\"font-size: 10px; position: absolute; top: 16px; right: 16px; \";\r\n                            if (schedule.isLive) {\r\n                                text += \"color: red;\\\"><i class=\\\"fa fa-circle\\\"></i> \" + $.i18n(\"transit-eta-live\") + \"</span>\";\r\n                            } else {\r\n                                text += \"color: black; font-style: italic;\\\">\" + $.i18n(\"transit-eta-scheduled\") + \"</span>\";\r\n                            }\r\n                        }\r\n                    }\r\n\r\n                    /*\r\n                    if (schedule.hasTime) {\r\n                        text += Misc.fillZero(schedule.time.hr) + \":\" + Misc.fillZero(schedule.time.min);\r\n                    } else {\r\n                        text += \"---\";\r\n                    }\r\n                    */\r\n\r\n                    //TODO: Features\r\n                }\r\n                var badge = node.children(\".transit-eta\");\r\n\r\n                badge.removeClass(\"badge-primary\");\r\n                badge.removeClass(\"badge-secondary\");\r\n                badge.removeClass(\"badge-warning\");\r\n                badge.removeClass(\"badge-danger\");\r\n                badge.removeClass(\"badge-dark\");\r\n                badge.addClass(badgeClass);\r\n\r\n                badge.html(text);\r\n            }).catch(function (options, err) {\r\n                var node = $(\".nearby-route-list .route-selection[gtw-provider=\\\"\" + options.provider + \"\\\"][gtw-route-id=\\\"\" + options.routeId + \"\\\"][gtw-bound=\\\"\" + options.selectedPath + \"\\\"][gtw-stop-id=\\\"\" + options.stopId + \"\\\"]\");\r\n\r\n                node.removeClass(\"list-group-item-secondary\");\r\n                node.removeClass(\"list-group-item-info\");\r\n                node.removeClass(\"list-group-item-success\");\r\n                node.removeClass(\"list-group-item-warning\");\r\n                node.removeClass(\"list-group-item-danger\");\r\n                node.removeClass(\"list-group-item-light\");\r\n                node.removeClass(\"list-group-item-dark\");\r\n                node.addClass(\"list-group-item-light\");\r\n\r\n                var badge = node.children(\".transit-eta\");\r\n\r\n                badge.removeClass(\"badge-primary\");\r\n                badge.removeClass(\"badge-secondary\");\r\n                badge.removeClass(\"badge-warning\");\r\n                badge.removeClass(\"badge-danger\");\r\n                badge.removeClass(\"badge-dark\");\r\n                badge.addClass(\"badge-danger\");\r\n\r\n                badge.html($.i18n(\"transit-eta-error-fetching-eta-short\"));\r\n            });\r\n        }\r\n    },\r\n    \"transitEta\": function () {\r\n        RequestLimiter.clear();\r\n        TransitEta.clearCache();\r\n\r\n        var pos = Loc.getCurrentPosition();\r\n        var providers = TransitRoutes.getProviders();\r\n\r\n        if (providers.length > 0) {\r\n            var buttonScroll =\r\n                \"<div class=\\\"hori-scroll btn-group\\\">\" +\r\n                \"    <button type=\\\"button\\\" class=\\\"btn btn-primary gtw-providersort gtw-providersort-all\\\"><i class=\\\"fa fa-reply-all\\\"></i><br />\" + $.i18n(\"transit-eta-sort-all\") + \"</button>\";\r\n\r\n            for (var iprovider of providers) {\r\n                var image = \"\";\r\n                if (iprovider.type === TransitType.BUS) {\r\n                    image = \"fa-bus\";\r\n                } else if (iprovider.type === TransitType.TRAIN) {\r\n                    image = \"fa-train\";\r\n                } else {\r\n                    image = \"fa-question\";\r\n                }\r\n                buttonScroll += \" <button type=\\\"button\\\" class=\\\"btn btn-default gtw-providersort gtw-providersort-provider\\\" gtw-provider=\\\"\" + iprovider.id + \"\\\"><i class=\\\"fa \" + image + \"\\\"></i><br />\" + Lang.localizedKey(iprovider, \"name\") + \"</button>\";\r\n            }\r\n\r\n            buttonScroll += \"</div>\";\r\n\r\n            $(\".tab-panel\").append(buttonScroll);\r\n\r\n            var searchField =\r\n                \"<div class=\\\"input-group mb-3\\\" style=\\\"margin-top: 16px;\\\">\" +\r\n                \"    <input type=\\\"text\\\" class=\\\"form-control\\\" placeholder=\\\"\" + $.i18n(\"transit-eta-placeholder-search-for-transit\") + \"\\\" aria-label=\\\"\" + $.i18n(\"transit-eta-placeholder-search-for-transit\") + \"\\\" aria-describedby=\\\"search-transit-icon\\\" id=\\\"search-transit-text\\\" readonly/>\" +\r\n                \"    <div class=\\\"input-group-append\\\">\" +\r\n                //\"        <span class=\\\"input-group-text\\\" id=\\\"search-transit-icon\\\"><i class=\\\"fas fa-search\\\"></i></span>\" +\r\n                \"        <button class=\\\"btn btn-light disabled\\\" type=\\\"button\\\" id=\\\"button-cancel-search\\\"><i class=\\\"fas fa-search\\\"></i></button>\" +\r\n                \"    </div>\" +\r\n                \"</div>\"\r\n                ;\r\n\r\n            $(\".tab-panel\").append(searchField);\r\n\r\n            var requestProgressBar =\r\n                \"<div class=\\\"request-progress-panel\\\">\" +\r\n                \"    <div class=\\\"progress bg-white\\\">\" +\r\n                \"        <div class=\\\"progress-bar progress-bar-striped progress-bar-animated\\\" role=\\\"progressbar\\\" style=\\\"width: 0%;\\\"></div>\" +\r\n                \"    </div>\" +\r\n                \"</div>\"\r\n                ;\r\n\r\n            $(\".tab-panel\").append(requestProgressBar);\r\n\r\n            $(\".gtw-providersort\").on(\"click\", function () {\r\n                if ($(this).hasClass(\"btn-primary\")) {\r\n                    return;\r\n                }\r\n                $(\".gtw-providersort\").removeClass(\"btn-primary\");\r\n                //$(\".gtw-providersort\").removeClass(\"btn-default\");\r\n\r\n                if ($(this).hasClass(\"gtw-providersort-all\")) {\r\n                    $(this).addClass(\"btn-primary\");\r\n\r\n                    //$(\".gtw-providersort-provider\").addClass(\"btn-default\");\r\n                    $(\".route-selection\").attr(\"style\", \"\");\r\n                } else {\r\n                    var provider = $(this).attr(\"gtw-provider\");\r\n                    $(this).addClass(\"btn-primary\");\r\n\r\n                    $(\".gtw-providersort-provider:not([gtw-provider='\" + provider + \"'])\").addClass(\"btn-default\");\r\n                    $(\".route-selection[gtw-provider='\" + provider + \"']\").attr(\"style\", \"\");\r\n                    $(\".route-selection:not([gtw-provider='\" + provider + \"'])\").attr(\"style\", \"display: none!important\");\r\n                }\r\n            });\r\n\r\n            var lat = pos.lat;\r\n            var lng = pos.lng;\r\n            var range = Settings.get(\"min_nearby_transit_range\", 200) / 1000.0;\r\n\r\n            var allNearbyStops = TransitStops.getAllStopsNearby(lat, lng, range, true, true);\r\n\r\n            if (allNearbyStops.length === 0) {\r\n                var testRange = range;\r\n                do {\r\n                    testRange += 0.05;\r\n                    allNearbyStops = TransitStops.getAllStopsNearby(lat, lng, testRange, true, true);\r\n                } while (allNearbyStops.length === 0 && testRange < 10);\r\n\r\n                if (testRange >= 10) {\r\n                    $(\".tab-panel\").append(\r\n                        \"<div class=\\\"alert alert-danger alert-dismissable\\\">\" +\r\n                        \"<button type=\\\"button\\\" class=\\\"close\\\" data-dismiss=\\\"alert\\\" aria-hidden=\\\"true\\\" >&#215;</button>\" +\r\n                        \"No routes are found in 10 km range.\" +\r\n                        \"</div>\"\r\n                    );\r\n                } else {\r\n                    $(\".tab-panel\").append(\r\n                        \"<div class=\\\"alert alert-warning alert-dismissable\\\">\" +\r\n                        \"<button type=\\\"button\\\" class=\\\"close\\\" data-dismiss=\\\"alert\\\" aria-hidden=\\\"true\\\" >&#215;</button>\" +\r\n                        $.i18n(\"transit-eta-no-routes-found-nearby-extended-range\", range * 1000, Math.ceil(testRange * 1000)) +\r\n                        \"</div>\"\r\n                    );\r\n                }\r\n            }\r\n\r\n            var maxNearbyBusDisplay = Settings.get(\"max_nearby_transit_to_display\", 20);\r\n            var allNearbyRoutes = [];\r\n            for (var stopResult of allNearbyStops) {\r\n                if (allNearbyRoutes.length >= maxNearbyBusDisplay) {\r\n                    break;\r\n                }\r\n\r\n                var routeResults = Transit.searchRoutesOfStop(stopResult.stop);\r\n\r\n                for (var routeResult of routeResults) {\r\n                    allNearbyRoutes.push({\r\n                        route: routeResult.route,\r\n                        bound: routeResult.bound,\r\n                        stop: stopResult.stop,\r\n                        distance: stopResult.distance\r\n                    });\r\n                }\r\n            }\r\n\r\n            var html;\r\n            var distance;\r\n            var paths;\r\n            var stopId;\r\n            var provider;\r\n            html = \"<div class=\\\"row item-list nearby-route-list\\\"><ul class=\\\"list-group\\\">\";\r\n            for (var result of allNearbyRoutes) {\r\n                paths = result.route.paths[result.bound];\r\n                stopId = paths[paths.length - 1];\r\n                distance = Math.round(result.distance * 1000);\r\n                provider = TransitRoutes.getProvider(result.route.provider);\r\n                html +=\r\n                    \"    <li class=\\\"list-group-item list-group-item-action d-flex justify-content-between align-items-center route-selection\\\" gtw-provider=\\\"\" + result.route.provider + \"\\\" gtw-route-id=\\\"\" + result.route.routeId + \"\\\" gtw-stop-id=\\\"\" + result.stop.stopId + \"\\\" gtw-bound=\\\"\" + result.bound + \"\\\">\" +\r\n                    \"        <div class=\\\"d-flex flex-column route-id\\\">\" +\r\n                    \"            <div>\" + Lang.localizedKey(provider, \"name\") + \"</div>\" +\r\n                    \"            <div>\" + Lang.localizedKey(result.route, \"routeName\") + \"</div>\" +\r\n                    \"        </div>\" +\r\n                    \"        <div class=\\\"d-flex flex-column stop-info mr-auto\\\">\" +\r\n                    \"            <div>\" +\r\n                    \"                <b>\" + $.i18n(\"transit-eta-to\") + \":</b> <small>\" + Lang.localizedKey(TransitStops.getStopById(stopId), \"stopName\") +\r\n                    \"</small></div>\" +\r\n                    \"            <div>\" +\r\n                    \"                \" + Lang.localizedKey(result.stop, \"stopName\") + \" (\" + distance + $.i18n(\"transit-eta-metres\") + \")\" +\r\n                    \"            </div>\" +\r\n                    \"        </div>\" +\r\n                    \"        <span class=\\\"badge badge-primary badge-pill transit-eta\\\">\" + $.i18n(\"transit-eta-retrieving\") + \"</span>\" +\r\n                    \"    </li>\";\r\n            }\r\n            html += \"</ul></div><div class=\\\"row item-list all-route-list\\\"></div>\";\r\n\r\n            $(\".content-panel-container\").html(html);\r\n\r\n            $(\".route-selection\").on(\"mouseenter\", mouseEnterPreviewRoute);\r\n\r\n            $(\".route-selection\").on(\"mouseleave\", function () {\r\n                //Map.setCenter(Loc.getCurrentPosition());\r\n                //Map.setZoom(16);\r\n                //Map.removeAllMarkers();\r\n                //Map.removeAllPolylines();\r\n            });\r\n\r\n            $(\".route-selection\").on(\"click\", mouseClickSelectRoute);\r\n\r\n            $(\"#button-cancel-search\").on(\"click\", function () {\r\n                if (!$(this).hasClass(\"disabled\")) {\r\n                    clearSearch();\r\n                }\r\n            });\r\n\r\n            $(\".touch-keypad-function-clear\").on(\"click\", function () {\r\n                clearSearch();\r\n            });\r\n\r\n            $(\".touch-keypad-function-backspace\").on(\"click\", function () {\r\n                var searchText = $(\"#search-transit-text\").val();\r\n                $(\"#search-transit-text\").val(searchText.slice(0, -1));\r\n                searchRoutes();\r\n            });\r\n\r\n            $(\".touch-keypad-value\").on(\"click\", mouseClickTouchKeypadValue);\r\n\r\n            var useKeypad = true;\r\n            if (useKeypad) {\r\n                $(\"#search-transit-text\").on(\"click\", function () {\r\n                    showTouchKeypad();\r\n                    showSearchRoutes();\r\n                });\r\n            }\r\n\r\n            $(\"#search-transit-text\").on(\"input\", function () {\r\n                clearTimeout(searchTimeout);\r\n                searchTimeout = setTimeout(function () {\r\n                    searchRoutes();\r\n                }, 500);\r\n            });\r\n\r\n            vars[\"allNearbyRoutes\"] = allNearbyRoutes;\r\n            scripts[\"transitEtaUpdateUi\"]();\r\n            timers[\"nearbyRoutesUpdate\"] = setInterval(function () {\r\n                scripts[\"transitEtaUpdateUi\"]();\r\n            }, 30000);\r\n        } else {\r\n            //TODO: better message or auto add plugins according to region\r\n            $(\".tab-panel\").html(\"<br /><div class=\\\"alert alert-danger\\\" role=\\\"alert\\\"><i class=\\\"fas fa-exclamation-triangle\\\"></i> \" + $.i18n(\"transit-eta-no-plugins-providing-transit-data\") + \"</div>\");\r\n        }\r\n    }\r\n};","//GTW Platform Configuration\r\n\r\nexport default {\r\n    //\r\n    // Default Map API\r\n    //\r\n    // The map to be used in the UI, you can use:\r\n    //   - auto (Experimental. Prefers Google Map, fallback to Open Street Map)\r\n    //   - googlemap (Recommended)\r\n    //   - openstreetmap\r\n    mapApi: \"googlemap\",\r\n\r\n    //\r\n    // Google Map API Key\r\n    //\r\n    // You have to create an API key from the Google Cloud Console to\r\n    // use Google Map features. The default one only works on the\r\n    // official server.\r\n    googleMapApiKey: \"AIzaSyAhU7FqH46IdF4RaHrBlABfkoFlHZeudFg\"\r\n};","// GoToWhere startup script\r\n\r\nimport $ from 'jquery';\r\nwindow.jQuery = $;\r\nwindow.$ = $;\r\n\r\nvar req = require.context(\"@wikimedia/jquery.i18n/src\");\r\n\r\nvar files = [\"js\", \"messagestore\", \"fallbacks\", \"parser\", \"emitter\", \"language\"];\r\nfiles.forEach(function (module) {\r\n    req(\"./jquery.i18n.\" + module);\r\n});\r\n\r\nimport 'bootstrap';\r\nimport 'bootstrap/dist/css/bootstrap.min.css';\r\nimport './style.css';\r\nimport './timeline.css';\r\n\r\nimport 'smartwizard';\r\nimport 'smartwizard/dist/css/smart_wizard.css';\r\n\r\nimport '@fortawesome/fontawesome-free/js/fontawesome';\r\nimport '@fortawesome/fontawesome-free/js/solid';\r\nimport '@fortawesome/fontawesome-free/js/regular';\r\nimport '@fortawesome/fontawesome-free/js/brands';\r\n\r\nif ('serviceWorker' in navigator) {\r\n    window.addEventListener('load', () => {\r\n        navigator.serviceWorker.register('/service-worker.js').then(registration => {\r\n            console.log('SW registered: ', registration);\r\n        }).catch(registrationError => {\r\n            console.log('SW registration failed: ', registrationError);\r\n        });\r\n    });\r\n}\r\n\r\nvar __headerTexts = [\"<i class=\\\"fas fa-map-marked-alt\\\"></i> \\u53bb\\u908a\\u35ce GoToWhere\", \"<i class=\\\"fas fa-map-marked-alt\\\"></i> GoToWhere<small>.ga</small>\", \"<i class=\\\"fas fa-map-marked-alt\\\"></i> HeuiBin<small>.ga</small>\"];\r\nvar __stopHeaderAnimation = false;\r\n\r\nfunction __headerAnimation(i) {\r\n    if (__stopHeaderAnimation) {\r\n        return;\r\n    }\r\n\r\n    if (i === undefined || i > 2) {\r\n        i = 0;\r\n    }\r\n    $(\".startup h1\").html(__headerTexts[i]);\r\n    $(\".startup h1\").fadeIn(2000, function () {\r\n        $(\".startup h1\").fadeOut(2000, function () {\r\n            __headerAnimation(i + 1);\r\n        });\r\n    });\r\n}\r\n\r\n$(document).ready(function () {\r\n    adjustMargin();\r\n    $(\".startup .progress-panel\").fadeIn(5000);\r\n    $(\".startup .container\").fadeIn(2000, function () {\r\n        __headerAnimation();\r\n    });\r\n    console.log(\"GoToWhere (c) 2019. Licensed under the MIT License.\");\r\n    $(\"#startup-status\").html(\"Loading GoToWhere scripts...\");\r\n});\r\n\r\n$(window).resize(function () {\r\n    adjustMargin();\r\n});\r\n\r\nwindow.adjustMargin = function () {\r\n    var nph = 0;\r\n    $(\".numeric-keypad .btn-group\").each(function () {\r\n        nph += $(this).height();\r\n    });\r\n    $(\".letter-keypad\").css(\"height\", nph);\r\n\r\n    var hh = $(\".header\").height();\r\n    var dh = $(window).height();\r\n    $(\".desktop.half-map-container\").css(\"height\", dh - hh);\r\n    $(\".content-panel-container\").css(\"height\", dh - hh - nph);\r\n};\r\n\r\n/*\r\nrequirejs.config({\r\n    baseUrl: 'js/lib',\r\n    paths: {\r\n        \"xhook\": \"../xhook.min\",\r\n        \"crypto-js\": \"../../vendor/crypto-js-3.1.9-1/crypto-js\",\r\n        \"proj4\": \"../../vendor/proj4js-2.5.0/dist/proj4\"\r\n    }\r\n});\r\n*/\r\n\r\nimport * as Cors from './gtw-cors';\r\nimport * as PluginLoader from './gtw-pluginloader';\r\nimport * as Transit from './gtw-citydata-transit';\r\nimport * as TransitEta from './gtw-citydata-transit-eta';\r\nimport * as Map from './gtw-map';\r\nimport * as loc from './gtw-location';\r\nimport * as ui from './gtw-ui';\r\nimport * as settings from './gtw-settings';\r\nimport * as RequestLimiter from './gtw-requestlimiter';\r\nimport * as log from './gtw-log';\r\nimport * as lang from './gtw-lang';\r\nimport * as Database from './gtw-db';\r\nimport proj4 from 'proj4';\r\n\r\n$(\".build-version\").html(VERSION);\r\n\r\nproj4.defs(\"EPSG:2326\", \"+proj=tmerc +lat_0=22.31213333333334 +lon_0=114.1785555555556 +k=1 +x_0=836694.05 +y_0=819069.8 +ellps=intl +towgs84=-162.619,-276.959,-161.764,0.067753,-2.24365,-1.15883,-1.09425 +units=m +no_defs\");\r\nproj4.defs(\"EPSG:4326\", \"+proj=longlat +datum=WGS84 +no_defs\");\r\n\r\nsettings.load();\r\n\r\nlang.changeLanguage(settings.get(\"preferred_language\", \"en\"));\r\n\r\nRequestLimiter.start();\r\n\r\nCors.register(\"www.gotowhere.ga\", true);\r\nCors.register(\"plugins.gotowhere.ga\", true);\r\n\r\n$(\"#startup-status\").html($.i18n(\"startup-status-downloading-plugins\"));\r\n\r\n$(\"#startup-progress\").css(\"width\", \"12.5%\");\r\n$(\"#startup-status\").html($.i18n(\"startup-status-open-db\"));\r\nvar promise = Database.open();\r\n\r\nif (!promise) {\r\n    $(\"#startup-status\").attr(\"style\", \"color: red\");\r\n    $(\"#startup-status\").html($.i18n(\"startup-status-not-supported\"));\r\n} else {\r\n    promise.then(function () {\r\n        $(\"#startup-progress\").css(\"width\", \"25%\");\r\n        $(\"#startup-status\").html($.i18n(\"startup-status-loading-plugins\"));\r\n        promise = PluginLoader.load(function (progress) {\r\n            $(\"#startup-progress\").css(\"width\", 25 + (progress / 8) + \"%\");\r\n        });\r\n        promise.then(function () {\r\n            $(\"#startup-status\").html($.i18n(\"startup-status-init-db\"));\r\n            promise = Transit.fetchAllDatabase(function (progress) {\r\n                $(\"#startup-progress\").css(\"width\", (25 + progress / 4 * 3) + \"%\");\r\n            });\r\n            promise.then(function () {\r\n                $(\"#startup-progress\").css(\"width\", \"100%\");\r\n                $(\"#startup-status\").html($.i18n(\"startup-status-init-map\"));\r\n                promise = Map.init();\r\n                promise.then(function () {\r\n                    $(\"#startup-status\").html($.i18n(\"startup-status-finish\"));\r\n                    $(\".build-version\").fadeOut(2000);\r\n\r\n                    var lastVer = localStorage.getItem(\"gtw-lastversion\");\r\n                    if (lastVer && lastVer !== VERSION) {\r\n                        console.log(\"Application updated to \" + VERSION + \". Showing change-log.\");\r\n                        ui.showModal(\"updated\", VERSION);\r\n                    }\r\n                    localStorage.setItem(\"gtw-lastversion\", VERSION);\r\n                    \r\n                    //TransitManager.start();\r\n                    //TransitManager.forceUpdate();\r\n\r\n                    var errPlugins = [];\r\n                    var plugin;\r\n                    for (var pluginKey in PluginLoader.plugins) {\r\n                        plugin = PluginLoader.plugins[pluginKey];\r\n                        if (plugin.status < 0) {\r\n                            errPlugins.push(plugin);\r\n                        }\r\n                    }\r\n                    console.log(errPlugins);\r\n\r\n                    if (errPlugins.length) {\r\n                        ui.showModal(\"errorplugins\", errPlugins);\r\n                    }\r\n\r\n                    loc.requestLocationAccess(function () {\r\n                        ui.init();\r\n                        //TransitManager.forceUpdate();\r\n                        $(\"#loc-status-btn\").addClass(\"btn-success\");\r\n                        $(\"#loc-status-btn\").removeClass(\"btn-warning\");\r\n                        setTimeout(function () {\r\n                            $(\"#loc-status-btn\").fadeOut(500);\r\n                        }, 2000);\r\n                    }, function () {\r\n                        $(\"#loc-status-btn\").addClass(\"btn-danger\");\r\n                        $(\"#loc-status-btn\").removeClass(\"btn-warning\");\r\n                        $(\"#loc-status-btn\").append(\" <span>Failed!</span>\");\r\n                        setTimeout(function () {\r\n                            $(\"#loc-status-btn span\").fadeOut(500);\r\n                        }, 5000);\r\n                    });\r\n\r\n                    setTimeout(function () {\r\n                        $(\".footer\").animate({ height: 0, opacity: 0 }, 1000, function () {\r\n                            $(\".footer\").css(\"display\", \"none\");\r\n                        });\r\n                    }, 2000);\r\n                    $(\".startup\").fadeOut(1000, function () {\r\n                        __stopHeaderAnimation = true;\r\n                    });\r\n                });\r\n            });\r\n        });\r\n    });\r\n}","var map = {\n\t\"./jquery.i18n\": 24,\n\t\"./jquery.i18n.emitter\": 25,\n\t\"./jquery.i18n.emitter.bidi\": 26,\n\t\"./jquery.i18n.emitter.bidi.js\": 26,\n\t\"./jquery.i18n.emitter.js\": 25,\n\t\"./jquery.i18n.fallbacks\": 27,\n\t\"./jquery.i18n.fallbacks.js\": 27,\n\t\"./jquery.i18n.js\": 24,\n\t\"./jquery.i18n.language\": 28,\n\t\"./jquery.i18n.language.js\": 28,\n\t\"./jquery.i18n.messagestore\": 29,\n\t\"./jquery.i18n.messagestore.js\": 29,\n\t\"./jquery.i18n.parser\": 30,\n\t\"./jquery.i18n.parser.js\": 30,\n\t\"./languages/bs\": 31,\n\t\"./languages/bs.js\": 31,\n\t\"./languages/dsb\": 32,\n\t\"./languages/dsb.js\": 32,\n\t\"./languages/fi\": 33,\n\t\"./languages/fi.js\": 33,\n\t\"./languages/ga\": 34,\n\t\"./languages/ga.js\": 34,\n\t\"./languages/he\": 35,\n\t\"./languages/he.js\": 35,\n\t\"./languages/hsb\": 36,\n\t\"./languages/hsb.js\": 36,\n\t\"./languages/hu\": 37,\n\t\"./languages/hu.js\": 37,\n\t\"./languages/hy\": 38,\n\t\"./languages/hy.js\": 38,\n\t\"./languages/la\": 39,\n\t\"./languages/la.js\": 39,\n\t\"./languages/ml\": 40,\n\t\"./languages/ml.js\": 40,\n\t\"./languages/os\": 41,\n\t\"./languages/os.js\": 41,\n\t\"./languages/ru\": 42,\n\t\"./languages/ru.js\": 42,\n\t\"./languages/sl\": 43,\n\t\"./languages/sl.js\": 43,\n\t\"./languages/uk\": 44,\n\t\"./languages/uk.js\": 44\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 50;","var content = require(\"!!../node_modules/css-loader/dist/cjs.js!./style.css\");\n\nif (typeof content === 'string') {\n  content = [[module.id, content, '']];\n}\n\nvar options = {}\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = require(\"!../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\")(content, options);\n\nif (content.locals) {\n  module.exports = content.locals;\n}\n","exports = module.exports = require(\"../node_modules/css-loader/dist/runtime/api.js\")(false);\n// Module\nexports.push([module.id, \"body {\\r\\n    width: 100%;\\r\\n    height: 100vh;\\r\\n    overflow: hidden;\\r\\n    position: absolute;\\r\\n}\\r\\n\\r\\n.landscape-notice {\\r\\n    display: none;\\r\\n    width: 100%;\\r\\n    height: 100%;\\r\\n    background-color: white;\\r\\n    z-index: 5;\\r\\n    position: relative;\\r\\n    padding: 12%;\\r\\n    font-weight: bold;\\r\\n}\\r\\n\\r\\n/* Update Change-log */\\r\\n\\r\\n.build-version {\\r\\n    margin-top: env(safe-area-inset-top);\\r\\n    margin-bottom: env(safe-area-inset-bottom);\\r\\n    position: absolute;\\r\\n    top: 0;\\r\\n    right: 0;\\r\\n    margin: 1rem;\\r\\n    z-index: 5;\\r\\n}\\r\\n\\r\\n#updated-changelog {\\r\\n    white-space: normal;\\r\\n}\\r\\n\\r\\n/* Toast */\\r\\n\\r\\n.toast-stack-container {\\r\\n    position: absolute;\\r\\n    top: 0;\\r\\n    right: 0;\\r\\n    width: 100%;\\r\\n}\\r\\n\\r\\n#gtw-toast-stack {\\r\\n    position: absolute;\\r\\n    top: 0;\\r\\n    right: 0;\\r\\n    margin: 1rem;\\r\\n    z-index: 3;\\r\\n}\\r\\n\\r\\n/* Startup DIV CSS */\\r\\n\\r\\n.startup {\\r\\n    position: absolute;\\r\\n    top: 0;\\r\\n    background-color: white;\\r\\n    width: 100%;\\r\\n    height: 100%;\\r\\n    overflow: hidden;\\r\\n    z-index: 4;\\r\\n}\\r\\n\\r\\n.startup .container {\\r\\n    display: none;\\r\\n    position: relative;\\r\\n}\\r\\n\\r\\n.startup .progress-panel {\\r\\n    position: absolute;\\r\\n    text-align: center;\\r\\n    width: 100%;\\r\\n    bottom: 0px;\\r\\n}\\r\\n\\r\\n.request-progress-panel {\\r\\n    position: absolute;\\r\\n    text-align: center;\\r\\n    width: 100%;\\r\\n    left: 0px;\\r\\n    bottom: 0px;\\r\\n    display: none;\\r\\n}\\r\\n\\r\\n.startup .overlay {\\r\\n    position: absolute;\\r\\n    top: 0;\\r\\n    height: 100%;\\r\\n    width: 100%;\\r\\n    background-color: white;\\r\\n    opacity: 0.5;\\r\\n    z-index: 1;\\r\\n}\\r\\n\\r\\n.startup .progress-panel {\\r\\n    display: none;\\r\\n}\\r\\n\\r\\n/* Getting Started Panel */\\r\\n.getting-started-panel {\\r\\n    display: none;\\r\\n    padding: 1rem;\\r\\n    position: absolute;\\r\\n    z-index: 1;\\r\\n    width: 100%;\\r\\n    height: 100%;\\r\\n}\\r\\n\\r\\n.getting-started-panel p.app-title {\\r\\n    margin-top: 0.8125rem;\\r\\n    margin-left: 1rem;\\r\\n    margin-bottom: 0.8125rem;\\r\\n    white-space: nowrap;\\r\\n    line-height: inherit;\\r\\n    font-size: 1.25rem;\\r\\n}\\r\\n\\r\\n#gettingStartedWizard {\\r\\n    margin-top: 2rem;\\r\\n    background-color: white;\\r\\n    padding: 1rem;\\r\\n    width: 100%;\\r\\n}\\r\\n\\r\\n#gettingStartedWizard ul {\\r\\n    flex-wrap: nowrap;\\r\\n    overflow-x: auto;\\r\\n    overflow-y: hidden;\\r\\n}\\r\\n\\r\\n.getting-started-progress-panel {\\r\\n    display: none;\\r\\n}\\r\\n\\r\\n.getting-started-progress-panel .progress-panel {\\r\\n    text-align: center;\\r\\n}\\r\\n\\r\\n.getting-started-plugin-error-panel{\\r\\n    display: none;\\r\\n}\\r\\n\\r\\n/* ETA CSS */\\r\\n.bg-trans {\\r\\n    background-color: unset;\\r\\n}\\r\\n\\r\\n.half-map-container {\\r\\n    display: none;\\r\\n    width: 100%;\\r\\n    position: absolute;\\r\\n    overflow-x: hidden;\\r\\n    overflow-y: scroll;\\r\\n    z-index: 2;\\r\\n}\\r\\n\\r\\n.container {\\r\\n    padding: 0px;\\r\\n}\\r\\n\\r\\n.content-panel-container {\\r\\n\\r\\n}\\r\\n\\r\\n.item-list {\\r\\n    height: inherit;\\r\\n}\\r\\n\\r\\n.item-list .list-group {\\r\\n    width: 100%;\\r\\n    height: inherit;\\r\\n    overflow-x: hidden;\\r\\n    overflow-y: scroll;\\r\\n    z-index: 1;\\r\\n}\\r\\n\\r\\n.item-list .list-group li {\\r\\n    min-height: 100px;\\r\\n}\\r\\n\\r\\n.all-route-list {\\r\\n    display: none;\\r\\n}\\r\\n\\r\\n.stop-eta tr.active {\\r\\n    font-size: 18px;\\r\\n    font-weight: bold;\\r\\n}\\r\\n\\r\\n/* Map CSS */\\r\\n\\r\\n#gtw-map {\\r\\n    width: 100vw;\\r\\n    height: 100vh;\\r\\n    top: 0px;\\r\\n    left: 0px;\\r\\n    position: fixed;\\r\\n    overflow: hidden;\\r\\n}\\r\\n\\r\\n/* Search panel CSS */\\r\\n\\r\\n.top-panel {\\r\\n    padding: 8px;\\r\\n    margin-bottom: 0px;\\r\\n    background-color: unset;\\r\\n}\\r\\n\\r\\n.top-panel .tabs, .hori-scroll {\\r\\n    overflow: auto;\\r\\n    white-space: nowrap;\\r\\n    display: block;\\r\\n    padding: 4px;\\r\\n}\\r\\n\\r\\n.top-panel .tabs .ui-tab, .hori-scroll button {\\r\\n    display: inline-block;\\r\\n}\\r\\n\\r\\n#loc-status-btn {\\r\\n    margin-top: env(safe-area-inset-top);\\r\\n    margin-bottom: env(safe-area-inset-bottom);\\r\\n    position: fixed;\\r\\n    z-index: 3;\\r\\n    right: 4px;\\r\\n    bottom: 4px;\\r\\n}\\r\\n\\r\\n/* Header, footer CSS */\\r\\n\\r\\n.gtw-container {\\r\\n    position: fixed;\\r\\n    top: 0;\\r\\n    width: 100%;\\r\\n    z-index: 1;\\r\\n}\\r\\n\\r\\n/*\\r\\n.header nav {\\r\\n    background-color: #343a40\\r\\n}\\r\\n*/\\r\\n\\r\\n.footer {\\r\\n    padding-top: 8px;\\r\\n    padding-bottom: 0px;\\r\\n    position: fixed;\\r\\n    bottom: 0;\\r\\n    z-index: 2;\\r\\n    width: 100%;\\r\\n}\\r\\n\\r\\n.map-overlay {\\r\\n    position: fixed;\\r\\n    width: 100%;\\r\\n    height: 100%;\\r\\n    top: 0;\\r\\n    left: 0;\\r\\n    right: 0;\\r\\n    bottom: 0;\\r\\n    background-color: rgba(233,236,239,0.8);\\r\\n    z-index: 1;\\r\\n    cursor: pointer;\\r\\n}\\r\\n\\r\\n/* Loading Overlay CSS */\\r\\n\\r\\n.loading-overlay {\\r\\n    position: fixed;\\r\\n    display: none;\\r\\n    width: 100%;\\r\\n    height: 100%;\\r\\n    top: 0;\\r\\n    left: 0;\\r\\n    right: 0;\\r\\n    bottom: 0;\\r\\n    background-color: rgba(0,0,0,0.3);\\r\\n    z-index: 3;\\r\\n    opacity: 100;\\r\\n    cursor: pointer;\\r\\n}\\r\\n\\r\\n.loading-overlay .spinner-border {\\r\\n    width: 3rem;\\r\\n    height: 3rem;\\r\\n}\\r\\n\\r\\n/* Touch Keypad */\\r\\n\\r\\n.touch-keypad {\\r\\n    position: fixed;\\r\\n    left: 0;\\r\\n    bottom: 0;\\r\\n    width: 100%;\\r\\n    margin: 0px;\\r\\n    padding: 0px;\\r\\n    z-index: 2;\\r\\n    background: white;\\r\\n    display: none;\\r\\n}\\r\\n\\r\\n.touch-keypad .numeric-keypad {\\r\\n    width: 75%;\\r\\n}\\r\\n\\r\\n.touch-keypad .letter-keypad {\\r\\n    width: 25%;\\r\\n    overflow-x: hidden;\\r\\n    overflow-y: auto;\\r\\n    white-space: nowrap;\\r\\n    justify-content: flex-start;\\r\\n}\\r\\n\\r\\n/* Route selection */\\r\\n\\r\\n.route-selection .route-id {\\r\\n    padding-right: 16px;\\r\\n    font-weight: bold;\\r\\n}\\r\\n\\r\\n.route-selection .stop-info {\\r\\n    margin-left: 8px;\\r\\n    margin-right: 8px;\\r\\n}\\r\\n\\r\\n.route-selection .stop-info .badge {\\r\\n\\r\\n}\\r\\n\\r\\n.route-selection .stop-info .col-sm-12{\\r\\n    white-space: nowrap;\\r\\n    overflow: hidden;\\r\\n    text-overflow: ellipsis; \\r\\n    width: inherit;\\r\\n}\\r\\n\\r\\n/* Search Transit Field */\\r\\n\\r\\n#search-transit-text {\\r\\n    background-color: #fff;\\r\\n}\\r\\n\\r\\n/* Half-map Panel */\\r\\n.half-map-panel {\\r\\n    display: none;\\r\\n    background-color: unset;\\r\\n    padding: 8px;\\r\\n    margin-bottom: 0px;\\r\\n    position: relative;\\r\\n    z-index: 1;\\r\\n}\\r\\n\\r\\n/* Media Query */\\r\\n@media only screen and (min-width: 768px) {\\r\\n    .top-panel {\\r\\n        /*width: 25%;*/\\r\\n    }\\r\\n\\r\\n    .half-map-panel {\\r\\n        /*width: 25%;*/\\r\\n    }\\r\\n\\r\\n    .half-map-container {\\r\\n        /*width: 25%;*/\\r\\n        margin-left: 0;\\r\\n    }\\r\\n\\r\\n    .content-panel-container {\\r\\n        /*width: 25%;*/\\r\\n        margin-left: 0;\\r\\n    }\\r\\n\\r\\n    .request-progress-panel {\\r\\n        width: 25%;\\r\\n    }\\r\\n\\r\\n    #gtw-map {\\r\\n        width: 100vw;\\r\\n        /*width: 75%;\\r\\n        margin-left: 25%;*/\\r\\n    }\\r\\n\\r\\n    .gtw-container {\\r\\n        width: 25%;\\r\\n    }\\r\\n\\r\\n    .map-overlay {\\r\\n        width: 25%;\\r\\n        /*display: none;*/\\r\\n    }\\r\\n    \\r\\n    .touch-keypad {\\r\\n        width: 25%;\\r\\n    }\\r\\n\\r\\n    .getting-started-panel {\\r\\n        /*width: 25%;*/\\r\\n    }\\r\\n\\r\\n    .desktop.half-map-panel.gtw-half-map {\\r\\n        display: block;\\r\\n    }\\r\\n\\r\\n    .desktop.half-map-container.gtw-half-map {\\r\\n        display: block;\\r\\n    }\\r\\n\\r\\n    .mobile.half-map-panel.gtw-half-map {\\r\\n        display: none;\\r\\n    }\\r\\n\\r\\n    .mobile.half-map-container.gtw-half-map {\\r\\n        display: none;\\r\\n    }\\r\\n}\\r\\n\\r\\n@media only screen and (max-width: 768px) {\\r\\n    .gtw-container nav {\\r\\n        margin-top: env(safe-area-inset-top);\\r\\n        background-color: unset;\\r\\n    }\\r\\n\\r\\n    .toast-stack-container {\\r\\n        margin-top: env(safe-area-inset-top);\\r\\n        margin-bottom: env(safe-area-inset-bottom);\\r\\n    }\\r\\n\\r\\n    .getting-started-panel {\\r\\n        margin-top: env(safe-area-inset-top);\\r\\n        margin-bottom: env(safe-area-inset-bottom);\\r\\n    }\\r\\n\\r\\n    .modal {\\r\\n        margin-top: env(safe-area-inset-top);\\r\\n        margin-bottom: env(safe-area-inset-bottom);\\r\\n    }\\r\\n\\r\\n    .mobile-split-container {\\r\\n        margin-top: 50vh;\\r\\n        padding: 0px;\\r\\n    }\\r\\n\\r\\n    .startup .progress-panel {\\r\\n        margin-bottom: env(safe-area-inset-bottom);\\r\\n    }\\r\\n\\r\\n    /*\\r\\n    body.gtw-half-map {\\r\\n        overflow-y: scroll;\\r\\n    }\\r\\n\\r\\n    #gtw-map {\\r\\n        display: none;\\r\\n    }\\r\\n    */\\r\\n\\r\\n    .map-overlay.gtw-half-map {\\r\\n        /*display: none;*/\\r\\n        margin-top: 50vh;\\r\\n        height: 50vh;\\r\\n    }\\r\\n\\r\\n    /*\\r\\n    #gtw-map.gtw-half-map {\\r\\n        height: 50vh;\\r\\n        display: block;\\r\\n    }\\r\\n    */\\r\\n\\r\\n    .desktop.half-map-panel.gtw-half-map {\\r\\n        display: none;\\r\\n    }\\r\\n\\r\\n    .desktop.half-map-container.gtw-half-map {\\r\\n        display: none;\\r\\n    }\\r\\n\\r\\n    .mobile.half-map-panel.gtw-half-map {\\r\\n        display: block;\\r\\n        height: 20vh;\\r\\n    }\\r\\n\\r\\n    .mobile.half-map-container.gtw-half-map {\\r\\n        display: block;\\r\\n        height: 30vh;\\r\\n    }\\r\\n}\\r\\n\\r\\n/*\\r\\n@media only screen and (max-height: 768px) and (orientation: landscape) {\\r\\n    .landscape-notice {\\r\\n        display: block;\\r\\n    }\\r\\n}\\r\\n*/\\r\\n\\r\\n@media screen and (max-width: 470px) {\\r\\n    .startup h1 {\\r\\n        font-size: 10vw;\\r\\n    }\\r\\n}\", \"\"]);\n","var content = require(\"!!../node_modules/css-loader/dist/cjs.js!./timeline.css\");\n\nif (typeof content === 'string') {\n  content = [[module.id, content, '']];\n}\n\nvar options = {}\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = require(\"!../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\")(content, options);\n\nif (content.locals) {\n  module.exports = content.locals;\n}\n","exports = module.exports = require(\"../node_modules/css-loader/dist/runtime/api.js\")(false);\n// Module\nexports.push([module.id, \"\\r\\nimg {\\r\\n    vertical-align: middle;\\r\\n}\\r\\n\\r\\n.img-responsive {\\r\\n    display: block;\\r\\n    height: auto;\\r\\n    max-width: 100%;\\r\\n}\\r\\n\\r\\n.img-rounded {\\r\\n    border-radius: 3px;\\r\\n}\\r\\n\\r\\n.img-thumbnail {\\r\\n    background-color: #fff;\\r\\n    border: 1px solid #ededf0;\\r\\n    border-radius: 3px;\\r\\n    display: inline-block;\\r\\n    height: auto;\\r\\n    line-height: 1.428571429;\\r\\n    max-width: 100%;\\r\\n    moz-transition: all .2s ease-in-out;\\r\\n    o-transition: all .2s ease-in-out;\\r\\n    padding: 2px;\\r\\n    transition: all .2s ease-in-out;\\r\\n    webkit-transition: all .2s ease-in-out;\\r\\n}\\r\\n\\r\\n.img-circle {\\r\\n    border-radius: 50%;\\r\\n}\\r\\n\\r\\n.timeline-centered {\\r\\n    position: relative;\\r\\n    margin-bottom: 30px;\\r\\n}\\r\\n\\r\\n    .timeline-centered:before, .timeline-centered:after {\\r\\n        content: \\\" \\\";\\r\\n        display: table;\\r\\n    }\\r\\n\\r\\n    .timeline-centered:after {\\r\\n        clear: both;\\r\\n    }\\r\\n\\r\\n    .timeline-centered:before, .timeline-centered:after {\\r\\n        content: \\\" \\\";\\r\\n        display: table;\\r\\n    }\\r\\n\\r\\n    .timeline-centered:after {\\r\\n        clear: both;\\r\\n    }\\r\\n\\r\\n    .timeline-centered:before {\\r\\n        content: '';\\r\\n        position: absolute;\\r\\n        display: block;\\r\\n        width: 4px;\\r\\n        background: #f5f5f6;\\r\\n        /*left: 50%;*/\\r\\n        top: 20px;\\r\\n        bottom: 20px;\\r\\n        margin-left: 30px;\\r\\n    }\\r\\n\\r\\n    .timeline-centered .timeline-entry {\\r\\n        position: relative;\\r\\n        /*width: 50%;\\r\\n        float: right;*/\\r\\n        margin-top: 5px;\\r\\n        margin-left: 30px;\\r\\n        margin-bottom: 10px;\\r\\n        clear: both;\\r\\n    }\\r\\n\\r\\n        .timeline-centered .timeline-entry:before, .timeline-centered .timeline-entry:after {\\r\\n            content: \\\" \\\";\\r\\n            display: table;\\r\\n        }\\r\\n\\r\\n        .timeline-centered .timeline-entry:after {\\r\\n            clear: both;\\r\\n        }\\r\\n\\r\\n        .timeline-centered .timeline-entry:before, .timeline-centered .timeline-entry:after {\\r\\n            content: \\\" \\\";\\r\\n            display: table;\\r\\n        }\\r\\n\\r\\n        .timeline-centered .timeline-entry:after {\\r\\n            clear: both;\\r\\n        }\\r\\n\\r\\n        .timeline-centered .timeline-entry.begin {\\r\\n            margin-bottom: 0;\\r\\n        }\\r\\n\\r\\n        .timeline-centered .timeline-entry.left-aligned {\\r\\n            float: left;\\r\\n        }\\r\\n\\r\\n            .timeline-centered .timeline-entry.left-aligned .timeline-entry-inner {\\r\\n                margin-left: 0;\\r\\n                margin-right: -18px;\\r\\n            }\\r\\n\\r\\n                .timeline-centered .timeline-entry.left-aligned .timeline-entry-inner .timeline-time {\\r\\n                    left: auto;\\r\\n                    right: -100px;\\r\\n                    text-align: left;\\r\\n                }\\r\\n\\r\\n                .timeline-centered .timeline-entry.left-aligned .timeline-entry-inner .timeline-icon {\\r\\n                    float: right;\\r\\n                }\\r\\n\\r\\n                .timeline-centered .timeline-entry.left-aligned .timeline-entry-inner .timeline-label {\\r\\n                    margin-left: 0;\\r\\n                    margin-right: 70px;\\r\\n                }\\r\\n\\r\\n                    .timeline-centered .timeline-entry.left-aligned .timeline-entry-inner .timeline-label:after {\\r\\n                        left: auto;\\r\\n                        right: 0;\\r\\n                        margin-left: 0;\\r\\n                        margin-right: -9px;\\r\\n                        -moz-transform: rotate(180deg);\\r\\n                        -o-transform: rotate(180deg);\\r\\n                        -webkit-transform: rotate(180deg);\\r\\n                        -ms-transform: rotate(180deg);\\r\\n                        transform: rotate(180deg);\\r\\n                    }\\r\\n\\r\\n        .timeline-centered .timeline-entry .timeline-entry-inner {\\r\\n            position: relative;\\r\\n            margin-left: -20px;\\r\\n        }\\r\\n\\r\\n            .timeline-centered .timeline-entry .timeline-entry-inner:before, .timeline-centered .timeline-entry .timeline-entry-inner:after {\\r\\n                content: \\\" \\\";\\r\\n                display: table;\\r\\n            }\\r\\n\\r\\n            .timeline-centered .timeline-entry .timeline-entry-inner:after {\\r\\n                clear: both;\\r\\n            }\\r\\n\\r\\n            .timeline-centered .timeline-entry .timeline-entry-inner:before, .timeline-centered .timeline-entry .timeline-entry-inner:after {\\r\\n                content: \\\" \\\";\\r\\n                display: table;\\r\\n            }\\r\\n\\r\\n            .timeline-centered .timeline-entry .timeline-entry-inner:after {\\r\\n                clear: both;\\r\\n            }\\r\\n\\r\\n            .timeline-centered .timeline-entry .timeline-entry-inner .timeline-time {\\r\\n                position: absolute;\\r\\n                left: -100px;\\r\\n                text-align: right;\\r\\n                padding: 10px;\\r\\n                -webkit-box-sizing: border-box;\\r\\n                -moz-box-sizing: border-box;\\r\\n                box-sizing: border-box;\\r\\n            }\\r\\n\\r\\n                .timeline-centered .timeline-entry .timeline-entry-inner .timeline-time > span {\\r\\n                    display: block;\\r\\n                }\\r\\n\\r\\n                    .timeline-centered .timeline-entry .timeline-entry-inner .timeline-time > span:first-child {\\r\\n                        font-size: 15px;\\r\\n                        font-weight: bold;\\r\\n                    }\\r\\n\\r\\n                    .timeline-centered .timeline-entry .timeline-entry-inner .timeline-time > span:last-child {\\r\\n                        font-size: 12px;\\r\\n                    }\\r\\n\\r\\n            .timeline-centered .timeline-entry .timeline-entry-inner .timeline-icon {\\r\\n                background: #fff;\\r\\n                color: #737881;\\r\\n                display: block;\\r\\n                width: 40px;\\r\\n                height: 40px;\\r\\n                -webkit-background-clip: padding-box;\\r\\n                -moz-background-clip: padding;\\r\\n                background-clip: padding-box;\\r\\n                -webkit-border-radius: 20px;\\r\\n                -moz-border-radius: 20px;\\r\\n                border-radius: 20px;\\r\\n                text-align: center;\\r\\n                -moz-box-shadow: 0 0 0 5px #f5f5f6;\\r\\n                -webkit-box-shadow: 0 0 0 5px #f5f5f6;\\r\\n                box-shadow: 0 0 0 5px #f5f5f6;\\r\\n                line-height: 40px;\\r\\n                font-size: 15px;\\r\\n                float: left;\\r\\n            }\\r\\n\\r\\n                .timeline-centered .timeline-entry .timeline-entry-inner .timeline-icon.bg-primary {\\r\\n                    background-color: #303641;\\r\\n                    color: #fff;\\r\\n                }\\r\\n\\r\\n                .timeline-centered .timeline-entry .timeline-entry-inner .timeline-icon.bg-secondary {\\r\\n                    background-color: #ee4749;\\r\\n                    color: #fff;\\r\\n                }\\r\\n\\r\\n                .timeline-centered .timeline-entry .timeline-entry-inner .timeline-icon.bg-success {\\r\\n                    background-color: #00a651;\\r\\n                    color: #fff;\\r\\n                }\\r\\n\\r\\n                .timeline-centered .timeline-entry .timeline-entry-inner .timeline-icon.bg-info {\\r\\n                    background-color: #21a9e1;\\r\\n                    color: #fff;\\r\\n                }\\r\\n\\r\\n                .timeline-centered .timeline-entry .timeline-entry-inner .timeline-icon.bg-warning {\\r\\n                    background-color: #fad839;\\r\\n                    color: #fff;\\r\\n                }\\r\\n\\r\\n                .timeline-centered .timeline-entry .timeline-entry-inner .timeline-icon.bg-danger {\\r\\n                    background-color: #cc2424;\\r\\n                    color: #fff;\\r\\n                }\\r\\n\\r\\n            .timeline-centered .timeline-entry .timeline-entry-inner .timeline-label {\\r\\n                position: relative;\\r\\n                background: #f5f5f6;\\r\\n                padding: 1em;\\r\\n                margin-left: 60px;\\r\\n                -webkit-background-clip: padding-box;\\r\\n                -moz-background-clip: padding;\\r\\n                background-clip: padding-box;\\r\\n                -webkit-border-radius: 3px;\\r\\n                -moz-border-radius: 3px;\\r\\n                border-radius: 3px;\\r\\n            }\\r\\n\\r\\n                .timeline-centered .timeline-entry .timeline-entry-inner .timeline-label:after {\\r\\n                    content: '';\\r\\n                    display: block;\\r\\n                    position: absolute;\\r\\n                    width: 0;\\r\\n                    height: 0;\\r\\n                    border-style: solid;\\r\\n                    border-width: 9px 9px 9px 0;\\r\\n                    border-color: transparent #f5f5f6 transparent transparent;\\r\\n                    left: 0;\\r\\n                    top: 10px;\\r\\n                    margin-left: -9px;\\r\\n                }\\r\\n\\r\\n                .timeline-centered .timeline-entry .timeline-entry-inner .timeline-label h2, .timeline-centered .timeline-entry .timeline-entry-inner .timeline-label p {\\r\\n                    color: #737881;\\r\\n                    font-family: \\\"Noto Sans\\\",sans-serif;\\r\\n                    font-size: 12px;\\r\\n                    margin: 0;\\r\\n                    line-height: 1.428571429;\\r\\n                }\\r\\n\\r\\n                    .timeline-centered .timeline-entry .timeline-entry-inner .timeline-label p + p {\\r\\n                        margin-top: 15px;\\r\\n                    }\\r\\n\\r\\n                .timeline-centered .timeline-entry .timeline-entry-inner .timeline-label h2 {\\r\\n                    font-size: 16px;\\r\\n                }\\r\\n\\r\\n                    .timeline-centered .timeline-entry .timeline-entry-inner .timeline-label h2 button {\\r\\n                        color: #303641;\\r\\n                    }\\r\\n\\r\\n                    .timeline-centered .timeline-entry .timeline-entry-inner .timeline-label h2 span {\\r\\n                        -webkit-opacity: .6;\\r\\n                        -moz-opacity: .6;\\r\\n                        opacity: .6;\\r\\n                        -ms-filter: alpha(opacity=60);\\r\\n                        filter: alpha(opacity=60);\\r\\n                    }\\r\\n\", \"\"]);\n","var map = {\n\t\"./categories\": [\n\t\t12,\n\t\t3\n\t],\n\t\"./categories.json\": [\n\t\t12,\n\t\t3\n\t],\n\t\"./gtwp-ctbnwfb\": [\n\t\t20,\n\t\t9,\n\t\t0\n\t],\n\t\"./gtwp-ctbnwfb/\": [\n\t\t20,\n\t\t9,\n\t\t0\n\t],\n\t\"./gtwp-ctbnwfb/LICENCE\": [\n\t\t75,\n\t\t7,\n\t\t29\n\t],\n\t\"./gtwp-ctbnwfb/index\": [\n\t\t20,\n\t\t9,\n\t\t0\n\t],\n\t\"./gtwp-ctbnwfb/index.js\": [\n\t\t20,\n\t\t9,\n\t\t0\n\t],\n\t\"./gtwp-hktransit\": [\n\t\t21,\n\t\t9,\n\t\t1\n\t],\n\t\"./gtwp-hktransit/\": [\n\t\t21,\n\t\t9,\n\t\t1\n\t],\n\t\"./gtwp-hktransit/LICENCE\": [\n\t\t76,\n\t\t7,\n\t\t30\n\t],\n\t\"./gtwp-hktransit/index\": [\n\t\t21,\n\t\t9,\n\t\t1\n\t],\n\t\"./gtwp-hktransit/index.js\": [\n\t\t21,\n\t\t9,\n\t\t1\n\t],\n\t\"./gtwp-kmb\": [\n\t\t22,\n\t\t9,\n\t\t2\n\t],\n\t\"./gtwp-kmb/\": [\n\t\t22,\n\t\t9,\n\t\t2\n\t],\n\t\"./gtwp-kmb/LICENCE\": [\n\t\t77,\n\t\t7,\n\t\t31\n\t],\n\t\"./gtwp-kmb/index\": [\n\t\t22,\n\t\t9,\n\t\t2\n\t],\n\t\"./gtwp-kmb/index.js\": [\n\t\t22,\n\t\t9,\n\t\t2\n\t],\n\t\"./repository\": [\n\t\t3,\n\t\t3\n\t],\n\t\"./repository.json\": [\n\t\t3,\n\t\t3\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(function() {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn Promise.all(ids.slice(2).map(__webpack_require__.e)).then(function() {\n\t\treturn __webpack_require__.t(id, ids[1])\n\t});\n}\nwebpackAsyncContext.keys = function webpackAsyncContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackAsyncContext.id = 69;\nmodule.exports = webpackAsyncContext;","var map = {\n\t\"./gtw-map-googlemap\": [\n\t\t48,\n\t\t3\n\t],\n\t\"./gtw-map-googlemap.js\": [\n\t\t48,\n\t\t3\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(function() {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn __webpack_require__.e(ids[1]).then(function() {\n\t\treturn __webpack_require__(id);\n\t});\n}\nwebpackAsyncContext.keys = function webpackAsyncContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackAsyncContext.id = 70;\nmodule.exports = webpackAsyncContext;","var map = {\n\t\"./modal-about-header.html\": [\n\t\t79,\n\t\t9\n\t],\n\t\"./modal-errorplugins-header.html\": [\n\t\t80,\n\t\t12\n\t],\n\t\"./modal-pluginclosedapi-header.html\": [\n\t\t81,\n\t\t15\n\t],\n\t\"./modal-pluginmanager-header.html\": [\n\t\t82,\n\t\t18\n\t],\n\t\"./modal-settings-header.html\": [\n\t\t83,\n\t\t21\n\t],\n\t\"./modal-updated-header.html\": [\n\t\t84,\n\t\t24\n\t],\n\t\"./modal-viewplugin-header.html\": [\n\t\t85,\n\t\t27\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(function() {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn __webpack_require__.e(ids[1]).then(function() {\n\t\treturn __webpack_require__.t(id, 7);\n\t});\n}\nwebpackAsyncContext.keys = function webpackAsyncContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackAsyncContext.id = 71;\nmodule.exports = webpackAsyncContext;","var map = {\n\t\"./modal-about-body.html\": [\n\t\t86,\n\t\t7\n\t],\n\t\"./modal-errorplugins-body.html\": [\n\t\t87,\n\t\t10\n\t],\n\t\"./modal-pluginclosedapi-body.html\": [\n\t\t88,\n\t\t13\n\t],\n\t\"./modal-pluginmanager-body.html\": [\n\t\t89,\n\t\t16\n\t],\n\t\"./modal-settings-body.html\": [\n\t\t90,\n\t\t19\n\t],\n\t\"./modal-updated-body.html\": [\n\t\t91,\n\t\t22\n\t],\n\t\"./modal-viewplugin-body.html\": [\n\t\t92,\n\t\t25\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(function() {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn __webpack_require__.e(ids[1]).then(function() {\n\t\treturn __webpack_require__.t(id, 7);\n\t});\n}\nwebpackAsyncContext.keys = function webpackAsyncContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackAsyncContext.id = 72;\nmodule.exports = webpackAsyncContext;","var map = {\n\t\"./modal-about-footer.html\": [\n\t\t93,\n\t\t8\n\t],\n\t\"./modal-errorplugins-footer.html\": [\n\t\t94,\n\t\t11\n\t],\n\t\"./modal-pluginclosedapi-footer.html\": [\n\t\t95,\n\t\t14\n\t],\n\t\"./modal-pluginmanager-footer.html\": [\n\t\t96,\n\t\t17\n\t],\n\t\"./modal-settings-footer.html\": [\n\t\t97,\n\t\t20\n\t],\n\t\"./modal-updated-footer.html\": [\n\t\t98,\n\t\t23\n\t],\n\t\"./modal-viewplugin-footer.html\": [\n\t\t99,\n\t\t26\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(function() {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn __webpack_require__.e(ids[1]).then(function() {\n\t\treturn __webpack_require__.t(id, 7);\n\t});\n}\nwebpackAsyncContext.keys = function webpackAsyncContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackAsyncContext.id = 73;\nmodule.exports = webpackAsyncContext;","//GTW Logging\r\n\r\nimport * as Settings from './gtw-settings';\r\n\r\nvar maxEntries = 1000;\r\n\r\nvar logEntries = [];\r\n\r\nvar jsTrace = console.trace;\r\nconsole.trace = function (msg) {\r\n    log(\"console\", msg, -1);\r\n};\r\n\r\nvar jsDebug = console.debug;\r\nconsole.debug = function (msg) {\r\n    log(\"console\", msg, -2);\r\n};\r\n\r\nvar jsInfo = console.log;\r\nconsole.log = function (msg) {\r\n    log(\"console\", msg, 0);\r\n};\r\n\r\nvar jsWarn = console.warn;\r\nconsole.warn = function (msg) {\r\n    log(\"console\", msg, 1);\r\n};\r\n\r\nvar jsError = console.error;\r\nconsole.error = function (msg) {\r\n    log(\"console\", msg, 2);\r\n};\r\n\r\nexport var printObject = true;\r\n\r\nexport function toConsole(msg, level) {\r\n    if (level === -2) {\r\n        jsTrace(msg);\r\n    } else if (level === -1) {\r\n        jsDebug(msg);\r\n    } else if (level === 0) {\r\n        jsInfo(msg);\r\n    } else if (level === 1) {\r\n        jsWarn(msg);\r\n    } else if (level === 2) {\r\n        jsError(msg);\r\n    }\r\n}\r\n\r\nexport function toLogger(tag, msg, time, level) {\r\n    if (logEntries.length >= maxEntries) {\r\n        logEntries.shift();\r\n    }\r\n    logEntries.push({\r\n        time: time,\r\n        msg: msg,\r\n        level: level\r\n    });\r\n\r\n    if (Settings.get(\"show_debug_msg\", false)) {\r\n        showToast(logEntries.length, tag, msg, time, level);\r\n    }\r\n}\r\n\r\nvar lastMsg = 0;\r\nvar lastTag = 0;\r\nvar lastLevel = 0;\r\nvar lastTime = 0;\r\n\r\nexport function showToast(id, tag, msg, time, level) {\r\n    if (level <= 0) {\r\n        return;\r\n    }\r\n\r\n    if (lastMsg === msg && lastTag === tag && lastLevel === level && time - lastTime < 7500) {\r\n        return;\r\n    }\r\n\r\n    lastTime = time;\r\n    lastMsg = msg;\r\n    lastTag = tag;\r\n    lastLevel = level;\r\n\r\n    var node = $(\"#gtw-toast-stack\");\r\n    var levelName = \"Unknown\";\r\n    var className = \"\";\r\n\r\n    if (level === -2) {\r\n        levelName = \"Trace\";\r\n    } else if (level === -1) {\r\n        levelName = \"Debug\";\r\n    } else if (level === 0) {\r\n        levelName = \"Info\";\r\n        className = \" text-primary\";\r\n    } else if (level === 1) {\r\n        levelName = \"Warning\";\r\n        className = \" text-warning\";\r\n    } else if (level === 2) {\r\n        levelName = \"Error\";\r\n        className = \" text-danger\";\r\n    }\r\n\r\n    var html =\r\n        \"<div class=\\\"toast\\\" role=\\\"alert\\\" log-entry-id=\\\"\" + id + \"\\\">\" +\r\n        \"    <div class=\\\"toast-header\\\">\" +\r\n        \"        <strong class=\\\"mr-auto\" + className + \"\\\">\" + levelName + \" (\" + tag + \")</strong>\" +\r\n        \"        <small class=\\\"text-muted\\\">\" + new Date(time).toLocaleString() + \"</small>\" +\r\n        \"        <button type=\\\"button\\\" class=\\\"ml-2 mb-1 close\\\" data-dismiss=\\\"toast\\\" aria-label=\\\"Close\\\"><span aria-hidden=\\\"true\\\">&times;</span></button>\" +\r\n        \"    </div>\" +\r\n        \"    <div class=\\\"toast-body\\\">\" + msg +\r\n        \"    </div>\" +\r\n        \"</div>\"\r\n        ;\r\n\r\n    if (node.children().length >= 3) {\r\n        node.children().each(function (i) {\r\n            if (i >= 2) {\r\n                $(this).toast('hide');\r\n            }\r\n        });\r\n    }\r\n\r\n    node.prepend(html);\r\n\r\n    var key = \".toast[log-entry-id='\" + id + \"']\";\r\n    $(key).on('hidden.bs.toast', function () {\r\n        $(this).remove();\r\n    });\r\n    $(key).toast({\r\n        animation: true,\r\n        autohide: true,\r\n        delay: 5000\r\n    });\r\n    $(key).toast('show');\r\n}\r\n\r\nexport function getEntries() {\r\n    return logEntries;\r\n}\r\n\r\nexport function log(tag = \"unknown\", msg, level = 0) {\r\n    var time = Date.now();\r\n\r\n    if (typeof msg === \"object\") {\r\n        if (printObject) {\r\n            toConsole(\"[\" + new Date(time).toLocaleString() + \"] [\" + tag + \"]\", level);\r\n            toConsole(msg, level);\r\n        } else {\r\n            var pmsg = JSON.stringify(msg);\r\n            toConsole(\"[\" + new Date(time).toLocaleString() + \"] [\" + tag + \"] \" + pmsg, level);\r\n        }\r\n    } else {\r\n        toConsole(\"[\" + new Date(time).toLocaleString() + \"] [\" + tag + \"] \" + msg, level);\r\n    }\r\n\r\n    toLogger(tag, msg, time, level);\r\n}\r\n\r\nexport function trace(tag, msg) {\r\n    log(tag, msg, -2);\r\n}\r\n\r\nexport function debug(tag, msg) {\r\n    log(tag, msg, -1);\r\n}\r\n\r\nexport function info(tag, msg) {\r\n    log(tag, msg, 0);\r\n}\r\n\r\nexport function warn(tag, msg) {\r\n    log(tag, msg, 1);\r\n}\r\n\r\nexport function error(tag, msg) {\r\n    log(tag, msg, 2);\r\n}"],"sourceRoot":""}
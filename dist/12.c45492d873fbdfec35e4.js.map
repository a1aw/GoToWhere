{"version":3,"sources":["webpack:///./src/gtw-ui-gettingstarted.js"],"names":["enable","$","css","smartWizard","useURLhash","showStepURLhash","html","lang","on","this","val","byRegion","key","region","push","regionOptionsHtml","i18n","removeAttr","byCategory","pluginKey","category","calcInstallCount","categoryCount","node","totalCount","allCount","categoryKey","id","each","prop","attr","length","removeClass","addClass","installCountNode","pluginHtml","plugin","closedApi","package","fullName","name","change","checked","hasClass","pkgs","pkg","errors","i","setTimeout","window","location","reload"],"mappings":"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","file":"12.c45492d873fbdfec35e4.js","sourcesContent":["import * as PluginLoader from './gtw-pluginloader';\r\nimport * as Lang from './gtw-lang';\r\nimport * as UI from './gtw-ui';\r\nimport repos from './plugins/repository.json';\r\nimport cates from './plugins/categories.json';\r\n\r\nexport function enable() {\r\n    $(\".header nav\").css(\"display\", \"none\");\r\n    $(\"#gettingStartedWizard\").smartWizard({\r\n        useURLhash: false,\r\n        showStepURLhash: false\r\n    });\r\n    $(\".top-panel\").css(\"display\", \"none\");\r\n    $(\".content-panel-container\").css(\"display\", \"none\");\r\n    $(\".getting-started-panel\").css(\"display\", \"block\");\r\n\r\n    var html = \"\";\r\n    for (var lang in Lang.languages) {\r\n        html += \"<option value=\\\"\" + lang + \"\\\">\" + Lang.languages[lang] + \" (\" + lang + \")</option>\";\r\n    }\r\n    $(\"#langSelect\").html(html);\r\n    $(\"#langSelect\").on(\"change\", function () {\r\n        Lang.changeLanguage($(this).val());\r\n    });\r\n\r\n    var byRegion = {};\r\n    for (var key in repos) {\r\n        if (!byRegion[repos[key].region]) {\r\n            byRegion[repos[key].region] = [];\r\n        }\r\n        byRegion[repos[key].region].push(repos[key]);\r\n    }\r\n\r\n    $(\"#regionSelect\").html(\"\");\r\n    var regionOptionsHtml = \"<option value=\\\"notselected\\\">-- \" + $.i18n(\"getting-started-wizard-step-plugins-select\") + \" --</option>\";\r\n    for (var region in byRegion) {\r\n        regionOptionsHtml += \"<option value=\\\"\" + region + \"\\\"> \" + region + \"</option>\";\r\n    }\r\n    $(\"#regionSelect\").removeAttr(\"disabled\");\r\n    $(\"#regionSelect\").html(regionOptionsHtml);\r\n\r\n    var byCategory = {};\r\n    for (var pluginKey in repos) {\r\n        if (!byCategory[repos[pluginKey].category]) {\r\n            byCategory[repos[pluginKey].category] = [];\r\n        }\r\n        byCategory[repos[pluginKey].category].push(repos[pluginKey]);\r\n    }\r\n\r\n    var calcInstallCount = function () {\r\n        var totalCount = 0;\r\n        var categoryCount;\r\n        var node;\r\n        var allCount = 0;\r\n        var category;\r\n\r\n        for (var categoryKey in byCategory) {\r\n            category = cates[categoryKey];\r\n\r\n            categoryCount = 0;\r\n            $(\".plugin-switch[category-id='\" + category.id + \"']\").each(function () {\r\n                if ($(this).prop(\"checked\")) {\r\n                    categoryCount++;\r\n                }\r\n            });\r\n            node = $(\".category-btn[category-id='\" + category.id + \"']\");\r\n            node.html(node.attr(\"category-name\") + \" (\" + categoryCount + \"/\" + byCategory[categoryKey].length + \")\");\r\n            totalCount += categoryCount;\r\n            allCount += byCategory[categoryKey].length;\r\n        }\r\n\r\n        $(\"#pluginsToInstallCount\").html($.i18n(\"getting-started-wizard-step-plugins-install-count\", totalCount, allCount));\r\n        $(\"#installCount\").html($.i18n(\"getting-started-wizard-step-finish-press-button\", totalCount));\r\n        $(\".need-to-install\").css(\"display\", totalCount > 0 ? \"none\" : \"block\");\r\n        if (totalCount > 0) {\r\n            $(\"#getStartedBtn\").removeClass(\"disabled\");\r\n        } else {\r\n            $(\"#getStartedBtn\").addClass(\"disabled\");\r\n        }\r\n    };\r\n\r\n    $(\"#regionSelect\").on(\"change\", function () {\r\n        var val = $(this).val();\r\n        var node = $(\"#pluginsToInstallAccordion\");\r\n        var installCountNode = $(\"#pluginsToInstallCount\");\r\n        if (val === \"notselected\") {\r\n            node.html(\"\");\r\n            installCountNode.html(\"\");\r\n            calcInstallCount();\r\n            return;\r\n        }\r\n\r\n        var html = \"\";\r\n        var pluginHtml;\r\n        var category;\r\n        for (var categoryKey in byCategory) {\r\n            category = cates[categoryKey];\r\n            \r\n            pluginHtml = \"\";\r\n            for (var plugin of byCategory[categoryKey]) {\r\n                pluginHtml +=\r\n                    \"            <div class=\\\"custom-control custom-switch\\\">\" +\r\n                    \"                <input type=\\\"checkbox\\\" class=\\\"custom-control-input plugin-switch\" + (plugin.closedApi ? \" plugin-closed-api\" : \"\") + \"\\\" category-id=\\\"\" + category.id + \"\\\" package=\\\"\" + plugin.package + \"\\\" id=\\\"switch-\" + plugin.package + \"\\\"\" + (plugin.closedApi ? \"\" : \"checked\") + \">\" +\r\n                    \"                <label class=\\\"custom-control-label\\\" for=\\\"switch-\" + plugin.package + \"\\\">\" + plugin.fullName;\r\n                if (plugin.closedApi) {\r\n                    pluginHtml +=\r\n                        \"<br /><i class=\\\"fas fa-exclamation-triangle\\\"></i> \" + $.i18n(\"getting-started-wizard-step-plugins-closed-api\");\r\n                }\r\n                pluginHtml +=\r\n                    \"</label>\" +\r\n                    \"            </div>\"\r\n                    ;\r\n            }\r\n\r\n            html +=\r\n                \"<div class=\\\"card\\\">\" +\r\n                \"    <div class=\\\"card-header\\\" id=\\\"category-\" + category.id + \"-heading\\\">\" +\r\n                \"        <h2 class=\\\"mb-0\\\">\" +\r\n                \"            <button class=\\\"btn btn-link category-btn\\\" type=\\\"button\\\" data-toggle=\\\"collapse\\\" data-target=\\\"#collapse-category-\" + category.id + \"\\\" aria-expanded=\\\"true\\\" aria-controls=\\\"collapse-category-\" + category.id + \"\\\" category-id=\\\"\" + category.id + \"\\\" category-name=\\\"\" + category.name + \"\\\">\" + category.name + \"</button>\" +\r\n                \"        </h2>\" +\r\n                \"    </div>\" +\r\n                \"    <div id=\\\"collapse-category-\" + category.id + \"\\\" class=\\\"collapse\\\" aria-labelledby=\\\"category-\" + category.id + \"-heading\\\" data-parent=\\\"#pluginsToInstallAccordion\\\">\" +\r\n                \"        <div class=\\\"card-body\\\">\" + pluginHtml +\r\n                \"        </div>\" +\r\n                \"    </div>\" +\r\n                \"</div>\"\r\n                ;\r\n        }\r\n        node.html(html);\r\n        calcInstallCount();\r\n\r\n        $(\".plugin-closed-api\").change(function () {\r\n            if (this.checked) {\r\n                UI.showModal(\"pluginclosedapi\", $(this), calcInstallCount);\r\n                //$(this).prop(\"checked\", returnVal);\r\n            }\r\n        });\r\n\r\n        $(\".plugin-switch\").change(function () {\r\n            calcInstallCount();\r\n        });\r\n\r\n        $(\"#getStartedBtn\").on(\"click\", function () {\r\n            if ($(this).hasClass(\"disabled\")) {\r\n                return;\r\n            }\r\n\r\n            $(\"#gettingStartedWizard\").css(\"display\", \"none\");\r\n            $(\".getting-started-progress-panel\").css(\"display\", \"block\");\r\n\r\n            var pkgs = [];\r\n            $(\".plugin-switch\").each(function () {\r\n                if ($(this).prop(\"checked\")) {\r\n                    var pkg = $(this).attr(\"package\");\r\n                    pkgs.push(pkg);\r\n                }\r\n            });\r\n            var errors = [];\r\n            var p;\r\n            for (var pkg of pkgs) {\r\n                PluginLoader.install(pkg);\r\n            }\r\n            $(\"#gs-plugin-progress\").css(\"width\", \"100%\");\r\n\r\n            if (errors.length === 0) {\r\n                setTimeout(function () {\r\n                    window.location.reload();\r\n                }, 500);\r\n                return;\r\n            }\r\n\r\n            $(\".getting-started-progress-panel\").css(\"display\", \"none\");\r\n            $(\".getting-started-plugin-error-panel\").css(\"display\", \"block\");\r\n\r\n            var html = \"<p>\" + $.i18n(\"getting-started-error-plugin-network-error\") + \"</p><button class=\\\"btn btn-block btn-warning\\\" onclick=\\\"window.location.reload()\\\" type=\\\"button\\\">\" + $.i18n(\"getting-started-error-refresh-btn\") + \"</button><hr /><p><b>\" + $.i18n(\"getting-started-error-affected-plugins\") + \"</b><br />\";\r\n            var i;\r\n            for (i = 0; i < errors.length; i++) {\r\n                html += errors[i];\r\n                if (i !== errors.length - 1) {\r\n                    html += \", \";\r\n                }\r\n            }\r\n            html += \"</p>\";\r\n\r\n            $(\".getting-started-plugin-error-panel .desc\").html(html);\r\n        });\r\n    });\r\n}"],"sourceRoot":""}
(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{111:function(t,e,a){"use strict";(function(t){a.d(e,"d",(function(){return i})),a.d(e,"f",(function(){return o})),a.d(e,"b",(function(){return n})),a.d(e,"a",(function(){return l})),a.d(e,"c",(function(){return d})),a.d(e,"e",(function(){return c}));var r=[];function s(){if(!t(this).hasClass("disabled"))for(var e of r)e(this)}function i(){t(".numeric-keypad .touch-keypad-value").each((function(){t(this).removeClass("disabled"),t(this).removeClass("btn-secondary"),t(this).addClass("btn-outline-secondary")}))}function o(){t(".touch-keypad").css("display","flex"),adjustMargin()}function n(){t(".touch-keypad").css("display",""),adjustMargin()}function l(t){return"function"==typeof t&&(r.push(t),!0)}function d(t){if("function"!=typeof t)return!1;var e=r.indexOf(t);return-1!==e&&(r.splice(e,1),!0)}function c(e){t(".numeric-keypad .touch-keypad-value").each((function(){var a=t(this).html();e[a]?(t(this).removeClass("disabled"),t(this).removeClass("btn-secondary"),t(this).addClass("btn-outline-secondary")):(t(this).addClass("disabled"),t(this).addClass("btn-secondary"),t(this).removeClass("btn-outline-secondary")),delete e[a]}));var a=Object.keys(e);a.sort((function(t,e){return t.charCodeAt(0)-e.charCodeAt(0)}));var r="";for(var i of a)r+='<button type="button" class="btn btn-outline-secondary py-3 touch-keypad-key touch-keypad-value">'+i+"</button>";t(".letter-keypad").html(r),t(".letter-keypad .touch-keypad-value").on("click",s)}t(".touch-keypad-function-clear").on("click",s),t(".touch-keypad-function-backspace").on("click",s),t(".touch-keypad-value").on("click",s)}).call(this,a(0))},57:function(t,e,a){"use strict";a.r(e),function(t){a.d(e,"enable",(function(){return q})),a.d(e,"disable",(function(){return A}));var r,s,i,o,n,l,d,c=a(22),u=a(6),p=a(7),v=a(8),g=a(23),h=a(1),b=a(4),f=a(16),m=a(15),y=a(111),w=a(20),C=a(12),k=a(3),I=!1;function x(){t("#search-transit-text").attr("readonly","readonly"),y.b()}function z(e){t(".gtw-providersort-provider").each((function(){var a=t(this).attr("gtw-provider");t(e+" .route-selection[gtw-provider='"+a+"']").length>0?t(this).css("display",""):t(this).css("display","none")}))}function K(){var e=t("#search-transit-text").val();var a,r,s,i,o,n,l,d=u.getAllRoutes(),c=[];for(var v of d)for(n=0;n<v.paths.length;n++)r=(i=v.paths[n])[i.length-1],s=u.getProvider(v.provider),a=p.getStopById(r),l=f.localizedKey(v,"routeName"),f.localizedKey(s,"name"),f.localizedKey(a,"stopName"),o=b.d(l,e),l.startsWith(e)&&c.push({provider:s,route:v,bound:n,lastStop:a,sim:o});c.sort((function(t,e){return e.sim-t.sim}));var g,h='<ul class="list-group">',m={};for(n=0;n<c.length;n++){if(g=c[n],l=f.localizedKey(g.route,"routeName"),e.length<l.length)m[l.charAt(e.length)]=!0;n<=20&&(h+='<li class="list-group-item list-group-item-action d-flex align-items-center route-selection" gtw-provider="'+g.provider.id+'" gtw-route-id="'+g.route.routeId+'" gtw-bound="'+g.bound+'">    <div class="d-flex flex-column route-id">        <div>'+f.localizedKey(g.provider,"name")+"</div>        <div>"+l+"</div>    </div>    <div><b>"+t.i18n("transit-eta-to")+":</b> "+f.localizedKey(g.lastStop,"stopName")+"</div></li>")}h+="</ul>",t(".all-route-list").html(h),y.e(m),t(".all-route-list .route-selection").on("mouseenter",T),t(".all-route-list .route-selection").on("click",S),z(".all-route-list")}function N(){t(".gtw-providersort").removeClass("btn-primary"),t(".gtw-providersort-all").addClass("btn-primary"),t(".route-selection").attr("style","")}function P(){x(),t("#search-transit-text").val(""),t("#button-cancel-search").addClass("btn-light"),t("#button-cancel-search").addClass("disabled"),t("#button-cancel-search").removeClass("btn-danger"),t("#button-cancel-search").html('<i class="fas fa-search"></i>'),t(".nearby-route-list").css("display","flex"),t(".all-route-list").css("display","none"),k.g(m.a()),k.h(16),k.e(),k.f(),N(),z(".nearby-route-list"),y.d()}function B(t,e){var a,r,s,i=t.paths[e],o=[];for(s=0;s<i.length;s++)a={lat:(r=p.getStopById(i[s])).lat,lng:r.lng},o.push(a),k.a(a,r.stopName,""+(s+1));k.b(o,"#FF0000",2)}function S(){I=t(this).parent().parent().hasClass("all-route-list"),C.b(),x(),k.e(),k.f();var e=u.getProvider(t(this).attr("gtw-provider")).getRouteById(t(this).attr("gtw-route-id")),a=p.getStopById(t(this).attr("gtw-stop-id")),r=t(this).attr("gtw-bound");!function e(a,r,i=!1,o=!1){var n='<div class="row" style="padding: 2%;"><div class="timeline-centered">';var l=a.paths[r];var d;var c;for(c=0;c<l.length;c++)d=p.getStopById(l[c]),n+='<article class="timeline-entry" stop-id="'+d.stopId+'" stop-index="'+c+'">    <div class="timeline-entry-inner">        <div class="timeline-icon bg-light">            '+(c+1)+'        </div>        <div class="timeline-label">            <h2><button style="padding: 0px;" class="btn btn-link" stop-id="'+d.stopId+'">'+f.localizedKey(d,"stopName")+"</button></h2>            <p></p>        </div>    </div></article>";n+="</div></div>";t(".half-map-container").html(n);t(".half-map-container button").on("click",(function(){var s=p.getStopById(t(this).attr("stop-id"));s&&e(a,r,s)}));var g=u.getProvider(a.provider);var h=l[l.length-1];n='<ul class="list-group"><li class="list-group-item d-flex align-items-center route-selection">    <div class="d-flex flex-column route-id">        <div>'+f.localizedKey(g,"name")+"</div>        <div>"+f.localizedKey(a,"routeName")+"</div>    </div>    <div><b>"+t.i18n("transit-eta-to")+":</b> "+f.localizedKey(p.getStopById(h),"stopName")+"</div></li></ul>";t(".half-map-tab-panel").html(n);adjustMargin();if(i){var m=screen.width>=768?".desktop":".mobile",y=t(m+" .timeline-entry[stop-id='"+i.stopId+"']"),w=y.children().children(".timeline-icon");w.removeClass("bg-light"),w.addClass("bg-primary"),o&&y[0].scrollIntoView();var C={lat:i.lat,lng:i.lng};k.g(C),k.h(18),clearInterval(s);var I=function(){!function(e,a,r){var s=t(".timeline-entry[stop-id='"+r.stopId+"'] p"),i="<p><u>"+t.i18n("transit-eta")+'</u></p><table class="table stop-eta">',o=v.fetchEta({provider:e.provider,etaProviders:e.etaProviders,routeId:e.routeId,selectedPath:parseInt(a),stopId:r.stopId});o?(i+='<tr class="table-dark">    <td colspan="4"><div class="spinner-border spinner-border-sm" role="status"></div> '+t.i18n("transit-eta-retrieving-data")+"</td></tr>",o.then((function(e){var a=e.options,r="",s=t(".timeline-entry[stop-id='"+a.stopId+"'] p table tbody");if(e.code&&-2===e.code)r+='<tr class="table-dark">    <td colspan="4">'+t.i18n("transit-eta-no-eta-providers")+"</td></tr>";else if(!e.schedules||e.code&&-1===e.code)r+='<tr class="table-dark">    <td colspan="4">'+t.i18n("transit-eta-no-data-received")+"</td></tr>";else if(0===e.schedules.length)r+='<tr class="table-dark">    <td colspan="4">'+t.i18n("transit-eta-no-schedules-pending")+"</td></tr>";else{var i=!1;for(var o of e.schedules){var n=Math.floor((o.time-o.serverTime)/1e3/60),l='<tr class="table-';l+=n>=20?"secondary":n>=15?"info":n>=10?"success":n>=5?"warning":n>=1?"danger":"dark",!i&&n>0&&(i=!0,l+=" active"),l+='">';var d=v.getProvider(o.provider);if(!d)return void console.error("Error: Could not find TransitEta provider to get localized names: "+o.provider);var c=4;if(a.etaProviders.length>1&&(l+="<td>"+f.localizedKey(d,"name")+"</td>",c--),void 0!==o.msg&&void 0===o.time)l+='<td colspan="'+c+'">'+o.msg+"</td>";else{l+="<td>",void 0!==o.msg&&(l+=o.msg),void 0!==o.time&&(void 0!==o.msg&&(l+="<br />"),l+=n>0?t.i18n("transit-eta-minutes",n):t.i18n("transit-eta-arrived-left")),l+="</td><td",void 0===o.isLive&&(l+=' colspan="2"'),l+=">";var u=new Date(o.time);void 0!==o.time?l+=b.b(u.getHours())+":"+b.b(u.getMinutes()):l+="---",l+="</td>",void 0!==o.isLive&&(o.isLive?l+='<td><span style="color: red; float: right; font-size: 10px;"><i class="fa fa-circle"></i> '+t.i18n("transit-eta-live")+"</span></td>":l+='<td><span style="font-size: 10px; float: right; font-style: italic;">'+t.i18n("transit-eta-scheduled")+"</span></td>")}r+=l+="</tr>"}}s.html(r)})).catch((function(e,a){t(".timeline-entry[stop-id='"+e.stopId+"'] p table tbody").html('<tr class="table-danger"><td colspan="4">'+t.i18n("transit-eta-error-fetching-eta")+"</td></tr>")}))):i+='<tr class="table-dark">    <td colspan="4">'+t.i18n("transit-eta-route-not-available")+"</td></tr>";i+="</table>",s.html(i)}(a,r,i)};I(),s=setInterval(I,3e4)}}(e,r,a,!0),B(e,r)}function T(){k.e(),k.f();var e=u.getProvider(t(this).attr("gtw-provider")).getRouteById(t(this).attr("gtw-route-id")),a=p.getStopById(t(this).attr("gtw-stop-id")),r=t(this).attr("gtw-bound");if(B(e,r),a){var s={lat:a.lat,lng:a.lng};k.g(s),k.h(18)}else{var i,o=e.paths[r],n=[];for(var l of o)i=p.getStopById(l),n.push({lat:parseFloat(i.lat),lng:parseFloat(i.lng)});k.c(n)}}function _(){var e=g.c.length;if(e>0){t(".request-progress-panel").fadeIn(500);var a=n;(!a||e>a)&&(a=n=e),t(".request-progress-panel .progress-bar").html(t.i18n("transit-eta-requesting-data",a-e,a)),t(".request-progress-panel .progress-bar").css("width",Math.floor((a-e)/a*100)+"%")}else n=0,t(".request-progress-panel .progress-bar").css("width","100%"),t(".request-progress-panel").fadeOut(500,(function(){t(".request-progress-panel .progress-bar").css("width","0%")}));for(var r of o){v.fetchEta({provider:r.route.provider,etaProviders:r.route.etaProviders,routeId:r.route.routeId,selectedPath:r.bound,stopId:r.stop.stopId}).then((function(e){var a="",r=e.options,s=t('.nearby-route-list .route-selection[gtw-provider="'+r.provider+'"][gtw-route-id="'+r.routeId+'"][gtw-bound="'+r.selectedPath+'"][gtw-stop-id="'+r.stopId+'"]');s.removeClass("list-group-item-secondary"),s.removeClass("list-group-item-info"),s.removeClass("list-group-item-success"),s.removeClass("list-group-item-warning"),s.removeClass("list-group-item-danger"),s.removeClass("list-group-item-light"),s.removeClass("list-group-item-dark");var i="btn-secondary";if(!e||!e.schedules||e.code&&e.code<0)a=t.i18n("transit-eta-route-not-available-short"),s.addClass("list-group-item-light");else if(0===e.schedules.length)a=t.i18n("transit-eta-no-schedules-pending-short"),s.addClass("list-group-item-light");else{var o=e.schedules[0],n=Math.floor((o.time-o.serverTime)/1e3/60),l="";if(l=n>=20?"secondary":n>=15?"info":n>=10?"success":n>=5?"warning":n>=1?"danger":"dark",s.addClass("list-group-item-"+l),void 0!==o.msg)a=o.msg.length>20?t.i18n("transit-eta-transit-notice"):o.msg,i="badge-warning";else void 0!==o.time&&(void 0!==o.msg&&(a+="<br />"),i="badge-primary",n>0?a+=t.i18n("transit-eta-minutes",n):(a+=t.i18n("transit-eta-arrived-left",n),i="badge-dark"),void 0!==o.isLive&&(a+='<br /><span style="font-size: 10px; position: absolute; top: 16px; right: 16px; ',o.isLive?a+='color: red;"><i class="fa fa-circle"></i> '+t.i18n("transit-eta-live")+"</span>":a+='color: black; font-style: italic;">'+t.i18n("transit-eta-scheduled")+"</span>"))}var d=s.children(".transit-eta");d.removeClass("badge-primary"),d.removeClass("badge-secondary"),d.removeClass("badge-warning"),d.removeClass("badge-danger"),d.removeClass("badge-dark"),d.addClass(i),d.html(a)})).catch((function(e,a){var r=t('.nearby-route-list .route-selection[gtw-provider="'+e.provider+'"][gtw-route-id="'+e.routeId+'"][gtw-bound="'+e.selectedPath+'"][gtw-stop-id="'+e.stopId+'"]');r.removeClass("list-group-item-secondary"),r.removeClass("list-group-item-info"),r.removeClass("list-group-item-success"),r.removeClass("list-group-item-warning"),r.removeClass("list-group-item-danger"),r.removeClass("list-group-item-light"),r.removeClass("list-group-item-dark"),r.addClass("list-group-item-light");var s=r.children(".transit-eta");s.removeClass("badge-primary"),s.removeClass("badge-secondary"),s.removeClass("badge-warning"),s.removeClass("badge-danger"),s.removeClass("badge-dark"),s.addClass("badge-danger"),s.html(t.i18n("transit-eta-error-fetching-eta-short"))}))}}function q(){g.a(),v.clearCache(),y.a(l=function(e){var a;if(t(e).hasClass("touch-keypad-function-clear"))P();else if(t(e).hasClass("touch-keypad-function-backspace"))a=t("#search-transit-text").val(),t("#search-transit-text").val(a.slice(0,-1)),K();else if(t(e).hasClass("touch-keypad-value")){var r=t(e).html();a=t("#search-transit-text").val(),t("#search-transit-text").val(a+r),K()}}),w.b(w.a.EVENT_UI_BACK,(function(){I&&y.f(),clearInterval(s)}));var e=m.a(),a=u.getProviders();if(a.length>0){var n='<div class="hori-scroll btn-group">    <button type="button" class="btn btn-primary gtw-providersort gtw-providersort-all"><i class="fa fa-reply-all"></i><br />'+t.i18n("transit-eta-sort-all")+"</button>";for(var d of a){var b="";b=d.type===TransitType.BUS?"fa-bus":d.type===TransitType.TRAIN?"fa-train":"fa-question",n+=' <button type="button" class="btn btn-default gtw-providersort gtw-providersort-provider" gtw-provider="'+d.id+'"><i class="fa '+b+'"></i><br />'+f.localizedKey(d,"name")+"</button>"}n+="</div>",t(".tab-panel").append(n);var C='<div class="input-group mb-3" style="margin-top: 16px;">    <input type="text" class="form-control" placeholder="'+t.i18n("transit-eta-placeholder-search-for-transit")+'" aria-label="'+t.i18n("transit-eta-placeholder-search-for-transit")+'" aria-describedby="search-transit-icon" id="search-transit-text" readonly/>    <div class="input-group-append">        <button class="btn btn-light disabled" type="button" id="button-cancel-search"><i class="fas fa-search"></i></button>    </div></div>';t(".tab-panel").append(C);t(".tab-panel").append('<div class="request-progress-panel">    <div class="progress bg-white">        <div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" style="width: 0%;"></div>    </div></div>'),t(".gtw-providersort").on("click",(function(){if(!t(this).hasClass("btn-primary"))if(t(this).hasClass("gtw-providersort-all"))N();else{t(".gtw-providersort").removeClass("btn-primary");var e=t(this).attr("gtw-provider");t(this).addClass("btn-primary"),t(".gtw-providersort-provider:not([gtw-provider='"+e+"'])").addClass("btn-default"),t(".route-selection[gtw-provider='"+e+"']").attr("style",""),t(".route-selection:not([gtw-provider='"+e+"'])").attr("style","display: none!important")}}));var x=e.lat,B=e.lng,q=h.get("min_nearby_transit_range",200)/1e3,A=p.getAllStopsNearby(x,B,q,!0,!0);if(0===A.length){var M=q;do{M+=.05,A=p.getAllStopsNearby(x,B,M,!0,!0)}while(0===A.length&&M<10);M>=10?t(".tab-panel").append('<div class="alert alert-danger alert-dismissable"><button type="button" class="close" data-dismiss="alert" aria-hidden="true" >&#215;</button>No routes are found in 10 km range.</div>'):t(".tab-panel").append('<div class="alert alert-warning alert-dismissable"><button type="button" class="close" data-dismiss="alert" aria-hidden="true" >&#215;</button>'+t.i18n("transit-eta-no-routes-found-nearby-extended-range",1e3*q,Math.ceil(1e3*M))+"</div>")}var E,j,L,F,R,O=h.get("max_nearby_transit_to_display",20);for(var U of(o=[],A)){if(o.length>=O)break;var V=c.c(U.stop);for(var J of V)o.push({route:J.route,bound:J.bound,stop:U.stop,distance:U.distance})}for(var D of(E='<div class="row item-list nearby-route-list"><ul class="list-group">',o))F=(L=D.route.paths[D.bound])[L.length-1],j=Math.round(1e3*D.distance),R=u.getProvider(D.route.provider),E+='    <li class="list-group-item list-group-item-action d-flex justify-content-between align-items-center route-selection" gtw-provider="'+D.route.provider+'" gtw-route-id="'+D.route.routeId+'" gtw-stop-id="'+D.stop.stopId+'" gtw-bound="'+D.bound+'">        <div class="d-flex flex-column route-id">            <div>'+f.localizedKey(R,"name")+"</div>            <div>"+f.localizedKey(D.route,"routeName")+'</div>        </div>        <div class="d-flex flex-column stop-info mr-auto">            <div>                <b>'+t.i18n("transit-eta-to")+":</b> <small>"+f.localizedKey(p.getStopById(F),"stopName")+"</small></div>            <div>                "+f.localizedKey(D.stop,"stopName")+" ("+j+t.i18n("transit-eta-metres")+')            </div>        </div>        <span class="badge badge-primary badge-pill transit-eta">'+t.i18n("transit-eta-retrieving")+"</span>    </li>";E+='</ul></div><div class="row item-list all-route-list"></div>',t(".content-panel-container").html(E),t(".route-selection").on("mouseenter",T),t(".route-selection").on("mouseleave",(function(){})),t(".route-selection").on("click",S),t("#button-cancel-search").on("click",(function(){t(this).hasClass("disabled")||P()}));t("#search-transit-text").on("click",(function(){t("#search-transit-text").attr("readonly",""),y.f(),t("#button-cancel-search").removeClass("btn-light"),t("#button-cancel-search").removeClass("disabled"),t("#button-cancel-search").addClass("btn-danger"),t("#button-cancel-search").html('<i class="fas fa-times"></i>'),t(".nearby-route-list").css("display","none"),t(".all-route-list").css("display","flex"),k.g(m.a()),k.h(16),k.e(),k.f(),K(),N(),z(".all-route-list")})),t("#search-transit-text").on("input",(function(){clearTimeout(r),r=setTimeout((function(){K()}),500)})),z(".nearby-route-list"),_(),i=setInterval(_,3e4)}else t(".tab-panel").html('<br /><div class="alert alert-danger" role="alert"><i class="fas fa-exclamation-triangle"></i> '+t.i18n("transit-eta-no-plugins-providing-transit-data")+"</div>")}function A(){y.c(l),w.d(w.a.EVENT_UI_BACK,d),clearTimeout(r),clearInterval(i),clearInterval(s),r=!1,i=!1}}.call(this,a(0))}}]);
//# sourceMappingURL=4.b00771a373eb3379f833.js.map
{"version":3,"sources":["webpack:///./src/gtw-map.js","webpack:///./src/gtw-settings.js","webpack:///./src/gtw-db.js","webpack:///./src/gtw-misc.js","webpack:///./src/gtw-pluginloader.js","webpack:///./src/gtw-event.js","webpack:///./src/gtw-citydata-transit-routes.js","webpack:///./src/gtw-citydata-transit-stops.js","webpack:///./src/gtw-citydata-transit-eta.js","webpack:///./src/gtw-ui.js","webpack:///./src/gtw-cors.js","webpack:///./src/gtw-location.js","webpack:///./src/gtw-lang.js","webpack:///./src/gtw-citydata-transit.js","webpack:///./src/gtw-requestlimiter.js","webpack:///./src/gtw-config.js","webpack:///./src/app.js","webpack:///./node_modules/@wikimedia/jquery.i18n/src sync ^\\.\\/.*$","webpack:///./src/style.css?9819","webpack:///./src/style.css","webpack:///./src/timeline.css?025a","webpack:///./src/timeline.css","webpack:///./src/plugins lazy ^\\.\\/.*\\/index\\.js$ namespace object","webpack:///./src lazy ^\\.\\/gtw\\-map\\-.*$ namespace object","webpack:///./src lazy ^\\.\\/gtw\\-ui\\-modal\\-.*$ namespace object","webpack:///./src/ui lazy ^\\.\\/.*\\-header\\.html$ namespace object","webpack:///./src/ui lazy ^\\.\\/.*\\-body\\.html$ namespace object","webpack:///./src/ui lazy ^\\.\\/.*\\-footer\\.html$ namespace object","webpack:///./src lazy ^\\.\\/gtw\\-ui\\-tab\\-.*$ namespace object","webpack:///./src/gtw-log.js"],"names":["map","init","Promise","resolve","reject","mapApi","then","m","setCenter","coords","setZoom","zoom","addMarker","position","options","setMarkerPosition","markerId","lockMarker","removeAllMarkers","addPolyline","strokeColor","strokeWeight","strokeOpacity","geodesic","removeAllPolylines","fitBounds","bounds","SETTINGS_STORAGE_KEY","getDefaultSettings","key","type","name","$","i18n","desc","def","checkfunc","val","locales","languages","found","locale","x","parseInt","Number","isNaN","startsWith","endsWith","json","get","set","load","localStorage","t","getItem","save","j","JSON","parse","setItem","stringify","dbPromise","open","window","console","log","request","indexedDB","onupgradeneeded","event","db","target","result","objectStoreNames","contains","createObjectStore","keyPath","onsuccess","onerror","putPluginStorage","pkg","data","tx","transaction","store","objectStore","clone","Object","assign","put","package","complete","getPluginStorage","getTransitRoutesByProvider","provider","putTransitRoutes","routes","version","error","route","routeId","routeName","etaProviders","paths","length","getTransitStopsByProvider","putTransitStops","stops","stop","stopId","stopName","addr","lat","lng","getTransitReferenceByProvider","putTransitReference","undefined","geoDistance","lat1","lon1","lat2","lon2","p","c","Math","cos","a","asin","sqrt","allProgress","proms","progress_cb","d","all","fillZero","number","similarity","s1","s2","longer","shorter","longerLength","toLowerCase","costs","Array","i","lastValue","newValue","charAt","min","editDistance","parseFloat","plugins","installedPlugins","install","autoSave","plugin","isInstalled","push","uninstall","splice","getPlugin","pc","pluginsStr","warn","installedPlugin","info","status","msg","mod","onload","catch","EVENTS","EVENT_UI_BACK","EVENT_LOCATION_CHANGE","eventListeners","dispatchEvent","args","listener","apply","removeListener","addListener","indexOf","providers","registerProvider","id","fetchDatabase","isDatabaseUpdateNeeded","Error","getRoute","this","getRouteById","getRoutes","unregisterProvider","getProviders","getProvider","fetchAllDatabase","needs","needed","getAllRoutes","allRoutes","concat","getStop","getStopById","getStops","getAllStops","allStops","getAllStopsNearby","range","sorted","distance","sort","b","cache","clearCache","timeDifference","hr","fetchEta","opt","count","providerId","selectedPath","cached","now","Date","lastFetched","scheObj","schedules","sche","serverTime","time","out","getTime","err","values","value","code","getCache","currentTabModule","currentModalModule","keys","cleanUpTab","cleanUpModal","module","enable","showTab","adjustMargin","showPanel","css","removeClass","hidePanel","addClass","showModal","layout","backdrop","keyboard","html","default","modal","loadModalLayout","hideModal","disable","tab","document","ready","on","hasClass","attr","CORS_PROTOCOL","domains","register","domain","allowCors","config","extractHost","url","includes","last","substring","isCors","host","location","before","callback","Cors","Settings","statusText","headers","proxy","index","sindex","ERROR_NOT_SUPPORTED","ERROR_NO_ACCESS","currentPosition","requestLocationAccess","successFunc","errorFunc","navigator","geolocation","getCurrentPosition","latitude","longitude","icon","watchPosition","onPositionChangeSuccess","onPositionChangeError","enableHighAccuracy","timeout","maximumAge","alert","localizedKey","localizedObject","langKey","getLanguage","localeKey","getLocale","enKey","split","changeLanguage","done","first","second","third","getStopIndex","path","searchRoutesOfStop","bound","TransitType","BUS","MINIBUS","TRAM","TRAIN","FERRY","requests","duration","running","queue","func","TypeError","start","dispatch","next","shift","setTimeout","clear","googleMapApiKey","jQuery","req","forEach","addEventListener","serviceWorker","registration","registrationError","__headerTexts","__stopHeaderAnimation","fadeIn","__headerAnimation","fadeOut","resize","nph","each","height","hh","dh","defs","promise","progress","lastVer","errPlugins","pluginKey","append","animate","opacity","webpackContext","webpackContextResolve","__webpack_require__","o","e","exports","content","locals","webpackAsyncContext","ids","maxEntries","logEntries","jsTrace","trace","jsDebug","debug","jsInfo","jsWarn","jsError","printObject","toConsole","level","toLogger","tag","lastMsg","lastTag","lastLevel","lastTime","node","levelName","className","toLocaleString","children","toast","prepend","remove","animation","autohide","delay","showToast","pmsg"],"mappings":"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","file":"app.08fc988c47226dcec18b.js","sourcesContent":["//GTW Map source code\r\n\r\nimport config from './gtw-config';\r\n\r\nexport var map = false;\r\n\r\nexport function init() {\r\n    return new Promise((resolve, reject) => {\r\n        import(\"./gtw-map-\" + config.mapApi).then(function (m) {\r\n            map = m;\r\n            map.init().then(function () {\r\n                resolve();\r\n            });\r\n        });\r\n    });\r\n}\r\n\r\nexport function setCenter(coords) {\r\n    return map.setCenter(coords);\r\n}\r\n\r\nexport function setZoom(zoom) {\r\n    return map.setZoom(zoom);\r\n}\r\n\r\nexport function addMarker(position, options) {\r\n    return map.addMarker(position, options);\r\n}\r\n\r\nexport function setMarkerPosition(markerId, position) {\r\n    return map.setMarkerPosition(markerId, position);\r\n}\r\n\r\nexport function lockMarker(markerId) {\r\n    return map.lockMarker(markerId);\r\n}\r\n\r\nexport function unlockMarker(markerId) {\r\n    return map.unlockMarker(markerId);\r\n}\r\n\r\nexport function removeMarker(markerId) {\r\n    return map.removeMarker(markerId);\r\n}\r\n\r\nexport function removeAllMarkers() {\r\n    return map.removeAllMarkers();\r\n}\r\n\r\nexport function addInfoWindow(markerId, content, open = false) {\r\n    return map.addInfoWindow(markerId, content, open);\r\n}\r\n\r\nexport function addPolyline(coords, strokeColor, strokeWeight, strokeOpacity = 1.0, geodesic = true) {\r\n    return map.addPolyline(coords, strokeColor, strokeWeight, strokeOpacity, geodesic);\r\n}\r\n\r\nexport function lockPolyline(polylineId) {\r\n    return map.lockPolyline(polylineId);\r\n}\r\n\r\nexport function unlockPolyline(polylineId) {\r\n    return map.unlockPolyline(polylineId);\r\n}\r\n\r\nexport function removePolyline(polylineId) {\r\n    return map.removePolyline(polylineId);\r\n}\r\n\r\nexport function removeAllPolylines() {\r\n    return map.removeAllPolylines();\r\n}\r\n\r\nexport function fitBounds(bounds) {\r\n    return map.fitBounds(bounds);\r\n}","//GTW Settings\r\n\r\nconst SETTINGS_STORAGE_KEY = \"gtw-settings\";\r\n\r\nconst VALUE_TYPES = {\r\n    number: \"number\",\r\n    string: \"string\",\r\n    boolean: \"boolean\"\r\n};\r\n\r\nexport function getDefaultSettings() {\r\n    return [\r\n        {\r\n            key: \"preferred_language\",\r\n            type: \"string\",\r\n            name: $.i18n(\"settings-key-preferred-language\"),\r\n            desc: $.i18n(\"settings-key-preferred-language-desc\"),\r\n            def: \"en\",\r\n            checkfunc: function (val) {\r\n                var locales = require(\"./gtw-lang\").languages;\r\n                var found = false;\r\n                for (var locale in locales) {\r\n                    if (locale === val) {\r\n                        found = true;\r\n                        break;\r\n                    }\r\n                }\r\n                return found;\r\n            }\r\n        },\r\n        {\r\n            key: \"show_debug_msg\",\r\n            type: \"boolean\",\r\n            name: $.i18n(\"settings-key-show-debug-msg\"),\r\n            desc: $.i18n(\"settings-key-show-debug-msg-desc\"),\r\n            def: false\r\n        },\r\n        {\r\n            key: \"min_nearby_transit_range\",\r\n            type: \"number\",\r\n            name: $.i18n(\"settings-key-min-nearby-transit-search-range\"),\r\n            desc: $.i18n(\"settings-key-min-nearby-transit-search-range-desc\"),\r\n            def: 200,\r\n            checkfunc: function (val) {\r\n                var x = parseInt(val);\r\n                return !Number.isNaN(x) && x < 10000;\r\n            }\r\n        },\r\n        {\r\n            key: \"max_nearby_transit_to_display\",\r\n            type: \"number\",\r\n            name: $.i18n(\"settings-key-max-nearby-transit-to-be-displayed\"),\r\n            desc: $.i18n(\"settings-key-max-nearby-transit-to-be-displayed-desc\"),\r\n            def: 20,\r\n            checkfunc: function (val) {\r\n                var x = parseInt(val);\r\n                return !Number.isNaN(x) && x < 100;\r\n            }\r\n        },\r\n        {\r\n            key: \"use_cors_proxy\",\r\n            type: \"boolean\",\r\n            name: $.i18n(\"settings-key-use-cors-proxy\"),\r\n            desc: $.i18n(\"settings-key-use-cors-proxy-desc\"),\r\n            def: true\r\n        },\r\n        {\r\n            key: \"cors_proxy_server\",\r\n            type: \"string\",\r\n            name: $.i18n(\"settings-key-cors-proxy-server\"),\r\n            desc: $.i18n(\"settings-key-cors-proxy-server-desc\"),\r\n            def: \"https://cp1.gotowhere.ga/\",\r\n            checkfunc: function (val) {\r\n                return val.startsWith(\"https://\") && val.endsWith(\"/\")\r\n            }\r\n        },\r\n        {\r\n            key: \"cors_check_bypass\",\r\n            type: \"boolean\",\r\n            name: $.i18n(\"settings-key-cors-check-bypass\"),\r\n            desc: $.i18n(\"settings-key-cors-check-bypass-desc\"),\r\n            def: false\r\n        }\r\n    ];\r\n}\r\n\r\nexport var json = {};\r\n\r\nexport function get(key, def = false) {\r\n    var val = json[key];\r\n    if (typeof val === 'undefined') {\r\n        return def;\r\n    }\r\n    return val;\r\n}\r\n\r\nexport function set(key, val) {\r\n    json[key] = val;\r\n    return true;\r\n}\r\n\r\nexport function load() {\r\n    if (!localStorage) {\r\n        return false;\r\n    }\r\n    var t = localStorage.getItem(SETTINGS_STORAGE_KEY);\r\n\r\n    if (!t) {\r\n        return save();\r\n    }\r\n\r\n    var j = JSON.parse(t);\r\n\r\n    if (!j) {\r\n        return false;\r\n    }\r\n\r\n    json = j;\r\n    return true;\r\n}\r\n\r\nexport function save() {\r\n    if (!localStorage) {\r\n        return false;\r\n    }\r\n    localStorage.setItem(SETTINGS_STORAGE_KEY, JSON.stringify(json));\r\n    return true;\r\n}","//GTW Database\r\n\r\nvar dbPromise = false;\r\n\r\nexport function open() {\r\n    return dbPromise = new Promise((resolve, reject) => {\r\n        if (!('indexedDB' in window)) {\r\n            console.log('This browser doesn\\'t support IndexedDB');\r\n            return false;\r\n        }\r\n        var request = indexedDB.open(\"gotowhere-db\", 1);\r\n        request.onupgradeneeded = function (event) {\r\n            var db = event.target.result;\r\n            //Schema v1\r\n            console.log(\"Creating DB schema\");\r\n            if (!db.objectStoreNames.contains(\"transitRoutes\")) {\r\n                db.createObjectStore(\"transitRoutes\", { keyPath: 'provider' });\r\n            }\r\n            if (!db.objectStoreNames.contains(\"transitStops\")) {\r\n                db.createObjectStore(\"transitStops\", { keyPath: 'provider' });\r\n            }\r\n            if (!db.objectStoreNames.contains(\"transitReference\")) {\r\n                db.createObjectStore(\"transitReference\", { keyPath: 'provider' });\r\n            }\r\n            if (!db.objectStoreNames.contains(\"pluginStorage\")) {\r\n                db.createObjectStore(\"pluginStorage\", { keyPath: 'package' });\r\n            }\r\n        };\r\n        request.onsuccess = function (event) {\r\n            resolve(request.result);\r\n        };\r\n        request.onerror = reject;\r\n    });\r\n};\r\n\r\nexport function query(func) {\r\n    if (typeof func === \"function\") {\r\n        return dbPromise.then(func);\r\n    }\r\n};\r\n\r\nexport function putPluginStorage(pkg, data) {\r\n    return dbPromise.then(function (db) {\r\n        var tx = db.transaction(\"pluginStorage\", \"readwrite\");\r\n        var store = tx.objectStore(\"pluginStorage\");\r\n        var clone = Object.assign({}, data);\r\n        store.put({\r\n            package: pkg,\r\n            data: clone\r\n        });\r\n        return tx.complete;\r\n    });\r\n};\r\n\r\nexport function getPluginStorage(pkg) {\r\n    return new Promise((resolve, reject) => {\r\n        dbPromise.then(function (db) {\r\n            var tx = db.transaction(\"pluginStorage\", \"readonly\");\r\n            var store = tx.objectStore(\"pluginStorage\");\r\n            var request = store.get(pkg);\r\n            request.onsuccess = function () {\r\n                resolve(request.result ? request.result.data : false);\r\n            };\r\n            request.onerror = reject;\r\n        });\r\n    });\r\n}\r\n\r\nexport function getTransitRoutesByProvider(provider) {\r\n    return new Promise((resolve, reject) => {\r\n        dbPromise.then(function (db) {\r\n            var tx = db.transaction(\"transitRoutes\", \"readonly\");\r\n            var store = tx.objectStore(\"transitRoutes\");\r\n            var request = store.get(provider);\r\n            request.onsuccess = function () {\r\n                resolve(request.result);\r\n            };\r\n            request.onerror = reject;\r\n        });\r\n    });\r\n}\r\n\r\nexport function putTransitRoutes(db) {\r\n    const { type, provider, routes, version } = db;\r\n    if (!type || !provider || !routes || !version) {\r\n        console.error(\"Error: Invalid routes database structure from \" + (provider ? provider : \"unknown provider\") + \".\");\r\n        return false;\r\n    }\r\n    for (var route of routes) {\r\n        const { type, provider, routeId, routeName, etaProviders, paths } = route;\r\n        if (!type || !provider || !routeId || !routeName || !etaProviders || !paths || !etaProviders.length || !paths.length) {\r\n            console.error(\"Error: Invalid database route structure from \" + (db.provider ? db.provider : \"unknown provider\") + \".\");\r\n            return false;\r\n        }\r\n    }\r\n    var clone = Object.assign({}, db);\r\n    return dbPromise.then(function (db) {\r\n        var tx = db.transaction(\"transitRoutes\", \"readwrite\");\r\n        var store = tx.objectStore(\"transitRoutes\");\r\n        store.put(clone);\r\n        return tx.complete;\r\n    });\r\n}\r\n\r\nexport function getTransitStopsByProvider(provider) {\r\n    return new Promise((resolve, reject) => {\r\n        dbPromise.then(function (db) {\r\n            var tx = db.transaction(\"transitStops\", \"readonly\");\r\n            var store = tx.objectStore(\"transitStops\");\r\n            var request = store.get(provider);\r\n            request.onsuccess = function () {\r\n                resolve(request.result);\r\n            };\r\n            request.onerror = reject;\r\n        });\r\n    });\r\n}\r\n\r\nexport function putTransitStops(db) {\r\n    const { type, provider, stops, version } = db;\r\n    if (!type || !provider || !stops || !version) {\r\n        console.error(\"Error: Invalid stops database structure from \" + (provider ? provider : \"unknown provider\") + \".\");\r\n        return false;\r\n    }\r\n    for (var stop of stops) {\r\n        const { type, provider, stopId, stopName, addr, lat, lng } = stop;\r\n        if (!type || !provider || !stopId || !stopName || !addr || !lat || !lng || typeof lat !== \"number\" || typeof lng !== \"number\") {\r\n            console.error(\"Error: Invalid database stop structure from \" + (db.provider ? db.provider : \"unknown provider\") + \".\");\r\n            return false;\r\n        }\r\n    }\r\n    var clone = Object.assign({}, db);\r\n    return dbPromise.then(function (db) {\r\n        var tx = db.transaction(\"transitStops\", \"readwrite\");\r\n        var store = tx.objectStore(\"transitStops\");\r\n        store.put(clone);\r\n        return tx.complete;\r\n    });\r\n}\r\n\r\nexport function getTransitReferenceByProvider(provider) {\r\n    return new Promise((resolve, reject) => {\r\n        dbPromise.then(function (db) {\r\n            var tx = db.transaction(\"transitReference\", \"readonly\");\r\n            var store = tx.objectStore(\"transitReference\");\r\n            var request = store.get(provider);\r\n            request.onsuccess = function () {\r\n                resolve(request.result);\r\n            };\r\n            request.onerror = reject;\r\n        });\r\n    });\r\n}\r\n\r\nexport function putTransitReference(db) {\r\n    const { type, provider, routes, stops, version } = db;\r\n    if (!type || !provider || !routes || !stops || !version) {\r\n        console.error(\"Error: Invalid reference database structure from \" + (provider ? provider : \"unknown provider\") + \".\");\r\n        return false;\r\n    }\r\n    for (var route of routes) {\r\n        const { type, provider, routeId, routeName, etaProviders, paths } = route;\r\n        if (!type || !provider || !routeId || !routeName || !etaProviders || !paths || !etaProviders.length) { //|| !paths.length) {\r\n            console.error(\"Error: Invalid reference database route structure from \" + (db.provider ? db.provider : \"unknown provider\") + \".\");\r\n            return false;\r\n        }\r\n    }\r\n    for (var stop of stops) {\r\n        const { type, provider, stopId, stopName, addr, lat, lng } = stop;\r\n        if (!type || !provider || !stopId || !stopName || !addr || lat === undefined || lng === undefined || typeof lat !== \"number\" || typeof lng !== \"number\") {\r\n            console.error(\"Error: Invalid reference database stop structure from \" + (db.provider ? db.provider : \"unknown provider\") + \".\");\r\n            return false;\r\n        }\r\n    }\r\n    var clone = Object.assign({}, db);\r\n    return dbPromise.then(function (db) {\r\n        var tx = db.transaction(\"transitReference\", \"readwrite\");\r\n        var store = tx.objectStore(\"transitReference\");\r\n        store.put(clone);\r\n        return tx.complete;\r\n    });\r\n}","//GTW Misc\r\n\r\nexport function geoDistance(lat1, lon1, lat2, lon2) {\r\n    var p = 0.017453292519943295;    // Math.PI / 180\r\n    var c = Math.cos;\r\n    var a = 0.5 - c((lat2 - lat1) * p) / 2 +\r\n        c(lat1 * p) * c(lat2 * p) *\r\n        (1 - c((lon2 - lon1) * p)) / 2;\r\n\r\n    return 12742 * Math.asin(Math.sqrt(a)); // 2 * R; R = 6371 km\r\n}\r\n\r\nexport function allProgress(proms, progress_cb) {\r\n    let d = 0;\r\n    progress_cb(0);\r\n    for (const p of proms) {\r\n        p.then(() => {\r\n            d++;\r\n            progress_cb((d * 100) / proms.length);\r\n        });\r\n    }\r\n    return Promise.all(proms);\r\n}\r\n\r\nexport function isSamePropertyValueInArray(array, name, value) {\r\n    for (var object of array) {\r\n        if (object[name] === value) {\r\n            return true;\r\n        }\r\n    }\r\n    return false;\r\n}\r\n\r\nexport function fillZero(number) {\r\n    return number < 10 ? (\"0\" + number) : number;\r\n}\r\n\r\nexport function similarity(s1, s2) {\r\n    var longer = s1;\r\n    var shorter = s2;\r\n    if (s1.length < s2.length) {\r\n        longer = s2;\r\n        shorter = s1;\r\n    }\r\n    var longerLength = longer.length;\r\n    if (longerLength == 0) {\r\n        return 1.0;\r\n    }\r\n    return (longerLength - editDistance(longer, shorter)) / parseFloat(longerLength);\r\n}\r\n\r\nexport function editDistance(s1, s2) {\r\n    s1 = s1.toLowerCase();\r\n    s2 = s2.toLowerCase();\r\n\r\n    var costs = new Array();\r\n    for (var i = 0; i <= s1.length; i++) {\r\n        var lastValue = i;\r\n        for (var j = 0; j <= s2.length; j++) {\r\n            if (i == 0)\r\n                costs[j] = j;\r\n            else {\r\n                if (j > 0) {\r\n                    var newValue = costs[j - 1];\r\n                    if (s1.charAt(i - 1) != s2.charAt(j - 1))\r\n                        newValue = Math.min(Math.min(newValue, lastValue),\r\n                            costs[j]) + 1;\r\n                    costs[j - 1] = lastValue;\r\n                    lastValue = newValue;\r\n                }\r\n            }\r\n        }\r\n        if (i > 0)\r\n            costs[s2.length] = lastValue;\r\n    }\r\n    return costs[s2.length];\r\n}","// GTW Plugin Loader\r\n\r\nimport * as Misc from './gtw-misc';\r\nimport repos from './plugins/repository.json';\r\n\r\nexport var plugins = {};\r\n\r\nexport var installedPlugins = [];\r\n\r\nexport function install(pkg, autoSave) {\r\n    if (isInstalled(pkg)) {\r\n        return false;\r\n    }\r\n    installedPlugins.push(pkg);\r\n    if (autoSave !== false){\r\n        save();\r\n    }\r\n    return true;\r\n}\r\n\r\nexport function uninstall(pkg, autoSave){\r\n    var i;\r\n    for (i = 0; i < installedPlugins.length; i++){\r\n        if (installedPlugins[i] === pkg){\r\n            installedPlugins.splice(i, 1);\r\n            if (autoSave !== false) {\r\n                save();\r\n            }\r\n            return true;\r\n        }\r\n    }\r\n    return false;\r\n}\r\n\r\nexport function getPlugin(pkg) {\r\n    return plugins[pkg];\r\n}\r\n\r\nexport function isInstalled(pkg) {\r\n    for (var plugin of installedPlugins){\r\n        if (plugin === pkg){\r\n            return true;\r\n        }\r\n    }\r\n    return false;\r\n}\r\n\r\nexport function save() {\r\n    var localStorage = window.localStorage;\r\n    localStorage.setItem(\"gtw-plugins\", JSON.stringify(installedPlugins));\r\n    return true;\r\n}\r\n\r\nexport function load(pc) {\r\n    if (!localStorage){\r\n        console.error(\"Error: LocalStorage is not supported in this browser.\");\r\n        return;\r\n    }\r\n\r\n    var pluginsStr = localStorage.getItem(\"gtw-plugins\");\r\n\r\n    if (pluginsStr) {\r\n        installedPlugins = JSON.parse(pluginsStr);\r\n    }\r\n    \r\n    if (!installedPlugins || typeof installedPlugins.length !== \"number\"){\r\n        console.warn(\"Warning: Installed plugins JSON string is invalid. Resetting as empty.\");\r\n        save();\r\n    }\r\n    \r\n    var p;\r\n    var proms = [];\r\n    for (var installedPlugin of installedPlugins) {\r\n        const info = {\r\n            \"package\": installedPlugin,\r\n            status: 1,\r\n            msg: \"Not Enabled\"\r\n        };\r\n\r\n        if (repos[installedPlugin]){\r\n            proms.push(new Promise((resolve, reject) => {\r\n                import(`./plugins/${installedPlugin}/index.js`).then(function(mod) {\r\n                    var msg;\r\n                    if (!mod) {\r\n                        msg = $.i18n(\"plugin-error-no-module-returned\", pkg);\r\n                        console.error(msg);\r\n                        info.status = -2;\r\n                        info.msg = msg;\r\n                    } else if (!mod.onload || typeof mod.onload !== \"function\") {\r\n                        msg = $.i18n(\"plugin-error-no-onload-function\", pkg);\r\n                        console.error(msg);\r\n                        info.status = -3;\r\n                        info.msg = msg;\r\n                    } else {\r\n                        var promise = new Promise((resolve, reject) => {\r\n                            var status = mod.onload();\r\n                            if (status instanceof Promise) {\r\n                                status.then(resolve).catch(reject);\r\n                            } else {\r\n                                resolve(status);\r\n                            }\r\n                        });\r\n                        promise.then(function (status) {\r\n                            if (status) {\r\n                                info.status = 0;\r\n                                delete info.msg;\r\n                            } else {\r\n                                var msg = $.i18n(\"plugin-error-onload-function-error\", pkg);\r\n                                console.error(msg);\r\n                                info.status = -4;\r\n                                info.msg = msg;\r\n                            }\r\n                            resolve();\r\n                        }).catch(reject);\r\n                    }\r\n                });\r\n            }));\r\n        } else {\r\n            info.status = -1;\r\n            info.msg = \"This plugin is not available in this version of GoToWhere.\";\r\n        }\r\n        plugins[installedPlugin] = info;\r\n    }\r\n    return Misc.allProgress(proms, pc);\r\n}","//GTW Event Manager\r\n\r\nexport const EVENTS = {\r\n    EVENT_UI_BACK: \"EVENT_UI_BACK\",\r\n    EVENT_LOCATION_CHANGE: \"EVENT_LOCATION_CHANGE\"\r\n};\r\n\r\nvar eventListeners = {};\r\n\r\nexport function dispatchEvent(event, ...args) {\r\n    if (!eventListeners[event]) {\r\n        return;\r\n    }\r\n    for (var listener of eventListeners[event]) {\r\n        if (listener) {\r\n            listener.apply(args);\r\n        } else {\r\n            removeListener(listener);\r\n        }\r\n    }\r\n}\r\n\r\nexport function addListener(event, listener) {\r\n    if (!eventListeners[event]) {\r\n        eventListeners[event] = [];\r\n    }\r\n    eventListeners[event].push(listener);\r\n}\r\n\r\nexport function removeListener(event, listener) {\r\n    if (!eventListeners[event]) {\r\n        return;\r\n    }\r\n    var i = eventListeners[event].indexOf(listener);\r\n    if (i === -1) {\r\n        return;\r\n    }\r\n    eventListeners[event].splice(i, 1);\r\n}\r\n\r\nexport function removeAllListeners() {\r\n    eventListeners = {};\r\n}","//City Data: Transit Routes\r\n\r\nimport * as Misc from './gtw-misc';\r\nimport * as Database from './gtw-db';\r\n\r\nvar providers = [];\r\n\r\nexport function registerProvider(type, id, name, provider) {\r\n    if (!provider.fetchDatabase || typeof provider.fetchDatabase !== \"function\" ||\r\n        !provider.isDatabaseUpdateNeeded || typeof provider.isDatabaseUpdateNeeded !== \"function\") {\r\n        throw new Error(\"Error: \" + name + \" does not contain fetchDatabase or isDatabaseUpdateNeeded function!\");\r\n    }\r\n\r\n    provider.type = type;\r\n    provider.id = id;\r\n\r\n    if (typeof name === \"object\") {\r\n        provider[\"name\"] = name[\"default\"];\r\n        for (var key in name) {\r\n            provider[\"name_\" + key] = name[key];\r\n        }\r\n    } else {\r\n        provider.name = name;\r\n    }\r\n\r\n    provider.db = false;\r\n\r\n    provider.getRoute = function (routeId) {\r\n        if (!this.db) {\r\n            return false;\r\n        }\r\n        var i;\r\n        for (i = 0; i < this.db.routes.length; i++) {\r\n            if (this.db.routes[i].routeId === routeId) {\r\n                return this.db.routes[i];\r\n            }\r\n        }\r\n        return false;\r\n    };\r\n\r\n    provider.getRouteById = function (routeId) {\r\n        var routes = this.getRoutes();\r\n        for (var route of routes) {\r\n            if (route.routeId === routeId) {\r\n                return route;\r\n            }\r\n        }\r\n        return false;\r\n    };\r\n\r\n    provider.getRoutes = function () {\r\n        return this.db ? this.db.routes : [];\r\n    };\r\n\r\n    providers.push(provider);\r\n}\r\n\r\nexport function unregisterProvider(id) {\r\n    var found = -1;\r\n    for (var i = 0; i < providers.length; i++) {\r\n        if (providers[i].id === id) {\r\n            found = i;\r\n        }\r\n    }\r\n    providers.splice(found, 1);\r\n}\r\n\r\nexport function getProviders() {\r\n    return providers;\r\n}\r\n\r\nexport function getProvider(id) {\r\n    for (var provider of providers) {\r\n        if (provider.id === id) {\r\n            return provider;\r\n        }\r\n    }\r\n    return false;\r\n}\r\n\r\nexport function fetchAllDatabase(pc) {\r\n    return new Promise((resolve, reject) => {\r\n        var proms = [];\r\n        for (var provider of providers) {\r\n            proms.push(Database.getTransitRoutesByProvider(provider.id).then(function (db) {\r\n                if (!db) {\r\n                    return;\r\n                }\r\n                var TransitRoutes = require(\"./gtw-citydata-transit-routes\");\r\n                var provider = TransitRoutes.getProvider(db.provider);\r\n                if (provider) {\r\n                    provider.db = db;\r\n                }\r\n            }).catch(reject));\r\n        }\r\n        Promise.all(proms).then(function () {\r\n            var needs = {};\r\n            var proms = [];\r\n            var p;\r\n            for (var provider of providers) {\r\n                if (provider.db) {\r\n                    p = new Promise((resolve, reject) => {\r\n                        provider.isDatabaseUpdateNeeded(resolve, reject, provider.db.version);\r\n                    });\r\n                    p.then(function (needed) {\r\n                        needs[provider.id] = needed;\r\n                    }).catch(function () {\r\n                        console.error(\"Error: Database check update for \" + provider.id + \" failed!\");\r\n                        needs[provider.id] = false;\r\n                    });\r\n                    proms.push(p);\r\n                } else {\r\n                    needs[provider.id] = true;\r\n                }\r\n            }\r\n            Promise.all(proms).then(function () {\r\n                var proms = [];\r\n                var p;\r\n                for (var provider of providers) {\r\n                    if (needs[provider.id]) {\r\n                        p = new Promise((resolve, reject) => {\r\n                            provider.fetchDatabase(resolve, reject);\r\n                        });\r\n                        p.then(function (data) {\r\n                            const { type, provider, routes, version } = data;\r\n\r\n                            if (!type || !provider || !routes || !version) {\r\n                                console.error(\"Error: Returned routes database is in wrong structure for \" + (provider ? provider : \"unknown provider\") + \".\");\r\n                                return;\r\n                            }\r\n\r\n                            var db = {\r\n                                type: type,\r\n                                provider: provider,\r\n                                routes: routes,\r\n                                version: version\r\n                            };\r\n\r\n                            var TransitRoutes = require(\"./gtw-citydata-transit-routes\");\r\n                            var providerObj = TransitRoutes.getProvider(data.provider);\r\n                            providerObj.db = db;\r\n\r\n                            return Database.putTransitRoutes(db);\r\n                        });\r\n                        proms.push(p);\r\n                    }\r\n                }\r\n                Misc.allProgress(proms, pc).then(resolve).catch(reject);\r\n            });\r\n        }).catch(reject);\r\n    });\r\n}\r\n\r\nexport function getAllRoutes() {\r\n    var allRoutes = [];\r\n    for (var provider of providers) {\r\n        if (provider) {\r\n            var routes = provider.getRoutes();\r\n            if (routes && routes.length > 0) {\r\n                allRoutes = allRoutes.concat(routes);\r\n            }\r\n        }\r\n    }\r\n    return allRoutes;\r\n}\r\n\r\nexport function getRouteById(routeId) {\r\n    var allRoutes = getAllRoutes();\r\n    var i;\r\n    for (i = 0; i < allRoutes.length; i++) {\r\n        if (routeId === allRoutes[i].routeId) {\r\n            return allRoutes[i];\r\n        }\r\n    }\r\n    return false;\r\n}","//City Data: Transit Stops\r\n\r\nimport * as Misc from './gtw-misc';\r\nimport * as Database from './gtw-db';\r\n\r\nvar providers = [];\r\n\r\nexport function registerProvider(type, id, name, provider) {\r\n    if (!provider.fetchDatabase || typeof provider.fetchDatabase !== \"function\" ||\r\n        !provider.isDatabaseUpdateNeeded || typeof provider.isDatabaseUpdateNeeded !== \"function\") {\r\n        throw new Error(\"Error: \" + name + \" does not contain fetchDatabase or isDatabaseUpdateNeeded function!\");\r\n    }\r\n\r\n    provider.type = type;\r\n    provider.id = id;\r\n\r\n    if (typeof name === \"object\") {\r\n        provider[\"name\"] = name[\"default\"];\r\n        for (var key in name) {\r\n            provider[\"name_\" + key] = name[key];\r\n        }\r\n    } else {\r\n        provider.name = name;\r\n    }\r\n\r\n    provider.db = false;\r\n\r\n    provider.getStop = function (stopId) {\r\n        if (!this.db) {\r\n            return false;\r\n        }\r\n        var i;\r\n        for (i = 0; i < this.db.stops.length; i++) {\r\n            if (this.db.stops[i].stopId === stopId) {\r\n                return this.db.stops[i];\r\n            }\r\n        }\r\n        return false;\r\n    };\r\n\r\n    provider.getStopById = function (stopId) {\r\n        var stops = this.getStops();\r\n        for (var stop of stops) {\r\n            if (stop.stopId === stopId) {\r\n                return stop;\r\n            }\r\n        }\r\n        return false;\r\n    };\r\n\r\n    provider.getStops = function () {\r\n        return this.db ? this.db.stops : [];\r\n    };\r\n    console.log(provider);\r\n    providers.push(provider);\r\n}\r\n\r\nexport function unregisterProvider(id) {\r\n    var found = -1;\r\n    for (var i = 0; i < providers.length; i++) {\r\n        if (providers[i].id === id) {\r\n            found = i;\r\n        }\r\n    }\r\n    providers.splice(found, 1);\r\n}\r\n\r\nexport function getProviders() {\r\n    return providers;\r\n}\r\n\r\nexport function getProvider(id) {\r\n    console.log(\"Finding \" + id);\r\n    for (var provider of providers) {\r\n        console.log(\"Cmoparing \" + id + \" vs \" + provider.id);\r\n        if (provider.id === id) {\r\n            console.log(\"Found\");\r\n            return provider;\r\n        }\r\n    }\r\n    console.log(\"none\");\r\n    return false;\r\n}\r\n\r\nexport function fetchAllDatabase(pc) {\r\n    return new Promise((resolve, reject) => {\r\n        var proms = [];\r\n        for (var provider of providers) {\r\n            proms.push(Database.getTransitStopsByProvider(provider.id).then(function (db) {\r\n                if (!db) {\r\n                    return;\r\n                }\r\n                var TransitStops = require(\"./gtw-citydata-transit-stops\");\r\n                var provider = TransitStops.getProvider(db.provider);\r\n                if (provider) {\r\n                    provider.db = db;\r\n                }\r\n            }).catch(reject));\r\n        }\r\n        Promise.all(proms).then(function () {\r\n            var needs = {};\r\n            var proms = [];\r\n            var p;\r\n            for (var provider of providers) {\r\n                if (provider.db) {\r\n                    p = new Promise((resolve, reject) => {\r\n                        provider.isDatabaseUpdateNeeded(resolve, reject, provider.db.version);\r\n                    });\r\n                    p.then(function (needed) {\r\n                        needs[provider.id] = needed;\r\n                    }).catch(function () {\r\n                        console.error(\"Error: Database check update for \" + provider.id + \" failed!\");\r\n                        needs[provider.id] = false;\r\n                    });\r\n                    proms.push(p);\r\n                } else {\r\n                    needs[provider.id] = true;\r\n                }\r\n            }\r\n            Promise.all(proms).then(function () {\r\n                console.log(needs);\r\n                var proms = [];\r\n                var p;\r\n                for (var provider of providers) {\r\n                    if (needs[provider.id]) {\r\n                        p = new Promise((resolve, reject) => {\r\n                            provider.fetchDatabase(resolve, reject);\r\n                        });\r\n                        p.then(function (data) {\r\n                            const { type, provider, stops, version } = data;\r\n\r\n                            if (!type || !provider || !stops || !version) {\r\n                                console.error(\"Error: Returned stops database is in wrong structure for \" + (provider ? provider : \"unknown provider\") + \".\");\r\n                                return;\r\n                            }\r\n\r\n                            var db = {\r\n                                type: type,\r\n                                provider: provider,\r\n                                stops: stops,\r\n                                version: version\r\n                            };\r\n\r\n                            var TransitStops = require(\"./gtw-citydata-transit-stops\");\r\n                            var providerObj = TransitStops.getProvider(data.provider);\r\n                            providerObj.db = db;\r\n\r\n                            return Database.putTransitStops(db);\r\n                        });\r\n                        proms.push(p);\r\n                    }\r\n                }\r\n                Misc.allProgress(proms, pc).then(resolve).catch(reject);\r\n            });\r\n        }).catch(reject);\r\n    });\r\n}\r\n\r\nexport function getAllStops() {\r\n    var allStops = [];\r\n    for (var provider of providers) {\r\n        if (provider) {\r\n            var stops = provider.getStops();\r\n            if (stops && stops.length > 0) {\r\n                allStops = allStops.concat(stops);\r\n            }\r\n        }\r\n    }\r\n    return allStops;\r\n}\r\n\r\nexport function getAllStopsNearby(lat, lng, range, sorted = true) {\r\n    var allStops = getAllStops();\r\n    var stops = [];\r\n    var stop;\r\n    var d;\r\n    for (var i = 0; i < allStops.length; i++) {\r\n        stop = allStops[i];\r\n        d = Misc.geoDistance(lat, lng, stop.lat, stop.lng);\r\n        if (d <= range) {\r\n            stops.push({\r\n                stop: stop,\r\n                distance: d\r\n            });\r\n        }\r\n    }\r\n\r\n    if (sorted) {\r\n        stops.sort(function (a, b) {\r\n            if (a.distance < b.distance) {\r\n                return -1;\r\n            } else if (a.distance > b.distance) {\r\n                return 1;\r\n            } else {\r\n                return 0;\r\n            }\r\n        });\r\n    }\r\n\r\n    return stops;\r\n}\r\n\r\nexport function getStopById(stopId) {\r\n    var allStops = getAllStops();\r\n    var i;\r\n    for (i = 0; i < allStops.length; i++) {\r\n        if (stopId === allStops[i].stopId) {\r\n            return allStops[i];\r\n        }\r\n    }\r\n    return false;\r\n}","//City Data: Transit ETA\r\nimport * as Misc from './gtw-misc';\r\nimport * as Database from './gtw-db';\r\n\r\nvar providers = [];\r\n\r\nvar cache = {};\r\n\r\nexport function clearCache() {\r\n    cache = {};\r\n}\r\n\r\nexport function timeDifference(a, b) {\r\n    var x = a.hr * 60 + a.min;\r\n    var y = b.hr * 60 + b.min;\r\n    return x - y;\r\n}\r\n\r\nexport function registerProvider(type, id, name, provider) {\r\n    if (!provider.fetchEta || typeof provider.fetchEta !== \"function\" ||\r\n        !provider.fetchDatabase || typeof provider.fetchDatabase !== \"function\" ||\r\n        !provider.isDatabaseUpdateNeeded || typeof provider.isDatabaseUpdateNeeded !== \"function\") {\r\n        throw new Error(\"Error: \" + id + \" does not contain fetchEta, fetchDatabase or isDatabaseUpdateNeeded function!\");\r\n    }\r\n\r\n    provider.type = type;\r\n    provider.id = id;\r\n    provider.db = false;\r\n\r\n    if (typeof name === \"object\") {\r\n        provider[\"name\"] = name[\"default\"];\r\n        for (var key in name) {\r\n            provider[\"name_\" + key] = name[key];\r\n        }\r\n    } else {\r\n        provider.name = name;\r\n    }\r\n\r\n    provider.getRoute = function (routeId) {\r\n        if (!this.db) {\r\n            return false;\r\n        }\r\n        var i;\r\n        for (i = 0; i < this.db.routes.length; i++) {\r\n            if (this.db.routes[i].routeId === routeId) {\r\n                return this.db.routes[i];\r\n            }\r\n        }\r\n        return false;\r\n    };\r\n\r\n    provider.getRouteById = function (routeId) {\r\n        var routes = this.getRoutes();\r\n        for (var route of routes) {\r\n            if (route.routeId === routeId) {\r\n                return route;\r\n            }\r\n        }\r\n        return false;\r\n    };\r\n\r\n    provider.getRoutes = function () {\r\n        return this.db ? this.db.routes : [];\r\n    };\r\n\r\n    provider.getStop = function (stopId) {\r\n        if (!this.db) {\r\n            return false;\r\n        }\r\n        var i;\r\n        for (i = 0; i < this.db.stops.length; i++) {\r\n            if (this.db.stops[i].stopId === stopId) {\r\n                return this.db.stops[i];\r\n            }\r\n        }\r\n        return false;\r\n    };\r\n\r\n    provider.getStopById = function (stopId) {\r\n        var stops = this.getStops();\r\n        for (var stop of stops) {\r\n            if (stop.stopId === stopId) {\r\n                return stop;\r\n            }\r\n        }\r\n        return false;\r\n    };\r\n\r\n    provider.getStops = function () {\r\n        return this.db ? this.db.stops : [];\r\n    };\r\n\r\n    providers.push(provider);\r\n}\r\n\r\nexport function unregisterProvider(id) {\r\n    var found = -1;\r\n    for (var i = 0; i < providers.length; i++) {\r\n        if (providers[i].id === id) {\r\n            found = i;\r\n        }\r\n    }\r\n    providers.splice(found, 1);\r\n}\r\n\r\nexport function getProviders() {\r\n    return providers;\r\n}\r\n\r\nexport function getProvider(id) {\r\n    for (var provider of providers) {\r\n        if (provider.id === id) {\r\n            return provider;\r\n        }\r\n    }\r\n    return false;\r\n}\r\n\r\nexport function fetchAllDatabase(pc) {\r\n    return new Promise((resolve, reject) => {\r\n        var proms = [];\r\n        for (var provider of providers) {\r\n            proms.push(Database.getTransitReferenceByProvider(provider.id).then(function (db) {\r\n                if (!db) {\r\n                    return;\r\n                }\r\n                var TransitEta = require('./gtw-citydata-transit-eta.js');\r\n                var provider = TransitEta.getProvider(db.provider);\r\n                if (provider) {\r\n                    provider.db = db;\r\n                }\r\n            }).catch(reject));\r\n        }\r\n        Promise.all(proms).then(function () {\r\n            var needs = {};\r\n            var proms = [];\r\n            var p;\r\n            for (const provider of providers) {\r\n                if (provider.db) {\r\n                    console.log(\"has db \" + provider.id);\r\n                    p = new Promise((resolve, reject) => {\r\n                        provider.isDatabaseUpdateNeeded(resolve, reject, provider.db.version);\r\n                    });\r\n                    p.then(function (needed) {\r\n                        console.log(\"update: \" + provider.id + \" \" + needed);\r\n                        needs[provider.id] = needed;\r\n                    }).catch(function () {\r\n                        console.error(\"Error: Database check update for \" + provider.id + \" failed!\");\r\n                        needs[provider.id] = false;\r\n                    });\r\n                    proms.push(p);\r\n                } else {\r\n                    console.log(\"No db found for \" + provider.id);\r\n                    needs[provider.id] = true;\r\n                }\r\n            }\r\n            Promise.all(proms).then(function () {\r\n                var proms = [];\r\n                var p;\r\n                console.log(needs);\r\n                for (const provider of providers) {\r\n                    if (needs[provider.id]) {\r\n                        p = new Promise((resolve, reject) => {\r\n                            provider.fetchDatabase(resolve, reject);\r\n                        });\r\n                        p.then(function (data) {\r\n                            const { type, provider, routes, stops, version } = data;\r\n\r\n                            if (!type || !provider || !routes || !stops || !version) {\r\n                                console.error(\"Error: Returned reference database is in wrong structure for \" + (provider ? provider : \"unknown provider\") + \".\");\r\n                                return;\r\n                            }\r\n\r\n                            var db = {\r\n                                type: type,\r\n                                provider: provider,\r\n                                routes: routes,\r\n                                stops: stops,\r\n                                version: version\r\n                            };\r\n\r\n                            var TransitEta = require('./gtw-citydata-transit-eta.js');\r\n                            var providerObj = TransitEta.getProvider(data.provider);\r\n                            providerObj.db = db;\r\n\r\n                            return Database.putTransitReference(db);\r\n                        });\r\n                        proms.push(p);\r\n                    }\r\n                }\r\n                Misc.allProgress(proms, pc).then(resolve).catch(reject);\r\n            });\r\n        }).catch(reject);\r\n    });\r\n}\r\n\r\nexport function fetchEta(opt) {\r\n    return new Promise((resolve, reject) => {\r\n        var proms = [];\r\n        var count = 0;\r\n        for (var providerId of opt.etaProviders) {\r\n            proms.push(new Promise((resolve, reject) => {\r\n                var provider = getProvider(providerId);\r\n\r\n                if (!provider) {\r\n                    resolve();\r\n                    console.log(\"Could not find registered Transit ETA provider with name \\\"\" + providerId + \"\\\"\");\r\n                    return;\r\n                }\r\n\r\n                count++;\r\n\r\n                var key = providerId + \"-\" + opt.routeId + \"-\" + opt.selectedPath + \"-\" + opt.stopId;\r\n                var cached = cache[key];\r\n                var now = new Date();\r\n\r\n                if (cached && (now - cached.lastFetched) > 30000) {\r\n                    cached = false;\r\n                    delete cache[key];\r\n                }\r\n\r\n                if (!cached) {\r\n                    var global = this;\r\n                    var p = new Promise((resolve, reject) => {\r\n                        provider.fetchEta(resolve, reject, opt);\r\n                    });\r\n                    p.then(function (scheObj) {\r\n                        if (!scheObj) {\r\n                            resolve(false);\r\n                            return;\r\n                        }\r\n\r\n                        const { schedules, options } = scheObj;\r\n                        if (!schedules || !options) {\r\n                            console.error(\"Error: Plugin returned a TransitSchedule object with invalid structure.\");\r\n                            reject(opt, \"Invalid TransitSchedule structure\");\r\n                            return;\r\n                        }\r\n\r\n                        for (var sche of schedules) {\r\n                            if (sche.type === undefined || sche.provider === undefined || sche.serverTime === undefined || sche.msg === undefined && sche.time === undefined || isNaN(parseInt(sche.serverTime))) {\r\n                                console.error(\"Error: Plugin returned a TransitSchedule object with invalid schedules.\");\r\n                                reject(opt, \"Invalid TransitSchedule schedules\");\r\n                                return;\r\n                            }\r\n                        }\r\n\r\n                        var time = new Date();\r\n\r\n                        var out = {\r\n                            schedules: schedules,\r\n                            options: options\r\n                        };\r\n\r\n                        cache[key] = {\r\n                            lastFetched: time.getTime(),\r\n                            data: out\r\n                        };\r\n\r\n                        resolve(out);\r\n                    }).catch(function (err) {\r\n                        reject(opt, err);\r\n                    });\r\n                } else {\r\n                    resolve(cached.data);\r\n                }\r\n            }));\r\n        }\r\n        Promise.all(proms).then(function (values) {\r\n            if (count > 0) {\r\n                var schedules = [];\r\n                for (var value of values) {\r\n                    if (value && value.schedules) {\r\n                        schedules = schedules.concat(value.schedules);\r\n                    }\r\n                }\r\n                schedules.sort(function (a, b) {\r\n                    if (!a.time) {\r\n                        return 1;\r\n                    } else if (!b.time) {\r\n                        return -1;\r\n                    }\r\n                    return a.time - b.time;\r\n                });\r\n                resolve({\r\n                    schedules: schedules,\r\n                    options: opt,\r\n                    code: 0\r\n                })\r\n            } else if (opt.etaProviders && opt.etaProviders.length > 0) {\r\n                resolve({\r\n                    code: -2,\r\n                    options: opt\r\n                });\r\n            } else {\r\n                resolve({\r\n                    code: -1,\r\n                    options: opt\r\n                });\r\n            }\r\n        }).catch(reject);\r\n    });\r\n}\r\n\r\nexport function getCache() {\r\n    return cache;\r\n}","//GTW UI\r\n\r\nimport * as Map from './gtw-map';\r\nimport * as PluginLoader from './gtw-pluginloader';\r\nimport * as Loc from './gtw-location';\r\nimport * as Event from './gtw-event';\r\n\r\nvar currentTabModule = false;\r\nvar currentModalModule = false;\r\n\r\n$(document).ready(function () {\r\n    $(\".header-links-plugins\").on(\"click\", function () {\r\n        showModal(\"pluginmanager\");\r\n    });\r\n    $(\".header-links-settings\").on(\"click\", function () {\r\n        showModal(\"settings\");\r\n    });\r\n    $(\".header-links-about\").on(\"click\", function () {\r\n        showModal(\"about\");\r\n    });\r\n    $(\".feedback-btn\").on(\"click\", function () {\r\n        window.open(\"https://forms.gle/tPT6LTKLNzFZwiPy8\");\r\n    });\r\n});\r\n\r\n$(\".ui-tab\").on(\"click\", function () {\r\n    if ($(this).hasClass(\"btn-primary\")) {\r\n        return;\r\n    }\r\n    $(\".ui-tab\").removeClass(\"btn-primary\");\r\n    $(\".ui-tab\").removeClass(\"btn-link\");\r\n\r\n    var tab = $(this).attr(\"gtw-tab\");\r\n    $(this).addClass(\"btn-primary\");\r\n\r\n    $(\".ui-tab:not([gtw-tab='\" + tab + \"'])\").addClass(\"btn-link\");\r\n\r\n    showTab(tab);\r\n});\r\n\r\n$(\".ui-half-map-back-btn\").on(\"click\", function () {\r\n    Event.dispatchEvent(Event.EVENTS.EVENT_UI_BACK);\r\n    Map.setCenter(Loc.getCurrentPosition());\r\n    Map.setZoom(16);\r\n    Map.removeAllMarkers();\r\n    Map.removeAllPolylines();\r\n    showPanel();\r\n});\r\n\r\nexport function init() {\r\n    if (Object.keys(PluginLoader.plugins).length === 0) {\r\n        gettingStarted();\r\n    }\r\n\r\n    showTab(\"transit\");\r\n    adjustMargin();\r\n    showPanel();\r\n}\r\n\r\nexport function showPanel() {\r\n    $(\".content-panel-container\").css(\"display\", \"inline-block\");\r\n    $(\".top-panel\").css(\"display\", \"block\");\r\n    $(\".header nav\").removeClass(\"gtw-half-map\");\r\n\r\n    $(\"body\").removeClass(\"gtw-half-map\");\r\n    $(\"#gtw-map\").removeClass(\"gtw-half-map\");\r\n    $(\".map-overlay\").removeClass(\"gtw-half-map\");\r\n    $(\".half-map-panel\").removeClass(\"gtw-half-map\");\r\n    $(\".half-map-container\").removeClass(\"gtw-half-map\");\r\n\r\n    //$(\".header nav\").addClass(\"bg-dark\");\r\n    //$(\".half-map-panel\").css(\"display\", \"none\");\r\n    //$(\".top-panel\").css(\"display\", \"block\");\r\n    //$(\".half-map-container\").css(\"display\", \"none\");\r\n    //$(\".map-overlay\").fadeIn(500);\r\n    adjustMargin();\r\n}\r\n\r\nexport function hidePanel() {\r\n    $(\".top-panel\").css(\"display\", \"none\");\r\n    $(\".content-panel-container\").css(\"display\", \"none\");\r\n    $(\".header nav\").addClass(\"gtw-half-map\");\r\n\r\n    //$(\"body\").addClass(\"gtw-half-map\");\r\n    $(\"#gtw-map\").addClass(\"gtw-half-map\");\r\n    $(\".map-overlay\").addClass(\"gtw-half-map\");\r\n    $(\".half-map-panel\").addClass(\"gtw-half-map\");\r\n    $(\".half-map-container\").addClass(\"gtw-half-map\");\r\n\r\n    //$(\".half-map-panel\").css(\"display\", \"block\");\r\n    //$(\".half-map-container\").css(\"display\", \"block\");\r\n    //$(\".header nav\").removeClass(\"bg-dark\");\r\n    //$(\".map-overlay\").fadeOut(500);\r\n    adjustMargin();\r\n}\r\n\r\n/*\r\nexport function clearUp() {\r\n    Map.setCenter(Loc.getCurrentPosition());\r\n    Map.setZoom(16);\r\n    Map.removeAllMarkers();\r\n    Map.removeAllPolylines();\r\n\r\n    vars = {};\r\n    for (var key in timers) {\r\n        clearInterval(timers[key]);\r\n    }\r\n    timers = [];\r\n    $(\".tab-panel\").html(\"\");\r\n    $(\".content-panel-container\").html(\"\");\r\n}\r\n\r\nexport function modalClearUp() {\r\n    modalVars = {};\r\n    for (var timer of modalTimers) {\r\n        clearInterval(timer);\r\n    }\r\n}\r\n*/\r\n\r\nexport function showModal(layout, ...args) {\r\n    //nowUi = layout;\r\n    //previousUi = 0;\r\n    cleanUpModal();\r\n    loadModalLayout(layout, true).then(function () {\r\n        $(\".modal\").i18n();\r\n        import(`./gtw-ui-modal-${layout}`).then(function (module) {\r\n            currentModalModule = module;\r\n            module.enable.apply(this, args);\r\n        });\r\n    });\r\n}\r\n\r\nexport function loadModalLayout(layout, options = {}) {\r\n    const key = \"modal-\" + layout;\r\n\r\n    if (options === true) {\r\n        options = {};\r\n        options.backdrop = \"static\";\r\n        options.keyboard = false;\r\n    }\r\n    \r\n    var proms = [];\r\n    proms.push(import(`./ui/${key}-header.html`).then(function (mod) {\r\n        $(\".modal-header\").html(mod.default);\r\n    }));\r\n    proms.push(import(`./ui/${key}-body.html`).then(function (mod) {\r\n        $(\".modal-body\").html(mod.default);\r\n    }));\r\n    proms.push(import(`./ui/${key}-footer.html`).then(function (mod) {\r\n        $(\".modal-footer\").html(mod.default);\r\n    }));\r\n\r\n    var p = Promise.all(proms);\r\n    p.then(function () {\r\n        $(\".modal\").modal(options);\r\n    });\r\n    return p;\r\n}\r\n\r\nexport function hideModal() {\r\n    $(\".modal\").modal(\"hide\");\r\n    cleanUpModal();\r\n}\r\n\r\nexport function isModalShown() {\r\n    return ($(\".modal\").data('bs.modal') || {})._isShown;\r\n}\r\n\r\nexport function cleanUpModal() {\r\n    if (currentModalModule) {\r\n        currentModalModule.disable();\r\n        currentModalModule = false;\r\n    }\r\n}\r\n\r\nexport function cleanUpTab() {\r\n    if (currentTabModule) {\r\n        currentTabModule.disable();\r\n        currentTabModule = false;\r\n    }\r\n}\r\n\r\nexport function showTab(tab) {\r\n    cleanUpTab();\r\n    import(`./gtw-ui-tab-${tab}`).then(function (module) {\r\n        currentTabModule = module;\r\n        module.enable();\r\n    });\r\n}\r\n\r\nexport function gettingStarted() {\r\n    cleanUpTab();\r\n    cleanUpModal();\r\n    import(\"./gtw-ui-gettingstarted\").then(function (module) {\r\n        module.enable();\r\n    });\r\n}\r\n\r\n//\r\n// Available scripts\r\n//\r\n// Modal: updated, pluginclosedapi, errorplugins, viewplugin, pluginmanager, settings\r\n// Tab: transit\r\n//","//GTW CORS Handling\r\n\r\nimport xhook from 'xhook';\r\n\r\nconst CORS_PROTOCOL = \"https://\";\r\n\r\nexport var domains = {};\r\n\r\nexport function register(domain, allowCors = false) {\r\n    var config = {};\r\n    config.allowCors = allowCors;\r\n    domains[domain] = config;\r\n}\r\n\r\nxhook.before(function (request, callback) {\r\n    var Cors = require(\"./gtw-cors\");\r\n    var Settings = require(\"./gtw-settings\");\r\n\r\n    if (Settings.get(\"cors_check_bypass\", false)) {\r\n        callback();\r\n        return;\r\n    }\r\n\r\n    var cors = Cors.isCors(request.url);\r\n\r\n    if (cors) {\r\n        var host = Cors.extractHost(request.url);\r\n\r\n        if (!host || host === \"\" || host === \"___local___\") {\r\n            callback();\r\n            return;\r\n        }\r\n\r\n        var config = Cors.domains[host];\r\n        if (!config) {\r\n            console.error(\"gtw-cors: The request to \\\"\" + host + \"\\\" was dropped, because this cross-domain host was not registered before performing AJAX.\");\r\n            callback({\r\n                status: 403,\r\n                statusText: 'The request is dropped by GoToWhere because this host was not registered before performing AJAX.',\r\n                headers: {}\r\n            });\r\n            return;\r\n        }\r\n\r\n        if (config.allowCors) {\r\n            callback();\r\n            return;\r\n        }\r\n\r\n        if (Settings.get(\"use_cors_proxy\", true)) {\r\n            var proxy = Settings.get(\"cors_proxy_server\", \"https://cp1.gotowhere.ga/\");\r\n            if (proxy.startsWith(\"https://\") && proxy.endsWith(\"/\")) {\r\n                var index = request.url.indexOf(\"http://\");\r\n                var sindex = request.url.indexOf(\"https://\");\r\n                if (index !== -1 && sindex === -1) {\r\n                    request.url = proxy + request.url.substring(index + 7);\r\n                } else if (index === -1 && sindex !== -1) {\r\n                    request.url = proxy + request.url.substring(sindex + 8);\r\n                } else {\r\n                    console.error(\"gtw-cors: Invalid URL: \" + request.url);\r\n                    callback({\r\n                        status: 403,\r\n                        statusText: 'Invalid URL: ' + request.url,\r\n                        headers: {}\r\n                    });\r\n                    return;\r\n                }\r\n            } else {\r\n                console.error(\"gtw-cors: The provided CORS Proxy server is invalid! Please check if the server URL in the settings is correct!\");\r\n                callback({\r\n                    status: 403,\r\n                    statusText: 'The provided CORS Proxy server is invalid! Please check if the server URL in the settings is correct!.',\r\n                    headers: {}\r\n                });\r\n                return;\r\n            }\r\n        } else {\r\n            console.error(\"gtw-cors: The request was dropped because there are no proxy available to handle CORS requests.\");\r\n            callback({\r\n                status: 403,\r\n                statusText: 'The request was dropped because there are no proxy available to handle CORS requests.',\r\n                headers: {}\r\n            });\r\n            return;\r\n        }\r\n    }\r\n\r\n    callback();\r\n});\r\n\r\nexport function extractHost(url) {\r\n    if (!url.includes(\"://\")) {\r\n        return \"___local___\";\r\n    } else if (url.startsWith(\"file://\")) {\r\n        return \"___file___\";\r\n    }\r\n    var i = url.indexOf(\"://\");\r\n    var last = url.substring(i + 3);\r\n\r\n    i = last.indexOf(\"/\");\r\n    if (i === -1) {\r\n        i = last.length();\r\n    }\r\n    return last.substring(0, i);\r\n}\r\n\r\nexport function isCors(url) {\r\n    if (!url.startsWith(CORS_PROTOCOL)) {\r\n        return true;\r\n    }\r\n\r\n    var host = extractHost(url);\r\n\r\n    if (domains[host]) {\r\n        var config = domains[host];\r\n        if (config.allowCors) {\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n\r\n    return window.location.host !== host;\r\n}","//GTW Location Manager\r\n\r\nimport * as Map from './gtw-map';\r\nimport * as Event from './gtw-event';\r\n\r\nconst LOCATION_MANAGER_CONVENTION_KEY = \"openeta-location-convention\";\r\n\r\nconst CONVENTION_ASK_EVERYTIME = \"CONVENTION_ASK_EVERYTIME\";\r\nconst CONVENTION_CUSTOM_LOCATION = \"CONVENTION_CUSTOM_LOCATION\";\r\nconst CONVENTION_ASK_LOCATION_ACCESS = \"CONVENTION_ASK_LOCATION_ACCESS\";\r\nconst CONVENTION_DIRECT_LOCATION_ACCESS = \"CONVENTION_DIRECT_LOCATION_ACCESS\";\r\nconst ERROR_NOT_SUPPORTED = 0;\r\nconst ERROR_NO_ACCESS = 1;\r\n\r\nexport var watchId = 0;\r\n\r\nexport var markerId = 0;\r\n\r\nexport var currentPosition = { lat: 22.2952296, lng: 114.1766577 };\r\n\r\nexport function getConvention() {\r\n    var localStorage = window.localStorage;\r\n    if (!localStorage || !localStorage.getItem(LOCATION_MANAGER_CONVENTION_KEY)) {\r\n        return CONVENTION_ASK_EVERYTIME;\r\n    }\r\n    return localStorage.getItem(LOCATION_MANAGER_CONVENTION_KEY);\r\n}\r\n\r\nexport function setConvention(convention) {\r\n    var localStorage = window.localStorage;\r\n    if (!localStorage) {\r\n        return;\r\n    }\r\n    localStorage.setItem(LOCATION_MANAGER_CONVENTION_KEY, convention);\r\n}\r\n\r\nexport function requestLocationAccess(successFunc = function () { }, errorFunc = function () { }) {\r\n    if (!navigator.geolocation) {\r\n        errorFunc(ERROR_NOT_SUPPORTED);\r\n        return;\r\n    }\r\n\r\n    var global = this;\r\n\r\n    navigator.geolocation.getCurrentPosition(function (position) {\r\n        currentPosition = {\r\n            lat: position.coords.latitude,\r\n            lng: position.coords.longitude\r\n        };\r\n\r\n        Map.setCenter(currentPosition);\r\n        Map.setZoom(16);\r\n\r\n        markerId = Map.addMarker(currentPosition, {\r\n            icon: \"img/star.png\"\r\n        });\r\n        Map.lockMarker(markerId);\r\n\r\n        watchId = navigator.geolocation.watchPosition(\r\n            onPositionChangeSuccess,\r\n            onPositionChangeError,\r\n            {\r\n                enableHighAccuracy: false,\r\n                timeout: 5000,\r\n                maximumAge: 0\r\n            }\r\n        );\r\n        successFunc(currentPosition);\r\n    }, function () {\r\n        errorFunc(ERROR_NO_ACCESS);\r\n    }, { timeout: 5000 });\r\n}\r\n\r\nexport function getCurrentPosition() {\r\n    return currentPosition;\r\n}\r\n\r\nexport function onPositionChangeSuccess(position) {\r\n    currentPosition = {\r\n        lat: position.coords.latitude,\r\n        lng: position.coords.longitude\r\n    };\r\n    Map.setMarkerPosition(markerId, currentPosition);\r\n    Event.dispatchEvent(Event.EVENTS.EVENT_LOCATION_CHANGE, currentPosition);\r\n}\r\n\r\nexport function onPositionChangeError(error) {\r\n    alert(\"TODO: Handle Position error!\");\r\n}","// GTW Language\r\n\r\nimport * as Settings from './gtw-settings';\r\n\r\nexport const languages = {\r\n    \"en\": \"English\",\r\n    \"zh\": \"\\u7e41\\u9ad4\\u4e2d\\u6587\"\r\n};\r\n\r\nexport function localizedKey(localizedObject, key) {\r\n    var lang = getLanguage();\r\n    var locale = getLocale();\r\n\r\n    var langKey = key + \"_\" + lang;\r\n    var localeKey = key + \"_\" + locale;\r\n    var enKey = key + \"_en\";\r\n\r\n    if (localizedObject[langKey]) {\r\n        return localizedObject[langKey];\r\n    }\r\n\r\n    if (localizedObject[localeKey]) {\r\n        return localizedObject[localeKey];\r\n    }\r\n\r\n    if (localizedObject[enKey]) {\r\n        return localizedObject[enKey];\r\n    }\r\n\r\n    if (localizedObject[key]) {\r\n        return localizedObject[key];\r\n    }\r\n\r\n    return false;\r\n}\r\n\r\nexport function getLanguage() {\r\n    return Settings.get(\"preferred_language\", \"en\");\r\n};\r\n\r\nexport function getLocale() {\r\n    return Settings.get(\"preferred_language\", \"en\").split(\"-\")[0];\r\n};\r\n\r\nexport function changeLanguage(locale) {\r\n    var found = false;\r\n    for (var x in languages) {\r\n        if (locale === x) {\r\n            found = true;\r\n            break;\r\n        }\r\n    }\r\n    if (!found) {\r\n        return false;\r\n    }\r\n\r\n    Settings.set(\"preferred_language\", locale);\r\n    Settings.save();\r\n    $.i18n().locale = locale;\r\n    return $.i18n().load(\"i18n/\" + locale + \".json\", locale).done(function () {\r\n        $(\"body\").i18n();\r\n    });\r\n}","//City Data: Transit (Misc functions)\r\nimport * as TransitRoutes from './gtw-citydata-transit-routes';\r\nimport * as TransitStops from './gtw-citydata-transit-stops';\r\nimport * as TransitEta from './gtw-citydata-transit-eta';\r\n\r\nwindow.TransitType = {\r\n    BUS: \"bus\",\r\n    MINIBUS: \"minibus\",\r\n    TRAM: \"tram\",\r\n    TRAIN: \"train\",\r\n    FERRY: \"ferry\"\r\n};\r\n\r\nexport function getAllRoutes() {\r\n    return TransitRoutes.getAllRoutes();\r\n}\r\n\r\nexport function getAllStops() {\r\n    return TransitStops.getAllStops();\r\n}\r\n\r\nexport function fetchAllDatabase (pc) {\r\n    var proms = [];\r\n    var first = 0;\r\n    var second = 0;\r\n    var third = 0;\r\n    proms.push(TransitRoutes.fetchAllDatabase(function (p) {\r\n        first = p;\r\n        pc((first + second + third) / 3);\r\n    }));\r\n    proms.push(TransitStops.fetchAllDatabase(function (p) {\r\n        second = p;\r\n        pc((first + second + third) / 3);\r\n    }));\r\n    proms.push(TransitEta.fetchAllDatabase(function (p) {\r\n        third = p;\r\n        pc((first + second + third) / 3);\r\n    }));\r\n    return Promise.all(proms);\r\n}\r\n\r\nexport function getStopIndex(route, stop, selectedPath) {\r\n    if (selectedPath < 0 || selectedPath >= route.paths.length) {\r\n        return -1;\r\n    }\r\n    var path = route.paths[selectedPath];\r\n    for (var i = 0; i < path.length; i++) {\r\n        var stopId = path[i];\r\n        if (stop.stopId === stopId) {\r\n            return i;\r\n        }\r\n    }\r\n    return -1;\r\n}\r\n\r\nexport function searchRoutesOfStop(stop) {\r\n    var out = [];\r\n\r\n    var allRoutes = getAllRoutes();\r\n    for (var route of allRoutes) {\r\n        var paths = route.paths;\r\n        for (var i = 0; i < paths.length; i++) {\r\n            var path = paths[i];\r\n            for (var stopId of path) {\r\n                if (stop.stopId === stopId) {\r\n                    out.push({\r\n                        route: route,\r\n                        bound: i\r\n                    });\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    return out;\r\n}\r\n\r\nexport function getRoutesOfStop(stop) {\r\n    var result = searchRoutesOfStop(stop);\r\n\r\n    return result.map(function (value, index) {\r\n        return value[0];\r\n    });\r\n}","//GTW Request Limiter\r\n\r\nexport var requests = [];\r\n\r\nexport var duration = 500;\r\n\r\nexport var running = false;\r\n\r\nexport function queue(func, args) {\r\n    if (typeof func !== \"function\") {\r\n        throw new TypeError(\"The variable must be a 'function'.\");\r\n    }\r\n    requests.push([func, args]);\r\n    return func;\r\n}\r\n\r\nexport function stack(func, args) {\r\n    if (typeof func !== \"function\") {\r\n        throw new TypeError(\"The variable must be a 'function'.\");\r\n    }\r\n    requests.unshift([func, args]);\r\n    return func;\r\n}\r\n\r\nexport function start() {\r\n    if (running) {\r\n        return;\r\n    }\r\n\r\n    running = true;\r\n    dispatch();\r\n}\r\n\r\nexport function dispatch() {\r\n    var next = requests.shift();\r\n    var global = this;\r\n\r\n    if (next && typeof next[0] === 'function') {\r\n        next[0].apply(null, next[1]);\r\n    }\r\n\r\n    if (running) {\r\n        setTimeout(function () {\r\n            dispatch();\r\n        }, duration);\r\n    }\r\n}\r\n\r\nexport function stop() {\r\n    running = false;\r\n}\r\n\r\nexport function clear() {\r\n    requests = [];\r\n}","//GTW Platform Configuration\r\n\r\nexport default {\r\n    //\r\n    // Default Map API\r\n    //\r\n    // The map to be used in the UI, you can use:\r\n    //   - auto (Experimental. Prefers Google Map, fallback to Open Street Map)\r\n    //   - googlemap (Recommended)\r\n    //   - openstreetmap\r\n    mapApi: \"googlemap\",\r\n\r\n    //\r\n    // Google Map API Key\r\n    //\r\n    // You have to create an API key from the Google Cloud Console to\r\n    // use Google Map features. The default one only works on the\r\n    // official server.\r\n    googleMapApiKey: \"AIzaSyAhU7FqH46IdF4RaHrBlABfkoFlHZeudFg\"\r\n};","// GoToWhere startup script\r\n\r\nimport $ from 'jquery';\r\nwindow.jQuery = $;\r\nwindow.$ = $;\r\n\r\nvar req = require.context(\"@wikimedia/jquery.i18n/src\");\r\n\r\nvar files = [\"js\", \"messagestore\", \"fallbacks\", \"parser\", \"emitter\", \"language\"];\r\nfiles.forEach(function (module) {\r\n    req(\"./jquery.i18n.\" + module);\r\n});\r\n\r\nimport 'bootstrap';\r\nimport 'bootstrap/dist/css/bootstrap.min.css';\r\nimport './style.css';\r\nimport './timeline.css';\r\n\r\nimport 'smartwizard';\r\nimport 'smartwizard/dist/css/smart_wizard.css';\r\n\r\nimport '@fortawesome/fontawesome-free/js/fontawesome';\r\nimport '@fortawesome/fontawesome-free/js/solid';\r\nimport '@fortawesome/fontawesome-free/js/regular';\r\nimport '@fortawesome/fontawesome-free/js/brands';\r\n\r\nif ('serviceWorker' in navigator) {\r\n    window.addEventListener('load', () => {\r\n        navigator.serviceWorker.register('/service-worker.js').then(registration => {\r\n            console.log('SW registered: ', registration);\r\n        }).catch(registrationError => {\r\n            console.log('SW registration failed: ', registrationError);\r\n        });\r\n    });\r\n}\r\n\r\nvar __headerTexts = [\"<i class=\\\"fas fa-map-marked-alt\\\"></i> \\u53bb\\u908a\\u35ce GoToWhere\", \"<i class=\\\"fas fa-map-marked-alt\\\"></i> GoToWhere<small>.ga</small>\", \"<i class=\\\"fas fa-map-marked-alt\\\"></i> HeuiBin<small>.ga</small>\"];\r\nvar __stopHeaderAnimation = false;\r\n\r\nfunction __headerAnimation(i) {\r\n    if (__stopHeaderAnimation) {\r\n        return;\r\n    }\r\n\r\n    if (i === undefined || i > 2) {\r\n        i = 0;\r\n    }\r\n    $(\".startup h1\").html(__headerTexts[i]);\r\n    $(\".startup h1\").fadeIn(2000, function () {\r\n        $(\".startup h1\").fadeOut(2000, function () {\r\n            __headerAnimation(i + 1);\r\n        });\r\n    });\r\n}\r\n\r\n$(document).ready(function () {\r\n    adjustMargin();\r\n    $(\".startup .progress-panel\").fadeIn(5000);\r\n    $(\".startup .container\").fadeIn(2000, function () {\r\n        __headerAnimation();\r\n    });\r\n    console.log(\"GoToWhere (c) 2019. Licensed under the MIT License.\");\r\n    $(\"#startup-status\").html(\"Loading GoToWhere scripts...\");\r\n});\r\n\r\n$(window).resize(function () {\r\n    adjustMargin();\r\n});\r\n\r\nwindow.adjustMargin = function () {\r\n    var nph = 0;\r\n    $(\".numeric-keypad .btn-group\").each(function () {\r\n        nph += $(this).height();\r\n    });\r\n    $(\".letter-keypad\").css(\"height\", nph);\r\n\r\n    var hh = $(\".header\").height();\r\n    var dh = $(window).height();\r\n    $(\".desktop.half-map-container\").css(\"height\", dh - hh);\r\n    $(\".content-panel-container\").css(\"height\", dh - hh - nph);\r\n};\r\n\r\n/*\r\nrequirejs.config({\r\n    baseUrl: 'js/lib',\r\n    paths: {\r\n        \"xhook\": \"../xhook.min\",\r\n        \"crypto-js\": \"../../vendor/crypto-js-3.1.9-1/crypto-js\",\r\n        \"proj4\": \"../../vendor/proj4js-2.5.0/dist/proj4\"\r\n    }\r\n});\r\n*/\r\n\r\nimport * as Cors from './gtw-cors';\r\nimport * as PluginLoader from './gtw-pluginloader';\r\nimport * as Transit from './gtw-citydata-transit';\r\nimport * as TransitEta from './gtw-citydata-transit-eta';\r\nimport * as Map from './gtw-map';\r\nimport * as loc from './gtw-location';\r\nimport * as ui from './gtw-ui';\r\nimport * as settings from './gtw-settings';\r\nimport * as RequestLimiter from './gtw-requestlimiter';\r\nimport * as log from './gtw-log';\r\nimport * as lang from './gtw-lang';\r\nimport * as Database from './gtw-db';\r\nimport proj4 from 'proj4';\r\n\r\n$(\".build-version\").html(VERSION);\r\n\r\nproj4.defs(\"EPSG:2326\", \"+proj=tmerc +lat_0=22.31213333333334 +lon_0=114.1785555555556 +k=1 +x_0=836694.05 +y_0=819069.8 +ellps=intl +towgs84=-162.619,-276.959,-161.764,0.067753,-2.24365,-1.15883,-1.09425 +units=m +no_defs\");\r\nproj4.defs(\"EPSG:4326\", \"+proj=longlat +datum=WGS84 +no_defs\");\r\n\r\nsettings.load();\r\n\r\nlang.changeLanguage(settings.get(\"preferred_language\", \"en\"));\r\n\r\nRequestLimiter.start();\r\n\r\nCors.register(\"www.gotowhere.ga\", true);\r\nCors.register(\"plugins.gotowhere.ga\", true);\r\n\r\n$(\"#startup-status\").html($.i18n(\"startup-status-downloading-plugins\"));\r\n\r\n$(\"#startup-progress\").css(\"width\", \"12.5%\");\r\n$(\"#startup-status\").html($.i18n(\"startup-status-open-db\"));\r\nvar promise = Database.open();\r\n\r\nif (!promise) {\r\n    $(\"#startup-status\").attr(\"style\", \"color: red\");\r\n    $(\"#startup-status\").html($.i18n(\"startup-status-not-supported\"));\r\n} else {\r\n    promise.then(function () {\r\n        $(\"#startup-progress\").css(\"width\", \"25%\");\r\n        $(\"#startup-status\").html($.i18n(\"startup-status-loading-plugins\"));\r\n        promise = PluginLoader.load(function (progress) {\r\n            $(\"#startup-progress\").css(\"width\", 25 + (progress / 8) + \"%\");\r\n        });\r\n        promise.then(function () {\r\n            $(\"#startup-status\").html($.i18n(\"startup-status-init-db\"));\r\n            promise = Transit.fetchAllDatabase(function (progress) {\r\n                $(\"#startup-progress\").css(\"width\", (25 + progress / 4 * 3) + \"%\");\r\n            });\r\n            promise.then(function () {\r\n                $(\"#startup-progress\").css(\"width\", \"100%\");\r\n                $(\"#startup-status\").html($.i18n(\"startup-status-init-map\"));\r\n                promise = Map.init();\r\n                promise.then(function () {\r\n                    $(\"#startup-status\").html($.i18n(\"startup-status-finish\"));\r\n                    $(\".build-version\").fadeOut(2000);\r\n\r\n                    var lastVer = localStorage.getItem(\"gtw-lastversion\");\r\n                    if (lastVer && lastVer !== VERSION) {\r\n                        console.log(\"Application updated to \" + VERSION + \". Showing change-log.\");\r\n                        ui.showModal(\"updated\", VERSION);\r\n                    }\r\n                    localStorage.setItem(\"gtw-lastversion\", VERSION);\r\n\r\n                    //ui.init();\r\n\r\n                    //TransitManager.start();\r\n                    //TransitManager.forceUpdate();\r\n\r\n                    var errPlugins = [];\r\n                    var plugin;\r\n                    for (var pluginKey in PluginLoader.plugins) {\r\n                        plugin = PluginLoader.plugins[pluginKey];\r\n                        if (plugin.status < 0) {\r\n                            errPlugins.push(plugin);\r\n                        }\r\n                    }\r\n                    console.log(errPlugins);\r\n\r\n                    if (errPlugins.length) {\r\n                        ui.showModal(\"errorplugins\", errPlugins);\r\n                    }\r\n\r\n                    loc.requestLocationAccess(function () {\r\n                        ui.init();\r\n                        //TransitManager.forceUpdate();\r\n                        $(\"#loc-status-btn\").addClass(\"btn-success\");\r\n                        $(\"#loc-status-btn\").removeClass(\"btn-warning\");\r\n                        setTimeout(function () {\r\n                            $(\"#loc-status-btn\").fadeOut(500);\r\n                        }, 2000);\r\n                    }, function () {\r\n                        $(\"#loc-status-btn\").addClass(\"btn-danger\");\r\n                        $(\"#loc-status-btn\").removeClass(\"btn-warning\");\r\n                        $(\"#loc-status-btn\").append(\" <span>Failed!</span>\");\r\n                        setTimeout(function () {\r\n                            $(\"#loc-status-btn span\").fadeOut(500);\r\n                        }, 5000);\r\n                    });\r\n\r\n                    setTimeout(function () {\r\n                        $(\".footer\").animate({ height: 0, opacity: 0 }, 1000, function () {\r\n                            $(\".footer\").css(\"display\", \"none\");\r\n                        });\r\n                    }, 2000);\r\n                    $(\".startup\").fadeOut(1000, function () {\r\n                        __stopHeaderAnimation = true;\r\n                    });\r\n                });\r\n            });\r\n        });\r\n    });\r\n}","var map = {\n\t\"./jquery.i18n\": 21,\n\t\"./jquery.i18n.emitter\": 22,\n\t\"./jquery.i18n.emitter.bidi\": 23,\n\t\"./jquery.i18n.emitter.bidi.js\": 23,\n\t\"./jquery.i18n.emitter.js\": 22,\n\t\"./jquery.i18n.fallbacks\": 24,\n\t\"./jquery.i18n.fallbacks.js\": 24,\n\t\"./jquery.i18n.js\": 21,\n\t\"./jquery.i18n.language\": 25,\n\t\"./jquery.i18n.language.js\": 25,\n\t\"./jquery.i18n.messagestore\": 26,\n\t\"./jquery.i18n.messagestore.js\": 26,\n\t\"./jquery.i18n.parser\": 27,\n\t\"./jquery.i18n.parser.js\": 27,\n\t\"./languages/bs\": 28,\n\t\"./languages/bs.js\": 28,\n\t\"./languages/dsb\": 29,\n\t\"./languages/dsb.js\": 29,\n\t\"./languages/fi\": 30,\n\t\"./languages/fi.js\": 30,\n\t\"./languages/ga\": 31,\n\t\"./languages/ga.js\": 31,\n\t\"./languages/he\": 32,\n\t\"./languages/he.js\": 32,\n\t\"./languages/hsb\": 33,\n\t\"./languages/hsb.js\": 33,\n\t\"./languages/hu\": 34,\n\t\"./languages/hu.js\": 34,\n\t\"./languages/hy\": 35,\n\t\"./languages/hy.js\": 35,\n\t\"./languages/la\": 36,\n\t\"./languages/la.js\": 36,\n\t\"./languages/ml\": 37,\n\t\"./languages/ml.js\": 37,\n\t\"./languages/os\": 38,\n\t\"./languages/os.js\": 38,\n\t\"./languages/ru\": 39,\n\t\"./languages/ru.js\": 39,\n\t\"./languages/sl\": 40,\n\t\"./languages/sl.js\": 40,\n\t\"./languages/uk\": 41,\n\t\"./languages/uk.js\": 41\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 55;","var content = require(\"!!../node_modules/css-loader/dist/cjs.js!./style.css\");\n\nif (typeof content === 'string') {\n  content = [[module.id, content, '']];\n}\n\nvar options = {}\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = require(\"!../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\")(content, options);\n\nif (content.locals) {\n  module.exports = content.locals;\n}\n","exports = module.exports = require(\"../node_modules/css-loader/dist/runtime/api.js\")(false);\n// Module\nexports.push([module.id, \"body {\\r\\n    width: 100%;\\r\\n    height: 100vh;\\r\\n    overflow: hidden;\\r\\n    position: absolute;\\r\\n}\\r\\n\\r\\n.landscape-notice {\\r\\n    display: none;\\r\\n    width: 100%;\\r\\n    height: 100%;\\r\\n    background-color: white;\\r\\n    z-index: 5;\\r\\n    position: relative;\\r\\n    padding: 12%;\\r\\n    font-weight: bold;\\r\\n}\\r\\n\\r\\n/* Update Change-log */\\r\\n\\r\\n.build-version {\\r\\n    position: absolute;\\r\\n    top: 0;\\r\\n    right: 0;\\r\\n    margin: 1rem;\\r\\n    z-index: 5;\\r\\n    margin-top: env(safe-area-inset-top);\\r\\n}\\r\\n\\r\\n#updated-changelog {\\r\\n    white-space: normal;\\r\\n}\\r\\n\\r\\n/* Toast */\\r\\n\\r\\n.toast-stack-container {\\r\\n    position: absolute;\\r\\n    top: 0;\\r\\n    right: 0;\\r\\n    width: 100%;\\r\\n}\\r\\n\\r\\n#gtw-toast-stack {\\r\\n    position: absolute;\\r\\n    top: 0;\\r\\n    right: 0;\\r\\n    margin: 1rem;\\r\\n    z-index: 3;\\r\\n}\\r\\n\\r\\n/* Startup DIV CSS */\\r\\n\\r\\n.startup {\\r\\n    position: absolute;\\r\\n    top: 0;\\r\\n    background-color: white;\\r\\n    width: 100%;\\r\\n    height: 100%;\\r\\n    overflow: hidden;\\r\\n    z-index: 4;\\r\\n}\\r\\n\\r\\n.startup .container {\\r\\n    display: none;\\r\\n    position: relative;\\r\\n}\\r\\n\\r\\n.startup .progress-panel {\\r\\n    position: absolute;\\r\\n    text-align: center;\\r\\n    width: 100%;\\r\\n    bottom: 0px;\\r\\n}\\r\\n\\r\\n.request-progress-panel {\\r\\n    position: absolute;\\r\\n    text-align: center;\\r\\n    width: 100%;\\r\\n    left: 0px;\\r\\n    bottom: 0px;\\r\\n    display: none;\\r\\n}\\r\\n\\r\\n.startup .overlay {\\r\\n    position: absolute;\\r\\n    top: 0;\\r\\n    height: 100%;\\r\\n    width: 100%;\\r\\n    background-color: white;\\r\\n    opacity: 0.5;\\r\\n    z-index: 1;\\r\\n}\\r\\n\\r\\n.startup .progress-panel {\\r\\n    display: none;\\r\\n}\\r\\n\\r\\n/* Getting Started Panel */\\r\\n.getting-started-panel {\\r\\n    display: none;\\r\\n    padding: 1rem;\\r\\n    position: absolute;\\r\\n    z-index: 1;\\r\\n    width: 100%;\\r\\n    height: 100%;\\r\\n}\\r\\n\\r\\n.getting-started-panel p.app-title {\\r\\n    margin-top: 0.8125rem;\\r\\n    margin-left: 1rem;\\r\\n    margin-bottom: 0.8125rem;\\r\\n    white-space: nowrap;\\r\\n    line-height: inherit;\\r\\n    font-size: 1.25rem;\\r\\n}\\r\\n\\r\\n#gettingStartedWizard {\\r\\n    margin-top: 2rem;\\r\\n    background-color: white;\\r\\n    padding: 1rem;\\r\\n    width: 100%;\\r\\n}\\r\\n\\r\\n#gettingStartedWizard ul {\\r\\n    flex-wrap: nowrap;\\r\\n    overflow-x: auto;\\r\\n    overflow-y: hidden;\\r\\n}\\r\\n\\r\\n.getting-started-progress-panel {\\r\\n    display: none;\\r\\n}\\r\\n\\r\\n.getting-started-progress-panel .progress-panel {\\r\\n    text-align: center;\\r\\n}\\r\\n\\r\\n.getting-started-plugin-error-panel{\\r\\n    display: none;\\r\\n}\\r\\n\\r\\n/* ETA CSS */\\r\\n.bg-trans {\\r\\n    background-color: unset;\\r\\n}\\r\\n\\r\\n.half-map-container {\\r\\n    display: none;\\r\\n    width: 100%;\\r\\n    position: absolute;\\r\\n    overflow-x: hidden;\\r\\n    overflow-y: scroll;\\r\\n    z-index: 2;\\r\\n}\\r\\n\\r\\n.container {\\r\\n    padding: 0px;\\r\\n}\\r\\n\\r\\n.content-panel-container {\\r\\n\\r\\n}\\r\\n\\r\\n.item-list {\\r\\n    height: inherit;\\r\\n}\\r\\n\\r\\n.item-list .list-group {\\r\\n    width: 100%;\\r\\n    height: inherit;\\r\\n    overflow-x: hidden;\\r\\n    overflow-y: scroll;\\r\\n    z-index: 1;\\r\\n}\\r\\n\\r\\n.item-list .list-group li {\\r\\n    min-height: 100px;\\r\\n}\\r\\n\\r\\n.all-route-list {\\r\\n    display: none;\\r\\n}\\r\\n\\r\\n.stop-eta tr.active {\\r\\n    font-size: 18px;\\r\\n    font-weight: bold;\\r\\n}\\r\\n\\r\\n/* Map CSS */\\r\\n\\r\\n#gtw-map {\\r\\n    width: 100vw;\\r\\n    height: 100vh;\\r\\n    top: 0px;\\r\\n    left: 0px;\\r\\n    position: fixed;\\r\\n    overflow: hidden;\\r\\n}\\r\\n\\r\\n/* Search panel CSS */\\r\\n\\r\\n.top-panel {\\r\\n    padding: 8px;\\r\\n    margin-bottom: 0px;\\r\\n    background-color: unset;\\r\\n}\\r\\n\\r\\n.top-panel .tabs, .hori-scroll {\\r\\n    overflow: auto;\\r\\n    white-space: nowrap;\\r\\n    display: block;\\r\\n    padding: 4px;\\r\\n}\\r\\n\\r\\n.top-panel .tabs .ui-tab, .hori-scroll button {\\r\\n    display: inline-block;\\r\\n}\\r\\n\\r\\n#loc-status-btn {\\r\\n    margin-top: env(safe-area-inset-top);\\r\\n    margin-bottom: env(safe-area-inset-bottom);\\r\\n    position: fixed;\\r\\n    z-index: 3;\\r\\n    right: 4px;\\r\\n    bottom: 4px;\\r\\n}\\r\\n\\r\\n/* Header, footer CSS */\\r\\n\\r\\n.gtw-container {\\r\\n    position: fixed;\\r\\n    top: 0;\\r\\n    width: 100%;\\r\\n    z-index: 1;\\r\\n}\\r\\n\\r\\n/*\\r\\n.header nav {\\r\\n    background-color: #343a40\\r\\n}\\r\\n*/\\r\\n\\r\\n.footer {\\r\\n    padding-top: 8px;\\r\\n    padding-bottom: 0px;\\r\\n    position: fixed;\\r\\n    bottom: 0;\\r\\n    z-index: 2;\\r\\n    width: 100%;\\r\\n}\\r\\n\\r\\n.map-overlay {\\r\\n    position: fixed;\\r\\n    width: 100%;\\r\\n    height: 100%;\\r\\n    top: 0;\\r\\n    left: 0;\\r\\n    right: 0;\\r\\n    bottom: 0;\\r\\n    background-color: rgba(233,236,239,0.8);\\r\\n    z-index: 1;\\r\\n    cursor: pointer;\\r\\n}\\r\\n\\r\\n/* Loading Overlay CSS */\\r\\n\\r\\n.loading-overlay {\\r\\n    position: fixed;\\r\\n    display: none;\\r\\n    width: 100%;\\r\\n    height: 100%;\\r\\n    top: 0;\\r\\n    left: 0;\\r\\n    right: 0;\\r\\n    bottom: 0;\\r\\n    background-color: rgba(0,0,0,0.3);\\r\\n    z-index: 3;\\r\\n    opacity: 100;\\r\\n    cursor: pointer;\\r\\n}\\r\\n\\r\\n.loading-overlay .spinner-border {\\r\\n    width: 3rem;\\r\\n    height: 3rem;\\r\\n}\\r\\n\\r\\n/* Touch Keypad */\\r\\n\\r\\n.touch-keypad {\\r\\n    position: fixed;\\r\\n    left: 0;\\r\\n    bottom: 0;\\r\\n    width: 100%;\\r\\n    margin: 0px;\\r\\n    padding: 0px;\\r\\n    z-index: 2;\\r\\n    background: white;\\r\\n    display: none;\\r\\n    padding-bottom: env(safe-area-inset-bottom);\\r\\n}\\r\\n\\r\\n.touch-keypad .numeric-keypad {\\r\\n    width: 75%;\\r\\n}\\r\\n\\r\\n.touch-keypad .letter-keypad {\\r\\n    width: 25%;\\r\\n    overflow-x: hidden;\\r\\n    overflow-y: auto;\\r\\n    white-space: nowrap;\\r\\n    justify-content: flex-start;\\r\\n}\\r\\n\\r\\n.touch-keypad-key {\\r\\n    min-height: 58px;\\r\\n}\\r\\n\\r\\n/* Route selection */\\r\\n\\r\\n.route-selection .route-id {\\r\\n    padding-right: 16px;\\r\\n    font-weight: bold;\\r\\n}\\r\\n\\r\\n.route-selection .stop-info {\\r\\n    margin-left: 8px;\\r\\n    margin-right: 8px;\\r\\n}\\r\\n\\r\\n.route-selection .stop-info .badge {\\r\\n\\r\\n}\\r\\n\\r\\n.route-selection .stop-info .col-sm-12{\\r\\n    white-space: nowrap;\\r\\n    overflow: hidden;\\r\\n    text-overflow: ellipsis; \\r\\n    width: inherit;\\r\\n}\\r\\n\\r\\n/* Search Transit Field */\\r\\n\\r\\n#search-transit-text {\\r\\n    background-color: #fff;\\r\\n}\\r\\n\\r\\n/* Half-map Panel */\\r\\n.half-map-panel {\\r\\n    display: none;\\r\\n    background-color: unset;\\r\\n    padding: 8px;\\r\\n    margin-bottom: 0px;\\r\\n    position: relative;\\r\\n    z-index: 1;\\r\\n}\\r\\n\\r\\n/* Media Query */\\r\\n@media only screen and (min-width: 768px) {\\r\\n    .top-panel {\\r\\n        /*width: 25%;*/\\r\\n    }\\r\\n\\r\\n    .half-map-panel {\\r\\n        /*width: 25%;*/\\r\\n    }\\r\\n\\r\\n    .half-map-container {\\r\\n        /*width: 25%;*/\\r\\n        margin-left: 0;\\r\\n    }\\r\\n\\r\\n    .content-panel-container {\\r\\n        /*width: 25%;*/\\r\\n        margin-left: 0;\\r\\n    }\\r\\n\\r\\n    .request-progress-panel {\\r\\n        width: 25%;\\r\\n    }\\r\\n\\r\\n    #gtw-map {\\r\\n        width: 100vw;\\r\\n        /*width: 75%;\\r\\n        margin-left: 25%;*/\\r\\n    }\\r\\n\\r\\n    .gtw-container {\\r\\n        width: 25%;\\r\\n    }\\r\\n\\r\\n    .map-overlay {\\r\\n        width: 25%;\\r\\n        /*display: none;*/\\r\\n    }\\r\\n    \\r\\n    .touch-keypad {\\r\\n        width: 25%;\\r\\n    }\\r\\n\\r\\n    .getting-started-panel {\\r\\n        /*width: 25%;*/\\r\\n    }\\r\\n\\r\\n    .desktop.half-map-panel.gtw-half-map {\\r\\n        display: block;\\r\\n    }\\r\\n\\r\\n    .desktop.half-map-container.gtw-half-map {\\r\\n        display: block;\\r\\n    }\\r\\n\\r\\n    .mobile.half-map-panel.gtw-half-map {\\r\\n        display: none;\\r\\n    }\\r\\n\\r\\n    .mobile.half-map-container.gtw-half-map {\\r\\n        display: none;\\r\\n    }\\r\\n}\\r\\n\\r\\n@media only screen and (max-width: 768px) {\\r\\n    .gtw-container nav {\\r\\n        margin-top: env(safe-area-inset-top);\\r\\n        background-color: unset;\\r\\n    }\\r\\n\\r\\n    .toast-stack-container {\\r\\n        margin-top: env(safe-area-inset-top);\\r\\n        margin-bottom: env(safe-area-inset-bottom);\\r\\n    }\\r\\n\\r\\n    .getting-started-panel {\\r\\n        margin-top: env(safe-area-inset-top);\\r\\n        margin-bottom: env(safe-area-inset-bottom);\\r\\n    }\\r\\n\\r\\n    .modal {\\r\\n        margin-top: env(safe-area-inset-top);\\r\\n        margin-bottom: env(safe-area-inset-bottom);\\r\\n    }\\r\\n\\r\\n    .mobile-split-container {\\r\\n        margin-top: 50vh;\\r\\n        padding: 0px;\\r\\n    }\\r\\n\\r\\n    .startup .progress-panel {\\r\\n        margin-bottom: env(safe-area-inset-bottom);\\r\\n    }\\r\\n\\r\\n    /*\\r\\n    body.gtw-half-map {\\r\\n        overflow-y: scroll;\\r\\n    }\\r\\n\\r\\n    #gtw-map {\\r\\n        display: none;\\r\\n    }\\r\\n    */\\r\\n\\r\\n    .map-overlay.gtw-half-map {\\r\\n        /*display: none;*/\\r\\n        margin-top: 50vh;\\r\\n        height: 50vh;\\r\\n    }\\r\\n\\r\\n    /*\\r\\n    #gtw-map.gtw-half-map {\\r\\n        height: 50vh;\\r\\n        display: block;\\r\\n    }\\r\\n    */\\r\\n\\r\\n    .desktop.half-map-panel.gtw-half-map {\\r\\n        display: none;\\r\\n    }\\r\\n\\r\\n    .desktop.half-map-container.gtw-half-map {\\r\\n        display: none;\\r\\n    }\\r\\n\\r\\n    .mobile.half-map-panel.gtw-half-map {\\r\\n        display: block;\\r\\n        height: 20vh;\\r\\n    }\\r\\n\\r\\n    .mobile.half-map-container.gtw-half-map {\\r\\n        display: block;\\r\\n        height: 30vh;\\r\\n    }\\r\\n}\\r\\n\\r\\n/*\\r\\n@media only screen and (max-height: 768px) and (orientation: landscape) {\\r\\n    .landscape-notice {\\r\\n        display: block;\\r\\n    }\\r\\n}\\r\\n*/\\r\\n\\r\\n@media screen and (max-width: 470px) {\\r\\n    .startup h1 {\\r\\n        font-size: 10vw;\\r\\n    }\\r\\n}\", \"\"]);\n","var content = require(\"!!../node_modules/css-loader/dist/cjs.js!./timeline.css\");\n\nif (typeof content === 'string') {\n  content = [[module.id, content, '']];\n}\n\nvar options = {}\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = require(\"!../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\")(content, options);\n\nif (content.locals) {\n  module.exports = content.locals;\n}\n","exports = module.exports = require(\"../node_modules/css-loader/dist/runtime/api.js\")(false);\n// Module\nexports.push([module.id, \"\\r\\nimg {\\r\\n    vertical-align: middle;\\r\\n}\\r\\n\\r\\n.img-responsive {\\r\\n    display: block;\\r\\n    height: auto;\\r\\n    max-width: 100%;\\r\\n}\\r\\n\\r\\n.img-rounded {\\r\\n    border-radius: 3px;\\r\\n}\\r\\n\\r\\n.img-thumbnail {\\r\\n    background-color: #fff;\\r\\n    border: 1px solid #ededf0;\\r\\n    border-radius: 3px;\\r\\n    display: inline-block;\\r\\n    height: auto;\\r\\n    line-height: 1.428571429;\\r\\n    max-width: 100%;\\r\\n    moz-transition: all .2s ease-in-out;\\r\\n    o-transition: all .2s ease-in-out;\\r\\n    padding: 2px;\\r\\n    transition: all .2s ease-in-out;\\r\\n    webkit-transition: all .2s ease-in-out;\\r\\n}\\r\\n\\r\\n.img-circle {\\r\\n    border-radius: 50%;\\r\\n}\\r\\n\\r\\n.timeline-centered {\\r\\n    position: relative;\\r\\n    margin-bottom: 30px;\\r\\n}\\r\\n\\r\\n    .timeline-centered:before, .timeline-centered:after {\\r\\n        content: \\\" \\\";\\r\\n        display: table;\\r\\n    }\\r\\n\\r\\n    .timeline-centered:after {\\r\\n        clear: both;\\r\\n    }\\r\\n\\r\\n    .timeline-centered:before, .timeline-centered:after {\\r\\n        content: \\\" \\\";\\r\\n        display: table;\\r\\n    }\\r\\n\\r\\n    .timeline-centered:after {\\r\\n        clear: both;\\r\\n    }\\r\\n\\r\\n    .timeline-centered:before {\\r\\n        content: '';\\r\\n        position: absolute;\\r\\n        display: block;\\r\\n        width: 4px;\\r\\n        background: #f5f5f6;\\r\\n        /*left: 50%;*/\\r\\n        top: 20px;\\r\\n        bottom: 20px;\\r\\n        margin-left: 30px;\\r\\n    }\\r\\n\\r\\n    .timeline-centered .timeline-entry {\\r\\n        position: relative;\\r\\n        /*width: 50%;\\r\\n        float: right;*/\\r\\n        margin-top: 5px;\\r\\n        margin-left: 30px;\\r\\n        margin-bottom: 10px;\\r\\n        clear: both;\\r\\n    }\\r\\n\\r\\n        .timeline-centered .timeline-entry:before, .timeline-centered .timeline-entry:after {\\r\\n            content: \\\" \\\";\\r\\n            display: table;\\r\\n        }\\r\\n\\r\\n        .timeline-centered .timeline-entry:after {\\r\\n            clear: both;\\r\\n        }\\r\\n\\r\\n        .timeline-centered .timeline-entry:before, .timeline-centered .timeline-entry:after {\\r\\n            content: \\\" \\\";\\r\\n            display: table;\\r\\n        }\\r\\n\\r\\n        .timeline-centered .timeline-entry:after {\\r\\n            clear: both;\\r\\n        }\\r\\n\\r\\n        .timeline-centered .timeline-entry.begin {\\r\\n            margin-bottom: 0;\\r\\n        }\\r\\n\\r\\n        .timeline-centered .timeline-entry.left-aligned {\\r\\n            float: left;\\r\\n        }\\r\\n\\r\\n            .timeline-centered .timeline-entry.left-aligned .timeline-entry-inner {\\r\\n                margin-left: 0;\\r\\n                margin-right: -18px;\\r\\n            }\\r\\n\\r\\n                .timeline-centered .timeline-entry.left-aligned .timeline-entry-inner .timeline-time {\\r\\n                    left: auto;\\r\\n                    right: -100px;\\r\\n                    text-align: left;\\r\\n                }\\r\\n\\r\\n                .timeline-centered .timeline-entry.left-aligned .timeline-entry-inner .timeline-icon {\\r\\n                    float: right;\\r\\n                }\\r\\n\\r\\n                .timeline-centered .timeline-entry.left-aligned .timeline-entry-inner .timeline-label {\\r\\n                    margin-left: 0;\\r\\n                    margin-right: 70px;\\r\\n                }\\r\\n\\r\\n                    .timeline-centered .timeline-entry.left-aligned .timeline-entry-inner .timeline-label:after {\\r\\n                        left: auto;\\r\\n                        right: 0;\\r\\n                        margin-left: 0;\\r\\n                        margin-right: -9px;\\r\\n                        -moz-transform: rotate(180deg);\\r\\n                        -o-transform: rotate(180deg);\\r\\n                        -webkit-transform: rotate(180deg);\\r\\n                        -ms-transform: rotate(180deg);\\r\\n                        transform: rotate(180deg);\\r\\n                    }\\r\\n\\r\\n        .timeline-centered .timeline-entry .timeline-entry-inner {\\r\\n            position: relative;\\r\\n            margin-left: -20px;\\r\\n        }\\r\\n\\r\\n            .timeline-centered .timeline-entry .timeline-entry-inner:before, .timeline-centered .timeline-entry .timeline-entry-inner:after {\\r\\n                content: \\\" \\\";\\r\\n                display: table;\\r\\n            }\\r\\n\\r\\n            .timeline-centered .timeline-entry .timeline-entry-inner:after {\\r\\n                clear: both;\\r\\n            }\\r\\n\\r\\n            .timeline-centered .timeline-entry .timeline-entry-inner:before, .timeline-centered .timeline-entry .timeline-entry-inner:after {\\r\\n                content: \\\" \\\";\\r\\n                display: table;\\r\\n            }\\r\\n\\r\\n            .timeline-centered .timeline-entry .timeline-entry-inner:after {\\r\\n                clear: both;\\r\\n            }\\r\\n\\r\\n            .timeline-centered .timeline-entry .timeline-entry-inner .timeline-time {\\r\\n                position: absolute;\\r\\n                left: -100px;\\r\\n                text-align: right;\\r\\n                padding: 10px;\\r\\n                -webkit-box-sizing: border-box;\\r\\n                -moz-box-sizing: border-box;\\r\\n                box-sizing: border-box;\\r\\n            }\\r\\n\\r\\n                .timeline-centered .timeline-entry .timeline-entry-inner .timeline-time > span {\\r\\n                    display: block;\\r\\n                }\\r\\n\\r\\n                    .timeline-centered .timeline-entry .timeline-entry-inner .timeline-time > span:first-child {\\r\\n                        font-size: 15px;\\r\\n                        font-weight: bold;\\r\\n                    }\\r\\n\\r\\n                    .timeline-centered .timeline-entry .timeline-entry-inner .timeline-time > span:last-child {\\r\\n                        font-size: 12px;\\r\\n                    }\\r\\n\\r\\n            .timeline-centered .timeline-entry .timeline-entry-inner .timeline-icon {\\r\\n                background: #fff;\\r\\n                color: #737881;\\r\\n                display: block;\\r\\n                width: 40px;\\r\\n                height: 40px;\\r\\n                -webkit-background-clip: padding-box;\\r\\n                -moz-background-clip: padding;\\r\\n                background-clip: padding-box;\\r\\n                -webkit-border-radius: 20px;\\r\\n                -moz-border-radius: 20px;\\r\\n                border-radius: 20px;\\r\\n                text-align: center;\\r\\n                -moz-box-shadow: 0 0 0 5px #f5f5f6;\\r\\n                -webkit-box-shadow: 0 0 0 5px #f5f5f6;\\r\\n                box-shadow: 0 0 0 5px #f5f5f6;\\r\\n                line-height: 40px;\\r\\n                font-size: 15px;\\r\\n                float: left;\\r\\n            }\\r\\n\\r\\n                .timeline-centered .timeline-entry .timeline-entry-inner .timeline-icon.bg-primary {\\r\\n                    background-color: #303641;\\r\\n                    color: #fff;\\r\\n                }\\r\\n\\r\\n                .timeline-centered .timeline-entry .timeline-entry-inner .timeline-icon.bg-secondary {\\r\\n                    background-color: #ee4749;\\r\\n                    color: #fff;\\r\\n                }\\r\\n\\r\\n                .timeline-centered .timeline-entry .timeline-entry-inner .timeline-icon.bg-success {\\r\\n                    background-color: #00a651;\\r\\n                    color: #fff;\\r\\n                }\\r\\n\\r\\n                .timeline-centered .timeline-entry .timeline-entry-inner .timeline-icon.bg-info {\\r\\n                    background-color: #21a9e1;\\r\\n                    color: #fff;\\r\\n                }\\r\\n\\r\\n                .timeline-centered .timeline-entry .timeline-entry-inner .timeline-icon.bg-warning {\\r\\n                    background-color: #fad839;\\r\\n                    color: #fff;\\r\\n                }\\r\\n\\r\\n                .timeline-centered .timeline-entry .timeline-entry-inner .timeline-icon.bg-danger {\\r\\n                    background-color: #cc2424;\\r\\n                    color: #fff;\\r\\n                }\\r\\n\\r\\n            .timeline-centered .timeline-entry .timeline-entry-inner .timeline-label {\\r\\n                position: relative;\\r\\n                background: #f5f5f6;\\r\\n                padding: 1em;\\r\\n                margin-left: 60px;\\r\\n                -webkit-background-clip: padding-box;\\r\\n                -moz-background-clip: padding;\\r\\n                background-clip: padding-box;\\r\\n                -webkit-border-radius: 3px;\\r\\n                -moz-border-radius: 3px;\\r\\n                border-radius: 3px;\\r\\n            }\\r\\n\\r\\n                .timeline-centered .timeline-entry .timeline-entry-inner .timeline-label:after {\\r\\n                    content: '';\\r\\n                    display: block;\\r\\n                    position: absolute;\\r\\n                    width: 0;\\r\\n                    height: 0;\\r\\n                    border-style: solid;\\r\\n                    border-width: 9px 9px 9px 0;\\r\\n                    border-color: transparent #f5f5f6 transparent transparent;\\r\\n                    left: 0;\\r\\n                    top: 10px;\\r\\n                    margin-left: -9px;\\r\\n                }\\r\\n\\r\\n                .timeline-centered .timeline-entry .timeline-entry-inner .timeline-label h2, .timeline-centered .timeline-entry .timeline-entry-inner .timeline-label p {\\r\\n                    color: #737881;\\r\\n                    font-family: \\\"Noto Sans\\\",sans-serif;\\r\\n                    font-size: 12px;\\r\\n                    margin: 0;\\r\\n                    line-height: 1.428571429;\\r\\n                }\\r\\n\\r\\n                    .timeline-centered .timeline-entry .timeline-entry-inner .timeline-label p + p {\\r\\n                        margin-top: 15px;\\r\\n                    }\\r\\n\\r\\n                .timeline-centered .timeline-entry .timeline-entry-inner .timeline-label h2 {\\r\\n                    font-size: 16px;\\r\\n                }\\r\\n\\r\\n                    .timeline-centered .timeline-entry .timeline-entry-inner .timeline-label h2 button {\\r\\n                        color: #303641;\\r\\n                    }\\r\\n\\r\\n                    .timeline-centered .timeline-entry .timeline-entry-inner .timeline-label h2 span {\\r\\n                        -webkit-opacity: .6;\\r\\n                        -moz-opacity: .6;\\r\\n                        opacity: .6;\\r\\n                        -ms-filter: alpha(opacity=60);\\r\\n                        filter: alpha(opacity=60);\\r\\n                    }\\r\\n\", \"\"]);\n","var map = {\n\t\"./gtwp-ctbnwfb/index.js\": [\n\t\t82,\n\t\t35\n\t],\n\t\"./gtwp-hktransit/index.js\": [\n\t\t83,\n\t\t36\n\t],\n\t\"./gtwp-kmb/index.js\": [\n\t\t84,\n\t\t37\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(function() {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn __webpack_require__.e(ids[1]).then(function() {\n\t\treturn __webpack_require__(id);\n\t});\n}\nwebpackAsyncContext.keys = function webpackAsyncContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackAsyncContext.id = 74;\nmodule.exports = webpackAsyncContext;","var map = {\n\t\"./gtw-map-googlemap\": [\n\t\t45,\n\t\t2\n\t],\n\t\"./gtw-map-googlemap.js\": [\n\t\t45,\n\t\t2\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(function() {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn __webpack_require__.e(ids[1]).then(function() {\n\t\treturn __webpack_require__(id);\n\t});\n}\nwebpackAsyncContext.keys = function webpackAsyncContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackAsyncContext.id = 75;\nmodule.exports = webpackAsyncContext;","var map = {\n\t\"./gtw-ui-modal-about\": [\n\t\t46,\n\t\t3\n\t],\n\t\"./gtw-ui-modal-about.js\": [\n\t\t46,\n\t\t3\n\t],\n\t\"./gtw-ui-modal-errorplugins\": [\n\t\t47,\n\t\t4\n\t],\n\t\"./gtw-ui-modal-errorplugins.js\": [\n\t\t47,\n\t\t4\n\t],\n\t\"./gtw-ui-modal-pluginclosedapi\": [\n\t\t48,\n\t\t5\n\t],\n\t\"./gtw-ui-modal-pluginclosedapi.js\": [\n\t\t48,\n\t\t5\n\t],\n\t\"./gtw-ui-modal-pluginmanager\": [\n\t\t49,\n\t\t0\n\t],\n\t\"./gtw-ui-modal-pluginmanager.js\": [\n\t\t49,\n\t\t0\n\t],\n\t\"./gtw-ui-modal-settings\": [\n\t\t50,\n\t\t6\n\t],\n\t\"./gtw-ui-modal-settings.js\": [\n\t\t50,\n\t\t6\n\t],\n\t\"./gtw-ui-modal-updated\": [\n\t\t51,\n\t\t7\n\t],\n\t\"./gtw-ui-modal-updated.js\": [\n\t\t51,\n\t\t7\n\t],\n\t\"./gtw-ui-modal-viewplugin\": [\n\t\t52,\n\t\t8\n\t],\n\t\"./gtw-ui-modal-viewplugin.js\": [\n\t\t52,\n\t\t8\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(function() {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn __webpack_require__.e(ids[1]).then(function() {\n\t\treturn __webpack_require__(id);\n\t});\n}\nwebpackAsyncContext.keys = function webpackAsyncContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackAsyncContext.id = 76;\nmodule.exports = webpackAsyncContext;","var map = {\n\t\"./modal-about-header.html\": [\n\t\t86,\n\t\t15\n\t],\n\t\"./modal-errorplugins-header.html\": [\n\t\t87,\n\t\t18\n\t],\n\t\"./modal-pluginclosedapi-header.html\": [\n\t\t88,\n\t\t21\n\t],\n\t\"./modal-pluginmanager-header.html\": [\n\t\t89,\n\t\t24\n\t],\n\t\"./modal-settings-header.html\": [\n\t\t90,\n\t\t27\n\t],\n\t\"./modal-updated-header.html\": [\n\t\t91,\n\t\t30\n\t],\n\t\"./modal-viewplugin-header.html\": [\n\t\t92,\n\t\t33\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(function() {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn __webpack_require__.e(ids[1]).then(function() {\n\t\treturn __webpack_require__.t(id, 7);\n\t});\n}\nwebpackAsyncContext.keys = function webpackAsyncContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackAsyncContext.id = 77;\nmodule.exports = webpackAsyncContext;","var map = {\n\t\"./modal-about-body.html\": [\n\t\t93,\n\t\t13\n\t],\n\t\"./modal-errorplugins-body.html\": [\n\t\t94,\n\t\t16\n\t],\n\t\"./modal-pluginclosedapi-body.html\": [\n\t\t95,\n\t\t19\n\t],\n\t\"./modal-pluginmanager-body.html\": [\n\t\t96,\n\t\t22\n\t],\n\t\"./modal-settings-body.html\": [\n\t\t97,\n\t\t25\n\t],\n\t\"./modal-updated-body.html\": [\n\t\t98,\n\t\t28\n\t],\n\t\"./modal-viewplugin-body.html\": [\n\t\t99,\n\t\t31\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(function() {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn __webpack_require__.e(ids[1]).then(function() {\n\t\treturn __webpack_require__.t(id, 7);\n\t});\n}\nwebpackAsyncContext.keys = function webpackAsyncContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackAsyncContext.id = 78;\nmodule.exports = webpackAsyncContext;","var map = {\n\t\"./modal-about-footer.html\": [\n\t\t100,\n\t\t14\n\t],\n\t\"./modal-errorplugins-footer.html\": [\n\t\t101,\n\t\t17\n\t],\n\t\"./modal-pluginclosedapi-footer.html\": [\n\t\t102,\n\t\t20\n\t],\n\t\"./modal-pluginmanager-footer.html\": [\n\t\t103,\n\t\t23\n\t],\n\t\"./modal-settings-footer.html\": [\n\t\t104,\n\t\t26\n\t],\n\t\"./modal-updated-footer.html\": [\n\t\t105,\n\t\t29\n\t],\n\t\"./modal-viewplugin-footer.html\": [\n\t\t106,\n\t\t32\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(function() {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn __webpack_require__.e(ids[1]).then(function() {\n\t\treturn __webpack_require__.t(id, 7);\n\t});\n}\nwebpackAsyncContext.keys = function webpackAsyncContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackAsyncContext.id = 79;\nmodule.exports = webpackAsyncContext;","var map = {\n\t\"./gtw-ui-tab-transit\": [\n\t\t53,\n\t\t1\n\t],\n\t\"./gtw-ui-tab-transit.js\": [\n\t\t53,\n\t\t1\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(function() {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn __webpack_require__.e(ids[1]).then(function() {\n\t\treturn __webpack_require__(id);\n\t});\n}\nwebpackAsyncContext.keys = function webpackAsyncContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackAsyncContext.id = 80;\nmodule.exports = webpackAsyncContext;","//GTW Logging\r\n\r\nimport * as Settings from './gtw-settings';\r\n\r\nvar maxEntries = 1000;\r\n\r\nvar logEntries = [];\r\n\r\nvar jsTrace = console.trace;\r\nconsole.trace = function (msg) {\r\n    log(\"console\", msg, -1);\r\n};\r\n\r\nvar jsDebug = console.debug;\r\nconsole.debug = function (msg) {\r\n    log(\"console\", msg, -2);\r\n};\r\n\r\nvar jsInfo = console.log;\r\nconsole.log = function (msg) {\r\n    log(\"console\", msg, 0);\r\n};\r\n\r\nvar jsWarn = console.warn;\r\nconsole.warn = function (msg) {\r\n    log(\"console\", msg, 1);\r\n};\r\n\r\nvar jsError = console.error;\r\nconsole.error = function (msg) {\r\n    log(\"console\", msg, 2);\r\n};\r\n\r\nexport var printObject = true;\r\n\r\nexport function toConsole(msg, level) {\r\n    if (level === -2) {\r\n        jsTrace(msg);\r\n    } else if (level === -1) {\r\n        jsDebug(msg);\r\n    } else if (level === 0) {\r\n        jsInfo(msg);\r\n    } else if (level === 1) {\r\n        jsWarn(msg);\r\n    } else if (level === 2) {\r\n        jsError(msg);\r\n    }\r\n}\r\n\r\nexport function toLogger(tag, msg, time, level) {\r\n    if (logEntries.length >= maxEntries) {\r\n        logEntries.shift();\r\n    }\r\n    logEntries.push({\r\n        time: time,\r\n        msg: msg,\r\n        level: level\r\n    });\r\n\r\n    if (Settings.get(\"show_debug_msg\", false)) {\r\n        showToast(logEntries.length, tag, msg, time, level);\r\n    }\r\n}\r\n\r\nvar lastMsg = 0;\r\nvar lastTag = 0;\r\nvar lastLevel = 0;\r\nvar lastTime = 0;\r\n\r\nexport function showToast(id, tag, msg, time, level) {\r\n    if (level <= 0) {\r\n        return;\r\n    }\r\n\r\n    if (lastMsg === msg && lastTag === tag && lastLevel === level && time - lastTime < 7500) {\r\n        return;\r\n    }\r\n\r\n    lastTime = time;\r\n    lastMsg = msg;\r\n    lastTag = tag;\r\n    lastLevel = level;\r\n\r\n    var node = $(\"#gtw-toast-stack\");\r\n    var levelName = \"Unknown\";\r\n    var className = \"\";\r\n\r\n    if (level === -2) {\r\n        levelName = \"Trace\";\r\n    } else if (level === -1) {\r\n        levelName = \"Debug\";\r\n    } else if (level === 0) {\r\n        levelName = \"Info\";\r\n        className = \" text-primary\";\r\n    } else if (level === 1) {\r\n        levelName = \"Warning\";\r\n        className = \" text-warning\";\r\n    } else if (level === 2) {\r\n        levelName = \"Error\";\r\n        className = \" text-danger\";\r\n    }\r\n\r\n    var html =\r\n        \"<div class=\\\"toast\\\" role=\\\"alert\\\" log-entry-id=\\\"\" + id + \"\\\">\" +\r\n        \"    <div class=\\\"toast-header\\\">\" +\r\n        \"        <strong class=\\\"mr-auto\" + className + \"\\\">\" + levelName + \" (\" + tag + \")</strong>\" +\r\n        \"        <small class=\\\"text-muted\\\">\" + new Date(time).toLocaleString() + \"</small>\" +\r\n        \"        <button type=\\\"button\\\" class=\\\"ml-2 mb-1 close\\\" data-dismiss=\\\"toast\\\" aria-label=\\\"Close\\\"><span aria-hidden=\\\"true\\\">&times;</span></button>\" +\r\n        \"    </div>\" +\r\n        \"    <div class=\\\"toast-body\\\">\" + msg +\r\n        \"    </div>\" +\r\n        \"</div>\"\r\n        ;\r\n\r\n    if (node.children().length >= 3) {\r\n        node.children().each(function (i) {\r\n            if (i >= 2) {\r\n                $(this).toast('hide');\r\n            }\r\n        });\r\n    }\r\n\r\n    node.prepend(html);\r\n\r\n    var key = \".toast[log-entry-id='\" + id + \"']\";\r\n    $(key).on('hidden.bs.toast', function () {\r\n        $(this).remove();\r\n    });\r\n    $(key).toast({\r\n        animation: true,\r\n        autohide: true,\r\n        delay: 5000\r\n    });\r\n    $(key).toast('show');\r\n}\r\n\r\nexport function getEntries() {\r\n    return logEntries;\r\n}\r\n\r\nexport function log(tag = \"unknown\", msg, level = 0) {\r\n    var time = Date.now();\r\n\r\n    if (typeof msg === \"object\") {\r\n        if (printObject) {\r\n            toConsole(\"[\" + new Date(time).toLocaleString() + \"] [\" + tag + \"]\", level);\r\n            toConsole(msg, level);\r\n        } else {\r\n            var pmsg = JSON.stringify(msg);\r\n            toConsole(\"[\" + new Date(time).toLocaleString() + \"] [\" + tag + \"] \" + pmsg, level);\r\n        }\r\n    } else {\r\n        toConsole(\"[\" + new Date(time).toLocaleString() + \"] [\" + tag + \"] \" + msg, level);\r\n    }\r\n\r\n    toLogger(tag, msg, time, level);\r\n}\r\n\r\nexport function trace(tag, msg) {\r\n    log(tag, msg, -2);\r\n}\r\n\r\nexport function debug(tag, msg) {\r\n    log(tag, msg, -1);\r\n}\r\n\r\nexport function info(tag, msg) {\r\n    log(tag, msg, 0);\r\n}\r\n\r\nexport function warn(tag, msg) {\r\n    log(tag, msg, 1);\r\n}\r\n\r\nexport function error(tag, msg) {\r\n    log(tag, msg, 2);\r\n}"],"sourceRoot":""}
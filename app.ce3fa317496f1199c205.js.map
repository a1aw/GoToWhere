{"version":3,"sources":["webpack:///./src/gtw-map.js","webpack:///./src/gtw-event.js","webpack:///./src/gtw-citydata-transit-gtfs.js","webpack:///./src/gtw-settings.js","webpack:///./src/gtw-misc.js","webpack:///./src/gtw-citydata-transit.js","webpack:///./src/gtw-pluginloader.js","webpack:///./src/gtw-ui.js","webpack:///./src/gtw-cors.js","webpack:///./src/gtw-location.js","webpack:///./src/gtw-db.js","webpack:///./src/gtw-lang.js","webpack:///./src/gtw-citydata-transit-eta.js","webpack:///./src/gtw-requestlimiter.js","webpack:///./src/gtw-config.js","webpack:///./src/gtw-ui-touchkeypad.js","webpack:///./node_modules/@wikimedia/jquery.i18n/src sync ^\\.\\/.*$","webpack:///./src/style.css?9819","webpack:///./src/style.css","webpack:///./src/timeline.css?025a","webpack:///./src/timeline.css","webpack:///./src/html.loc-status-btn.js","webpack:///./src/html.build-version.js","webpack:///./src/html.map-overlay.js","webpack:///./src/html.loading-overlay.js","webpack:///./src/html.toast-stack-container.js","webpack:///./src/html.footer.js","webpack:///./src/html.gtw-map.js","webpack:///./src/html.mobile-split-container.js","webpack:///./src/html.modal.js","webpack:///./src/i18n lazy ^\\.\\/.*\\.json$ namespace object","webpack:///./src/workers/stoptimes-raw-by-stop-id.worker.js","webpack:///./src/workers/stoptimes-raw-by-trip-id.worker.js","webpack:///./src/plugins lazy ^\\.\\/.*\\/index\\.js$ namespace object","webpack:///./src/workers/loadgtfs.worker.js","webpack:///./src lazy ^\\.\\/gtw\\-map\\-.*$ namespace object","webpack:///./src lazy ^\\.\\/gtw\\-ui\\-modal\\-.*$ namespace object","webpack:///./src/ui lazy ^\\.\\/.*\\-header\\.html$ namespace object","webpack:///./src/ui lazy ^\\.\\/.*\\-body\\.html$ namespace object","webpack:///./src/ui lazy ^\\.\\/.*\\-footer\\.html$ namespace object","webpack:///./src lazy ^\\.\\/gtw\\-ui\\-tab\\-.*$ namespace object","webpack:///./src/gtw-log.js","webpack:///./src/html.gtw-container.nav.js","webpack:///./src/html.gtw-container.top-panel.js","webpack:///./src/html.gtw-container.split-map-panel.js","webpack:///./src/html.gtw-container.getting-started-panel.js","webpack:///./src/html.gtw-container.touch-keypad.js","webpack:///./src/html.gtw-container.js","webpack:///./src/app.js"],"names":["map","init","Promise","resolve","reject","mapApi","then","m","window","k","setCenter","coords","getCenter","setZoom","zoom","addMarker","position","options","setMarkerPosition","markerId","lockMarker","removeMarker","removeAllMarkers","addPolyline","strokeColor","strokeWeight","strokeOpacity","geodesic","removeAllPolylines","EVENTS","EVENT_UI_BACK","EVENT_LOCATION_CHANGE","EVENT_LOCATION_SUCCESS","EVENT_LOCATION_ERROR","EVENT_LOCATION_SELECTED","EVENT_MAP_CENTER_CHANGED","eventListeners","dispatchEvent","event","args","listener","apply","this","removeListener","addListener","push","i","indexOf","splice","db","version","stores","STORES","async","validateDatabase","pkg","provider","requiredRows","count","key","where","equals","console","warn","clearDatabase","storeKey","delete","clearPackageDatabase","selectAgencyStopName","agencyId","stopName","startsWith","endsWith","substr","length","splits","split","val","spaceIndex","selectFirstAgencyStopName","getCurrentTrip","routeId","trips","getTripsByRouteId","trip","getCurrentFrequency","timeToDate","timeStr","date","Date","setHours","setMinutes","setSeconds","isCurrentFrequency","freq","now","startDate","endDate","getTime","getRoutePathFrequencies","pathId","exist","out","freqs","getFrequencies","outFreq","tripId","toArray","searchRoutes","query","startsWithIgnoreCase","getAllRouteNames","offset","noDup","filter","route","each","str","includes","searchNearbyStops","lat","lng","range","sorted","stops","forEach","stop","distance","sort","a","b","searchStopRoutes","stopId","pathIds","routeIds","routes","stopTimes","st","sortBy","getStopTimePathsByStopId","stopTime","log","anyOf","getAgencies","getAgency","first","getRoute","getStop","getCalendar","serviceId","getStopTimePathByPathId","SETTINGS_STORAGE_KEY","getDefaultSettings","type","name","$","i18n","desc","def","checkfunc","locales","languages","found","locale","x","parseInt","Number","isNaN","json","get","set","load","localStorage","t","getItem","save","j","JSON","parse","setItem","stringify","geoDistance","lat1","lon1","lat2","lon2","p","c","Math","cos","asin","sqrt","allProgress","proms","progress_cb","d","all","fillZero","number","providers","totalProms","dbVersions","dbZips","dbChunks","dbUpdateNeeded","dbMaps","registerProvider","id","fetchDatabase","checkDatabaseUpdate","Error","obtainDatabaseVersion","pc","row","update","catch","err","error","validateAllDatabase","hasDatabaseUpdate","downloadDatabase","zip","FILES","prepareUpdate","files","file","obj","versions","put","worker","initializeWorker","Worker","terminateWorker","terminate","readChunks","dataType","infos","info","chunk","internalStream","on","data","postMessage","string","resume","waitToUpdate","addEventListener","ext","evt","msg","removeEventListener","progress","putGtfs","result","plugins","installedPlugins","deprecatedPlugins","install","autoSave","plugin","isInstalled","uninstall","getPlugin","pluginsStr","installedPlugin","alert","status","mod","onload","currentTabModule","currentModalModule","document","ready","showModal","open","hasClass","removeClass","tab","attr","addClass","showTab","blur","showPanel","splitContainerPercent","Object","keys","cleanUpTab","cleanUpModal","module","enable","adjustMargin","css","hidePanel","layout","backdrop","keyboard","html","default","modal","loadModalLayout","hideModal","disable","CORS_PROTOCOL","domains","register","domain","allowCors","config","extractHost","url","last","substring","isCors","host","location","before","request","callback","Cors","Settings","statusText","headers","proxy","index","sindex","currentPosition","located","requestLocationAccess","successFunc","errorFunc","navigator","geolocation","getCurrentPosition","latitude","longitude","icon","watchPosition","onPositionChangeSuccess","onPositionChangeError","enableHighAccuracy","timeout","maximumAge","ERROR_NOT_SUPPORTED","isLocated","isErrored","getError","getTransitReference","putTransitReference","translatedString","transStr","lang","getLanguage","getLocale","trans","translation","language","text","localizedKey","localizedObject","langKey","localeKey","enKey","changeLanguage","cache","clearCache","timeDifference","hr","min","etaProviders","fetchEta","unregisterProvider","getProviders","getProvider","getEtaProvider","etaProvider","fetchAllDatabase","needs","needed","opt","agency","providerId","cached","lastFetched","feed","FeedMessage","fromObject","verify","time","feeds","header","entity","code","getCache","requests","duration","running","start","dispatch","next","shift","setTimeout","clear","googleMapApiKey","onClickListeners","mouseClickTouchKeypadValue","reset","showTouchKeypad","hideTouchKeypad","enableFunctionKeys","disableFunctionKeys","setEnabled","keyMap","charCodeAt","letterKeypadHtml","webpackContext","req","webpackContextResolve","__webpack_require__","o","e","exports","content","locals","body","appendChild","element","createElement","setAttribute","component","innerHTML","loadingSpinner","spinner","spinnerSr","stack","splitMapPanel","container","backBtn","upBtn","downBtn","tabPanel","splitMapContainer","dialog","footer","webpackAsyncContext","ids","maxEntries","logEntries","jsTrace","trace","jsDebug","debug","jsInfo","jsWarn","jsError","printObject","toConsole","level","toLogger","tag","lastMsg","lastTag","lastLevel","lastTime","node","levelName","className","toLocaleString","children","toast","prepend","remove","animation","autohide","delay","showToast","pmsg","nav","brand","collapseBtn","navCollapse","navList","navListItem","darkMode","matchMedia","matches","linkName","iconCss","msgKey","listItem","btn","jumbo","btnGroup","tabButton","primary","disabled","splitMapTabPanel","appTitle","wizard","wizardSteps","wizardStepContents","wizardStep","p1","p2","p3","inputGroup","inputGroupPrepend","label","select","link","step1","optionLoading","accord","step2","p4","step3","panel","progressPanel","progressBar","errorPanel","stepLink","numericKeypad","letterKeypad","chain","opts","suffix","value","contentPanelContainer","splitMapContainerDesktop","jQuery","JSZip","JSZipUtils","serviceWorker","registration","registrationError","fadeIn","resize","nph","height","hh","dh","msh","hmph","defs","GTFS_DATA_TYPES","indexedDB","takeSomeTimeText","loadAllGtfs","fadeOut","lastVer","errPlugins","pluginKey","append","animate","opacity"],"mappings":"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","file":"app.ce3fa317496f1199c205.js","sourcesContent":["//GTW Map source code\r\n\r\nimport config from './gtw-config';\r\n\r\nexport var map = false;\r\n\r\nexport function init() {\r\n    return new Promise((resolve, reject) => {\r\n        import(`./gtw-map-${config.mapApi}`).then(function (m) {\r\n            map = m;\r\n            window.k = map;\r\n            map.init().then(function () {\r\n                resolve();\r\n            });\r\n        });\r\n    });\r\n}\r\n\r\nexport function setCenter(coords) {\r\n    return map.setCenter(coords);\r\n}\r\n\r\nexport function getCenter() {\r\n    return map.getCenter();\r\n}\r\n\r\nexport function setZoom(zoom) {\r\n    return map.setZoom(zoom);\r\n}\r\n\r\nexport function addMarker(position, options) {\r\n    return map.addMarker(position, options);\r\n}\r\n\r\nexport function setMarkerPosition(markerId, position) {\r\n    return map.setMarkerPosition(markerId, position);\r\n}\r\n\r\nexport function lockMarker(markerId) {\r\n    return map.lockMarker(markerId);\r\n}\r\n\r\nexport function unlockMarker(markerId) {\r\n    return map.unlockMarker(markerId);\r\n}\r\n\r\nexport function removeMarker(markerId) {\r\n    return map.removeMarker(markerId);\r\n}\r\n\r\nexport function removeAllMarkers() {\r\n    return map.removeAllMarkers();\r\n}\r\n\r\nexport function addInfoWindow(markerId, content, open = false) {\r\n    return map.addInfoWindow(markerId, content, open);\r\n}\r\n\r\nexport function addPolyline(coords, strokeColor, strokeWeight, strokeOpacity = 1.0, geodesic = true) {\r\n    return map.addPolyline(coords, strokeColor, strokeWeight, strokeOpacity, geodesic);\r\n}\r\n\r\nexport function lockPolyline(polylineId) {\r\n    return map.lockPolyline(polylineId);\r\n}\r\n\r\nexport function unlockPolyline(polylineId) {\r\n    return map.unlockPolyline(polylineId);\r\n}\r\n\r\nexport function removePolyline(polylineId) {\r\n    return map.removePolyline(polylineId);\r\n}\r\n\r\nexport function removeAllPolylines() {\r\n    return map.removeAllPolylines();\r\n}\r\n\r\nexport function fitBounds(bounds) {\r\n    return map.fitBounds(bounds);\r\n}","//GTW Event Manager\r\n\r\nexport const EVENTS = {\r\n    EVENT_UI_BACK: \"EVENT_UI_BACK\",\r\n    EVENT_LOCATION_CHANGE: \"EVENT_LOCATION_CHANGE\",\r\n    EVENT_LOCATION_SUCCESS: \"EVENT_LOCATION_SUCCESS\",\r\n    EVENT_LOCATION_ERROR: \"EVENT_LOCATION_ERROR\",\r\n    EVENT_LOCATION_SELECTED: \"EVENT_LOCATION_SELECTED\",\r\n    EVENT_MAP_CENTER_CHANGED: \"EVENT_MAP_CENTER_CHANGED\"\r\n};\r\n\r\nvar eventListeners = {};\r\n\r\nexport function dispatchEvent(event, ...args) {\r\n    if (!eventListeners[event]) {\r\n        return;\r\n    }\r\n    for (var listener of eventListeners[event]) {\r\n        if (listener) {\r\n            listener.apply(this, args);\r\n        } else {\r\n            removeListener(listener);\r\n        }\r\n    }\r\n}\r\n\r\nexport function addListener(event, listener) {\r\n    if (!eventListeners[event]) {\r\n        eventListeners[event] = [];\r\n    }\r\n    eventListeners[event].push(listener);\r\n}\r\n\r\nexport function removeListener(event, listener) {\r\n    if (!eventListeners[event]) {\r\n        return;\r\n    }\r\n    var i = eventListeners[event].indexOf(listener);\r\n    if (i === -1) {\r\n        return;\r\n    }\r\n    eventListeners[event].splice(i, 1);\r\n}\r\n\r\nexport function removeAllListeners() {\r\n    eventListeners = {};\r\n}","import Dexie from 'dexie';\r\nimport * as Misc from './gtw-misc';\r\n\r\nexport var db = new Dexie(\"gtfs\");\r\n\r\nvar stopTimesValid = {};\r\n\r\ndb.version(1).stores({\r\n    \"versions\": \"[package+provider],[package+provider+version],package\",\r\n    \"agency\": \"[package+provider+agency_id],[package+provider],[package+provider+version],package\",\r\n    \"calendar\": \"[package+provider+service_id],[package+provider],[package+provider+version],package\",\r\n    \"calendar_dates\": \"[package+provider+service_id+date],[package+provider],[package+provider+service_id],[package+provider+version],package\",\r\n    \"frequencies\": \"[package+provider+trip_id],[package+provider],[package+provider+version],package\",\r\n    \"routes\": \"[package+provider+route_id],[package+provider],route_short_name,[package+provider+version],package\",\r\n    \"trips\": \"[package+provider+trip_id],[package+provider],[package+provider+route_id],[package+provider+route_id+service_id],[package+provider+path_id],[package+provider+version],package\",\r\n    \"stops\": \"[package+provider+stop_id],[package+provider],[package+provider+version],package\",\r\n    \"stop_times\": \"++id, [package+provider+trip_id], [package+provider+stop_id], [package+provider],[package+provider+version],package\",\r\n    \"stop_time_paths\": \"++id, [package+provider+path_id], [package+provider+stop_id], [package+provider],[package+provider+version],package\",\r\n    \"fare_attributes\": \"[package+provider+fare_id],[package+provider],[package+provider+version],package\",\r\n    \"fare_rules\": \"[package+provider+fare_id],[package+provider],[package+provider+version],package\",\r\n    \"stop_times_raw\": \"[package+provider],[package+provider+version],package\",\r\n    \"fare_attributes_raw\": \"[package+provider],[package+provider+version],package\",\r\n    \"fare_rules_raw\": \"[package+provider],[package+provider+version],package\"\r\n});\r\n\r\nvar STORES = [\r\n    \"versions\",\r\n    \"agency\",\r\n    \"calendar\",\r\n    \"calendar_dates\",\r\n    \"frequencies\",\r\n    \"routes\",\r\n    \"trips\",\r\n    \"stops\",\r\n    \"stop_times\",\r\n    \"stop_time_paths\",\r\n    \"fare_attributes\",\r\n    \"fare_rules\",\r\n    \"stop_times_raw\",\r\n    \"fare_attributes_raw\",\r\n    \"fare_rules_raw\"\r\n];\r\n\r\n//\r\n// Misc\r\n//\r\n\r\nexport async function validateDatabase(pkg, provider, version, map) {\r\n    var requiredRows;\r\n    var count;\r\n    for (var key in map) {\r\n        if (key === \"stop_times\" ||\r\n            key === \"fare_attributes\" ||\r\n            key === \"fare_rules\"\r\n        ) {\r\n            continue;\r\n        }\r\n        requiredRows = map[key];\r\n        count = await db[key].where(\"[package+provider+version]\")\r\n            .equals([pkg, provider, version]).count();\r\n        if (count !== requiredRows) {\r\n            console.warn(\"Warning: \" + pkg + \",\" + provider + \" \" + version + \" version database invalid at \" + key + \" with different rows: \" + count + \" (Required: \" + requiredRows + \")\");\r\n            return false;\r\n        }\r\n    }\r\n    return true;\r\n}\r\n\r\nexport async function clearDatabase(pkg, provider) {\r\n    for (var storeKey of STORES) {\r\n        await db[storeKey].where(\"[package+provider]\")\r\n            .equals([pkg, provider]).delete();\r\n    }\r\n}\r\n\r\nexport async function clearPackageDatabase(pkg) {\r\n    for (var storeKey of STORES) {\r\n        await db[storeKey].where(\"package\")\r\n            .equals(pkg).delete();\r\n    }\r\n}\r\n\r\nexport function selectAgencyStopName(agencyId, stopName) {\r\n    if (stopName.startsWith(\"\\\"\") && stopName.endsWith(\"\\\"\")) {\r\n        stopName = stopName.substr(1, stopName.length - 2);\r\n    }\r\n    var splits = stopName.split(\"|\");\r\n    var key = \"[\" + agencyId + \"] \";\r\n    for (var i = 0; i < splits.length; i++) {\r\n        if (splits[i].startsWith(key)) {\r\n            return splits[i].substr(key.length);\r\n        }\r\n    }\r\n    var val = splits[0];\r\n    var spaceIndex = val.indexOf(\"] \");\r\n    if (spaceIndex === -1) {\r\n        return val;\r\n    } else {\r\n        return val.substr(spaceIndex + 2);\r\n    }\r\n}\r\n\r\nexport function selectFirstAgencyStopName(stopName){\r\n    if (stopName.startsWith(\"\\\"\") && stopName.endsWith(\"\\\"\")) {\r\n        stopName = stopName.substr(1, stopName.length - 2);\r\n    }\r\n    var splits = stopName.split(\"|\");\r\n    if (splits.length > 0) {\r\n        var val = splits[0];\r\n        var spaceIndex = val.indexOf(\"] \");\r\n        if (spaceIndex === -1) {\r\n            return val;\r\n        } else {\r\n            return val.substr(spaceIndex + 2);\r\n        }\r\n    } else {\r\n        return stopName;\r\n    }\r\n}\r\n\r\nexport async function getCurrentTrip(pkg, provider, routeId) {\r\n    var trips = await getTripsByRouteId(pkg, provider, routeId);\r\n    var freq;\r\n    for (var trip of trips) {\r\n        freq = getCurrentFrequency(pkg, provider, trip[\"trip_id\"]);\r\n        if (freq) {\r\n            return trip;\r\n        }\r\n    }\r\n    return false;\r\n}\r\n\r\nexport function timeToDate(timeStr) {\r\n    var splits = timeStr.split(\":\");\r\n    var date = new Date();\r\n    date.setHours(splits[0]);\r\n    date.setMinutes(splits[1]);\r\n    date.setSeconds(splits[2]);\r\n    return date;\r\n}\r\n\r\nexport function isCurrentFrequency(freq) {\r\n    var now = Date.now();\r\n\r\n    var startDate = timeToDate(freq[\"start_time\"]);\r\n    var endDate = timeToDate(freq[\"end_time\"]);\r\n\r\n    return now >= startDate.getTime() && now <= endDate.getTime();\r\n}\r\n\r\nexport async function getRoutePathFrequencies(pkg, provider, routeId, pathId) {\r\n    var trips = await getTripsByRouteId(pkg, provider, routeId);\r\n    var out = [];\r\n    var exist;\r\n    for (var trip of trips) {\r\n        if (trip[\"path_id\"] !== pathId) {\r\n            continue;\r\n        }\r\n        var freqs = await getFrequencies(pkg, provider, trip[\"trip_id\"]);\r\n        for (var freq of freqs) {\r\n            exist = false;\r\n            for (var outFreq of out) {\r\n                if (outFreq[\"start_time\"] === freq[\"start_time\"] &&\r\n                    outFreq[\"end_time\"] === freq[\"end_time\"] &&\r\n                    outFreq[\"headway_secs\"] === freq[\"headway_secs\"]) {\r\n                    exist = true;\r\n                    break;\r\n                }\r\n            }\r\n            if (!exist) {\r\n                out.push(freq);\r\n            }\r\n        }\r\n    }\r\n    return out;\r\n}\r\n\r\nexport async function getCurrentFrequency(pkg, provider, tripId) {\r\n    var freqs = await getFrequencies(pkg, provider, tripId);\r\n    var now = Date.now();\r\n    var startDate;\r\n    var endDate;\r\n    var splits;\r\n    for (var freq of freqs) {\r\n        if (isCurrentFrequency(freq)) {\r\n            return freq;\r\n        }\r\n    }\r\n    return false;\r\n}\r\n\r\nexport async function getFrequencies(pkg, provider, tripId) {\r\n    return await db[\"frequencies\"].where(\"[package+provider+trip_id]\")\r\n        .equals([pkg, provider, tripId]).toArray();\r\n}\r\n\r\nexport async function searchRoutes(query) {\r\n    return await db[\"routes\"].where(\"route_short_name\")\r\n        .startsWithIgnoreCase(query).toArray();\r\n}\r\n\r\nexport async function getAllRouteNames(offset, length, noDup) {\r\n    return new Promise((resolve, reject) => {\r\n        var out = [];\r\n        db[\"routes\"].filter(route => {\r\n            return route[\"route_short_name\"].length > offset;\r\n        }).each(route => {\r\n            var str = route[\"route_short_name\"].substr(offset, length);\r\n            if (!noDup || !out.includes(str)) {\r\n                out.push(str);\r\n            }\r\n        }).then(function () {\r\n            resolve(out);\r\n        });\r\n    });\r\n}\r\n\r\nexport async function searchNearbyStops(lat, lng, range, sorted = true) {\r\n    var stops = await db[\"stops\"].toArray();\r\n    var out = [];\r\n    stops.forEach(stop => {\r\n        var distance = Misc.geoDistance(lat, lng, stop[\"stop_lat\"], stop[\"stop_lon\"]);\r\n        if (distance <= range) {\r\n            out.push({\r\n                distance: distance,\r\n                stop: stop\r\n            });\r\n        }\r\n    });\r\n\r\n    if (sorted) {\r\n        out.sort((a, b) => {\r\n            return a.distance - b.distance;\r\n        });\r\n    }\r\n    return out;\r\n}\r\n\r\nexport function searchStopRoutes(pkg, provider, stopId) {\r\n    return new Promise((resolve, reject) => {\r\n        var pathIds = [];\r\n        var routeIds = [];\r\n        var routes = {};\r\n        var stopTimes = {};\r\n        var trips = {};\r\n        var st = Date.now();\r\n        return getStopTimePathsByStopId(pkg, provider, stopId).then(function (out) {\r\n            for (var stopTime of out) {\r\n                var pathId = stopTime[\"path_id\"];\r\n                pathIds.push([pkg, provider, pathId]);\r\n                stopTimes[pathId] = stopTime;\r\n            }\r\n            console.log(\"PATH DONE: \" + (Date.now() - st));\r\n        }).then(function () {\r\n            st = Date.now();\r\n            db[\"trips\"].where(\"[package+provider+path_id]\").anyOf(pathIds).each(trip => {\r\n                var routeId = trip[\"route_id\"];\r\n                trips[routeId] = trip;\r\n                routeIds.push([pkg, provider, routeId]);\r\n            }).then(function () {\r\n                console.log(\"EACH DONE: \" + (Date.now() - st));\r\n                st = Date.now();\r\n                db[\"routes\"].where(\"[package+provider+route_id]\").anyOf(routeIds).each(route => {\r\n                    var routeId = route[\"route_id\"];\r\n                    routes[routeId] = route;\r\n                }).then(function () {\r\n                    console.log(\"EACH2 DONE: \" + (Date.now() - st));\r\n                    resolve({\r\n                        routes: routes,\r\n                        trips: trips,\r\n                        stopTimes: stopTimes\r\n                    });\r\n                });\r\n            });\r\n        });\r\n    });\r\n}\r\n\r\n//\r\n// Getters\r\n//\r\n\r\nexport async function getAgencies() {\r\n    return await db[\"agency\"].toArray();\r\n}\r\n\r\nexport async function getAgency(pkg, provider, agencyId) {\r\n    return await db[\"agency\"].where(\"[package+provider+agency_id]\")\r\n        .equals([pkg, provider, agencyId]).first();\r\n}\r\n\r\nexport async function getRoute(pkg, provider, routeId) {\r\n    return await db[\"routes\"].where(\"[package+provider+route_id]\")\r\n        .equals([pkg, provider, routeId]).first();\r\n}\r\n\r\nexport async function getTrip(pkg, provider, tripId) {\r\n    return await db[\"trips\"].where(\"[package+provider+trip_id]\")\r\n        .equals([pkg, provider, tripId]).first();\r\n}\r\n\r\nexport async function getTripsByRouteId(pkg, provider, routeId) {\r\n    return await db[\"trips\"].where(\"[package+provider+route_id]\")\r\n        .equals([pkg, provider, routeId]).toArray();\r\n}\r\n\r\nexport async function getStop(pkg, provider, stopId) {\r\n    return await db[\"stops\"].where(\"[package+provider+stop_id]\")\r\n        .equals([pkg, provider, stopId]).first();\r\n}\r\n\r\nexport async function getCalendar(pkg, provider, serviceId) {\r\n    return await db[\"calendar\"].where(\"[package+provider+service_id]\")\r\n        .equals([pkg, provider, serviceId]).first();\r\n}\r\n\r\nexport async function getCalendarDates(pkg, provider, serviceId) {\r\n    return await db[\"calendar_dates\"].where(\"[package+provider+service_id]\")\r\n        .equals([pkg, provider, serviceId]).toArray();\r\n}\r\n\r\nexport async function getStopTimePathsByStopId(pkg, provider, stopId) {\r\n    return await db[\"stop_time_paths\"].where(\"[package+provider+stop_id]\")\r\n        .equals([pkg, provider, stopId]).sortBy(\"path_id\");\r\n}\r\n\r\nexport async function getStopTimePathByPathId(pkg, provider, pathId) {\r\n    return await db[\"stop_time_paths\"].where(\"[package+provider+path_id]\")\r\n        .equals([pkg, provider, pathId]).sortBy(\"stop_sequence\");\r\n}\r\n\r\nexport function getStopTimesByStopId(pkg, provider, stopId) {\r\n    return new Promise((resolve, reject) => {\r\n        if (isStopTimesValid(pkg, provider)) {\r\n            db[\"stop_times\"].where(\"[package+provider+stop_id]\")\r\n                .equals([pkg, provider, stopId]).sortBy(\"trip_id\").then(function (rows) {\r\n                    resolve(rows);\r\n                });\r\n        } else {\r\n            var worker = new Worker(\"./workers/stoptimes-raw-by-stop-id.worker.js\", { type: 'module' });\r\n            worker.postMessage({\r\n                pkg: pkg,\r\n                id: provider,\r\n                stopId: stopId\r\n            });\r\n            worker.addEventListener(\"message\", function (evt) {\r\n                var out = evt.data;\r\n                for (var datum of out) {\r\n                    datum[\"package\"] = pkg;\r\n                    datum[\"provider\"] = provider;\r\n                }\r\n                resolve(out);\r\n            });\r\n        }\r\n    });\r\n}\r\n\r\nexport function getStopTimesByTripId(pkg, provider, tripId) {\r\n    return new Promise((resolve, reject) => {\r\n        if (isStopTimesValid(pkg, provider)) {\r\n            db[\"stop_times\"].where(\"[package+provider+trip_id]\")\r\n                .equals([pkg, provider, tripId]).sortBy(\"stop_sequence\").then(function (rows) {\r\n                    resolve(rows);\r\n                });\r\n        } else {\r\n            var worker = new Worker(\"./workers/stoptimes-raw-by-trip-id.worker.js\", { type: 'module' });\r\n            worker.postMessage({\r\n                pkg: pkg,\r\n                id: provider,\r\n                tripId: tripId\r\n            });\r\n            worker.addEventListener(\"message\", function (evt) {\r\n                var out = evt.data;\r\n                for (var datum of out) {\r\n                    datum[\"package\"] = pkg;\r\n                    datum[\"provider\"] = provider;\r\n                }\r\n                resolve(out);\r\n            });\r\n        }\r\n    });\r\n}\r\n\r\nexport async function validateStopTimes(pkg, provider) {\r\n    var rawRowsArray = await db[\"stop_times_raw\"].where(\"[package+provider]\")\r\n        .equals([pkg, provider]).first();\r\n    var dbRows = await db[\"stop_times\"].where(\"[package+provider]\")\r\n        .equals([pkg, provider]).count();\r\n    return stopTimesValid[pkg + \",\" + provider] = rawRowsArray.rows.length === dbRows;\r\n}\r\n\r\nexport function isStopTimesValid(pkg, provider) {\r\n    return false;\r\n    return stopTimesValid[pkg + \",\" + provider];\r\n}\r\n","//GTW Settings\r\n\r\nconst SETTINGS_STORAGE_KEY = \"gtw-settings\";\r\n\r\nconst VALUE_TYPES = {\r\n    number: \"number\",\r\n    string: \"string\",\r\n    boolean: \"boolean\"\r\n};\r\n\r\nexport function getDefaultSettings() {\r\n    return [\r\n        {\r\n            key: \"preferred_language\",\r\n            type: \"string\",\r\n            name: $.i18n(\"settings-key-preferred-language\"),\r\n            desc: $.i18n(\"settings-key-preferred-language-desc\"),\r\n            def: \"en\",\r\n            checkfunc: function (val) {\r\n                var locales = require(\"./gtw-lang\").languages;\r\n                var found = false;\r\n                for (var locale in locales) {\r\n                    if (locale === val) {\r\n                        found = true;\r\n                        break;\r\n                    }\r\n                }\r\n                return found;\r\n            }\r\n        },\r\n        {\r\n            key: \"show_debug_msg\",\r\n            type: \"boolean\",\r\n            name: $.i18n(\"settings-key-show-debug-msg\"),\r\n            desc: $.i18n(\"settings-key-show-debug-msg-desc\"),\r\n            def: false\r\n        },\r\n        {\r\n            key: \"min_nearby_transit_range\",\r\n            type: \"number\",\r\n            name: $.i18n(\"settings-key-min-nearby-transit-search-range\"),\r\n            desc: $.i18n(\"settings-key-min-nearby-transit-search-range-desc\"),\r\n            def: 200,\r\n            checkfunc: function (val) {\r\n                var x = parseInt(val);\r\n                return !Number.isNaN(x) && x < 10000;\r\n            }\r\n        },\r\n        {\r\n            key: \"max_nearby_transit_to_display\",\r\n            type: \"number\",\r\n            name: $.i18n(\"settings-key-max-nearby-transit-to-be-displayed\"),\r\n            desc: $.i18n(\"settings-key-max-nearby-transit-to-be-displayed-desc\"),\r\n            def: 20,\r\n            checkfunc: function (val) {\r\n                var x = parseInt(val);\r\n                return !Number.isNaN(x) && x < 100;\r\n            }\r\n        },\r\n        {\r\n            key: \"use_cors_proxy\",\r\n            type: \"boolean\",\r\n            name: $.i18n(\"settings-key-use-cors-proxy\"),\r\n            desc: $.i18n(\"settings-key-use-cors-proxy-desc\"),\r\n            def: true\r\n        },\r\n        {\r\n            key: \"cors_proxy_server\",\r\n            type: \"string\",\r\n            name: $.i18n(\"settings-key-cors-proxy-server\"),\r\n            desc: $.i18n(\"settings-key-cors-proxy-server-desc\"),\r\n            def: \"https://cp1.gotowhere.ga/\",\r\n            checkfunc: function (val) {\r\n                return val.startsWith(\"https://\") && val.endsWith(\"/\")\r\n            }\r\n        },\r\n        {\r\n            key: \"cors_check_bypass\",\r\n            type: \"boolean\",\r\n            name: $.i18n(\"settings-key-cors-check-bypass\"),\r\n            desc: $.i18n(\"settings-key-cors-check-bypass-desc\"),\r\n            def: false\r\n        }\r\n    ];\r\n}\r\n\r\nexport var json = {};\r\n\r\nexport function get(key, def = false) {\r\n    var val = json[key];\r\n    if (typeof val === 'undefined') {\r\n        return def;\r\n    }\r\n    return val;\r\n}\r\n\r\nexport function set(key, val) {\r\n    json[key] = val;\r\n    return true;\r\n}\r\n\r\nexport function load() {\r\n    if (!localStorage) {\r\n        return false;\r\n    }\r\n    var t = localStorage.getItem(SETTINGS_STORAGE_KEY);\r\n\r\n    if (!t) {\r\n        return save();\r\n    }\r\n\r\n    var j = JSON.parse(t);\r\n\r\n    if (!j) {\r\n        return false;\r\n    }\r\n\r\n    json = j;\r\n    return true;\r\n}\r\n\r\nexport function save() {\r\n    if (!localStorage) {\r\n        return false;\r\n    }\r\n    localStorage.setItem(SETTINGS_STORAGE_KEY, JSON.stringify(json));\r\n    return true;\r\n}","//GTW Misc\r\n\r\nexport function geoDistance(lat1, lon1, lat2, lon2) {\r\n    var p = 0.017453292519943295;    // Math.PI / 180\r\n    var c = Math.cos;\r\n    var a = 0.5 - c((lat2 - lat1) * p) / 2 +\r\n        c(lat1 * p) * c(lat2 * p) *\r\n        (1 - c((lon2 - lon1) * p)) / 2;\r\n\r\n    return 12742 * Math.asin(Math.sqrt(a)); // 2 * R; R = 6371 km\r\n}\r\n\r\nexport function stringCompare(a, b) {\r\n    if (a.length < b.length) {\r\n        return -1;\r\n    } else if (a.length > b.length) {\r\n        return 1;\r\n    }\r\n    var i;\r\n    var ca;\r\n    var cb;\r\n    var len = a.length;\r\n    for (i = 0; i < len; i++) {\r\n        ca = a.charAt(i);\r\n        cb = b.charAt(i);\r\n        if (ca < cb) {\r\n            return -1;\r\n        } else if (ca > cb) {\r\n            return 1;\r\n        }\r\n    }\r\n    return 0;\r\n}\r\n\r\nexport function allProgress(proms, progress_cb) {\r\n    let d = 0;\r\n    progress_cb(0);\r\n    for (const p of proms) {\r\n        p.then(() => {\r\n            d++;\r\n            progress_cb((d * 100) / proms.length);\r\n        });\r\n    }\r\n    return Promise.all(proms);\r\n}\r\n\r\nexport function isSamePropertyValueInArray(array, name, value) {\r\n    for (var object of array) {\r\n        if (object[name] === value) {\r\n            return true;\r\n        }\r\n    }\r\n    return false;\r\n}\r\n\r\nexport function fillZero(number) {\r\n    return number < 10 ? (\"0\" + number) : number;\r\n}\r\n\r\nexport function similarity(s1, s2) {\r\n    var longer = s1;\r\n    var shorter = s2;\r\n    if (s1.length < s2.length) {\r\n        longer = s2;\r\n        shorter = s1;\r\n    }\r\n    var longerLength = longer.length;\r\n    if (longerLength == 0) {\r\n        return 1.0;\r\n    }\r\n    return (longerLength - editDistance(longer, shorter)) / parseFloat(longerLength);\r\n}\r\n\r\nexport function editDistance(s1, s2) {\r\n    s1 = s1.toLowerCase();\r\n    s2 = s2.toLowerCase();\r\n\r\n    var costs = new Array();\r\n    for (var i = 0; i <= s1.length; i++) {\r\n        var lastValue = i;\r\n        for (var j = 0; j <= s2.length; j++) {\r\n            if (i == 0)\r\n                costs[j] = j;\r\n            else {\r\n                if (j > 0) {\r\n                    var newValue = costs[j - 1];\r\n                    if (s1.charAt(i - 1) != s2.charAt(j - 1))\r\n                        newValue = Math.min(Math.min(newValue, lastValue),\r\n                            costs[j]) + 1;\r\n                    costs[j - 1] = lastValue;\r\n                    lastValue = newValue;\r\n                }\r\n            }\r\n        }\r\n        if (i > 0)\r\n            costs[s2.length] = lastValue;\r\n    }\r\n    return costs[s2.length];\r\n}","//City Data: Transit\r\nimport * as Misc from './gtw-misc';\r\nimport * as gtfs from './gtw-citydata-transit-gtfs';\r\nimport Dexie from 'dexie';\r\nimport Papa from 'papaparse';\r\nimport oboe from 'oboe';\r\nimport { db } from './gtw-citydata-transit-gtfs';\r\n\r\nvar providers = [];\r\nvar totalProms = [];\r\nvar dbVersions = {};\r\nvar dbZips = {};\r\nvar dbChunks = {};\r\nvar dbUpdateNeeded = {};\r\nvar dbMaps = {};\r\n\r\n//\r\n// Provider registration\r\n//\r\n\r\nexport function registerProvider(pkg, id, provider) {\r\n    if (!provider.fetchDatabase || typeof provider.fetchDatabase !== \"function\" ||\r\n        !provider.checkDatabaseUpdate || typeof provider.checkDatabaseUpdate !== \"function\") {\r\n        throw new Error(\"Error: \" + name + \" does not contain fetchDatabase or checkDatabaseUpdate function!\");\r\n    }\r\n\r\n    provider.pkg = pkg;\r\n    provider.id = id;\r\n    provider.db = false;\r\n\r\n    //provider.getRoute\r\n\r\n    //provider.getRouteById\r\n\r\n    //provider.getRoutes\r\n\r\n    providers.push(provider);\r\n}\r\n\r\nexport function unregisterProvider(id) {\r\n    var found = -1;\r\n    for (var i = 0; i < providers.length; i++) {\r\n        if (providers[i].id === id) {\r\n            found = i;\r\n        }\r\n    }\r\n    providers.splice(found, 1);\r\n}\r\n\r\nexport function getProviders() {\r\n    return providers;\r\n}\r\n\r\nexport function getProvider(id) {\r\n    for (var provider of providers) {\r\n        if (provider.id === id) {\r\n            return provider;\r\n        }\r\n    }\r\n    return false;\r\n}\r\n\r\n//\r\n// Database Update\r\n//\r\n\r\nexport function obtainDatabaseVersion(pc) {\r\n    console.log(\"Obtaining db version\");\r\n    var proms = [];\r\n    for (var provider of providers) {\r\n        //proms.push(new Promise((resolve, reject) => { resolve(false); }))\r\n        window.x = db;\r\n        proms.push(db[\"versions\"].where(\"[package+provider]\").equals([provider.pkg, provider.id]).first().then(function (row) {\r\n            if (row) {\r\n                var key = row[\"package\"] + \",\" + row[\"provider\"];\r\n                dbVersions[key] = row.version;\r\n                dbMaps[key] = row.map;\r\n            }\r\n        }));\r\n        /*\r\n        proms.push(dbGtfs.getVersion(provider.pkg, provider.id).then(function (ver) {\r\n            if (ver) {\r\n                var key = ver[\"package\"] + \",\" + ver[\"provider\"];\r\n                dbVersions[key] = ver.version;\r\n            }\r\n        }));\r\n        */\r\n    }\r\n    return Misc.allProgress(proms, pc);\r\n}\r\n\r\nexport function checkDatabaseUpdate(pc) {\r\n    console.log(\"DBVersions:\");\r\n    console.log(dbVersions);\r\n    var proms = [];\r\n    var p;\r\n    for (var provider of providers) {\r\n        var key = provider.pkg + \",\" + provider.id;\r\n        if (dbVersions[key]) {\r\n            p = new Promise((resolve, reject) => {\r\n                provider.checkDatabaseUpdate(resolve, reject, dbVersions[key]);\r\n            });\r\n            proms.push(p.then(function (update) {\r\n                dbUpdateNeeded[key] = update;\r\n            }).catch(function (err) {\r\n                console.error(\"Error: Promise rejected when checking update for \" + key + \".\");\r\n            }));\r\n        } else {\r\n            dbUpdateNeeded[key] = true;\r\n        }\r\n    }\r\n    return Misc.allProgress(proms, pc);\r\n}\r\n\r\nexport async function validateAllDatabase() {\r\n    var map;\r\n    var valid;\r\n    for (var provider of providers) {\r\n        var key = provider.pkg + \",\" + provider.id;\r\n        map = dbMaps[key];\r\n        if (!map) {\r\n            console.error(\"Error: GTFS database does not contain a map to validate! Forcing it to update!\");\r\n            dbUpdateNeeded[key] = true;\r\n            continue;\r\n        }\r\n        valid = await gtfs.validateDatabase(provider.pkg, provider.id, dbVersions[key], map);\r\n        if (!valid) {\r\n            console.warn(\"Warning: Invalid GTFS database compared with map! Forcing to update!\");\r\n            dbUpdateNeeded[key] = true;\r\n            continue;\r\n        }\r\n    }\r\n}\r\n\r\nexport function hasDatabaseUpdate() {\r\n    for (var key in dbUpdateNeeded) {\r\n        if (dbUpdateNeeded[key]) {\r\n            return true;\r\n        }\r\n    }\r\n    return false;\r\n}\r\n\r\nexport function downloadDatabase(pc) {\r\n    console.log(\"DBUpdateNeeded:\");\r\n    console.log(dbUpdateNeeded);\r\n    var proms = [];\r\n    var fdbp;\r\n    var p;\r\n    for (var provider of providers) {\r\n        var key = provider.pkg + \",\" + provider.id;\r\n        if (dbUpdateNeeded[key]) {\r\n            p = new Promise((resolve, reject) => {\r\n                provider.fetchDatabase(resolve, reject);\r\n            });\r\n            proms.push(p.then(function (zip) {\r\n                dbZips[key] = zip;\r\n            }));\r\n        }\r\n    }\r\n    return Misc.allProgress(proms, pc);\r\n}\r\n\r\nvar FILES = [\r\n    \"agency.json\",\r\n    \"calendar_dates.json\",\r\n    \"calendar.json\",\r\n    \"fare_attributes.json\",\r\n    \"fare_rules.json\",\r\n    \"frequencies.json\",\r\n    \"routes.json\",\r\n    \"stops.json\",\r\n    \"stop_time_paths.json\",\r\n    \"stop_times.json\",\r\n    \"trips.json\"\r\n];\r\n    \r\nexport function prepareUpdate(pc) {\r\n    console.log(\"DBZips:\");\r\n    console.log(dbZips);\r\n    var proms = [];\r\n    var p;\r\n    var zip;\r\n    for (var provider of providers) {\r\n        var key = provider.pkg + \",\" + provider.id;\r\n        if (dbZips[key]) {\r\n            zip = dbZips[key];\r\n            console.log(\"Preparing for update for key: \" + key);\r\n            if (!zip.files[\"version.json\"]) {\r\n                console.error(\"Error: Database returned from \" + key + \" does not contain a version file.\");\r\n                continue;\r\n            }\r\n\r\n            dbChunks[key] = [];\r\n            for (var file of FILES) {\r\n                if (zip.files[file]) {\r\n                    proms.push(zip.files[file].async(\"string\").then(function (str) {\r\n                        var obj = JSON.parse(str);\r\n                        obj.pkg = provider.pkg;\r\n                        obj.id = provider.id;\r\n                        console.log(obj);\r\n                        dbChunks[key].push(obj);\r\n                    }));\r\n                }\r\n            }\r\n\r\n            proms.push(zip.file(\"version.json\").async(\"string\").then(function (str) {\r\n                var json = JSON.parse(str);\r\n                json[\"package\"] = provider.pkg;\r\n                json[\"provider\"] = provider.id;\r\n                db.versions.put(json);\r\n            }));\r\n            proms.push(gtfs.clearDatabase(provider.pkg, provider.id));\r\n        }\r\n    }\r\n    return Misc.allProgress(proms, pc);\r\n}\r\n\r\n/*\r\nexport function readChunks(pc) {\r\n    return new Promise((resolve, reject) => {\r\n        var worker = new Worker(\"./workers/loaddb.worker.js\", { type: 'module' });\r\n\r\n        worker.postMessage({\r\n            chunks: dbChunks,\r\n            zips: dbZips\r\n        });\r\n\r\n        worker.addEventListener(\"message\", function (evt) {\r\n            console.log(evt);\r\n            var msg = evt.data;\r\n            if (msg.type === 0) {\r\n                resolve()\r\n            } else if (msg.type === 1) {\r\n                pc(msg.progress);\r\n            }\r\n        });\r\n    });\r\n}\r\n*/\r\nvar worker = false;\r\n\r\nexport function initializeWorker() {\r\n    worker = new Worker(\"./workers/loadgtfs.worker.js\", { type: 'module' });\r\n}\r\n\r\nexport function terminateWorker() {\r\n    worker.terminate();\r\n}\r\n\r\nexport function readChunks(dataType, pc) {\r\n    console.log(\"DBChunks:\");\r\n    console.log(dbChunks);\r\n    var proms = [];\r\n    var p;\r\n    var i;\r\n    var infos;\r\n    var zip;\r\n    for (var provider of providers) {\r\n        var key = provider.pkg + \",\" + provider.id;\r\n        zip = dbZips[key];\r\n        if (dbChunks[key]) {\r\n            infos = dbChunks[key];\r\n            for (const info of infos) {\r\n                if (dataType !== info.dataType) {\r\n                    continue;\r\n                }\r\n\r\n                proms.push(new Promise((resolve, reject) => {\r\n                    var chunk = \"\";\r\n                    var ps = [];\r\n                    console.log(\"Loading \" + info.dataType);\r\n                    zip.file(info.dataType + \"-chunk.json\").internalStream(\"string\")\r\n                        .on(\"data\", function (data) {\r\n                            chunk += data;\r\n                        })\r\n                        .on(\"error\", function (err) {\r\n                            console.log(\"ERROR\");\r\n                            reject(err);\r\n                        })\r\n                        .on(\"end\", function () {\r\n                            console.log(\"Chunk end\");\r\n                            worker.postMessage({\r\n                                type: 0,\r\n                                pkg: provider.pkg,\r\n                                id: provider.id,\r\n                                info: info,\r\n                                string: chunk\r\n                            });\r\n                            resolve();\r\n                        })\r\n                        .resume();\r\n                }));\r\n            }\r\n        }\r\n    }\r\n    return Misc.allProgress(proms, pc);\r\n}\r\n\r\nexport function waitToUpdate(pc) {\r\n    return new Promise((resolve, reject) => {\r\n        worker.addEventListener(\"message\", function ext(evt) {\r\n            var msg = evt.data;\r\n            if (msg.type === 0) {\r\n                console.log(\"Finish\");\r\n                worker.removeEventListener(\"message\", ext);\r\n                resolve();\r\n            } else if (msg.type === 1) {\r\n                pc(msg.progress);\r\n            } else if (msg.type === 2) {\r\n                var data = evt.data;\r\n                totalProms.push(db.putGtfs(data.pkg, data.id, data.info.dataType, data.result));\r\n            }\r\n        });\r\n        worker.postMessage({\r\n            type: 1\r\n        });\r\n    });\r\n}","// GTW Plugin Loader\r\n\r\nimport * as Misc from './gtw-misc';\r\nimport * as gtfs from './gtw-citydata-transit-gtfs';\r\nimport repos from './plugins/repository.json';\r\n\r\nexport var plugins = {};\r\n\r\nexport var installedPlugins = [];\r\n\r\nvar deprecatedPlugins = [\r\n    \"gtwp-kmb\"\r\n];\r\n\r\nexport function install(pkg, autoSave) {\r\n    if (isInstalled(pkg)) {\r\n        return false;\r\n    }\r\n    installedPlugins.push(pkg);\r\n    if (autoSave !== false){\r\n        save();\r\n    }\r\n    return true;\r\n}\r\n\r\nexport async function uninstall(pkg, autoSave) {\r\n    await gtfs.clearPackageDatabase(pkg);\r\n    var i;\r\n    for (i = 0; i < installedPlugins.length; i++){\r\n        if (installedPlugins[i] === pkg){\r\n            installedPlugins.splice(i, 1);\r\n            if (autoSave !== false) {\r\n                save();\r\n            }\r\n            return true;\r\n        }\r\n    }\r\n    return false;\r\n}\r\n\r\nexport function getPlugin(pkg) {\r\n    return plugins[pkg];\r\n}\r\n\r\nexport function isInstalled(pkg) {\r\n    for (var plugin of installedPlugins){\r\n        if (plugin === pkg){\r\n            return true;\r\n        }\r\n    }\r\n    return false;\r\n}\r\n\r\nexport function save() {\r\n    var localStorage = window.localStorage;\r\n    localStorage.setItem(\"gtw-plugins\", JSON.stringify(installedPlugins));\r\n    return true;\r\n}\r\n\r\nexport function load(pc) {\r\n    if (!localStorage){\r\n        console.error(\"Error: LocalStorage is not supported in this browser.\");\r\n        return;\r\n    }\r\n\r\n    var pluginsStr = localStorage.getItem(\"gtw-plugins\");\r\n\r\n    if (pluginsStr) {\r\n        installedPlugins = JSON.parse(pluginsStr);\r\n    }\r\n    \r\n    if (!installedPlugins || typeof installedPlugins.length !== \"number\"){\r\n        console.warn(\"Warning: Installed plugins JSON string is invalid. Resetting as empty.\");\r\n        save();\r\n    }\r\n    \r\n    var p;\r\n    var proms = [];\r\n    for (var installedPlugin of installedPlugins) {\r\n        if (deprecatedPlugins.includes(installedPlugin)) {\r\n            alert($.i18n(\"plugin-deprecated-auto-uninstall\", installedPlugin));\r\n            uninstall(installedPlugin);\r\n            continue;\r\n        }\r\n\r\n        const info = {\r\n            \"package\": installedPlugin,\r\n            status: 1,\r\n            msg: \"Not Enabled\"\r\n        };\r\n\r\n        if (repos[installedPlugin]){\r\n            proms.push(new Promise((resolve, reject) => {\r\n                import(`./plugins/${installedPlugin}/index.js`).then(function(mod) {\r\n                    var msg;\r\n                    if (!mod) {\r\n                        msg = $.i18n(\"plugin-error-no-module-returned\", installedPlugin);\r\n                        console.error(msg);\r\n                        info.status = -2;\r\n                        info.msg = msg;\r\n                    } else if (!mod.onload || typeof mod.onload !== \"function\") {\r\n                        msg = $.i18n(\"plugin-error-no-onload-function\", installedPlugin);\r\n                        console.error(msg);\r\n                        info.status = -3;\r\n                        info.msg = msg;\r\n                    } else {\r\n                        var promise = new Promise((resolve, reject) => {\r\n                            var status = mod.onload();\r\n                            if (status instanceof Promise) {\r\n                                status.then(resolve).catch(reject);\r\n                            } else {\r\n                                resolve(status);\r\n                            }\r\n                        });\r\n                        promise.then(function (status) {\r\n                            if (status) {\r\n                                info.status = 0;\r\n                                delete info.msg;\r\n                            } else {\r\n                                var msg = $.i18n(\"plugin-error-onload-function-error\", installedPlugin);\r\n                                console.error(msg);\r\n                                info.status = -4;\r\n                                info.msg = msg;\r\n                            }\r\n                            resolve();\r\n                        }).catch(reject);\r\n                    }\r\n                });\r\n            }));\r\n        } else {\r\n            info.status = -1;\r\n            info.msg = \"This plugin is not available in this version of GoToWhere.\";\r\n        }\r\n        plugins[installedPlugin] = info;\r\n    }\r\n    return Misc.allProgress(proms, pc);\r\n}","//GTW UI\r\n\r\nimport * as Map from './gtw-map';\r\nimport * as PluginLoader from './gtw-pluginloader';\r\nimport * as Loc from './gtw-location';\r\nimport * as Event from './gtw-event';\r\nimport * as TouchKeypad from './gtw-ui-touchkeypad';\r\n\r\nvar currentTabModule = false;\r\nvar currentModalModule = false;\r\n\r\n$(document).ready(function () {\r\n    $(\".header-links-plugins\").on(\"click\", function () {\r\n        showModal(\"pluginmanager\");\r\n    });\r\n    $(\".header-links-settings\").on(\"click\", function () {\r\n        showModal(\"settings\");\r\n    });\r\n    $(\".header-links-github\").on(\"click\", function () {\r\n        window.open(\"https://github.com/mob41/GoToWhere\");\r\n    });\r\n    $(\".header-links-about\").on(\"click\", function () {\r\n        showModal(\"about\");\r\n    });\r\n    $(\".header-links-feedback\").on(\"click\", function () {\r\n        window.open(\"https://forms.gle/nP9cp1V2rqhdqybv5\");\r\n    });\r\n});\r\n\r\n$(\".ui-tab\").on(\"click\", function () {\r\n    if ($(this).hasClass(\"btn-primary\")) {\r\n        return;\r\n    }\r\n    $(\".ui-tab\").removeClass(\"btn-primary\");\r\n    $(\".ui-tab\").removeClass(\"btn-link\");\r\n\r\n    var tab = $(this).attr(\"data-gtw-tab\");\r\n    $(this).addClass(\"btn-primary\");\r\n\r\n    $(\".ui-tab:not([data-gtw-tab='\" + tab + \"'])\").addClass(\"btn-link\");\r\n\r\n    showTab(tab);\r\n});\r\n\r\n$(\".btn\").on(\"click\", function () {\r\n    $(this).blur();\r\n});\r\n\r\n/*\r\n$(\".btn\").on(\"mouseup\", function () {\r\n    $(this).blur();\r\n});\r\n*/\r\n\r\n$(\".ui-split-map-back-btn\").on(\"click\", function () {\r\n    Event.dispatchEvent(Event.EVENTS.EVENT_UI_BACK);\r\n    Map.setCenter(Loc.getCurrentPosition());\r\n    Map.setZoom(16);\r\n    Map.removeAllMarkers();\r\n    Map.removeAllPolylines();\r\n    showPanel();\r\n});\r\n\r\nvar splitContainerPercent = 50;\r\n\r\n$(\".ui-pull-up-btn\").on(\"click\", function () {\r\n    if (splitContainerPercent >= 90) {\r\n        return;\r\n    }\r\n    splitContainerPercent += 10;\r\n    $(\".mobile-split-container\").css(\"height\", splitContainerPercent + \"%\");\r\n    adjustMargin();\r\n});\r\n\r\n$(\".ui-pull-down-btn\").on(\"click\", function () {\r\n    if (splitContainerPercent <= 10) {\r\n        return;\r\n    }\r\n    splitContainerPercent -= 10;\r\n    $(\".mobile-split-container\").css(\"height\", splitContainerPercent + \"%\");\r\n    adjustMargin();\r\n});\r\n\r\nexport function init() {\r\n    if (Object.keys(PluginLoader.plugins).length === 0) {\r\n        gettingStarted();\r\n    }\r\n\r\n    showTab(\"transit\");\r\n    adjustMargin();\r\n    showPanel();\r\n}\r\n\r\nexport function showPanel() {\r\n    $(\".content-panel-container\").css(\"display\", \"inline-block\");\r\n    $(\".top-panel\").css(\"display\", \"block\");\r\n    $(\".header nav\").removeClass(\"gtw-split-map\");\r\n\r\n    $(\"body\").removeClass(\"gtw-split-map\");\r\n    $(\"#gtw-map\").removeClass(\"gtw-split-map\");\r\n    $(\".map-overlay\").removeClass(\"gtw-split-map\");\r\n    $(\".split-map-panel\").removeClass(\"gtw-split-map\");\r\n    $(\".split-map-container\").removeClass(\"gtw-split-map\");\r\n    $(\".mobile-split-container\").removeClass(\"gtw-split-map\");\r\n\r\n    //$(\".header nav\").addClass(\"bg-dark\");\r\n    //$(\".split-map-panel\").css(\"display\", \"none\");\r\n    //$(\".top-panel\").css(\"display\", \"block\");\r\n    //$(\".split-map-container\").css(\"display\", \"none\");\r\n    //$(\".map-overlay\").fadeIn(500);\r\n    adjustMargin();\r\n}\r\n\r\nexport function hidePanel() {\r\n    $(\".top-panel\").css(\"display\", \"none\");\r\n    $(\".content-panel-container\").css(\"display\", \"none\");\r\n    $(\".header nav\").addClass(\"gtw-split-map\");\r\n\r\n    //$(\"body\").addClass(\"gtw-split-map\");\r\n    $(\"#gtw-map\").addClass(\"gtw-split-map\");\r\n    $(\".map-overlay\").addClass(\"gtw-split-map\");\r\n    $(\".split-map-panel\").addClass(\"gtw-split-map\");\r\n    $(\".split-map-container\").addClass(\"gtw-split-map\");\r\n    $(\".mobile-split-container\").addClass(\"gtw-split-map\");\r\n\r\n    //$(\".split-map-panel\").css(\"display\", \"block\");\r\n    //$(\".split-map-container\").css(\"display\", \"block\");\r\n    //$(\".header nav\").removeClass(\"bg-dark\");\r\n    //$(\".map-overlay\").fadeOut(500);\r\n    adjustMargin();\r\n}\r\n\r\n/*\r\nexport function clearUp() {\r\n    Map.setCenter(Loc.getCurrentPosition());\r\n    Map.setZoom(16);\r\n    Map.removeAllMarkers();\r\n    Map.removeAllPolylines();\r\n\r\n    vars = {};\r\n    for (var key in timers) {\r\n        clearInterval(timers[key]);\r\n    }\r\n    timers = [];\r\n    $(\".tab-panel\").html(\"\");\r\n    $(\".content-panel-container\").html(\"\");\r\n}\r\n\r\nexport function modalClearUp() {\r\n    modalVars = {};\r\n    for (var timer of modalTimers) {\r\n        clearInterval(timer);\r\n    }\r\n}\r\n*/\r\n\r\nexport function showModal(layout, ...args) {\r\n    //nowUi = layout;\r\n    //previousUi = 0;\r\n    cleanUpModal();\r\n    loadModalLayout(layout, true).then(function () {\r\n        $(\".modal\").i18n();\r\n        import(`./gtw-ui-modal-${layout}`).then(function (module) {\r\n            currentModalModule = module;\r\n            module.enable.apply(this, args);\r\n        });\r\n    });\r\n}\r\n\r\nexport function loadModalLayout(layout, options = {}) {\r\n    const key = \"modal-\" + layout;\r\n\r\n    if (options === true) {\r\n        options = {};\r\n        options.backdrop = \"static\";\r\n        options.keyboard = false;\r\n    }\r\n    \r\n    var proms = [];\r\n    proms.push(import(`./ui/${key}-header.html`).then(function (mod) {\r\n        $(\".modal-header\").html(mod.default);\r\n    }));\r\n    proms.push(import(`./ui/${key}-body.html`).then(function (mod) {\r\n        $(\".modal-body\").html(mod.default);\r\n    }));\r\n    proms.push(import(`./ui/${key}-footer.html`).then(function (mod) {\r\n        $(\".modal-footer\").html(mod.default);\r\n    }));\r\n\r\n    var p = Promise.all(proms);\r\n    p.then(function () {\r\n        $(\".modal\").modal(options);\r\n    });\r\n    return p;\r\n}\r\n\r\nexport function hideModal() {\r\n    $(\".modal\").modal(\"hide\");\r\n    cleanUpModal();\r\n}\r\n\r\nexport function isModalShown() {\r\n    return ($(\".modal\").data('bs.modal') || {})._isShown;\r\n}\r\n\r\nexport function cleanUpModal() {\r\n    if (currentModalModule) {\r\n        currentModalModule.disable();\r\n        currentModalModule = false;\r\n    }\r\n}\r\n\r\nexport function cleanUpTab() {\r\n    if (currentTabModule) {\r\n        currentTabModule.disable();\r\n        currentTabModule = false;\r\n        $(\".tab-panel\").html(\"\");\r\n        $(\".content-panel-container\").html(\"\");\r\n        $(\".split-map-tab-panel\").html(\"\");\r\n        $(\".split-map-container\").html(\"\");\r\n        TouchKeypad.hideTouchKeypad();\r\n    }\r\n}\r\n\r\nexport function showTab(tab) {\r\n    cleanUpTab();\r\n    import(`./gtw-ui-tab-${tab}`).then(function (module) {\r\n        currentTabModule = module;\r\n        module.enable();\r\n    });\r\n}\r\n\r\nexport function gettingStarted() {\r\n    cleanUpTab();\r\n    cleanUpModal();\r\n    import(\"./gtw-ui-gettingstarted\").then(function (module) {\r\n        module.enable();\r\n    });\r\n}\r\n\r\n//\r\n// Available scripts\r\n//\r\n// Modal: updated, pluginclosedapi, errorplugins, viewplugin, pluginmanager, settings\r\n// Tab: transit\r\n//","//GTW CORS Handling\r\n\r\nimport xhook from 'xhook';\r\n\r\nconst CORS_PROTOCOL = \"https://\";\r\n\r\nexport var domains = {};\r\n\r\nexport function register(domain, allowCors = false) {\r\n    var config = {};\r\n    config.allowCors = allowCors;\r\n    domains[domain] = config;\r\n}\r\n\r\nxhook.before(function (request, callback) {\r\n    var Cors = require(\"./gtw-cors\");\r\n    var Settings = require(\"./gtw-settings\");\r\n\r\n    if (Settings.get(\"cors_check_bypass\", false)) {\r\n        callback();\r\n        return;\r\n    }\r\n\r\n    var cors = Cors.isCors(request.url);\r\n\r\n    if (cors) {\r\n        var host = Cors.extractHost(request.url);\r\n\r\n        if (!host || host === \"\" || host === \"___local___\") {\r\n            callback();\r\n            return;\r\n        }\r\n\r\n        var config = Cors.domains[host];\r\n        if (!config) {\r\n            console.error(\"gtw-cors: The request to \\\"\" + host + \"\\\" was dropped, because this cross-domain host was not registered before performing AJAX.\");\r\n            callback({\r\n                status: 403,\r\n                statusText: 'The request is dropped by GoToWhere because this host was not registered before performing AJAX.',\r\n                headers: {}\r\n            });\r\n            return;\r\n        }\r\n\r\n        if (config.allowCors) {\r\n            callback();\r\n            return;\r\n        }\r\n\r\n        if (Settings.get(\"use_cors_proxy\", true)) {\r\n            var proxy = Settings.get(\"cors_proxy_server\", \"https://cp1.gotowhere.ga/\");\r\n            if (proxy.startsWith(\"https://\") && proxy.endsWith(\"/\")) {\r\n                var index = request.url.indexOf(\"http://\");\r\n                var sindex = request.url.indexOf(\"https://\");\r\n                if (index !== -1 && sindex === -1) {\r\n                    request.url = proxy + request.url.substring(index + 7);\r\n                } else if (index === -1 && sindex !== -1) {\r\n                    request.url = proxy + request.url.substring(sindex + 8);\r\n                } else {\r\n                    console.error(\"gtw-cors: Invalid URL: \" + request.url);\r\n                    callback({\r\n                        status: 403,\r\n                        statusText: 'Invalid URL: ' + request.url,\r\n                        headers: {}\r\n                    });\r\n                    return;\r\n                }\r\n            } else {\r\n                console.error(\"gtw-cors: The provided CORS Proxy server is invalid! Please check if the server URL in the settings is correct!\");\r\n                callback({\r\n                    status: 403,\r\n                    statusText: 'The provided CORS Proxy server is invalid! Please check if the server URL in the settings is correct!.',\r\n                    headers: {}\r\n                });\r\n                return;\r\n            }\r\n        } else {\r\n            console.error(\"gtw-cors: The request was dropped because there are no proxy available to handle CORS requests.\");\r\n            callback({\r\n                status: 403,\r\n                statusText: 'The request was dropped because there are no proxy available to handle CORS requests.',\r\n                headers: {}\r\n            });\r\n            return;\r\n        }\r\n    }\r\n\r\n    callback();\r\n});\r\n\r\nexport function extractHost(url) {\r\n    if (!url.includes(\"://\")) {\r\n        return \"___local___\";\r\n    } else if (url.startsWith(\"file://\")) {\r\n        return \"___file___\";\r\n    }\r\n    var i = url.indexOf(\"://\");\r\n    var last = url.substring(i + 3);\r\n\r\n    i = last.indexOf(\"/\");\r\n    if (i === -1) {\r\n        i = last.length();\r\n    }\r\n    return last.substring(0, i);\r\n}\r\n\r\nexport function isCors(url) {\r\n    if (!url.startsWith(CORS_PROTOCOL)) {\r\n        return true;\r\n    }\r\n\r\n    var host = extractHost(url);\r\n\r\n    if (domains[host]) {\r\n        var config = domains[host];\r\n        if (config.allowCors) {\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n\r\n    return window.location.host !== host;\r\n}","//GTW Location Manager\r\n\r\nimport * as Map from './gtw-map';\r\nimport * as Event from './gtw-event';\r\n\r\nconst LOCATION_MANAGER_CONVENTION_KEY = \"openeta-location-convention\";\r\n\r\nconst CONVENTION_ASK_EVERYTIME = \"CONVENTION_ASK_EVERYTIME\";\r\nconst CONVENTION_CUSTOM_LOCATION = \"CONVENTION_CUSTOM_LOCATION\";\r\nconst CONVENTION_ASK_LOCATION_ACCESS = \"CONVENTION_ASK_LOCATION_ACCESS\";\r\nconst CONVENTION_DIRECT_LOCATION_ACCESS = \"CONVENTION_DIRECT_LOCATION_ACCESS\";\r\n\r\nexport var watchId = 0;\r\n\r\nexport var markerId = 0;\r\n\r\nexport var currentPosition = { lat: 22.2952296, lng: 114.1766577 };\r\n\r\nvar located = false;\r\n\r\nvar error = false;\r\n\r\nexport function getConvention() {\r\n    var localStorage = window.localStorage;\r\n    if (!localStorage || !localStorage.getItem(LOCATION_MANAGER_CONVENTION_KEY)) {\r\n        return CONVENTION_ASK_EVERYTIME;\r\n    }\r\n    return localStorage.getItem(LOCATION_MANAGER_CONVENTION_KEY);\r\n}\r\n\r\nexport function setConvention(convention) {\r\n    var localStorage = window.localStorage;\r\n    if (!localStorage) {\r\n        return;\r\n    }\r\n    localStorage.setItem(LOCATION_MANAGER_CONVENTION_KEY, convention);\r\n}\r\n\r\nexport function requestLocationAccess(successFunc = function () { }, errorFunc = function () { }) {\r\n    if (!navigator.geolocation) {\r\n        errorFunc(ERROR_NOT_SUPPORTED);\r\n        return;\r\n    }\r\n\r\n    var global = this;\r\n\r\n    navigator.geolocation.getCurrentPosition(function (position) {\r\n        located = true;\r\n        currentPosition = {\r\n            lat: position.coords.latitude,\r\n            lng: position.coords.longitude\r\n        };\r\n\r\n        Map.setCenter(currentPosition);\r\n        Map.setZoom(16);\r\n\r\n        markerId = Map.addMarker(currentPosition, {\r\n            icon: \"img/star.png\"\r\n        });\r\n        Map.lockMarker(markerId);\r\n\r\n        watchId = navigator.geolocation.watchPosition(\r\n            onPositionChangeSuccess,\r\n            onPositionChangeError,\r\n            {\r\n                enableHighAccuracy: false,\r\n                timeout: 5000,\r\n                maximumAge: 0\r\n            }\r\n        );\r\n        Event.dispatchEvent(Event.EVENTS.EVENT_LOCATION_SUCCESS);\r\n        successFunc(currentPosition);\r\n    }, function (err) {\r\n        located = false;\r\n        error = err;\r\n        Event.dispatchEvent(Event.EVENTS.EVENT_LOCATION_ERROR, err);\r\n        errorFunc(err);\r\n    }, { timeout: 10000 });\r\n}\r\n\r\nexport function isLocated() {\r\n    return located;\r\n}\r\n\r\nexport function isErrored() {\r\n    return error !== false;\r\n}\r\n\r\nexport function getError() {\r\n    return error;\r\n}\r\n\r\nexport function getCurrentPosition() {\r\n    return currentPosition;\r\n}\r\n\r\nexport function onPositionChangeSuccess(position) {\r\n    currentPosition = {\r\n        lat: position.coords.latitude,\r\n        lng: position.coords.longitude\r\n    };\r\n    located = true;\r\n    error = false;\r\n    Map.setMarkerPosition(markerId, currentPosition);\r\n    Event.dispatchEvent(Event.EVENTS.EVENT_LOCATION_CHANGE, currentPosition);\r\n}\r\n\r\nexport function onPositionChangeError(err) {\r\n    located = false;\r\n    error = err;\r\n    Event.dispatchEvent(Event.EVENTS.EVENT_LOCATION_ERROR, err);\r\n}","//GTW Database\r\nimport Dexie from 'dexie';\r\n\r\nexport var db = new Dexie(\"gtw-db\");\r\n\r\ndb.version(2).stores({\r\n    \"pluginStorage\": \"package\",\r\n    \"transitReference\": \"[package+provider]\"\r\n});\r\n\r\nexport async function putPluginStorage(pkg, data) {\r\n    var clone = Object.assign({}, data);\r\n    return await db[\"pluginStorage\"].put({\r\n        \"package\": pkg,\r\n        data: clone\r\n    });\r\n};\r\n\r\nexport async function getPluginStorage(pkg) {\r\n    return await db[\"pluginStorage\"].where(\"package\")\r\n        .equals(pkg).first();\r\n}\r\n\r\nexport async function getTransitReference(pkg, provider) {\r\n    return await db[\"transitReference\"].where(\"[package+provider]\")\r\n        .equals([pkg, provider]).first();\r\n}\r\n\r\nexport async function putTransitReference(data) {\r\n    if (!data[\"package\"] || !data[\"provider\"]) {\r\n        console.error(\"Error: Database missing package or provider parameter(s).\");\r\n        return;\r\n    }\r\n    return await db[\"transitReference\"].put(data);\r\n}","// GTW Language\r\n\r\nimport * as Settings from './gtw-settings';\r\n\r\nexport const languages = {\r\n    \"en\": \"English\",\r\n    \"zh\": \"\\u7e41\\u9ad4\\u4e2d\\u6587\"\r\n};\r\n\r\nexport function translatedString(transStr) {\r\n    var lang = getLanguage();\r\n    var locale = getLocale();\r\n\r\n    for (var trans of transStr.translation) {\r\n        if (trans.language === lang) {\r\n            return trans.text;\r\n        }\r\n    }\r\n\r\n    for (var trans of transStr.translation) {\r\n        if (trans.language === locale || trans.language.split(\"-\")[0] === locale) {\r\n            return trans.text;\r\n        }\r\n    }\r\n\r\n    for (var trans of transStr.translation) {\r\n        if (trans.language === \"en\") {\r\n            return trans.text;\r\n        }\r\n    }\r\n\r\n    return false;\r\n}\r\n\r\nexport function localizedKey(localizedObject, key) {\r\n    var lang = getLanguage();\r\n    var locale = getLocale();\r\n\r\n    var langKey = key + \"_\" + lang;\r\n    var localeKey = key + \"_\" + locale;\r\n    var enKey = key + \"_en\";\r\n\r\n    if (localizedObject[langKey]) {\r\n        return localizedObject[langKey];\r\n    }\r\n\r\n    if (localizedObject[localeKey]) {\r\n        return localizedObject[localeKey];\r\n    }\r\n\r\n    if (localizedObject[enKey]) {\r\n        return localizedObject[enKey];\r\n    }\r\n\r\n    if (localizedObject[key]) {\r\n        return localizedObject[key];\r\n    }\r\n    return false;\r\n}\r\n\r\nexport function getLanguage() {\r\n    return Settings.get(\"preferred_language\", \"en\");\r\n};\r\n\r\nexport function getLocale() {\r\n    return Settings.get(\"preferred_language\", \"en\").split(\"-\")[0];\r\n};\r\n\r\nexport function changeLanguage(locale) {\r\n    var found = false;\r\n    for (var x in languages) {\r\n        if (locale === x) {\r\n            found = true;\r\n            break;\r\n        }\r\n    }\r\n    if (!found) {\r\n        return false;\r\n    }\r\n\r\n    Settings.set(\"preferred_language\", locale);\r\n    Settings.save();\r\n    $.i18n().locale = locale;\r\n    return import(`./i18n/${locale}.json`).then(function (module) {\r\n        $.i18n().load(module.default, locale);\r\n        $(\"body\").i18n();\r\n    });\r\n}","//City Data: Transit ETA\r\nimport * as Misc from './gtw-misc';\r\nimport * as Database from './gtw-db';\r\nimport { transit_realtime } from 'gtfs-realtime-bindings';\r\n\r\nvar providers = [];\r\n\r\nvar cache = {};\r\n\r\nexport function clearCache() {\r\n    cache = {};\r\n}\r\n\r\nexport function timeDifference(a, b) {\r\n    var x = a.hr * 60 + a.min;\r\n    var y = b.hr * 60 + b.min;\r\n    return x - y;\r\n}\r\n\r\nexport function registerProvider(pkg, id, etaProviders, provider) {\r\n    if (!provider.fetchEta || typeof provider.fetchEta !== \"function\" ||\r\n        !provider.fetchDatabase || typeof provider.fetchDatabase !== \"function\" ||\r\n        !provider.checkDatabaseUpdate || typeof provider.checkDatabaseUpdate !== \"function\") {\r\n        throw new Error(\"Error: \" + id + \" does not contain fetchEta, fetchDatabase or checkDatabaseUpdate function!\");\r\n    }\r\n\r\n    provider.pkg = pkg;\r\n    provider.id = id;\r\n    provider.etaProviders = etaProviders;\r\n    provider.db = false;\r\n\r\n    if (typeof name === \"object\") {\r\n        provider[\"name\"] = name[\"default\"];\r\n        for (var key in name) {\r\n            provider[\"name_\" + key] = name[key];\r\n        }\r\n    } else {\r\n        provider.name = name;\r\n    }\r\n\r\n    providers.push(provider);\r\n}\r\n\r\nexport function unregisterProvider(pkg, id) {\r\n    var found = -1;\r\n    for (var i = 0; i < providers.length; i++) {\r\n        if (providers[i].pkg === pkg && providers[i].id === id) {\r\n            found = i;\r\n        }\r\n    }\r\n    providers.splice(found, 1);\r\n}\r\n\r\nexport function getProviders() {\r\n    return providers;\r\n}\r\n\r\nexport function getProvider(pkg, id) {\r\n    for (var provider of providers) {\r\n        if (provider.pkg === pkg && provider.id === id) {\r\n            return provider;\r\n        }\r\n    }\r\n    return false;\r\n}\r\n\r\nexport function getEtaProvider(etaProvider) {\r\n    for (var provider of providers) {\r\n        if (provider.etaProviders.includes(etaProvider)){\r\n            return provider;\r\n        }\r\n    }\r\n    return false;\r\n}\r\n\r\nexport async function fetchAllDatabase(pc) {\r\n    var db;\r\n    for (var provider of providers) {\r\n        db = await Database.getTransitReference(provider.pkg, provider.id);\r\n        if (!db) {\r\n            continue;\r\n        }\r\n        provider.db = db;\r\n    }\r\n\r\n    var needs = {};\r\n    for (var provider of providers) {\r\n        if (provider.db) {\r\n            console.log(\"has db \" + provider.id);\r\n            try {\r\n                var needed = await new Promise((resolve, reject) => {\r\n                    provider.checkDatabaseUpdate(resolve, reject, provider.db.version);\r\n                });\r\n                console.log(\"update: \" + provider.id + \" \" + needed);\r\n                needs[provider.id] = needed;\r\n            } catch (err) {\r\n                console.error(\"Error: Database check update for \" + provider.id + \" failed!\");\r\n                needs[provider.id] = false;\r\n            }\r\n        } else {\r\n            console.log(\"No db found for \" + provider.id);\r\n            needs[provider.id] = true;\r\n        }\r\n    }\r\n    console.log(needs);\r\n    for (var provider of providers) {\r\n        if (needs[provider.id]) {\r\n            try {\r\n                var data = await new Promise((resolve, reject) => {\r\n                    provider.fetchDatabase(resolve, reject);\r\n                });\r\n                if (!data[\"package\"] || !data[\"provider\"] || !data.version) {\r\n                    console.error(\"Error: Returned reference database is missing version, package or provider parameter(s) for \" + (data.provider ? data.provider : \"unknown provider\") + \".\");\r\n                    return;\r\n                }\r\n                provider.db = data;\r\n                await Database.putTransitReference(data);\r\n            } catch (err) {\r\n                console.error(\"Error: Database fetch for \" + provider.id + \" failed!\");\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nexport function fetchEta(opt) {\r\n    if (!opt.agency || !opt.route || !opt.trip || !opt.stopTimes || !opt.stop) {\r\n        console.error(\"Error: Fetch ETA missing agency, route, trip or stop parameter.\");\r\n        return false;\r\n    }\r\n    return new Promise((resolve, reject) => {\r\n        var proms = [];\r\n        var count = 0;\r\n        for (var providerId of opt.etaProviders) {\r\n            proms.push(new Promise((resolve, reject) => {\r\n                var provider = getEtaProvider(providerId);\r\n\r\n                if (!provider) {\r\n                    resolve();\r\n                    console.log(\"Could not find registered Transit ETA provider with name \\\"\" + providerId + \"\\\"\");\r\n                    return;\r\n                }\r\n\r\n                count++;\r\n\r\n                var key = providerId + \"-\" + opt.route[\"route_id\"] + \"-\" + opt.trip[\"trip_id\"] + \"-\" + opt.stop[\"stop_id\"];\r\n                var cached = cache[key];\r\n                var now = new Date();\r\n\r\n                if (cached && (now - cached.lastFetched) > 30000) {\r\n                    cached = false;\r\n                    delete cache[key];\r\n                }\r\n\r\n                if (!cached) {\r\n                    var global = this;\r\n                    var p = new Promise((resolve, reject) => {\r\n                        provider.fetchEta(resolve, reject, opt);\r\n                    });\r\n                    p.then(function (feed) {\r\n                        var obj = transit_realtime.FeedMessage.fromObject(feed);\r\n                        var result = transit_realtime.FeedMessage.verify(obj);\r\n                        if (result !== null) {\r\n                            console.error(\"Error: Returned feed is invalid: \" + result);\r\n                            return;\r\n                        }\r\n\r\n                        var time = new Date();\r\n\r\n                        cache[key] = {\r\n                            lastFetched: time.getTime(),\r\n                            feed: obj\r\n                        };\r\n\r\n                        resolve(obj);\r\n                    }).catch(function (err) {\r\n                        reject(opt, err);\r\n                    });\r\n                } else {\r\n                    resolve(cached.feed);\r\n                }\r\n            }));\r\n        }\r\n        Promise.all(proms).then(function (feeds) {\r\n            if (count > 0) {\r\n                var out = [];\r\n                for (var feed of feeds) {\r\n                    if (feed && feed.header && feed.entity) {\r\n                        out.push(feed);\r\n                    }\r\n                }\r\n                resolve({\r\n                    feeds: out,\r\n                    options: opt,\r\n                    code: 0\r\n                })\r\n            } else if (opt.etaProviders && opt.etaProviders.length > 0) {\r\n                resolve({\r\n                    code: -2,\r\n                    options: opt\r\n                });\r\n            } else {\r\n                resolve({\r\n                    code: -1,\r\n                    options: opt\r\n                });\r\n            }\r\n        }).catch(reject);\r\n    });\r\n}\r\n\r\nexport function getCache() {\r\n    return cache;\r\n}","//GTW Request Limiter\r\n\r\nexport var requests = [];\r\n\r\nexport var duration = 500;\r\n\r\nexport var running = false;\r\n\r\nexport function queue(func, args) {\r\n    if (typeof func !== \"function\") {\r\n        throw new TypeError(\"The variable must be a 'function'.\");\r\n    }\r\n    requests.push([func, args]);\r\n    return func;\r\n}\r\n\r\nexport function stack(func, args) {\r\n    if (typeof func !== \"function\") {\r\n        throw new TypeError(\"The variable must be a 'function'.\");\r\n    }\r\n    requests.unshift([func, args]);\r\n    return func;\r\n}\r\n\r\nexport function start() {\r\n    if (running) {\r\n        return;\r\n    }\r\n\r\n    running = true;\r\n    dispatch();\r\n}\r\n\r\nexport function dispatch() {\r\n    var next = requests.shift();\r\n    var global = this;\r\n\r\n    if (next && typeof next[0] === 'function') {\r\n        next[0].apply(null, next[1]);\r\n    }\r\n\r\n    if (running) {\r\n        setTimeout(function () {\r\n            dispatch();\r\n        }, duration);\r\n    }\r\n}\r\n\r\nexport function stop() {\r\n    running = false;\r\n}\r\n\r\nexport function clear() {\r\n    requests = [];\r\n}","//GTW Platform Configuration\r\n\r\nexport default {\r\n    //\r\n    // Default Map API\r\n    //\r\n    // The map to be used in the UI, you can use:\r\n    //   - auto (Experimental. Prefers Google Map, fallback to Open Street Map)\r\n    //   - googlemap (Recommended)\r\n    //   - openstreetmap\r\n    mapApi: \"googlemap\",\r\n\r\n    //\r\n    // Google Map API Key\r\n    //\r\n    // You have to create an API key from the Google Cloud Console to\r\n    // use Google Map features. The default one only works on the\r\n    // official server.\r\n    googleMapApiKey: \"AIzaSyAhU7FqH46IdF4RaHrBlABfkoFlHZeudFg\"\r\n};","var onClickListeners = [];\r\n\r\n$(\".touch-keypad-function-done\").on(\"click\", mouseClickTouchKeypadValue);\r\n$(\".touch-keypad-function-backspace\").on(\"click\", mouseClickTouchKeypadValue);\r\n$(\".touch-keypad-value\").on(\"click\", mouseClickTouchKeypadValue);\r\n\r\nfunction mouseClickTouchKeypadValue() {\r\n    $(this).blur();\r\n    if ($(this).hasClass(\"disabled\")) {\r\n        return;\r\n    }\r\n    for (var listener of onClickListeners) {\r\n        listener(this);\r\n    }\r\n}\r\n\r\nexport function reset() {\r\n    $(\".numeric-keypad .touch-keypad-value\").each(function () {\r\n        $(this).removeClass(\"disabled\");\r\n        $(this).removeClass(\"btn-secondary\");\r\n        $(this).addClass(\"btn-outline-secondary\");\r\n    });\r\n}\r\n\r\nexport function showTouchKeypad() {\r\n    $(\".touch-keypad\").css(\"display\", \"flex\");\r\n    adjustMargin();\r\n}\r\n\r\nexport function hideTouchKeypad() {\r\n    $(\".touch-keypad\").css(\"display\", \"\");\r\n    adjustMargin();\r\n}\r\n\r\nexport function addListener(listener) {\r\n    if (typeof listener !== \"function\") {\r\n        return false;\r\n    }\r\n    onClickListeners.push(listener);\r\n    return true;\r\n}\r\n\r\nexport function removeListener(listener) {\r\n    if (typeof listener !== \"function\") {\r\n        return false;\r\n    }\r\n    var index = onClickListeners.indexOf(listener);\r\n    if (index !== -1) {\r\n        onClickListeners.splice(index, 1);\r\n        return true;\r\n    }\r\n    return false;\r\n}\r\n\r\nexport function enableFunctionKeys() {\r\n    $(\".touch-keypad-function\").removeClass(\"disabled\");\r\n}\r\n\r\nexport function disableFunctionKeys() {\r\n    $(\".touch-keypad-function\").addClass(\"disabled\");\r\n}\r\n\r\nexport function setEnabled(keyMap) {\r\n    $(\".numeric-keypad .touch-keypad-value\").each(function () {\r\n        var val = $(this).html();\r\n        if (!keyMap[val]) {\r\n            $(this).addClass(\"disabled\");\r\n            $(this).addClass(\"btn-secondary\");\r\n            $(this).removeClass(\"btn-outline-secondary\");\r\n        } else {\r\n            $(this).removeClass(\"disabled\");\r\n            $(this).removeClass(\"btn-secondary\");\r\n            $(this).addClass(\"btn-outline-secondary\");\r\n        }\r\n        delete keyMap[val];\r\n    });\r\n\r\n    var keys = Object.keys(keyMap);\r\n    keys.sort(function (a, b) {\r\n        return a.charCodeAt(0) - b.charCodeAt(0);\r\n    });\r\n\r\n    var letterKeypadHtml = \"\";\r\n    for (var key of keys) {\r\n        letterKeypadHtml += \"<button type=\\\"button\\\" class=\\\"btn btn-outline-secondary py-3 touch-keypad-key touch-keypad-value\\\">\" + key + \"</button>\";\r\n    }\r\n    $(\".letter-keypad\").html(letterKeypadHtml);\r\n\r\n    $(\".letter-keypad .touch-keypad-value\").on(\"click\", mouseClickTouchKeypadValue);\r\n}","var map = {\n\t\"./jquery.i18n\": 70,\n\t\"./jquery.i18n.emitter\": 71,\n\t\"./jquery.i18n.emitter.bidi\": 72,\n\t\"./jquery.i18n.emitter.bidi.js\": 72,\n\t\"./jquery.i18n.emitter.js\": 71,\n\t\"./jquery.i18n.fallbacks\": 73,\n\t\"./jquery.i18n.fallbacks.js\": 73,\n\t\"./jquery.i18n.js\": 70,\n\t\"./jquery.i18n.language\": 74,\n\t\"./jquery.i18n.language.js\": 74,\n\t\"./jquery.i18n.messagestore\": 75,\n\t\"./jquery.i18n.messagestore.js\": 75,\n\t\"./jquery.i18n.parser\": 76,\n\t\"./jquery.i18n.parser.js\": 76,\n\t\"./languages/bs\": 77,\n\t\"./languages/bs.js\": 77,\n\t\"./languages/dsb\": 78,\n\t\"./languages/dsb.js\": 78,\n\t\"./languages/fi\": 79,\n\t\"./languages/fi.js\": 79,\n\t\"./languages/ga\": 80,\n\t\"./languages/ga.js\": 80,\n\t\"./languages/he\": 81,\n\t\"./languages/he.js\": 81,\n\t\"./languages/hsb\": 82,\n\t\"./languages/hsb.js\": 82,\n\t\"./languages/hu\": 83,\n\t\"./languages/hu.js\": 83,\n\t\"./languages/hy\": 84,\n\t\"./languages/hy.js\": 84,\n\t\"./languages/la\": 85,\n\t\"./languages/la.js\": 85,\n\t\"./languages/ml\": 86,\n\t\"./languages/ml.js\": 86,\n\t\"./languages/os\": 87,\n\t\"./languages/os.js\": 87,\n\t\"./languages/ru\": 88,\n\t\"./languages/ru.js\": 88,\n\t\"./languages/sl\": 89,\n\t\"./languages/sl.js\": 89,\n\t\"./languages/uk\": 90,\n\t\"./languages/uk.js\": 90\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 147;","var content = require(\"!!../node_modules/css-loader/dist/cjs.js!./style.css\");\n\nif (typeof content === 'string') {\n  content = [[module.id, content, '']];\n}\n\nvar options = {}\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = require(\"!../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\")(content, options);\n\nif (content.locals) {\n  module.exports = content.locals;\n}\n","exports = module.exports = require(\"../node_modules/css-loader/dist/runtime/api.js\")(false);\n// Module\nexports.push([module.id, \"body {\\r\\n    width: 100%;\\r\\n    height: 100vh;\\r\\n    /* overflow: hidden; */\\r\\n    position: absolute;\\r\\n}\\r\\n\\r\\n.landscape-notice {\\r\\n    display: none;\\r\\n    width: 100%;\\r\\n    height: 100%;\\r\\n    background-color: white;\\r\\n    z-index: 5;\\r\\n    position: relative;\\r\\n    padding: 12%;\\r\\n    font-weight: bold;\\r\\n}\\r\\n\\r\\n/* Update Change-log */\\r\\n\\r\\n.build-version {\\r\\n    position: absolute;\\r\\n    top: 0;\\r\\n    right: 0;\\r\\n    z-index: 5;\\r\\n    padding-top: env(safe-area-inset-top);\\r\\n    margin: 1rem;\\r\\n}\\r\\n\\r\\n#updated-changelog {\\r\\n    white-space: normal;\\r\\n}\\r\\n\\r\\n/* Toast */\\r\\n\\r\\n.toast-stack-container {\\r\\n    position: absolute;\\r\\n    top: 0;\\r\\n    right: 0;\\r\\n    width: 100%;\\r\\n}\\r\\n\\r\\n#gtw-toast-stack {\\r\\n    position: absolute;\\r\\n    top: 0;\\r\\n    right: 0;\\r\\n    margin: 1rem;\\r\\n    z-index: 3;\\r\\n}\\r\\n\\r\\n/* Startup DIV CSS */\\r\\n\\r\\n.startup {\\r\\n    position: absolute;\\r\\n    top: 0;\\r\\n    background-color: white;\\r\\n    width: 100%;\\r\\n    height: 100%;\\r\\n    overflow: hidden;\\r\\n    z-index: 4;\\r\\n}\\r\\n\\r\\n.startup .container {\\r\\n    display: none;\\r\\n    position: relative;\\r\\n}\\r\\n\\r\\n.progress-panel {\\r\\n    position: absolute;\\r\\n    text-align: center;\\r\\n    width: 100%;\\r\\n    bottom: 0px;\\r\\n    z-index: 2;\\r\\n}\\r\\n\\r\\n.progress {\\r\\n    border-radius: 0px;\\r\\n}\\r\\n\\r\\n.bg-loaddb-panel {\\r\\n    display: none;\\r\\n}\\r\\n\\r\\n.request-progress-panel {\\r\\n    position: absolute;\\r\\n    text-align: center;\\r\\n    width: 100%;\\r\\n    left: 0px;\\r\\n    bottom: 0px;\\r\\n    display: none;\\r\\n}\\r\\n\\r\\n.startup .overlay {\\r\\n    position: absolute;\\r\\n    top: 0;\\r\\n    height: 100%;\\r\\n    width: 100%;\\r\\n    background-color: white;\\r\\n    opacity: 0.5;\\r\\n    z-index: 1;\\r\\n}\\r\\n\\r\\n.startup .progress-panel {\\r\\n    display: none;\\r\\n}\\r\\n\\r\\n/* Getting Started Panel */\\r\\n.getting-started-panel {\\r\\n    display: none;\\r\\n    padding: 1rem;\\r\\n    position: absolute;\\r\\n    z-index: 1;\\r\\n    width: 100%;\\r\\n    height: 100%;\\r\\n}\\r\\n\\r\\n.getting-started-panel p.app-title {\\r\\n    margin-top: 0.8125rem;\\r\\n    margin-left: 1rem;\\r\\n    margin-bottom: 0.8125rem;\\r\\n    white-space: nowrap;\\r\\n    line-height: inherit;\\r\\n    font-size: 1.25rem;\\r\\n}\\r\\n\\r\\n#gettingStartedWizard {\\r\\n    margin-top: 2rem;\\r\\n    background-color: white;\\r\\n    padding: 1rem;\\r\\n    width: 100%;\\r\\n}\\r\\n\\r\\n#gettingStartedWizard ul {\\r\\n    flex-wrap: nowrap;\\r\\n    overflow-x: auto;\\r\\n    overflow-y: hidden;\\r\\n}\\r\\n\\r\\n.getting-started-progress-panel {\\r\\n    display: none;\\r\\n}\\r\\n\\r\\n.getting-started-progress-panel .progress-panel {\\r\\n    text-align: center;\\r\\n}\\r\\n\\r\\n.getting-started-plugin-error-panel{\\r\\n    display: none;\\r\\n}\\r\\n\\r\\n/* Navigation CSS */\\r\\n\\r\\n.select-location-field {\\r\\n    background-color: #fff!important;\\r\\n}\\r\\n\\r\\n/* ETA CSS */\\r\\n.bg-trans {\\r\\n    background-color: unset;\\r\\n}\\r\\n\\r\\n.split-map-container {\\r\\n    display: none;\\r\\n    width: 100%;\\r\\n    position: absolute;\\r\\n    overflow-x: hidden;\\r\\n    overflow-y: scroll;\\r\\n    z-index: 2;\\r\\n}\\r\\n\\r\\n.container {\\r\\n    padding: 0px;\\r\\n}\\r\\n\\r\\n.content-panel-container {\\r\\n\\r\\n}\\r\\n\\r\\n.item-list {\\r\\n    height: inherit;\\r\\n}\\r\\n\\r\\n.item-list .list-group {\\r\\n    width: 100%;\\r\\n    height: inherit;\\r\\n    overflow-x: hidden;\\r\\n    overflow-y: scroll;\\r\\n    z-index: 1;\\r\\n}\\r\\n\\r\\n.item-list .list-group li {\\r\\n    min-height: 100px;\\r\\n}\\r\\n\\r\\n.all-route-list {\\r\\n    display: none;\\r\\n}\\r\\n\\r\\n.stop-eta tr.active {\\r\\n    font-size: 18px;\\r\\n    font-weight: bold;\\r\\n}\\r\\n\\r\\n/* Map CSS */\\r\\n\\r\\n#gtw-map {\\r\\n    width: 100vw;\\r\\n    height: 100vh;\\r\\n    top: 0px;\\r\\n    left: 0px;\\r\\n    position: fixed;\\r\\n    overflow: hidden;\\r\\n}\\r\\n\\r\\n/* Search panel CSS */\\r\\n\\r\\n.top-panel {\\r\\n    padding: 8px;\\r\\n    margin-bottom: 0px;\\r\\n    background-color: unset;\\r\\n}\\r\\n\\r\\n.top-panel .tabs, .hori-scroll {\\r\\n    overflow: auto;\\r\\n    white-space: nowrap;\\r\\n    display: block;\\r\\n    padding: 4px;\\r\\n}\\r\\n\\r\\n.top-panel .tabs .ui-tab, .hori-scroll button {\\r\\n    display: inline-block;\\r\\n}\\r\\n\\r\\n#loc-status-btn {\\r\\n    margin-top: env(safe-area-inset-top);\\r\\n    margin-bottom: env(safe-area-inset-bottom);\\r\\n    position: fixed;\\r\\n    z-index: 3;\\r\\n    right: 4px;\\r\\n    bottom: 4px;\\r\\n}\\r\\n\\r\\n/* Header, footer CSS */\\r\\n\\r\\n.gtw-container {\\r\\n    position: fixed;\\r\\n    top: 0;\\r\\n    width: 100%;\\r\\n    z-index: 1;\\r\\n}\\r\\n\\r\\n/*\\r\\n.header nav {\\r\\n    background-color: #343a40\\r\\n}\\r\\n*/\\r\\n\\r\\n.footer {\\r\\n    padding-top: 8px;\\r\\n    padding-bottom: 0px;\\r\\n    position: fixed;\\r\\n    bottom: 0;\\r\\n    z-index: 2;\\r\\n    width: 100%;\\r\\n}\\r\\n\\r\\n.map-overlay {\\r\\n    position: fixed;\\r\\n    width: 100%;\\r\\n    height: 100%;\\r\\n    top: 0;\\r\\n    left: 0;\\r\\n    right: 0;\\r\\n    bottom: 0;\\r\\n    background-color: rgba(233,236,239,0.8);\\r\\n    z-index: 1;\\r\\n    cursor: pointer;\\r\\n}\\r\\n\\r\\n/* Loading Overlay CSS */\\r\\n\\r\\n.loading-overlay {\\r\\n    position: fixed;\\r\\n    display: none;\\r\\n    width: 100%;\\r\\n    height: 100%;\\r\\n    top: 0;\\r\\n    left: 0;\\r\\n    right: 0;\\r\\n    bottom: 0;\\r\\n    background-color: rgba(0,0,0,0.3);\\r\\n    z-index: 3;\\r\\n    opacity: 100;\\r\\n    cursor: pointer;\\r\\n}\\r\\n\\r\\n.loading-overlay .loading-spinner {\\r\\n    width: 100%;\\r\\n    height: 100%;\\r\\n}\\r\\n\\r\\n.loading-overlay .spinner-border {\\r\\n    width: 3rem;\\r\\n    height: 3rem;\\r\\n}\\r\\n\\r\\n/* Touch Keypad */\\r\\n\\r\\n.touch-keypad {\\r\\n    position: fixed;\\r\\n    left: 0;\\r\\n    bottom: 0;\\r\\n    width: 100%;\\r\\n    margin: 0px;\\r\\n    padding: 0px;\\r\\n    z-index: 2;\\r\\n    background: rgba(255, 255, 255, 0.4);\\r\\n    display: none;\\r\\n    padding-bottom: env(safe-area-inset-bottom);\\r\\n}\\r\\n\\r\\n.touch-keypad .numeric-keypad {\\r\\n    width: 75%;\\r\\n}\\r\\n\\r\\n.touch-keypad .letter-keypad {\\r\\n    width: 25%;\\r\\n    overflow-x: hidden;\\r\\n    overflow-y: auto;\\r\\n    white-space: nowrap;\\r\\n    justify-content: flex-start;\\r\\n}\\r\\n\\r\\n.touch-keypad-key {\\r\\n    min-height: 58px;\\r\\n}\\r\\n\\r\\n/* Route selection */\\r\\n\\r\\n.route-selection .route-id {\\r\\n    padding-right: 16px;\\r\\n    font-weight: bold;\\r\\n}\\r\\n\\r\\n.route-selection .stop-info {\\r\\n    margin-left: 8px;\\r\\n    margin-right: 8px;\\r\\n}\\r\\n\\r\\n.route-selection .stop-info .badge {\\r\\n\\r\\n}\\r\\n\\r\\n.route-selection .stop-info .col-sm-12{\\r\\n    white-space: nowrap;\\r\\n    overflow: hidden;\\r\\n    text-overflow: ellipsis; \\r\\n    width: inherit;\\r\\n}\\r\\n\\r\\n/* Search Transit Field */\\r\\n\\r\\n#search-transit-text {\\r\\n    background-color: #fff;\\r\\n}\\r\\n\\r\\n/* split-map Panel */\\r\\n.split-map-panel {\\r\\n    display: none;\\r\\n    background-color: unset;\\r\\n    padding: 8px;\\r\\n    margin-bottom: 0px;\\r\\n    position: relative;\\r\\n    z-index: 1;\\r\\n}\\r\\n\\r\\n.mobile-split-container {\\r\\n    /*margin-top: 50vh;*/\\r\\n    display: none;\\r\\n    position: fixed;\\r\\n    left: 0;\\r\\n    bottom: 0;\\r\\n    width: 100%;\\r\\n    height: 80%;\\r\\n    padding: 0px;\\r\\n    background-color: rgba(233,236,239,0.8);\\r\\n}\\r\\n\\r\\n/* Route list */\\r\\n\\r\\n.view-alert-btn {\\r\\n    font-size: inherit;\\r\\n    padding: 0px;\\r\\n}\\r\\n\\r\\n/* Media Query */\\r\\n@media only screen and (min-width: 768px) {\\r\\n    .top-panel {\\r\\n        /*width: 25%;*/\\r\\n    }\\r\\n\\r\\n    .split-map-panel {\\r\\n        /*width: 25%;*/\\r\\n    }\\r\\n\\r\\n    .split-map-container {\\r\\n        /*width: 25%;*/\\r\\n        margin-left: 0;\\r\\n    }\\r\\n\\r\\n    .content-panel-container {\\r\\n        /*width: 25%;*/\\r\\n        margin-left: 0;\\r\\n    }\\r\\n\\r\\n    .request-progress-panel {\\r\\n        width: 25%;\\r\\n    }\\r\\n\\r\\n    #gtw-map {\\r\\n        width: 100vw;\\r\\n        /*width: 75%;\\r\\n        margin-left: 25%;*/\\r\\n    }\\r\\n\\r\\n    .gtw-container {\\r\\n        width: 25%;\\r\\n    }\\r\\n\\r\\n    .map-overlay {\\r\\n        width: 25%;\\r\\n        /*display: none;*/\\r\\n    }\\r\\n\\r\\n    .touch-keypad {\\r\\n        width: 25%;\\r\\n    }\\r\\n\\r\\n    .getting-started-panel {\\r\\n        /*width: 25%;*/\\r\\n    }\\r\\n\\r\\n    .desktop.split-map-panel.gtw-split-map {\\r\\n        display: block;\\r\\n    }\\r\\n\\r\\n    .desktop.split-map-container.gtw-split-map {\\r\\n        display: block;\\r\\n    }\\r\\n\\r\\n    .mobile.split-map-panel.gtw-split-map {\\r\\n        display: none;\\r\\n    }\\r\\n\\r\\n    .mobile.split-map-container.gtw-split-map {\\r\\n        display: none;\\r\\n    }\\r\\n}\\r\\n\\r\\n@media only screen and (max-width: 768px) {\\r\\n    .gtw-container nav {\\r\\n        margin-top: env(safe-area-inset-top);\\r\\n        background-color: unset;\\r\\n    }\\r\\n\\r\\n    .toast-stack-container {\\r\\n        margin-top: env(safe-area-inset-top);\\r\\n        margin-bottom: env(safe-area-inset-bottom);\\r\\n    }\\r\\n\\r\\n    .getting-started-panel {\\r\\n        padding-top: env(safe-area-inset-top);\\r\\n        padding-bottom: env(safe-area-inset-bottom);\\r\\n    }\\r\\n\\r\\n    .modal {\\r\\n        padding-top: env(safe-area-inset-top);\\r\\n        padding-bottom: env(safe-area-inset-bottom);\\r\\n    }\\r\\n\\r\\n    .mobile-split-container.gtw-split-map {\\r\\n        display: block;\\r\\n    }\\r\\n\\r\\n    .startup .progress-panel {\\r\\n        padding-bottom: env(safe-area-inset-bottom);\\r\\n    }\\r\\n\\r\\n    /*\\r\\n    body.gtw-split-map {\\r\\n        overflow-y: scroll;\\r\\n    }\\r\\n\\r\\n    #gtw-map {\\r\\n        display: none;\\r\\n    }\\r\\n    */\\r\\n\\r\\n    .map-overlay.gtw-split-map {\\r\\n        display: none;\\r\\n        /*margin-top: 50vh;\\r\\n        height: 50vh;*/\\r\\n    }\\r\\n\\r\\n    /*\\r\\n    #gtw-map.gtw-split-map {\\r\\n        height: 50vh;\\r\\n        display: block;\\r\\n    }\\r\\n    */\\r\\n\\r\\n    .desktop.split-map-panel.gtw-split-map {\\r\\n        display: none;\\r\\n    }\\r\\n\\r\\n    .desktop.split-map-container.gtw-split-map {\\r\\n        display: none;\\r\\n    }\\r\\n\\r\\n    .mobile.split-map-panel.gtw-split-map {\\r\\n        display: block;\\r\\n        /*height: 20vh;*/\\r\\n    }\\r\\n\\r\\n    .mobile.split-map-container.gtw-split-map {\\r\\n        display: block;\\r\\n        /*height: 30vh;*/\\r\\n        height: inherit;\\r\\n    }\\r\\n}\\r\\n\\r\\n/*\\r\\n@media only screen and (max-height: 768px) and (orientation: landscape) {\\r\\n    .landscape-notice {\\r\\n        display: block;\\r\\n    }\\r\\n}\\r\\n*/\\r\\n\\r\\n@media screen and (max-width: 470px) {\\r\\n    .startup h1 {\\r\\n        font-size: 10vw;\\r\\n    }\\r\\n}\\r\\n\\r\\n@media (prefers-color-scheme: dark) {\\r\\n    .map-overlay {\\r\\n        background-color: rgba(150, 150, 150, 0.8);\\r\\n    }\\r\\n\\r\\n    .mobile-split-container {\\r\\n        background-color: rgba(150, 150, 150, 0.8);\\r\\n    }\\r\\n\\r\\n    .list-group-item-light {\\r\\n        background-color: #dadada;\\r\\n    }\\r\\n    \\r\\n    #search-transit-text {\\r\\n        background-color: #ececec;\\r\\n    }\\r\\n\\r\\n    .btn, .btn-link, a {\\r\\n        color: #fff;\\r\\n    }\\r\\n\\r\\n    /*\\r\\n    .timeline-icon {\\r\\n        background: #a9a9a9;\\r\\n        color: #fff;\\r\\n    }\\r\\n\\r\\n    .timeline-icon.bg-light {\\r\\n        background-color: #a9a9a9!important;\\r\\n    }\\r\\n\\r\\n    .timeline-label {\\r\\n        background: #a9a9a9!important;\\r\\n    }\\r\\n\\r\\n    .timeline-label p{\\r\\n        color: #fff!important;\\r\\n    }\\r\\n    */\\r\\n\\r\\n    .startup {\\r\\n        background-color: #000;\\r\\n        color: #fff;\\r\\n    }\\r\\n\\r\\n    .build-version{\\r\\n        color: #fff;\\r\\n    }\\r\\n\\r\\n    .text-dark {\\r\\n        color: #fff!important;\\r\\n    }\\r\\n\\r\\n    #gettingStartedWizard {\\r\\n        background-color: #989898;\\r\\n    }\\r\\n\\r\\n    #gettingStartedWizard .nav-tabs{\\r\\n        border-bottom: unset;\\r\\n    }\\r\\n\\r\\n    #gettingStartedWizard li.active {\\r\\n        color: #ffffff!important;\\r\\n    }\\r\\n\\r\\n    #gettingStartedWizard li.done {\\r\\n        color: #cecece!important;\\r\\n    }\\r\\n\\r\\n    #gettingStartedWizard .step-content {\\r\\n        background-color: #989898;\\r\\n        color: #fff;\\r\\n    }\\r\\n\\r\\n    #gettingStartedWizard .sw-toolbar {\\r\\n        background-color: #989898;\\r\\n    }\\r\\n    \\r\\n}\", \"\"]);\n","var content = require(\"!!../node_modules/css-loader/dist/cjs.js!./timeline.css\");\n\nif (typeof content === 'string') {\n  content = [[module.id, content, '']];\n}\n\nvar options = {}\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = require(\"!../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\")(content, options);\n\nif (content.locals) {\n  module.exports = content.locals;\n}\n","exports = module.exports = require(\"../node_modules/css-loader/dist/runtime/api.js\")(false);\n// Module\nexports.push([module.id, \"\\r\\nimg {\\r\\n    vertical-align: middle;\\r\\n}\\r\\n\\r\\n.img-responsive {\\r\\n    display: block;\\r\\n    height: auto;\\r\\n    max-width: 100%;\\r\\n}\\r\\n\\r\\n.img-rounded {\\r\\n    border-radius: 3px;\\r\\n}\\r\\n\\r\\n.img-thumbnail {\\r\\n    background-color: #fff;\\r\\n    border: 1px solid #ededf0;\\r\\n    border-radius: 3px;\\r\\n    display: inline-block;\\r\\n    height: auto;\\r\\n    line-height: 1.428571429;\\r\\n    max-width: 100%;\\r\\n    moz-transition: all .2s ease-in-out;\\r\\n    o-transition: all .2s ease-in-out;\\r\\n    padding: 2px;\\r\\n    transition: all .2s ease-in-out;\\r\\n    webkit-transition: all .2s ease-in-out;\\r\\n}\\r\\n\\r\\n.img-circle {\\r\\n    border-radius: 50%;\\r\\n}\\r\\n\\r\\n.timeline-centered {\\r\\n    position: relative;\\r\\n    margin-bottom: 30px;\\r\\n}\\r\\n\\r\\n    .timeline-centered:before, .timeline-centered:after {\\r\\n        content: \\\" \\\";\\r\\n        display: table;\\r\\n    }\\r\\n\\r\\n    .timeline-centered:after {\\r\\n        clear: both;\\r\\n    }\\r\\n\\r\\n    .timeline-centered:before, .timeline-centered:after {\\r\\n        content: \\\" \\\";\\r\\n        display: table;\\r\\n    }\\r\\n\\r\\n    .timeline-centered:after {\\r\\n        clear: both;\\r\\n    }\\r\\n\\r\\n    .timeline-centered:before {\\r\\n        content: '';\\r\\n        position: absolute;\\r\\n        display: block;\\r\\n        width: 4px;\\r\\n        background: #f5f5f6;\\r\\n        /*left: 50%;*/\\r\\n        top: 20px;\\r\\n        bottom: 20px;\\r\\n        margin-left: 30px;\\r\\n    }\\r\\n\\r\\n    .timeline-centered .timeline-entry {\\r\\n        position: relative;\\r\\n        /*width: 50%;\\r\\n        float: right;*/\\r\\n        margin-top: 5px;\\r\\n        margin-left: 30px;\\r\\n        margin-bottom: 10px;\\r\\n        clear: both;\\r\\n    }\\r\\n\\r\\n        .timeline-centered .timeline-entry:before, .timeline-centered .timeline-entry:after {\\r\\n            content: \\\" \\\";\\r\\n            display: table;\\r\\n        }\\r\\n\\r\\n        .timeline-centered .timeline-entry:after {\\r\\n            clear: both;\\r\\n        }\\r\\n\\r\\n        .timeline-centered .timeline-entry:before, .timeline-centered .timeline-entry:after {\\r\\n            content: \\\" \\\";\\r\\n            display: table;\\r\\n        }\\r\\n\\r\\n        .timeline-centered .timeline-entry:after {\\r\\n            clear: both;\\r\\n        }\\r\\n\\r\\n        .timeline-centered .timeline-entry.begin {\\r\\n            margin-bottom: 0;\\r\\n        }\\r\\n\\r\\n        .timeline-centered .timeline-entry.left-aligned {\\r\\n            float: left;\\r\\n        }\\r\\n\\r\\n            .timeline-centered .timeline-entry.left-aligned .timeline-entry-inner {\\r\\n                margin-left: 0;\\r\\n                margin-right: -18px;\\r\\n            }\\r\\n\\r\\n                .timeline-centered .timeline-entry.left-aligned .timeline-entry-inner .timeline-time {\\r\\n                    left: auto;\\r\\n                    right: -100px;\\r\\n                    text-align: left;\\r\\n                }\\r\\n\\r\\n                .timeline-centered .timeline-entry.left-aligned .timeline-entry-inner .timeline-icon {\\r\\n                    float: right;\\r\\n                }\\r\\n\\r\\n                .timeline-centered .timeline-entry.left-aligned .timeline-entry-inner .timeline-label {\\r\\n                    margin-left: 0;\\r\\n                    margin-right: 70px;\\r\\n                }\\r\\n\\r\\n                    .timeline-centered .timeline-entry.left-aligned .timeline-entry-inner .timeline-label:after {\\r\\n                        left: auto;\\r\\n                        right: 0;\\r\\n                        margin-left: 0;\\r\\n                        margin-right: -9px;\\r\\n                        -moz-transform: rotate(180deg);\\r\\n                        -o-transform: rotate(180deg);\\r\\n                        -webkit-transform: rotate(180deg);\\r\\n                        -ms-transform: rotate(180deg);\\r\\n                        transform: rotate(180deg);\\r\\n                    }\\r\\n\\r\\n        .timeline-centered .timeline-entry .timeline-entry-inner {\\r\\n            position: relative;\\r\\n            margin-left: -20px;\\r\\n        }\\r\\n\\r\\n            .timeline-centered .timeline-entry .timeline-entry-inner:before, .timeline-centered .timeline-entry .timeline-entry-inner:after {\\r\\n                content: \\\" \\\";\\r\\n                display: table;\\r\\n            }\\r\\n\\r\\n            .timeline-centered .timeline-entry .timeline-entry-inner:after {\\r\\n                clear: both;\\r\\n            }\\r\\n\\r\\n            .timeline-centered .timeline-entry .timeline-entry-inner:before, .timeline-centered .timeline-entry .timeline-entry-inner:after {\\r\\n                content: \\\" \\\";\\r\\n                display: table;\\r\\n            }\\r\\n\\r\\n            .timeline-centered .timeline-entry .timeline-entry-inner:after {\\r\\n                clear: both;\\r\\n            }\\r\\n\\r\\n            .timeline-centered .timeline-entry .timeline-entry-inner .timeline-time {\\r\\n                position: absolute;\\r\\n                left: -100px;\\r\\n                text-align: right;\\r\\n                padding: 10px;\\r\\n                -webkit-box-sizing: border-box;\\r\\n                -moz-box-sizing: border-box;\\r\\n                box-sizing: border-box;\\r\\n            }\\r\\n\\r\\n                .timeline-centered .timeline-entry .timeline-entry-inner .timeline-time > span {\\r\\n                    display: block;\\r\\n                }\\r\\n\\r\\n                    .timeline-centered .timeline-entry .timeline-entry-inner .timeline-time > span:first-child {\\r\\n                        font-size: 15px;\\r\\n                        font-weight: bold;\\r\\n                    }\\r\\n\\r\\n                    .timeline-centered .timeline-entry .timeline-entry-inner .timeline-time > span:last-child {\\r\\n                        font-size: 12px;\\r\\n                    }\\r\\n\\r\\n            .timeline-centered .timeline-entry .timeline-entry-inner .timeline-icon {\\r\\n                background: #fff;\\r\\n                color: #737881;\\r\\n                display: block;\\r\\n                width: 40px;\\r\\n                height: 40px;\\r\\n                -webkit-background-clip: padding-box;\\r\\n                -moz-background-clip: padding;\\r\\n                background-clip: padding-box;\\r\\n                -webkit-border-radius: 20px;\\r\\n                -moz-border-radius: 20px;\\r\\n                border-radius: 20px;\\r\\n                text-align: center;\\r\\n                -moz-box-shadow: 0 0 0 5px #f5f5f6;\\r\\n                -webkit-box-shadow: 0 0 0 5px #f5f5f6;\\r\\n                box-shadow: 0 0 0 5px #f5f5f6;\\r\\n                line-height: 40px;\\r\\n                font-size: 15px;\\r\\n                float: left;\\r\\n            }\\r\\n\\r\\n                .timeline-centered .timeline-entry .timeline-entry-inner .timeline-icon.bg-primary {\\r\\n                    background-color: #303641;\\r\\n                    color: #fff;\\r\\n                }\\r\\n\\r\\n                .timeline-centered .timeline-entry .timeline-entry-inner .timeline-icon.bg-secondary {\\r\\n                    background-color: #ee4749;\\r\\n                    color: #fff;\\r\\n                }\\r\\n\\r\\n                .timeline-centered .timeline-entry .timeline-entry-inner .timeline-icon.bg-success {\\r\\n                    background-color: #00a651;\\r\\n                    color: #fff;\\r\\n                }\\r\\n\\r\\n                .timeline-centered .timeline-entry .timeline-entry-inner .timeline-icon.bg-info {\\r\\n                    background-color: #21a9e1;\\r\\n                    color: #fff;\\r\\n                }\\r\\n\\r\\n                .timeline-centered .timeline-entry .timeline-entry-inner .timeline-icon.bg-warning {\\r\\n                    background-color: #fad839;\\r\\n                    color: #fff;\\r\\n                }\\r\\n\\r\\n                .timeline-centered .timeline-entry .timeline-entry-inner .timeline-icon.bg-danger {\\r\\n                    background-color: #cc2424;\\r\\n                    color: #fff;\\r\\n                }\\r\\n\\r\\n            .timeline-centered .timeline-entry .timeline-entry-inner .timeline-label {\\r\\n                position: relative;\\r\\n                background: #f5f5f6;\\r\\n                padding: 1em;\\r\\n                margin-left: 60px;\\r\\n                -webkit-background-clip: padding-box;\\r\\n                -moz-background-clip: padding;\\r\\n                background-clip: padding-box;\\r\\n                -webkit-border-radius: 3px;\\r\\n                -moz-border-radius: 3px;\\r\\n                border-radius: 3px;\\r\\n            }\\r\\n\\r\\n                .timeline-centered .timeline-entry .timeline-entry-inner .timeline-label:after {\\r\\n                    content: '';\\r\\n                    display: block;\\r\\n                    position: absolute;\\r\\n                    width: 0;\\r\\n                    height: 0;\\r\\n                    border-style: solid;\\r\\n                    border-width: 9px 9px 9px 0;\\r\\n                    border-color: transparent #f5f5f6 transparent transparent;\\r\\n                    left: 0;\\r\\n                    top: 10px;\\r\\n                    margin-left: -9px;\\r\\n                }\\r\\n\\r\\n                .timeline-centered .timeline-entry .timeline-entry-inner .timeline-label h2, .timeline-centered .timeline-entry .timeline-entry-inner .timeline-label p {\\r\\n                    color: #737881;\\r\\n                    font-family: \\\"Noto Sans\\\",sans-serif;\\r\\n                    font-size: 12px;\\r\\n                    margin: 0;\\r\\n                    line-height: 1.428571429;\\r\\n                }\\r\\n\\r\\n                    .timeline-centered .timeline-entry .timeline-entry-inner .timeline-label p + p {\\r\\n                        margin-top: 15px;\\r\\n                    }\\r\\n\\r\\n                .timeline-centered .timeline-entry .timeline-entry-inner .timeline-label h2 {\\r\\n                    font-size: 16px;\\r\\n                }\\r\\n\\r\\n                    .timeline-centered .timeline-entry .timeline-entry-inner .timeline-label h2 button {\\r\\n                        color: #303641;\\r\\n                    }\\r\\n\\r\\n                    .timeline-centered .timeline-entry .timeline-entry-inner .timeline-label h2 span {\\r\\n                        -webkit-opacity: .6;\\r\\n                        -moz-opacity: .6;\\r\\n                        opacity: .6;\\r\\n                        -ms-filter: alpha(opacity=60);\\r\\n                        filter: alpha(opacity=60);\\r\\n                    }\\r\\n\", \"\"]);\n","function component() {\r\n    const element = document.createElement(\"button\");\r\n    const icon = document.createElement(\"i\");\r\n\r\n    element.setAttribute(\"class\", \"btn btn-warning\");\r\n    element.setAttribute(\"type\", \"button\");\r\n    element.setAttribute(\"id\", \"loc-status-btn\");\r\n\r\n    icon.setAttribute(\"class\", \"fas fa-location-arrow\");\r\n\r\n    element.appendChild(icon);\r\n\r\n    return element;\r\n}\r\n\r\ndocument.body.appendChild(component());","function component() {\r\n    const element = document.createElement(\"span\");\r\n\r\n    element.setAttribute(\"class\", \"build-version\");\r\n    element.innerHTML = VERSION;\r\n\r\n    return element;\r\n}\r\n\r\ndocument.body.appendChild(component());","﻿function component() {\r\n    const element = document.createElement(\"div\");\r\n\r\n    element.setAttribute(\"class\", \"map-overlay\");\r\n\r\n    return element;\r\n}\r\n\r\ndocument.body.appendChild(component());","﻿function component() {\r\n    const element = document.createElement(\"div\");\r\n    const loadingSpinner = document.createElement(\"div\");\r\n    const spinner = document.createElement(\"div\");\r\n    const spinnerSr = document.createElement(\"span\");\r\n\r\n    spinnerSr.setAttribute(\"class\", \"sr-only\");\r\n    spinnerSr.innerHTML = \"Loading...\";\r\n\r\n    spinner.setAttribute(\"class\", \"spinner-border m-5\");\r\n    spinner.setAttribute(\"role\", \"status\");\r\n    spinner.appendChild(spinnerSr);\r\n\r\n    loadingSpinner.setAttribute(\"class\", \"loading-spinner d-flex align-items-center justify-content-center\");\r\n    loadingSpinner.appendChild(spinner);\r\n\r\n    element.setAttribute(\"class\", \"loading-overlay\");\r\n    element.appendChild(loadingSpinner);\r\n\r\n    return element;\r\n}\r\n\r\ndocument.body.appendChild(component());","﻿function component() {\r\n    const element = document.createElement(\"div\");\r\n    const stack = document.createElement(\"div\");\r\n\r\n    stack.setAttribute(\"id\", \"gtw-toast-stack\");\r\n\r\n    element.setAttribute(\"class\", \"toast-stack-container\");\r\n    element.setAttribute(\"aria-live\", \"polite\");\r\n    element.setAttribute(\"aria-atomic\", \"true\");\r\n    element.appendChild(stack);\r\n\r\n    return element;\r\n}\r\n\r\ndocument.body.appendChild(component());","﻿function component() {\r\n    const element = document.createElement(\"div\");\r\n    const p = document.createElement(\"p\");\r\n\r\n    p.setAttribute(\"class\", \"text-center\");\r\n    p.setAttribute(\"data-i18n\", \"app-license-message\");\r\n\r\n    element.setAttribute(\"class\", \"jumbotron text-center footer\");\r\n    element.setAttribute(\"style\", \"margin-bottom: 0\");\r\n    element.appendChild(p);\r\n\r\n    return element;\r\n}\r\n\r\ndocument.body.appendChild(component());","﻿function component() {\r\n    const element = document.createElement(\"div\");\r\n\r\n    element.setAttribute(\"id\", \"gtw-map\");\r\n\r\n    return element;\r\n}\r\n\r\ndocument.body.appendChild(component());","﻿function component() {\r\n    const element = document.createElement(\"div\");\r\n    const splitMapPanel = document.createElement(\"div\");\r\n    const container = document.createElement(\"div\");\r\n    const backBtn = document.createElement(\"button\");\r\n    const upBtn = document.createElement(\"button\");\r\n    const downBtn = document.createElement(\"button\");\r\n    const tabPanel = document.createElement(\"div\");\r\n    const splitMapContainer = document.createElement(\"div\");\r\n\r\n    backBtn.setAttribute(\"type\", \"button\");\r\n    backBtn.setAttribute(\"class\", \"btn btn-link ui-split-map-back-btn\");\r\n    backBtn.innerHTML = \"<i class=\\\"fas fa-arrow-left\\\"></i> <span data-i18n=\\\"split-panel-back\\\"></span>\";\r\n\r\n    upBtn.setAttribute(\"type\", \"button\");\r\n    upBtn.setAttribute(\"class\", \"btn btn-link ui-pull-up-btn\");\r\n    upBtn.innerHTML = \"<i class=\\\"fas fa-arrow-up\\\"></i> <span data-i18n=\\\"split-panel-move-up\\\"></span>\";\r\n\r\n    downBtn.setAttribute(\"type\", \"button\");\r\n    downBtn.setAttribute(\"class\", \"btn btn-link ui-pull-down-btn\");\r\n    downBtn.innerHTML = \"<i class=\\\"fas fa-arrow-down\\\"></i> <span data-i18n=\\\"split-panel-move-down\\\"></span>\";\r\n\r\n    tabPanel.setAttribute(\"class\", \"split-map-tab-panel\");\r\n\r\n    container.setAttribute(\"class\", \"container-fluid\");\r\n    container.appendChild(backBtn);\r\n    container.appendChild(upBtn);\r\n    container.appendChild(downBtn);\r\n    container.appendChild(tabPanel);\r\n\r\n    splitMapPanel.setAttribute(\"class\", \"jumbotron jumbotron-fluid split-map-panel mobile\")\r\n    splitMapPanel.appendChild(container);\r\n\r\n    splitMapContainer.setAttribute(\"class\", \"container-fluid split-map-container mobile\");\r\n\r\n    element.setAttribute(\"class\", \"container-fluid mobile-split-container\");\r\n    element.appendChild(splitMapPanel);\r\n    element.appendChild(splitMapContainer);\r\n\r\n    return element;\r\n}\r\n\r\ndocument.body.appendChild(component());","﻿function component() {\r\n    const element = document.createElement(\"div\");\r\n    const dialog = document.createElement(\"div\");\r\n    const content = document.createElement(\"div\");\r\n    const header = document.createElement(\"div\");\r\n    const body = document.createElement(\"div\");\r\n    const footer = document.createElement(\"div\");\r\n\r\n    header.setAttribute(\"class\", \"modal-header\");\r\n    body.setAttribute(\"class\", \"modal-body\");\r\n    footer.setAttribute(\"class\", \"modal-footer\");\r\n\r\n    content.setAttribute(\"class\", \"modal-content\");\r\n    content.appendChild(header);\r\n    content.appendChild(body);\r\n    content.appendChild(footer);\r\n\r\n    dialog.setAttribute(\"class\", \"modal-dialog\");\r\n    dialog.setAttribute(\"role\", \"document\");\r\n    dialog.appendChild(content);\r\n\r\n    element.setAttribute(\"class\", \"modal fade\");\r\n    element.setAttribute(\"tabindex\", \"-1\");\r\n    element.setAttribute(\"role\", \"dialog\");\r\n    element.setAttribute(\"aria-labelledby\", \"modalLabel\");\r\n    element.setAttribute(\"aria-hidden\", \"true\");\r\n    element.appendChild(dialog);\r\n\r\n    return element;\r\n}\r\n\r\ndocument.body.appendChild(component());","var map = {\n\t\"./en.json\": [\n\t\t202,\n\t\t45\n\t],\n\t\"./zh.json\": [\n\t\t203,\n\t\t46\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(function() {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn __webpack_require__.e(ids[1]).then(function() {\n\t\treturn __webpack_require__.t(id, 3);\n\t});\n}\nwebpackAsyncContext.keys = function webpackAsyncContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackAsyncContext.id = 172;\nmodule.exports = webpackAsyncContext;","module.exports = __webpack_public_path__ + \"1.3143549eae1b49940de8.worker.js\"","module.exports = __webpack_public_path__ + \"2.b6dfd31411fea68be1fe.worker.js\"","var map = {\n\t\"./gtwp-ctbnwfb/index.js\": [\n\t\t204,\n\t\t47\n\t],\n\t\"./gtwp-hktransit/index.js\": [\n\t\t205,\n\t\t48\n\t],\n\t\"./gtwp-kmblwb/index.js\": [\n\t\t206,\n\t\t49\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(function() {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn __webpack_require__.e(ids[1]).then(function() {\n\t\treturn __webpack_require__(id);\n\t});\n}\nwebpackAsyncContext.keys = function webpackAsyncContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackAsyncContext.id = 175;\nmodule.exports = webpackAsyncContext;","module.exports = __webpack_public_path__ + \"0.9f7e8c2a42802d178851.worker.js\"","var map = {\n\t\"./gtw-map-googlemap\": [\n\t\t97,\n\t\t2\n\t],\n\t\"./gtw-map-googlemap.js\": [\n\t\t97,\n\t\t2\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(function() {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn __webpack_require__.e(ids[1]).then(function() {\n\t\treturn __webpack_require__(id);\n\t});\n}\nwebpackAsyncContext.keys = function webpackAsyncContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackAsyncContext.id = 194;\nmodule.exports = webpackAsyncContext;","var map = {\n\t\"./gtw-ui-modal-about\": [\n\t\t98,\n\t\t3\n\t],\n\t\"./gtw-ui-modal-about.js\": [\n\t\t98,\n\t\t3\n\t],\n\t\"./gtw-ui-modal-errorplugins\": [\n\t\t99,\n\t\t4\n\t],\n\t\"./gtw-ui-modal-errorplugins.js\": [\n\t\t99,\n\t\t4\n\t],\n\t\"./gtw-ui-modal-loading\": [\n\t\t100,\n\t\t5\n\t],\n\t\"./gtw-ui-modal-loading.js\": [\n\t\t100,\n\t\t5\n\t],\n\t\"./gtw-ui-modal-pluginclosedapi\": [\n\t\t101,\n\t\t6\n\t],\n\t\"./gtw-ui-modal-pluginclosedapi.js\": [\n\t\t101,\n\t\t6\n\t],\n\t\"./gtw-ui-modal-pluginmanager\": [\n\t\t102,\n\t\t0\n\t],\n\t\"./gtw-ui-modal-pluginmanager.js\": [\n\t\t102,\n\t\t0\n\t],\n\t\"./gtw-ui-modal-settings\": [\n\t\t103,\n\t\t7\n\t],\n\t\"./gtw-ui-modal-settings.js\": [\n\t\t103,\n\t\t7\n\t],\n\t\"./gtw-ui-modal-updated\": [\n\t\t104,\n\t\t8\n\t],\n\t\"./gtw-ui-modal-updated.js\": [\n\t\t104,\n\t\t8\n\t],\n\t\"./gtw-ui-modal-viewgtfsalerts\": [\n\t\t105,\n\t\t9\n\t],\n\t\"./gtw-ui-modal-viewgtfsalerts.js\": [\n\t\t105,\n\t\t9\n\t],\n\t\"./gtw-ui-modal-viewplugin\": [\n\t\t106,\n\t\t10\n\t],\n\t\"./gtw-ui-modal-viewplugin.js\": [\n\t\t106,\n\t\t10\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(function() {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn __webpack_require__.e(ids[1]).then(function() {\n\t\treturn __webpack_require__(id);\n\t});\n}\nwebpackAsyncContext.keys = function webpackAsyncContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackAsyncContext.id = 195;\nmodule.exports = webpackAsyncContext;","var map = {\n\t\"./modal-about-header.html\": [\n\t\t208,\n\t\t18\n\t],\n\t\"./modal-errorplugins-header.html\": [\n\t\t209,\n\t\t21\n\t],\n\t\"./modal-loading-header.html\": [\n\t\t210,\n\t\t24\n\t],\n\t\"./modal-pluginclosedapi-header.html\": [\n\t\t211,\n\t\t27\n\t],\n\t\"./modal-pluginmanager-header.html\": [\n\t\t212,\n\t\t30\n\t],\n\t\"./modal-settings-header.html\": [\n\t\t213,\n\t\t33\n\t],\n\t\"./modal-updated-header.html\": [\n\t\t214,\n\t\t36\n\t],\n\t\"./modal-viewgtfsalerts-header.html\": [\n\t\t215,\n\t\t39\n\t],\n\t\"./modal-viewplugin-header.html\": [\n\t\t216,\n\t\t42\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(function() {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn __webpack_require__.e(ids[1]).then(function() {\n\t\treturn __webpack_require__.t(id, 7);\n\t});\n}\nwebpackAsyncContext.keys = function webpackAsyncContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackAsyncContext.id = 196;\nmodule.exports = webpackAsyncContext;","var map = {\n\t\"./modal-about-body.html\": [\n\t\t217,\n\t\t16\n\t],\n\t\"./modal-errorplugins-body.html\": [\n\t\t218,\n\t\t19\n\t],\n\t\"./modal-loading-body.html\": [\n\t\t219,\n\t\t22\n\t],\n\t\"./modal-pluginclosedapi-body.html\": [\n\t\t220,\n\t\t25\n\t],\n\t\"./modal-pluginmanager-body.html\": [\n\t\t221,\n\t\t28\n\t],\n\t\"./modal-settings-body.html\": [\n\t\t222,\n\t\t31\n\t],\n\t\"./modal-updated-body.html\": [\n\t\t223,\n\t\t34\n\t],\n\t\"./modal-viewgtfsalerts-body.html\": [\n\t\t224,\n\t\t37\n\t],\n\t\"./modal-viewplugin-body.html\": [\n\t\t225,\n\t\t40\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(function() {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn __webpack_require__.e(ids[1]).then(function() {\n\t\treturn __webpack_require__.t(id, 7);\n\t});\n}\nwebpackAsyncContext.keys = function webpackAsyncContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackAsyncContext.id = 197;\nmodule.exports = webpackAsyncContext;","var map = {\n\t\"./modal-about-footer.html\": [\n\t\t226,\n\t\t17\n\t],\n\t\"./modal-errorplugins-footer.html\": [\n\t\t227,\n\t\t20\n\t],\n\t\"./modal-loading-footer.html\": [\n\t\t228,\n\t\t23\n\t],\n\t\"./modal-pluginclosedapi-footer.html\": [\n\t\t229,\n\t\t26\n\t],\n\t\"./modal-pluginmanager-footer.html\": [\n\t\t230,\n\t\t29\n\t],\n\t\"./modal-settings-footer.html\": [\n\t\t231,\n\t\t32\n\t],\n\t\"./modal-updated-footer.html\": [\n\t\t232,\n\t\t35\n\t],\n\t\"./modal-viewgtfsalerts-footer.html\": [\n\t\t233,\n\t\t38\n\t],\n\t\"./modal-viewplugin-footer.html\": [\n\t\t234,\n\t\t41\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(function() {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn __webpack_require__.e(ids[1]).then(function() {\n\t\treturn __webpack_require__.t(id, 7);\n\t});\n}\nwebpackAsyncContext.keys = function webpackAsyncContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackAsyncContext.id = 198;\nmodule.exports = webpackAsyncContext;","var map = {\n\t\"./gtw-ui-tab-navigation\": [\n\t\t107,\n\t\t1\n\t],\n\t\"./gtw-ui-tab-navigation.js\": [\n\t\t107,\n\t\t1\n\t],\n\t\"./gtw-ui-tab-transit\": [\n\t\t108,\n\t\t11\n\t],\n\t\"./gtw-ui-tab-transit.js\": [\n\t\t108,\n\t\t11\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(function() {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn __webpack_require__.e(ids[1]).then(function() {\n\t\treturn __webpack_require__(id);\n\t});\n}\nwebpackAsyncContext.keys = function webpackAsyncContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackAsyncContext.id = 199;\nmodule.exports = webpackAsyncContext;","//GTW Logging\r\n\r\nimport * as Settings from './gtw-settings';\r\n\r\nvar maxEntries = 1000;\r\n\r\nvar logEntries = [];\r\n\r\nvar jsTrace = console.trace;\r\nconsole.trace = function (msg) {\r\n    log(\"console\", msg, -1);\r\n};\r\n\r\nvar jsDebug = console.debug;\r\nconsole.debug = function (msg) {\r\n    log(\"console\", msg, -2);\r\n};\r\n\r\nvar jsInfo = console.log;\r\nconsole.log = function (msg) {\r\n    log(\"console\", msg, 0);\r\n};\r\n\r\nvar jsWarn = console.warn;\r\nconsole.warn = function (msg) {\r\n    log(\"console\", msg, 1);\r\n};\r\n\r\nvar jsError = console.error;\r\nconsole.error = function (msg) {\r\n    log(\"console\", msg, 2);\r\n};\r\n\r\nexport var printObject = true;\r\n\r\nexport function toConsole(msg, level) {\r\n    if (level === -2) {\r\n        jsTrace(msg);\r\n    } else if (level === -1) {\r\n        jsDebug(msg);\r\n    } else if (level === 0) {\r\n        jsInfo(msg);\r\n    } else if (level === 1) {\r\n        jsWarn(msg);\r\n    } else if (level === 2) {\r\n        jsError(msg);\r\n    }\r\n}\r\n\r\nexport function toLogger(tag, msg, time, level) {\r\n    if (logEntries.length >= maxEntries) {\r\n        logEntries.shift();\r\n    }\r\n    logEntries.push({\r\n        time: time,\r\n        msg: msg,\r\n        level: level\r\n    });\r\n\r\n    if (Settings.get(\"show_debug_msg\", false)) {\r\n        showToast(logEntries.length, tag, msg, time, level);\r\n    }\r\n}\r\n\r\nvar lastMsg = 0;\r\nvar lastTag = 0;\r\nvar lastLevel = 0;\r\nvar lastTime = 0;\r\n\r\nexport function showToast(id, tag, msg, time, level) {\r\n    if (level <= 0) {\r\n        return;\r\n    }\r\n\r\n    if (lastMsg === msg && lastTag === tag && lastLevel === level && time - lastTime < 7500) {\r\n        return;\r\n    }\r\n\r\n    lastTime = time;\r\n    lastMsg = msg;\r\n    lastTag = tag;\r\n    lastLevel = level;\r\n\r\n    var node = $(\"#gtw-toast-stack\");\r\n    var levelName = \"Unknown\";\r\n    var className = \"\";\r\n\r\n    if (level === -2) {\r\n        levelName = \"Trace\";\r\n    } else if (level === -1) {\r\n        levelName = \"Debug\";\r\n    } else if (level === 0) {\r\n        levelName = \"Info\";\r\n        className = \" text-primary\";\r\n    } else if (level === 1) {\r\n        levelName = \"Warning\";\r\n        className = \" text-warning\";\r\n    } else if (level === 2) {\r\n        levelName = \"Error\";\r\n        className = \" text-danger\";\r\n    }\r\n\r\n    var html =\r\n        \"<div class=\\\"toast\\\" role=\\\"alert\\\" log-entry-id=\\\"\" + id + \"\\\">\" +\r\n        \"    <div class=\\\"toast-header\\\">\" +\r\n        \"        <strong class=\\\"mr-auto\" + className + \"\\\">\" + levelName + \" (\" + tag + \")</strong>\" +\r\n        \"        <small class=\\\"text-muted\\\">\" + new Date(time).toLocaleString() + \"</small>\" +\r\n        \"        <button type=\\\"button\\\" class=\\\"ml-2 mb-1 close\\\" data-dismiss=\\\"toast\\\" aria-label=\\\"Close\\\"><span aria-hidden=\\\"true\\\">&times;</span></button>\" +\r\n        \"    </div>\" +\r\n        \"    <div class=\\\"toast-body\\\">\" + msg +\r\n        \"    </div>\" +\r\n        \"</div>\"\r\n        ;\r\n\r\n    if (node.children().length >= 3) {\r\n        node.children().each(function (i) {\r\n            if (i >= 2) {\r\n                $(this).toast('hide');\r\n            }\r\n        });\r\n    }\r\n\r\n    node.prepend(html);\r\n\r\n    var key = \".toast[log-entry-id='\" + id + \"']\";\r\n    $(key).on('hidden.bs.toast', function () {\r\n        $(this).remove();\r\n    });\r\n    $(key).toast({\r\n        animation: true,\r\n        autohide: true,\r\n        delay: 5000\r\n    });\r\n    $(key).toast('show');\r\n}\r\n\r\nexport function getEntries() {\r\n    return logEntries;\r\n}\r\n\r\nexport function log(tag = \"unknown\", msg, level = 0) {\r\n    var time = Date.now();\r\n\r\n    if (typeof msg === \"object\") {\r\n        if (printObject) {\r\n            toConsole(\"[\" + new Date(time).toLocaleString() + \"] [\" + tag + \"]\", level);\r\n            toConsole(msg, level);\r\n        } else {\r\n            var pmsg = JSON.stringify(msg);\r\n            toConsole(\"[\" + new Date(time).toLocaleString() + \"] [\" + tag + \"] \" + pmsg, level);\r\n        }\r\n    } else {\r\n        toConsole(\"[\" + new Date(time).toLocaleString() + \"] [\" + tag + \"] \" + msg, level);\r\n    }\r\n\r\n    toLogger(tag, msg, time, level);\r\n}\r\n\r\nexport function trace(tag, msg) {\r\n    log(tag, msg, -2);\r\n}\r\n\r\nexport function debug(tag, msg) {\r\n    log(tag, msg, -1);\r\n}\r\n\r\nexport function info(tag, msg) {\r\n    log(tag, msg, 0);\r\n}\r\n\r\nexport function warn(tag, msg) {\r\n    log(tag, msg, 1);\r\n}\r\n\r\nexport function error(tag, msg) {\r\n    log(tag, msg, 2);\r\n}","﻿export default function() {\r\n    const nav = document.createElement(\"nav\");\r\n\r\n    const brand = document.createElement(\"a\");\r\n    brand.setAttribute(\"class\", \"navbar-brand\");\r\n    brand.innerHTML = \"<i class=\\\"fas fa-map-marked-alt\\\"></i> <span data-i18n=\\\"app-name\\\"></span>\";\r\n    nav.appendChild(brand);\r\n\r\n    const collapseBtn = document.createElement(\"button\");\r\n    collapseBtn.setAttribute(\"class\", \"navbar-toggler\");\r\n    collapseBtn.setAttribute(\"type\", \"button\");\r\n    collapseBtn.setAttribute(\"data-toggle\", \"collapse\");\r\n    collapseBtn.setAttribute(\"data-target\", \"#collapsibleNavbar\");\r\n    collapseBtn.innerHTML = \"<span class=\\\"navbar-toggler-icon\\\"></span>\";\r\n    nav.appendChild(collapseBtn);\r\n\r\n    const navCollapse = document.createElement(\"div\");\r\n    const navList = document.createElement(\"ul\");\r\n\r\n    navList.setAttribute(\"class\", \"navbar-nav\");\r\n    navList.appendChild(navListItem(\"plugins\", \"fas fa-plus-circle\", \"nav-plugins\"));\r\n    navList.appendChild(navListItem(\"settings\", \"fas fa-cog\", \"nav-settings\"));\r\n    navList.appendChild(navListItem(\"github\", \"fab fa-github\", \"nav-github\"));\r\n    navList.appendChild(navListItem(\"feedback\", \"fas fa-exclamation-triangle\", \"nav-feedback\"));\r\n    navList.appendChild(navListItem(\"about\", \"fas fa-info-circle\", \"nav-about\"));\r\n\r\n    navCollapse.setAttribute(\"class\", \"collapse navbar-collapse\");\r\n    navCollapse.setAttribute(\"id\", \"collapsibleNavbar\");\r\n    navCollapse.appendChild(navList);\r\n\r\n    var darkMode = window.matchMedia && window.matchMedia(\"(prefers-color-scheme: dark)\").matches;\r\n\r\n    nav.setAttribute(\"class\", \"navbar navbar-\" + (darkMode ? \"dark\" : \"light\"));\r\n    nav.appendChild(navCollapse);\r\n\r\n    return nav;\r\n}\r\n\r\nfunction navListItem(linkName, iconCss, msgKey) {\r\n    const listItem = document.createElement(\"li\");\r\n    const btn = document.createElement(\"button\");\r\n\r\n    btn.setAttribute(\"class\", \"btn btn-link nav-link header-links-\" + linkName);\r\n    btn.setAttribute(\"data-toggle\", \"collapse\");\r\n    btn.setAttribute(\"data-target\", \".navbar-collapse.show\");\r\n    btn.innerHTML = \"<i class=\\\"\" + iconCss + \"\\\"></i> <span data-i18n=\\\"\" + msgKey + \"\\\"></span>\";\r\n    listItem.setAttribute(\"class\", \"nav-item\");\r\n    listItem.appendChild(btn);\r\n\r\n    return listItem;\r\n}","﻿export default function () {\r\n    const jumbo = document.createElement(\"div\");\r\n    const container = document.createElement(\"div\");\r\n    const btnGroup = document.createElement(\"div\");\r\n    const tabPanel = document.createElement(\"div\");\r\n\r\n    btnGroup.setAttribute(\"class\", \"tabs btn-group\");\r\n    btnGroup.appendChild(tabButton(\"transit\", \"fas fa-bus\", \"home-tab-transit\", true));\r\n    btnGroup.appendChild(tabButton(\"navigation\", \"fas fa-location-arrow\", \"home-tab-navigation\"));\r\n    container.appendChild(btnGroup);\r\n\r\n    tabPanel.setAttribute(\"class\", \"tab-panel\");\r\n    container.appendChild(tabPanel);\r\n\r\n    container.setAttribute(\"class\", \"container-fluid\");\r\n    jumbo.appendChild(container);\r\n\r\n    jumbo.setAttribute(\"class\", \"jumbotron jumbotron-fluid top-panel\");\r\n\r\n    return jumbo;\r\n}\r\n\r\nfunction tabButton(tab, iconCss, msgKey, primary = false, disabled = false) {\r\n    const btn = document.createElement(\"button\");\r\n    btn.setAttribute(\"class\", \"btn \" + (primary ? \"btn-primary\" : \"btn-link\") + \" ui-tab\");\r\n    btn.setAttribute(\"type\", \"button\");\r\n    if (disabled) {\r\n        btn.setAttribute(\"disabled\", \"disabled\");\r\n    }\r\n    btn.setAttribute(\"data-gtw-tab\", tab);\r\n    btn.innerHTML = \"<i class=\\\"\" + iconCss + \"\\\"></i> <span data-i18n=\\\"\" + msgKey + \"\\\"></span>\";\r\n    return btn;\r\n}","﻿export default function() {\r\n    const jumbo = document.createElement(\"div\");\r\n    const container = document.createElement(\"div\");\r\n    const btn = document.createElement(\"button\");\r\n    const splitMapTabPanel = document.createElement(\"div\");\r\n\r\n    btn.setAttribute(\"type\", \"button\");\r\n    btn.setAttribute(\"class\", \"btn btn-link ui-split-map-back-btn\");\r\n    btn.innerHTML = \"<i class=\\\"fas fa-arrow-left\\\"></i> <span data-i18n=\\\"split-panel-back\\\"></span>\";\r\n\r\n    splitMapTabPanel.setAttribute(\"class\", \"split-map-tab-panel\");\r\n\r\n    container.setAttribute(\"class\", \"container-fluid\");\r\n    container.appendChild(btn);\r\n    container.appendChild(splitMapTabPanel);\r\n    jumbo.appendChild(container);\r\n\r\n    jumbo.setAttribute(\"class\", \"jumbotron jumbotron-fluid split-map-panel desktop\");\r\n\r\n    return jumbo;\r\n}","﻿export default function () {\r\n    const container = document.createElement(\"div\");\r\n    const appTitle = document.createElement(\"p\");\r\n    const wizard = document.createElement(\"div\");\r\n    const wizardSteps = document.createElement(\"ul\");\r\n    const wizardStepContents = document.createElement(\"div\");\r\n\r\n    appTitle.setAttribute(\"class\", \"app-title\");\r\n    appTitle.innerHTML = \"<i class=\\\"fas fa-map-marked-alt\\\"></i> <span data-i18n=\\\"app-name\\\"></span> <span class=\\\"lead\\\" data-i18n=\\\"app-desc\\\"></span>\";\r\n\r\n    wizardSteps.appendChild(wizardStep(\"#step-1\", \"getting-started-wizard-step-language\"));\r\n    wizardSteps.appendChild(wizardStep(\"#step-2\", \"getting-started-wizard-step-plugins\"));\r\n    wizardSteps.appendChild(wizardStep(\"#step-3\", \"getting-started-wizard-step-finish\"));\r\n\r\n    wizardStepContents.appendChild(step1());\r\n    wizardStepContents.appendChild(step2());\r\n    wizardStepContents.appendChild(step3());\r\n\r\n    wizard.setAttribute(\"id\", \"gettingStartedWizard\");\r\n    wizard.appendChild(wizardSteps);\r\n    wizard.appendChild(wizardStepContents);\r\n\r\n    container.setAttribute(\"class\", \"container-fluid getting-started-panel\");\r\n    container.appendChild(appTitle);\r\n    container.appendChild(wizard);\r\n    container.appendChild(progressPanel());\r\n    container.appendChild(errorPanel());\r\n\r\n    return container;\r\n}\r\n\r\nfunction step1() {\r\n    const container = document.createElement(\"div\");\r\n    const p1 = document.createElement(\"p\");\r\n    const p2 = document.createElement(\"p\");\r\n    const p3 = document.createElement(\"p\");\r\n    const inputGroup = document.createElement(\"div\");\r\n    const inputGroupPrepend = document.createElement(\"div\");\r\n    const label = document.createElement(\"label\");\r\n    const select = document.createElement(\"select\");\r\n    const link = document.createElement(\"a\");\r\n\r\n    p1.setAttribute(\"class\", \"display-4\");\r\n    p1.setAttribute(\"data-i18n\", \"getting-started-wizard-step-language-welcome\");\r\n\r\n    p2.setAttribute(\"class\", \"lead\");\r\n    p2.setAttribute(\"data-i18n\", \"getting-started-wizard-step-language-desc\");\r\n\r\n    p3.setAttribute(\"class\", \"display-5\");\r\n    p3.setAttribute(\"data-i18n\", \"getting-started-wizard-step-language-choose-language\");\r\n\r\n    label.setAttribute(\"class\", \"input-group-text\");\r\n    label.setAttribute(\"for\", \"langSelect\");\r\n    label.setAttribute(\"data-i18n\", \"getting-started-wizard-step-language-input-language\");\r\n\r\n    inputGroupPrepend.setAttribute(\"class\", \"input-group-prepend\");\r\n    inputGroupPrepend.appendChild(label);\r\n\r\n    select.setAttribute(\"class\", \"custom-select\");\r\n    select.setAttribute(\"id\", \"langSelect\");\r\n\r\n    inputGroup.setAttribute(\"class\", \"input-group mb-3\");\r\n    inputGroup.appendChild(inputGroupPrepend);\r\n    inputGroup.appendChild(select);\r\n\r\n    link.setAttribute(\"href\", \"https://github.com/mob41/GoToWhere\");\r\n    link.setAttribute(\"target\", \"_blank\");\r\n    link.setAttribute(\"data-i18n\", \"getting-started-wizard-step-language-help-translate\");\r\n\r\n    container.setAttribute(\"id\", \"step-1\");\r\n    container.appendChild(p1);\r\n    container.appendChild(p2);\r\n    container.appendChild(p3);\r\n    container.appendChild(inputGroup);\r\n    container.appendChild(link);\r\n\r\n    return container;\r\n}\r\n\r\nfunction step2() {\r\n    const container = document.createElement(\"div\");\r\n    const p1 = document.createElement(\"p\");\r\n    const inputGroup = document.createElement(\"div\");\r\n    const inputGroupPrepend = document.createElement(\"div\");\r\n    const label = document.createElement(\"label\");\r\n    const select = document.createElement(\"select\");\r\n    const optionLoading = document.createElement(\"option\");\r\n    const p2 = document.createElement(\"p\");\r\n    const accord = document.createElement(\"div\");\r\n\r\n    p1.setAttribute(\"class\", \"display-5\");\r\n    p1.setAttribute(\"data-i18n\", \"getting-started-wizard-step-plugins-select-region\");\r\n\r\n    label.setAttribute(\"class\", \"input-group-text\");\r\n    label.setAttribute(\"for\", \"regionSelect\");\r\n    label.setAttribute(\"data-i18n\", \"getting-started-wizard-step-plugins-input-region\");\r\n\r\n    inputGroupPrepend.setAttribute(\"class\", \"input-group-prepend\");\r\n    inputGroupPrepend.appendChild(label);\r\n\r\n    optionLoading.setAttribute(\"data-i18n\", \"getting-started-wizard-step-plugins-loading\");\r\n\r\n    select.setAttribute(\"class\", \"custom-select\");\r\n    select.setAttribute(\"id\", \"regionSelect\");\r\n    select.setAttribute(\"disabled\", \"disabled\");\r\n    select.appendChild(optionLoading);\r\n\r\n    inputGroup.setAttribute(\"class\", \"input-group mb-3\");\r\n    inputGroup.appendChild(inputGroupPrepend);\r\n    inputGroup.appendChild(select);\r\n\r\n    p2.setAttribute(\"id\", \"pluginsToInstallCount\");\r\n\r\n    accord.setAttribute(\"class\", \"accordion\");\r\n    accord.setAttribute(\"id\", \"pluginsToInstallAccordion\");\r\n\r\n    container.setAttribute(\"id\", \"step-2\");\r\n    container.appendChild(p1);\r\n    container.appendChild(inputGroup);\r\n    container.appendChild(p2);\r\n    container.appendChild(accord);\r\n\r\n    return container;\r\n}\r\n\r\nfunction step3() {\r\n    const container = document.createElement(\"div\");\r\n    const p1 = document.createElement(\"p\");\r\n    const p2 = document.createElement(\"p\");\r\n    const p3 = document.createElement(\"p\");\r\n    const p4 = document.createElement(\"p\");\r\n    const btn = document.createElement(\"button\");\r\n\r\n    p1.setAttribute(\"class\", \"display-4\");\r\n    p1.setAttribute(\"data-i18n\", \"getting-started-wizard-step-finish-finish-text\");\r\n\r\n    p2.setAttribute(\"class\", \"lead\");\r\n    p2.setAttribute(\"data-i18n\", \"getting-started-wizard-step-finish-desc\");\r\n\r\n    p3.setAttribute(\"class\", \"display-5\");\r\n    p3.setAttribute(\"id\", \"installCount\");\r\n\r\n    p4.setAttribute(\"class\", \"need-to-install\");\r\n    p4.setAttribute(\"data-i18n\", \"[html]getting-started-wizard-step-finish-must-install\");\r\n\r\n    btn.setAttribute(\"class\", \"btn btn-block btn-success disabled\");\r\n    btn.setAttribute(\"type\", \"button\");\r\n    btn.setAttribute(\"id\", \"getStartedBtn\");\r\n    btn.setAttribute(\"data-i18n\", \"getting-started-wizard-step-finish-get-started-btn\");\r\n\r\n    container.setAttribute(\"id\", \"step-3\");\r\n    container.appendChild(p1);\r\n    container.appendChild(p2);\r\n    container.appendChild(p3);\r\n    container.appendChild(p4);\r\n    container.appendChild(btn);\r\n\r\n    return container;\r\n}\r\n\r\nfunction progressPanel() {\r\n    const panel = document.createElement(\"div\");\r\n    const p1 = document.createElement(\"p\");\r\n    const p2 = document.createElement(\"p\");\r\n    const progressPanel = document.createElement(\"div\");\r\n    const status = document.createElement(\"small\");\r\n    const progress = document.createElement(\"div\");\r\n    const progressBar = document.createElement(\"div\");\r\n\r\n    p1.setAttribute(\"class\", \"display-4\");\r\n    p1.setAttribute(\"data-i18n\", \"getting-started-please-wait\");\r\n\r\n    p2.setAttribute(\"class\", \"lead\");\r\n    p2.setAttribute(\"data-i18n\", \"getting-started-please-wait-desc\");\r\n\r\n    status.setAttribute(\"data-i18n\", \"getting-started-installing-plugins\");\r\n\r\n    progressBar.setAttribute(\"class\", \"progress-bar progress-bar-striped progress-bar-animated\");\r\n    progressBar.setAttribute(\"role\", \"progressbar\");\r\n    progressBar.setAttribute(\"id\", \"gs-plugin-progress\");\r\n    progressBar.setAttribute(\"style\", \"width: 0%\");\r\n\r\n    progress.setAttribute(\"class\", \"progress\");\r\n    progress.appendChild(progressBar);\r\n\r\n    progressPanel.setAttribute(\"class\", \"progress-panel\");\r\n    progressPanel.appendChild(status);\r\n    progressPanel.appendChild(progress);\r\n\r\n    panel.setAttribute(\"class\", \"getting-started-progress-panel\");\r\n    panel.appendChild(p1);\r\n    panel.appendChild(p2);\r\n    panel.appendChild(progressPanel);\r\n\r\n    return panel;\r\n}\r\n\r\nfunction errorPanel() {\r\n    const panel = document.createElement(\"div\");\r\n    const p1 = document.createElement(\"p\");\r\n    const p2 = document.createElement(\"p\");\r\n\r\n    p1.setAttribute(\"class\", \"display-4\");\r\n    p1.setAttribute(\"data-i18n\", \"getting-started-error\");\r\n\r\n    p2.setAttribute(\"class\", \"desc\");\r\n    \r\n    panel.setAttribute(\"class\", \"getting-started-plugin-error-panel\");\r\n    panel.appendChild(p1);\r\n    panel.appendChild(p2);\r\n\r\n    return panel;\r\n}\r\n\r\nfunction wizardStep(stepLink, msgKey) {\r\n    const listItem = document.createElement(\"li\");\r\n    const link = document.createElement(\"a\");\r\n    link.setAttribute(\"href\", stepLink);\r\n    link.setAttribute(\"data-i18n\", msgKey);\r\n    listItem.appendChild(link);\r\n    return listItem;\r\n}","﻿export default function() {\r\n    const container = document.createElement(\"div\");\r\n    const numericKeypad = document.createElement(\"div\");\r\n    const letterKeypad = document.createElement(\"div\");\r\n\r\n    numericKeypad.setAttribute(\"class\", \"numeric-keypad btn-group-vertical\");\r\n    numericKeypad.setAttribute(\"role\", \"group\");\r\n\r\n    numericKeypad.appendChild(chain([\r\n        [\"value\", \"btn-outline-secondary\", \"1\"],\r\n        [\"value\", \"btn-outline-secondary\", \"2\"],\r\n        [\"value\", \"btn-outline-secondary\", \"3\"]\r\n    ]));\r\n\r\n    numericKeypad.appendChild(chain([\r\n        [\"value\", \"btn-outline-secondary\", \"4\"],\r\n        [\"value\", \"btn-outline-secondary\", \"5\"],\r\n        [\"value\", \"btn-outline-secondary\", \"6\"]\r\n    ]));\r\n\r\n    numericKeypad.appendChild(chain([\r\n        [\"value\", \"btn-outline-secondary\", \"7\"],\r\n        [\"value\", \"btn-outline-secondary\", \"8\"],\r\n        [\"value\", \"btn-outline-secondary\", \"9\"]\r\n    ]));\r\n\r\n    numericKeypad.appendChild(chain([\r\n        [\"function\", \"btn-primary touch-keypad-function-done\", \"<i class=\\\"fas fa-check\\\"></i>\"],\r\n        [\"value\", \"btn-outline-secondary\", \"0\"],\r\n        [\"function\", \"btn-warning touch-keypad-function-backspace\", \"<i class=\\\"fas fa-backspace\\\"></i>\"]\r\n    ]));\r\n\r\n    letterKeypad.setAttribute(\"class\", \"letter-keypad btn-group-vertical\");\r\n    letterKeypad.setAttribute(\"role\", \"group\");\r\n\r\n    container.setAttribute(\"class\", \"container-fluid touch-keypad row\");\r\n    container.appendChild(numericKeypad);\r\n    container.appendChild(letterKeypad);\r\n\r\n    return container;\r\n}\r\n\r\nfunction chain(opts) {\r\n    const btnGroup = document.createElement(\"div\");\r\n\r\n    btnGroup.setAttribute(\"class\", \"btn-group\");\r\n    var i;\r\n    for (i = 0; i < opts.length; i++) {\r\n        btnGroup.appendChild(key(opts[i][0], opts[i][1], opts[i][2]));\r\n    }\r\n\r\n    return btnGroup;\r\n}\r\n\r\nfunction key(suffix, css, value) {\r\n    const btn = document.createElement(\"button\");\r\n    btn.setAttribute(\"type\", \"button\");\r\n    btn.setAttribute(\"class\", \"btn \" + css + \" py-3 touch-keypad-key touch-keypad-\" + suffix + \" disabled\");\r\n    btn.innerHTML = value;\r\n    return btn;\r\n}","﻿import nav from './html.gtw-container.nav';\r\nimport topPanel from './html.gtw-container.top-panel';\r\nimport splitMapPanel from './html.gtw-container.split-map-panel';\r\nimport gettingStartedPanel from './html.gtw-container.getting-started-panel';\r\nimport touchKeypad from './html.gtw-container.touch-keypad';\r\n\r\nfunction component() {\r\n    const element = document.createElement(\"div\");\r\n    const header = document.createElement(\"div\");\r\n    const contentPanelContainer = document.createElement(\"div\");\r\n    const splitMapContainerDesktop = document.createElement(\"div\");\r\n\r\n    contentPanelContainer.setAttribute(\"class\", \"container-fluid content-panel-container\");\r\n\r\n    splitMapContainerDesktop.setAttribute(\"class\", \"container-fluid split-map-container desktop\");\r\n\r\n    header.setAttribute(\"class\", \"header\");\r\n    header.appendChild(nav());\r\n    header.appendChild(topPanel());\r\n    header.appendChild(splitMapPanel());\r\n\r\n    element.setAttribute(\"class\", \"gtw-container\");\r\n    element.appendChild(header);\r\n    element.appendChild(gettingStartedPanel());\r\n    element.appendChild(contentPanelContainer);\r\n    element.appendChild(splitMapContainerDesktop);\r\n    element.appendChild(touchKeypad());\r\n\r\n    return element;\r\n}\r\n\r\ndocument.body.appendChild(component());","// GoToWhere startup script\r\n\r\nimport $ from 'jquery';\r\nwindow.jQuery = $;\r\nwindow.$ = $;\r\nimport JSZip from 'jszip';\r\nimport JSZipUtils from 'jszip-utils';\r\nwindow.JSZip = JSZip;\r\nwindow.JSZipUtils = JSZipUtils;\r\n\r\nvar req = require.context(\"@wikimedia/jquery.i18n/src\");\r\n\r\nvar files = [\"js\", \"messagestore\", \"fallbacks\", \"parser\", \"emitter\", \"language\"];\r\nfiles.forEach(function (module) {\r\n    req(\"./jquery.i18n.\" + module);\r\n});\r\n\r\nimport 'bootstrap';\r\nimport 'bootstrap/dist/css/bootstrap.min.css';\r\nimport './style.css';\r\nimport './timeline.css';\r\n\r\nimport 'smartwizard';\r\nimport 'smartwizard/dist/css/smart_wizard.css';\r\n\r\nimport '@fortawesome/fontawesome-free/js/fontawesome';\r\nimport '@fortawesome/fontawesome-free/js/solid';\r\nimport '@fortawesome/fontawesome-free/js/regular';\r\nimport '@fortawesome/fontawesome-free/js/brands';\r\n\r\nimport './html.loc-status-btn';\r\nimport './html.build-version';\r\n//import './html.startup';\r\nimport './html.map-overlay';\r\nimport './html.loading-overlay';\r\nimport './html.gtw-container';\r\nimport './html.toast-stack-container';\r\nimport './html.footer';\r\nimport './html.gtw-map';\r\nimport './html.mobile-split-container';\r\nimport './html.modal';\r\n\r\nimport * as settings from './gtw-settings';\r\nimport * as Cors from './gtw-cors';\r\nimport * as PluginLoader from './gtw-pluginloader';\r\nimport * as Transit from './gtw-citydata-transit';\r\nimport * as TransitEta from './gtw-citydata-transit-eta';\r\nimport * as Map from './gtw-map';\r\nimport * as loc from './gtw-location';\r\nimport * as ui from './gtw-ui';\r\nimport * as RequestLimiter from './gtw-requestlimiter';\r\nimport * as log from './gtw-log';\r\nimport * as lang from './gtw-lang';\r\nimport * as Database from './gtw-db';\r\nimport * as gtfs from './gtw-citydata-transit-gtfs';\r\nimport proj4 from 'proj4';\r\n\r\nif ('serviceWorker' in navigator) {\r\n    window.addEventListener('load', () => {\r\n        navigator.serviceWorker.register('/service-worker.js').then(registration => {\r\n            console.log('SW registered: ', registration);\r\n        }).catch(registrationError => {\r\n            console.log('SW registration failed: ', registrationError);\r\n        });\r\n    });\r\n}\r\n\r\nsettings.load();\r\nimport(\"./html.startup\").then(function () {\r\n    $(\".startup .progress-panel\").fadeIn(5000);\r\n    $(\".startup .container\").fadeIn(2000);\r\n    console.log(\"GoToWhere (c) 2019. Licensed under the GPLv3 License.\");\r\n    $(\"#startup-status\").html(\"Loading GoToWhere scripts...\");\r\n\r\n    $(window).resize(function () {\r\n        adjustMargin();\r\n    });\r\n\r\n    window.adjustMargin = function () {\r\n        var nph = 0;\r\n        $(\".numeric-keypad .btn-group\").each(function () {\r\n            nph += $(this).height();\r\n        });\r\n        $(\".letter-keypad\").css(\"height\", nph);\r\n\r\n        var hh = $(\".header\").height();\r\n        var dh = $(window).height();\r\n        $(\".desktop.split-map-container\").css(\"height\", dh - hh);\r\n        $(\".content-panel-container\").css(\"height\", dh - hh - nph);\r\n\r\n        var msh = $(\".mobile-split-container\").height();\r\n        var hmph = $(\".mobile.split-map-panel\").height();\r\n        $(\".mobile.split-map-container\").css(\"height\", msh - hmph);\r\n    };\r\n    adjustMargin();\r\n\r\n    lang.changeLanguage(settings.get(\"preferred_language\", \"en\"));\r\n\r\n    window.p = TransitEta;\r\n\r\n    proj4.defs(\"EPSG:2326\", \"+proj=tmerc +lat_0=22.31213333333334 +lon_0=114.1785555555556 +k=1 +x_0=836694.05 +y_0=819069.8 +ellps=intl +towgs84=-162.619,-276.959,-161.764,0.067753,-2.24365,-1.15883,-1.09425 +units=m +no_defs\");\r\n    proj4.defs(\"EPSG:4326\", \"+proj=longlat +datum=WGS84 +no_defs\");\r\n\r\n    RequestLimiter.start();\r\n\r\n    Cors.register(\"www.gotowhere.ga\", true);\r\n    Cors.register(\"plugins.gotowhere.ga\", true);\r\n\r\n    var GTFS_DATA_TYPES = [\r\n        \"agency\",\r\n        \"calendar\",\r\n        \"calendar_dates\",\r\n        \"frequencies\",\r\n        \"routes\",\r\n        \"trips\",\r\n        \"stops\",\r\n        \"stop_time_paths\",\r\n        \"stop_times\",\r\n        \"fare_attributes\",\r\n        \"fare_rules\"\r\n    ];\r\n\r\n    if (!window.indexedDB || !window.localStorage) {\r\n        $(\"#startup-status\").attr(\"style\", \"color: red\");\r\n        $(\"#startup-status\").html($.i18n(\"startup-status-not-supported\"));\r\n    } else {\r\n        $(\"#startup-progress\").css(\"width\", \"0%\");\r\n        $(\"#startup-status\").html($.i18n(\"startup-status-loading-plugins\"));\r\n        PluginLoader.load(function (progress) {\r\n            $(\"#startup-progress\").css(\"width\", progress / 5 + \"%\");\r\n        }).then(function () {\r\n            $(\"#startup-status\").html($.i18n(\"startup-status-fetching-reference-db\"));\r\n            return TransitEta.fetchAllDatabase(function (progress) {\r\n                $(\"#startup-progress\").css(\"width\", (progress / 5 + 20) + \"%\");\r\n            });\r\n        }).then(function () {\r\n            $(\"#startup-status\").html($.i18n(\"startup-status-obtaining-db-version\"));\r\n            return Transit.obtainDatabaseVersion(function (progress) {\r\n                $(\"#startup-progress\").css(\"width\", (progress / 5 + 40) + \"%\");\r\n            });\r\n        }).then(function () {\r\n            $(\"#startup-status\").html($.i18n(\"startup-status-checking-db-update\"));\r\n            return Transit.checkDatabaseUpdate(function (progress) {\r\n                $(\"#startup-progress\").css(\"width\", (progress / 5 + 60) + \"%\");\r\n            });\r\n        }).then(function () {\r\n            $(\"#startup-status\").html($.i18n(\"startup-status-validating-db\"));\r\n            return Transit.validateAllDatabase(function (progress) {\r\n                $(\"#startup-progress\").css(\"width\", (progress / 5 + 80) + \"%\");\r\n            });\r\n        }).then(function () {\r\n            if (Transit.hasDatabaseUpdate()) {\r\n                Transit.initializeWorker();\r\n                var takeSomeTimeText = \"<b>\" + $.i18n(\"startup-status-load-db-take-some-time\") + \"</b><br />\";\r\n                $(\"#startup-status\").html(takeSomeTimeText + $.i18n(\"startup-status-downloading-db\"));\r\n                return Transit.downloadDatabase(function (progress) {\r\n                    console.log(progress);\r\n                    $(\"#startup-progress\").css(\"width\", progress / 8 + \"%\");\r\n                }).then(function () {\r\n                    $(\"#startup-status\").html(takeSomeTimeText + $.i18n(\"startup-status-preparing-update\"));\r\n                    return Transit.prepareUpdate(function (progress) {\r\n                        console.log(progress);\r\n                        $(\"#startup-progress\").css(\"width\", progress / 8 + 12.5 + \"%\");\r\n                    });\r\n                }).then(function loadAllGtfs(i) {\r\n                    if (typeof i !== \"number\") {\r\n                        i = 0;\r\n                    }\r\n                    var dataType = GTFS_DATA_TYPES[i];\r\n                    $(\"#startup-status\").html(takeSomeTimeText + $.i18n(\"startup-status-loading-\" + dataType));\r\n                    return Transit.readChunks(dataType, function (progress) {\r\n                        console.log(progress);\r\n                        $(\"#startup-progress\").css(\"width\", (((progress / 2 / GTFS_DATA_TYPES.length) + (i * 100 / GTFS_DATA_TYPES.length)) / 100 * 75 + 25) + \"%\");\r\n                    }).then(function () {\r\n                        $(\"#startup-status\").html(takeSomeTimeText + $.i18n(\"startup-status-updating-\" + dataType));\r\n                        return Transit.waitToUpdate(function (progress) {\r\n                            console.log(progress);\r\n                            $(\"#startup-progress\").css(\"width\", (((progress / 2 + 50) / GTFS_DATA_TYPES.length + (i * 100 / GTFS_DATA_TYPES.length)) / 100 * 75 + 25) + \"%\");\r\n                        });\r\n                    }).then(function () {\r\n                        if (i != GTFS_DATA_TYPES.length - 1) {\r\n                            return loadAllGtfs(i + 1);\r\n                        } else {\r\n                            Transit.terminateWorker();\r\n                        }\r\n                    });\r\n                })\r\n            }\r\n        }).then(function () {\r\n            $(\"#startup-progress\").css(\"width\", \"100%\");\r\n            $(\"#startup-status\").html($.i18n(\"startup-status-init-map\"));\r\n            return Map.init();\r\n        }).then(function () {\r\n            $(\"#startup-status\").html($.i18n(\"startup-status-finish\"));\r\n            $(\".build-version\").fadeOut(2000);\r\n\r\n            var lastVer = localStorage.getItem(\"gtw-lastversion\");\r\n            if (lastVer && lastVer !== VERSION) {\r\n                console.log(\"Application updated to \" + VERSION + \". Showing change-log.\");\r\n                ui.showModal(\"updated\", VERSION);\r\n            }\r\n            localStorage.setItem(\"gtw-lastversion\", VERSION);\r\n\r\n            ui.init();\r\n\r\n            //TransitManager.start();\r\n            //TransitManager.forceUpdate();\r\n\r\n            var errPlugins = [];\r\n            var plugin;\r\n            for (var pluginKey in PluginLoader.plugins) {\r\n                plugin = PluginLoader.plugins[pluginKey];\r\n                if (plugin.status < 0) {\r\n                    errPlugins.push(plugin);\r\n                }\r\n            }\r\n            console.log(errPlugins);\r\n\r\n            if (errPlugins.length) {\r\n                ui.showModal(\"errorplugins\", errPlugins);\r\n            }\r\n\r\n            loc.requestLocationAccess(function () {\r\n                //ui.init();\r\n                //TransitManager.forceUpdate();\r\n                $(\"#loc-status-btn\").addClass(\"btn-success\");\r\n                $(\"#loc-status-btn\").removeClass(\"btn-warning\");\r\n                setTimeout(function () {\r\n                    $(\"#loc-status-btn\").fadeOut(500);\r\n                }, 2000);\r\n            }, function () {\r\n                $(\"#loc-status-btn\").addClass(\"btn-danger\");\r\n                $(\"#loc-status-btn\").removeClass(\"btn-warning\");\r\n                $(\"#loc-status-btn\").append(\" <span> \" + $.i18n(\"location-error\") + \"</span>\");\r\n                setTimeout(function () {\r\n                    $(\"#loc-status-btn span\").fadeOut(500);\r\n                }, 5000);\r\n            });\r\n\r\n            setTimeout(function () {\r\n                $(\".footer\").animate({ height: 0, opacity: 0 }, 1000, function () {\r\n                    $(\".footer\").css(\"display\", \"none\");\r\n                });\r\n            }, 2000);\r\n            $(\".startup\").fadeOut(1000);\r\n\r\n            //TODO: Check is raw\r\n            if (false) {\r\n                $(\"#bg-loaddb-status\").html(\"Preparing to build database...\");\r\n                $(\".bg-loaddb-panel\").fadeIn();\r\n                var worker = new Worker(\"./workers/bg-loaddb-worker.js\", { type: 'module' });\r\n                worker.addEventListener(\"message\", function (evt) {\r\n                    var msg = evt.data;\r\n                    if (msg.type === 0) {\r\n                        $(\"#bg-loaddb-status\").html(\"Finish!\");\r\n                        $(\".bg-loaddb-panel\").fadeOut();\r\n                    } else if (msg.type === 1) {\r\n                        $(\"#bg-loaddb-status\").html(\"Building \" + msg.stage + \" database...\");\r\n                    } else if (msg.type === 2) {\r\n                        console.log(msg.progress);\r\n                        $(\"#bg-loaddb-progress\").css(\"width\", msg.progress + \"%\");\r\n                    }\r\n                });\r\n                worker.postMessage(\"stop_times\");\r\n            }\r\n        });\r\n    }\r\n});"],"sourceRoot":""}
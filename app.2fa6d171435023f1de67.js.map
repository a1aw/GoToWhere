{"version":3,"sources":["webpack:///./src/app.js","webpack:///./node_modules/@wikimedia/jquery.i18n/src sync ^\\.\\/.*$","webpack:///./src/style.css?9819","webpack:///./src/style.css","webpack:///./src/timeline.css?025a","webpack:///./src/timeline.css","webpack:///./src/gtw-pluginloader.js","webpack:///./src/i18n lazy ^\\.\\/.*\\.json$ namespace object","webpack:///./src/workers/stoptimes-raw-by-stop-id.worker.js","webpack:///./src/workers/stoptimes-raw-by-trip-id.worker.js","webpack:///./src/plugins lazy ^\\.\\/.*\\/index\\.js$ namespace object","webpack:///./src/workers/loadgtfs.worker.js","webpack:///./src lazy ^\\.\\/gtw\\-map\\-.*$ namespace object","webpack:///./src lazy ^\\.\\/gtw\\-ui\\-modal\\-.*$ namespace object","webpack:///./src/ui lazy ^\\.\\/.*\\-header\\.html$ namespace object","webpack:///./src/ui lazy ^\\.\\/.*\\-body\\.html$ namespace object","webpack:///./src/ui lazy ^\\.\\/.*\\-footer\\.html$ namespace object","webpack:///./src lazy ^\\.\\/gtw\\-ui\\-tab\\-.*$ namespace object","webpack:///./src/gtw-log.js","webpack:///./src/gtw-map.js","webpack:///./src/gtw-ui.js","webpack:///./src/gtw-cors.js","webpack:///./src/gtw-location.js","webpack:///./src/gtw-db.js","webpack:///./src/gtw-lang.js","webpack:///./src/gtw-citydata-transit-eta.js","webpack:///./src/gtw-requestlimiter.js","webpack:///./src/gtw-event.js","webpack:///./src/gtw-citydata-transit-gtfs.js","webpack:///./src/gtw-settings.js","webpack:///./src/gtw-misc.js","webpack:///./src/gtw-citydata-transit.js","webpack:///./src/gtw-config.js"],"names":["window","jQuery","$","JSZip","JSZipUtils","req","forEach","module","navigator","addEventListener","serviceWorker","register","then","registration","console","log","catch","registrationError","__headerTexts","__stopHeaderAnimation","document","ready","adjustMargin","fadeIn","__headerAnimation","i","undefined","html","fadeOut","resize","nph","each","this","height","css","hh","dh","msh","hmph","p","defs","GTFS_DATA_TYPES","indexedDB","localStorage","i18n","progress","takeSomeTimeText","loadAllGtfs","dataType","length","lastVer","getItem","setItem","plugin","errPlugins","pluginKey","status","push","addClass","removeClass","setTimeout","append","animate","opacity","attr","map","webpackContext","id","webpackContextResolve","__webpack_require__","o","e","Error","code","keys","Object","resolve","exports","content","options","locals","plugins","installedPlugins","deprecatedPlugins","install","pkg","autoSave","isInstalled","save","async","uninstall","splice","getPlugin","JSON","stringify","load","pc","pluginsStr","parse","warn","proms","installedPlugin","includes","alert","info","msg","Promise","reject","mod","onload","error","webpackAsyncContext","ids","t","maxEntries","logEntries","jsTrace","trace","jsDebug","debug","jsInfo","jsWarn","jsError","printObject","toConsole","level","toLogger","tag","time","shift","lastMsg","lastTag","lastLevel","lastTime","node","levelName","className","Date","toLocaleString","children","toast","prepend","key","on","remove","animation","autohide","delay","showToast","now","pmsg","init","mapApi","m","k","setCenter","coords","setZoom","zoom","addMarker","position","setMarkerPosition","markerId","lockMarker","removeAllMarkers","addPolyline","strokeColor","strokeWeight","strokeOpacity","geodesic","removeAllPolylines","currentTabModule","currentModalModule","showModal","open","hasClass","tab","showTab","blur","EVENT_UI_BACK","showPanel","splitContainerPercent","cleanUpTab","cleanUpModal","enable","hidePanel","layout","args","backdrop","keyboard","default","all","modal","loadModalLayout","apply","hideModal","disable","matchMedia","matches","CORS_PROTOCOL","domains","domain","allowCors","config","extractHost","url","startsWith","indexOf","last","substring","isCors","host","location","before","request","callback","Cors","Settings","get","statusText","headers","proxy","endsWith","index","sindex","currentPosition","lat","lng","located","requestLocationAccess","successFunc","errorFunc","geolocation","getCurrentPosition","latitude","longitude","icon","watchPosition","onPositionChangeSuccess","onPositionChangeError","enableHighAccuracy","timeout","maximumAge","EVENT_LOCATION_SUCCESS","err","EVENT_LOCATION_ERROR","ERROR_NOT_SUPPORTED","isLocated","isErrored","getError","EVENT_LOCATION_CHANGE","db","getTransitReference","provider","where","equals","first","putTransitReference","data","put","version","stores","languages","translatedString","transStr","lang","getLanguage","locale","getLocale","trans","translation","language","text","split","localizedKey","localizedObject","langKey","localeKey","enKey","changeLanguage","found","x","providers","cache","clearCache","timeDifference","a","b","hr","min","registerProvider","etaProviders","fetchEta","fetchDatabase","checkDatabaseUpdate","name","unregisterProvider","getProviders","getProvider","getEtaProvider","etaProvider","fetchAllDatabase","needs","needed","opt","agency","route","trip","stopTimes","stop","count","providerId","cached","lastFetched","feed","obj","FeedMessage","fromObject","result","verify","getTime","feeds","out","header","entity","getCache","requests","duration","running","start","dispatch","next","clear","EVENTS","eventListeners","dispatchEvent","event","listener","removeListener","addListener","STORES","validateDatabase","requiredRows","clearDatabase","storeKey","delete","clearPackageDatabase","selectAgencyStopName","agencyId","stopName","substr","splits","val","spaceIndex","getCurrentTrip","routeId","trips","getTripsByRouteId","getCurrentFrequency","timeToDate","timeStr","date","setHours","setMinutes","setSeconds","isCurrentFrequency","freq","startDate","endDate","getRoutePathFrequencies","pathId","exist","freqs","getFrequencies","outFreq","tripId","toArray","searchRoutes","query","startsWithIgnoreCase","getAllRouteNames","offset","noDup","filter","str","searchNearbyStops","range","sorted","stops","distance","sort","searchStopRoutes","stopId","pathIds","routeIds","routes","st","sortBy","getStopTimePathsByStopId","stopTime","anyOf","getAgencies","getAgency","getRoute","getStop","getCalendar","serviceId","getStopTimePathByPathId","SETTINGS_STORAGE_KEY","getDefaultSettings","type","desc","def","checkfunc","locales","parseInt","Number","isNaN","json","set","j","geoDistance","lat1","lon1","lat2","lon2","c","Math","cos","asin","sqrt","allProgress","progress_cb","d","fillZero","number","totalProms","dbVersions","dbZips","dbChunks","dbUpdateNeeded","dbMaps","obtainDatabaseVersion","row","update","validateAllDatabase","hasDatabaseUpdate","downloadDatabase","zip","FILES","prepareUpdate","files","file","versions","worker","initializeWorker","Worker","terminateWorker","terminate","readChunks","infos","chunk","internalStream","postMessage","string","resume","waitToUpdate","ext","evt","removeEventListener","putGtfs","googleMapApiKey"],"mappings":"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","file":"app.2fa6d171435023f1de67.js","sourcesContent":["// GoToWhere startup script\r\n\r\nimport $ from 'jquery';\r\nwindow.jQuery = $;\r\nwindow.$ = $;\r\nimport JSZip from 'jszip';\r\nimport JSZipUtils from 'jszip-utils';\r\nwindow.JSZip = JSZip;\r\nwindow.JSZipUtils = JSZipUtils;\r\n\r\nvar req = require.context(\"@wikimedia/jquery.i18n/src\");\r\n\r\nvar files = [\"js\", \"messagestore\", \"fallbacks\", \"parser\", \"emitter\", \"language\"];\r\nfiles.forEach(function (module) {\r\n    req(\"./jquery.i18n.\" + module);\r\n});\r\n\r\nimport 'bootstrap';\r\nimport 'bootstrap/dist/css/bootstrap.min.css';\r\nimport './style.css';\r\nimport './timeline.css';\r\n\r\nimport 'smartwizard';\r\nimport 'smartwizard/dist/css/smart_wizard.css';\r\n\r\nimport '@fortawesome/fontawesome-free/js/fontawesome';\r\nimport '@fortawesome/fontawesome-free/js/solid';\r\nimport '@fortawesome/fontawesome-free/js/regular';\r\nimport '@fortawesome/fontawesome-free/js/brands';\r\n\r\nif ('serviceWorker' in navigator) {\r\n    window.addEventListener('load', () => {\r\n        navigator.serviceWorker.register('/service-worker.js').then(registration => {\r\n            console.log('SW registered: ', registration);\r\n        }).catch(registrationError => {\r\n            console.log('SW registration failed: ', registrationError);\r\n        });\r\n    });\r\n}\r\n\r\nvar __headerTexts = [\"<i class=\\\"fas fa-map-marked-alt\\\"></i> \\u53bb\\u908a\\u35ce GoToWhere\", \"<i class=\\\"fas fa-map-marked-alt\\\"></i> GoToWhere<small>.ga</small>\", \"<i class=\\\"fas fa-map-marked-alt\\\"></i> HeuiBin<small>.ga</small>\"];\r\nvar __stopHeaderAnimation = false;\r\n\r\nfunction __headerAnimation(i) {\r\n    if (__stopHeaderAnimation) {\r\n        return;\r\n    }\r\n\r\n    if (i === undefined || i > 2) {\r\n        i = 0;\r\n    }\r\n    $(\".startup h1\").html(__headerTexts[i]);\r\n    $(\".startup h1\").fadeIn(2000, function () {\r\n        $(\".startup h1\").fadeOut(2000, function () {\r\n            __headerAnimation(i + 1);\r\n        });\r\n    });\r\n}\r\n\r\n$(document).ready(function () {\r\n    adjustMargin();\r\n    $(\".startup .progress-panel\").fadeIn(5000);\r\n    $(\".startup .container\").fadeIn(2000, function () {\r\n        __headerAnimation();\r\n    });\r\n    console.log(\"GoToWhere (c) 2019. Licensed under the MIT License.\");\r\n    $(\"#startup-status\").html(\"Loading GoToWhere scripts...\");\r\n});\r\n\r\n$(window).resize(function () {\r\n    adjustMargin();\r\n});\r\n\r\nwindow.adjustMargin = function () {\r\n    var nph = 0;\r\n    $(\".numeric-keypad .btn-group\").each(function () {\r\n        nph += $(this).height();\r\n    });\r\n    $(\".letter-keypad\").css(\"height\", nph);\r\n\r\n    var hh = $(\".header\").height();\r\n    var dh = $(window).height();\r\n    $(\".desktop.half-map-container\").css(\"height\", dh - hh);\r\n    $(\".content-panel-container\").css(\"height\", dh - hh - nph);\r\n\r\n    var msh = $(\".mobile-split-container\").height();\r\n    var hmph = $(\".mobile.half-map-panel\").height();\r\n    $(\".mobile.half-map-container\").css(\"height\", msh - hmph);\r\n};\r\n\r\n/*\r\nrequirejs.config({\r\n    baseUrl: 'js/lib',\r\n    paths: {\r\n        \"xhook\": \"../xhook.min\",\r\n        \"crypto-js\": \"../../vendor/crypto-js-3.1.9-1/crypto-js\",\r\n        \"proj4\": \"../../vendor/proj4js-2.5.0/dist/proj4\"\r\n    }\r\n});\r\n*/\r\n\r\nimport * as Cors from './gtw-cors';\r\nimport * as PluginLoader from './gtw-pluginloader';\r\nimport * as Transit from './gtw-citydata-transit';\r\nimport * as TransitEta from './gtw-citydata-transit-eta';\r\nimport * as Map from './gtw-map';\r\nimport * as loc from './gtw-location';\r\nimport * as ui from './gtw-ui';\r\nimport * as settings from './gtw-settings';\r\nimport * as RequestLimiter from './gtw-requestlimiter';\r\nimport * as log from './gtw-log';\r\nimport * as lang from './gtw-lang';\r\nimport * as Database from './gtw-db';\r\nimport * as gtfs from './gtw-citydata-transit-gtfs';\r\nimport proj4 from 'proj4';\r\n\r\nwindow.p = TransitEta;\r\n\r\n$(\".build-version\").html(VERSION);\r\n\r\nproj4.defs(\"EPSG:2326\", \"+proj=tmerc +lat_0=22.31213333333334 +lon_0=114.1785555555556 +k=1 +x_0=836694.05 +y_0=819069.8 +ellps=intl +towgs84=-162.619,-276.959,-161.764,0.067753,-2.24365,-1.15883,-1.09425 +units=m +no_defs\");\r\nproj4.defs(\"EPSG:4326\", \"+proj=longlat +datum=WGS84 +no_defs\");\r\n\r\nsettings.load();\r\n\r\nlang.changeLanguage(settings.get(\"preferred_language\", \"en\"));\r\n\r\nRequestLimiter.start();\r\n\r\nCors.register(\"www.gotowhere.ga\", true);\r\nCors.register(\"plugins.gotowhere.ga\", true);\r\n\r\nvar GTFS_DATA_TYPES = [\r\n    \"agency\",\r\n    \"calendar\",\r\n    \"calendar_dates\",\r\n    \"frequencies\",\r\n    \"routes\",\r\n    \"trips\",\r\n    \"stops\",\r\n    \"stop_time_paths\",\r\n    \"stop_times\",\r\n    \"fare_attributes\",\r\n    \"fare_rules\"\r\n];\r\n\r\nif (!window.indexedDB || !window.localStorage) {\r\n    $(\"#startup-status\").attr(\"style\", \"color: red\");\r\n    $(\"#startup-status\").html($.i18n(\"startup-status-not-supported\"));\r\n} else {\r\n    $(\"#startup-progress\").css(\"width\", \"0%\");\r\n    $(\"#startup-status\").html($.i18n(\"startup-status-loading-plugins\"));\r\n    PluginLoader.load(function (progress) {\r\n            $(\"#startup-progress\").css(\"width\", progress / 5 + \"%\");\r\n    }).then(function () {\r\n        $(\"#startup-status\").html($.i18n(\"startup-status-fetching-reference-db\"));\r\n        return TransitEta.fetchAllDatabase(function (progress) {\r\n            $(\"#startup-progress\").css(\"width\", (progress / 5 + 20) + \"%\");\r\n        });\r\n    }).then(function () {\r\n        $(\"#startup-status\").html($.i18n(\"startup-status-obtaining-db-version\"));\r\n        return Transit.obtainDatabaseVersion(function (progress) {\r\n            $(\"#startup-progress\").css(\"width\", (progress / 5  + 40) + \"%\");\r\n        });\r\n    }).then(function () {\r\n        $(\"#startup-status\").html($.i18n(\"startup-status-checking-db-update\"));\r\n        return Transit.checkDatabaseUpdate(function (progress) {\r\n            $(\"#startup-progress\").css(\"width\", (progress / 5 + 60) + \"%\");\r\n        });\r\n    }).then(function () {\r\n        $(\"#startup-status\").html($.i18n(\"startup-status-validating-db\"));\r\n        return Transit.validateAllDatabase(function (progress) {\r\n            $(\"#startup-progress\").css(\"width\", (progress / 5 + 80) + \"%\");\r\n        });\r\n    }).then(function () {\r\n        if (Transit.hasDatabaseUpdate()) {\r\n            Transit.initializeWorker();\r\n            var takeSomeTimeText = \"<b>\" + $.i18n(\"startup-status-load-db-take-some-time\") + \"</b><br />\";\r\n            $(\"#startup-status\").html(takeSomeTimeText + $.i18n(\"startup-status-downloading-db\"));\r\n            return Transit.downloadDatabase(function (progress) {\r\n                console.log(progress);\r\n                $(\"#startup-progress\").css(\"width\", progress / 8 + \"%\");\r\n            }).then(function () {\r\n                $(\"#startup-status\").html(takeSomeTimeText + $.i18n(\"startup-status-preparing-update\"));\r\n                return Transit.prepareUpdate(function (progress) {\r\n                    console.log(progress);\r\n                    $(\"#startup-progress\").css(\"width\", progress / 8 + 12.5 + \"%\");\r\n                });\r\n            }).then(function loadAllGtfs(i) {\r\n                if (typeof i !== \"number\") {\r\n                    i = 0;\r\n                }\r\n                var dataType = GTFS_DATA_TYPES[i];\r\n                $(\"#startup-status\").html(takeSomeTimeText + $.i18n(\"startup-status-loading-\" + dataType));\r\n                return Transit.readChunks(dataType, function (progress) {\r\n                    console.log(progress);\r\n                    $(\"#startup-progress\").css(\"width\", (((progress / 2 / GTFS_DATA_TYPES.length) + (i * 100 / GTFS_DATA_TYPES.length)) / 100 * 75 + 25) + \"%\");\r\n                }).then(function () {\r\n                    $(\"#startup-status\").html(takeSomeTimeText + $.i18n(\"startup-status-updating-\" + dataType));\r\n                    return Transit.waitToUpdate(function (progress) {\r\n                        console.log(progress);\r\n                        $(\"#startup-progress\").css(\"width\", (((progress / 2 + 50) / GTFS_DATA_TYPES.length + (i * 100 / GTFS_DATA_TYPES.length)) / 100 * 75 + 25) + \"%\");\r\n                    });\r\n                }).then(function () {\r\n                    if (i != GTFS_DATA_TYPES.length - 1) {\r\n                        return loadAllGtfs(i + 1);\r\n                    } else {\r\n                        Transit.terminateWorker();\r\n                    }\r\n                });\r\n            })\r\n        }\r\n    }).then(function () {\r\n        $(\"#startup-progress\").css(\"width\", \"100%\");\r\n        $(\"#startup-status\").html($.i18n(\"startup-status-init-map\"));\r\n        return Map.init();\r\n    }).then(function () {\r\n        $(\"#startup-status\").html($.i18n(\"startup-status-finish\"));\r\n        $(\".build-version\").fadeOut(2000);\r\n\r\n        var lastVer = localStorage.getItem(\"gtw-lastversion\");\r\n        if (lastVer && lastVer !== VERSION) {\r\n            console.log(\"Application updated to \" + VERSION + \". Showing change-log.\");\r\n            ui.showModal(\"updated\", VERSION);\r\n        }\r\n        localStorage.setItem(\"gtw-lastversion\", VERSION);\r\n\r\n        ui.init();\r\n\r\n        //TransitManager.start();\r\n        //TransitManager.forceUpdate();\r\n\r\n        var errPlugins = [];\r\n        var plugin;\r\n        for (var pluginKey in PluginLoader.plugins) {\r\n            plugin = PluginLoader.plugins[pluginKey];\r\n            if (plugin.status < 0) {\r\n                errPlugins.push(plugin);\r\n            }\r\n        }\r\n        console.log(errPlugins);\r\n\r\n        if (errPlugins.length) {\r\n            ui.showModal(\"errorplugins\", errPlugins);\r\n        }\r\n\r\n        loc.requestLocationAccess(function () {\r\n            //ui.init();\r\n            //TransitManager.forceUpdate();\r\n            $(\"#loc-status-btn\").addClass(\"btn-success\");\r\n            $(\"#loc-status-btn\").removeClass(\"btn-warning\");\r\n            setTimeout(function () {\r\n                $(\"#loc-status-btn\").fadeOut(500);\r\n            }, 2000);\r\n        }, function () {\r\n            $(\"#loc-status-btn\").addClass(\"btn-danger\");\r\n            $(\"#loc-status-btn\").removeClass(\"btn-warning\");\r\n            $(\"#loc-status-btn\").append(\" <span> \" + $.i18n(\"location-error\") + \"</span>\");\r\n            setTimeout(function () {\r\n                $(\"#loc-status-btn span\").fadeOut(500);\r\n            }, 5000);\r\n        });\r\n\r\n        setTimeout(function () {\r\n            $(\".footer\").animate({ height: 0, opacity: 0 }, 1000, function () {\r\n                $(\".footer\").css(\"display\", \"none\");\r\n            });\r\n        }, 2000);\r\n        $(\".startup\").fadeOut(1000, function () {\r\n            __stopHeaderAnimation = true;\r\n        });\r\n\r\n        //TODO: Check is raw\r\n        if (false) {\r\n            $(\"#bg-loaddb-status\").html(\"Preparing to build database...\");\r\n            $(\".bg-loaddb-panel\").fadeIn();\r\n            var worker = new Worker(\"./workers/bg-loaddb-worker.js\", { type: 'module' });\r\n            worker.addEventListener(\"message\", function (evt) {\r\n                var msg = evt.data;\r\n                if (msg.type === 0) {\r\n                    $(\"#bg-loaddb-status\").html(\"Finish!\");\r\n                    $(\".bg-loaddb-panel\").fadeOut();\r\n                } else if (msg.type === 1) {\r\n                    $(\"#bg-loaddb-status\").html(\"Building \" + msg.stage + \" database...\");\r\n                } else if (msg.type === 2) {\r\n                    console.log(msg.progress);\r\n                    $(\"#bg-loaddb-progress\").css(\"width\", msg.progress + \"%\");\r\n                }\r\n            });\r\n            worker.postMessage(\"stop_times\");\r\n        }\r\n    });\r\n}","var map = {\n\t\"./jquery.i18n\": 70,\n\t\"./jquery.i18n.emitter\": 71,\n\t\"./jquery.i18n.emitter.bidi\": 72,\n\t\"./jquery.i18n.emitter.bidi.js\": 72,\n\t\"./jquery.i18n.emitter.js\": 71,\n\t\"./jquery.i18n.fallbacks\": 73,\n\t\"./jquery.i18n.fallbacks.js\": 73,\n\t\"./jquery.i18n.js\": 70,\n\t\"./jquery.i18n.language\": 74,\n\t\"./jquery.i18n.language.js\": 74,\n\t\"./jquery.i18n.messagestore\": 75,\n\t\"./jquery.i18n.messagestore.js\": 75,\n\t\"./jquery.i18n.parser\": 76,\n\t\"./jquery.i18n.parser.js\": 76,\n\t\"./languages/bs\": 77,\n\t\"./languages/bs.js\": 77,\n\t\"./languages/dsb\": 78,\n\t\"./languages/dsb.js\": 78,\n\t\"./languages/fi\": 79,\n\t\"./languages/fi.js\": 79,\n\t\"./languages/ga\": 80,\n\t\"./languages/ga.js\": 80,\n\t\"./languages/he\": 81,\n\t\"./languages/he.js\": 81,\n\t\"./languages/hsb\": 82,\n\t\"./languages/hsb.js\": 82,\n\t\"./languages/hu\": 83,\n\t\"./languages/hu.js\": 83,\n\t\"./languages/hy\": 84,\n\t\"./languages/hy.js\": 84,\n\t\"./languages/la\": 85,\n\t\"./languages/la.js\": 85,\n\t\"./languages/ml\": 86,\n\t\"./languages/ml.js\": 86,\n\t\"./languages/os\": 87,\n\t\"./languages/os.js\": 87,\n\t\"./languages/ru\": 88,\n\t\"./languages/ru.js\": 88,\n\t\"./languages/sl\": 89,\n\t\"./languages/sl.js\": 89,\n\t\"./languages/uk\": 90,\n\t\"./languages/uk.js\": 90\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 146;","var content = require(\"!!../node_modules/css-loader/dist/cjs.js!./style.css\");\n\nif (typeof content === 'string') {\n  content = [[module.id, content, '']];\n}\n\nvar options = {}\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = require(\"!../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\")(content, options);\n\nif (content.locals) {\n  module.exports = content.locals;\n}\n","exports = module.exports = require(\"../node_modules/css-loader/dist/runtime/api.js\")(false);\n// Module\nexports.push([module.id, \"body {\\r\\n    width: 100%;\\r\\n    height: 100vh;\\r\\n    /* overflow: hidden; */\\r\\n    position: absolute;\\r\\n}\\r\\n\\r\\n.landscape-notice {\\r\\n    display: none;\\r\\n    width: 100%;\\r\\n    height: 100%;\\r\\n    background-color: white;\\r\\n    z-index: 5;\\r\\n    position: relative;\\r\\n    padding: 12%;\\r\\n    font-weight: bold;\\r\\n}\\r\\n\\r\\n/* Update Change-log */\\r\\n\\r\\n.build-version {\\r\\n    position: absolute;\\r\\n    top: 0;\\r\\n    right: 0;\\r\\n    z-index: 5;\\r\\n    padding-top: env(safe-area-inset-top);\\r\\n    margin: 1rem;\\r\\n}\\r\\n\\r\\n#updated-changelog {\\r\\n    white-space: normal;\\r\\n}\\r\\n\\r\\n/* Toast */\\r\\n\\r\\n.toast-stack-container {\\r\\n    position: absolute;\\r\\n    top: 0;\\r\\n    right: 0;\\r\\n    width: 100%;\\r\\n}\\r\\n\\r\\n#gtw-toast-stack {\\r\\n    position: absolute;\\r\\n    top: 0;\\r\\n    right: 0;\\r\\n    margin: 1rem;\\r\\n    z-index: 3;\\r\\n}\\r\\n\\r\\n/* Startup DIV CSS */\\r\\n\\r\\n.startup {\\r\\n    position: absolute;\\r\\n    top: 0;\\r\\n    background-color: white;\\r\\n    width: 100%;\\r\\n    height: 100%;\\r\\n    overflow: hidden;\\r\\n    z-index: 4;\\r\\n}\\r\\n\\r\\n.startup .container {\\r\\n    display: none;\\r\\n    position: relative;\\r\\n}\\r\\n\\r\\n.progress-panel {\\r\\n    position: absolute;\\r\\n    text-align: center;\\r\\n    width: 100%;\\r\\n    bottom: 0px;\\r\\n    z-index: 2;\\r\\n}\\r\\n\\r\\n.progress {\\r\\n    border-radius: 0px;\\r\\n}\\r\\n\\r\\n.bg-loaddb-panel {\\r\\n    display: none;\\r\\n}\\r\\n\\r\\n.request-progress-panel {\\r\\n    position: absolute;\\r\\n    text-align: center;\\r\\n    width: 100%;\\r\\n    left: 0px;\\r\\n    bottom: 0px;\\r\\n    display: none;\\r\\n}\\r\\n\\r\\n.startup .overlay {\\r\\n    position: absolute;\\r\\n    top: 0;\\r\\n    height: 100%;\\r\\n    width: 100%;\\r\\n    background-color: white;\\r\\n    opacity: 0.5;\\r\\n    z-index: 1;\\r\\n}\\r\\n\\r\\n.startup .progress-panel {\\r\\n    display: none;\\r\\n}\\r\\n\\r\\n/* Getting Started Panel */\\r\\n.getting-started-panel {\\r\\n    display: none;\\r\\n    padding: 1rem;\\r\\n    position: absolute;\\r\\n    z-index: 1;\\r\\n    width: 100%;\\r\\n    height: 100%;\\r\\n}\\r\\n\\r\\n.getting-started-panel p.app-title {\\r\\n    margin-top: 0.8125rem;\\r\\n    margin-left: 1rem;\\r\\n    margin-bottom: 0.8125rem;\\r\\n    white-space: nowrap;\\r\\n    line-height: inherit;\\r\\n    font-size: 1.25rem;\\r\\n}\\r\\n\\r\\n#gettingStartedWizard {\\r\\n    margin-top: 2rem;\\r\\n    background-color: white;\\r\\n    padding: 1rem;\\r\\n    width: 100%;\\r\\n}\\r\\n\\r\\n#gettingStartedWizard ul {\\r\\n    flex-wrap: nowrap;\\r\\n    overflow-x: auto;\\r\\n    overflow-y: hidden;\\r\\n}\\r\\n\\r\\n.getting-started-progress-panel {\\r\\n    display: none;\\r\\n}\\r\\n\\r\\n.getting-started-progress-panel .progress-panel {\\r\\n    text-align: center;\\r\\n}\\r\\n\\r\\n.getting-started-plugin-error-panel{\\r\\n    display: none;\\r\\n}\\r\\n\\r\\n/* ETA CSS */\\r\\n.bg-trans {\\r\\n    background-color: unset;\\r\\n}\\r\\n\\r\\n.half-map-container {\\r\\n    display: none;\\r\\n    width: 100%;\\r\\n    position: absolute;\\r\\n    overflow-x: hidden;\\r\\n    overflow-y: scroll;\\r\\n    z-index: 2;\\r\\n}\\r\\n\\r\\n.container {\\r\\n    padding: 0px;\\r\\n}\\r\\n\\r\\n.content-panel-container {\\r\\n\\r\\n}\\r\\n\\r\\n.item-list {\\r\\n    height: inherit;\\r\\n}\\r\\n\\r\\n.item-list .list-group {\\r\\n    width: 100%;\\r\\n    height: inherit;\\r\\n    overflow-x: hidden;\\r\\n    overflow-y: scroll;\\r\\n    z-index: 1;\\r\\n}\\r\\n\\r\\n.item-list .list-group li {\\r\\n    min-height: 100px;\\r\\n}\\r\\n\\r\\n.all-route-list {\\r\\n    display: none;\\r\\n}\\r\\n\\r\\n.stop-eta tr.active {\\r\\n    font-size: 18px;\\r\\n    font-weight: bold;\\r\\n}\\r\\n\\r\\n/* Map CSS */\\r\\n\\r\\n#gtw-map {\\r\\n    width: 100vw;\\r\\n    height: 100vh;\\r\\n    top: 0px;\\r\\n    left: 0px;\\r\\n    position: fixed;\\r\\n    overflow: hidden;\\r\\n}\\r\\n\\r\\n/* Search panel CSS */\\r\\n\\r\\n.top-panel {\\r\\n    padding: 8px;\\r\\n    margin-bottom: 0px;\\r\\n    background-color: unset;\\r\\n}\\r\\n\\r\\n.top-panel .tabs, .hori-scroll {\\r\\n    overflow: auto;\\r\\n    white-space: nowrap;\\r\\n    display: block;\\r\\n    padding: 4px;\\r\\n}\\r\\n\\r\\n.top-panel .tabs .ui-tab, .hori-scroll button {\\r\\n    display: inline-block;\\r\\n}\\r\\n\\r\\n#loc-status-btn {\\r\\n    margin-top: env(safe-area-inset-top);\\r\\n    margin-bottom: env(safe-area-inset-bottom);\\r\\n    position: fixed;\\r\\n    z-index: 3;\\r\\n    right: 4px;\\r\\n    bottom: 4px;\\r\\n}\\r\\n\\r\\n/* Header, footer CSS */\\r\\n\\r\\n.gtw-container {\\r\\n    position: fixed;\\r\\n    top: 0;\\r\\n    width: 100%;\\r\\n    z-index: 1;\\r\\n}\\r\\n\\r\\n/*\\r\\n.header nav {\\r\\n    background-color: #343a40\\r\\n}\\r\\n*/\\r\\n\\r\\n.footer {\\r\\n    padding-top: 8px;\\r\\n    padding-bottom: 0px;\\r\\n    position: fixed;\\r\\n    bottom: 0;\\r\\n    z-index: 2;\\r\\n    width: 100%;\\r\\n}\\r\\n\\r\\n.map-overlay {\\r\\n    position: fixed;\\r\\n    width: 100%;\\r\\n    height: 100%;\\r\\n    top: 0;\\r\\n    left: 0;\\r\\n    right: 0;\\r\\n    bottom: 0;\\r\\n    background-color: rgba(233,236,239,0.8);\\r\\n    z-index: 1;\\r\\n    cursor: pointer;\\r\\n}\\r\\n\\r\\n/* Loading Overlay CSS */\\r\\n\\r\\n.loading-overlay {\\r\\n    position: fixed;\\r\\n    display: none;\\r\\n    width: 100%;\\r\\n    height: 100%;\\r\\n    top: 0;\\r\\n    left: 0;\\r\\n    right: 0;\\r\\n    bottom: 0;\\r\\n    background-color: rgba(0,0,0,0.3);\\r\\n    z-index: 3;\\r\\n    opacity: 100;\\r\\n    cursor: pointer;\\r\\n}\\r\\n\\r\\n.loading-overlay .loading-spinner {\\r\\n    width: 100%;\\r\\n    height: 100%;\\r\\n}\\r\\n\\r\\n.loading-overlay .spinner-border {\\r\\n    width: 3rem;\\r\\n    height: 3rem;\\r\\n}\\r\\n\\r\\n/* Touch Keypad */\\r\\n\\r\\n.touch-keypad {\\r\\n    position: fixed;\\r\\n    left: 0;\\r\\n    bottom: 0;\\r\\n    width: 100%;\\r\\n    margin: 0px;\\r\\n    padding: 0px;\\r\\n    z-index: 2;\\r\\n    background: rgba(255, 255, 255, 0.4);\\r\\n    display: none;\\r\\n    padding-bottom: env(safe-area-inset-bottom);\\r\\n}\\r\\n\\r\\n.touch-keypad .numeric-keypad {\\r\\n    width: 75%;\\r\\n}\\r\\n\\r\\n.touch-keypad .letter-keypad {\\r\\n    width: 25%;\\r\\n    overflow-x: hidden;\\r\\n    overflow-y: auto;\\r\\n    white-space: nowrap;\\r\\n    justify-content: flex-start;\\r\\n}\\r\\n\\r\\n.touch-keypad-key {\\r\\n    min-height: 58px;\\r\\n}\\r\\n\\r\\n/* Route selection */\\r\\n\\r\\n.route-selection .route-id {\\r\\n    padding-right: 16px;\\r\\n    font-weight: bold;\\r\\n}\\r\\n\\r\\n.route-selection .stop-info {\\r\\n    margin-left: 8px;\\r\\n    margin-right: 8px;\\r\\n}\\r\\n\\r\\n.route-selection .stop-info .badge {\\r\\n\\r\\n}\\r\\n\\r\\n.route-selection .stop-info .col-sm-12{\\r\\n    white-space: nowrap;\\r\\n    overflow: hidden;\\r\\n    text-overflow: ellipsis; \\r\\n    width: inherit;\\r\\n}\\r\\n\\r\\n/* Search Transit Field */\\r\\n\\r\\n#search-transit-text {\\r\\n    background-color: #fff;\\r\\n}\\r\\n\\r\\n/* Half-map Panel */\\r\\n.half-map-panel {\\r\\n    display: none;\\r\\n    background-color: unset;\\r\\n    padding: 8px;\\r\\n    margin-bottom: 0px;\\r\\n    position: relative;\\r\\n    z-index: 1;\\r\\n}\\r\\n\\r\\n.mobile-split-container {\\r\\n    /*margin-top: 50vh;*/\\r\\n    display: none;\\r\\n    position: fixed;\\r\\n    left: 0;\\r\\n    bottom: 0;\\r\\n    width: 100%;\\r\\n    height: 80%;\\r\\n    padding: 0px;\\r\\n    background-color: rgba(233,236,239,0.8);\\r\\n}\\r\\n\\r\\n/* Route list */\\r\\n\\r\\n.view-alert-btn {\\r\\n    font-size: inherit;\\r\\n    padding: 0px;\\r\\n}\\r\\n\\r\\n/* Media Query */\\r\\n@media only screen and (min-width: 768px) {\\r\\n    .top-panel {\\r\\n        /*width: 25%;*/\\r\\n    }\\r\\n\\r\\n    .half-map-panel {\\r\\n        /*width: 25%;*/\\r\\n    }\\r\\n\\r\\n    .half-map-container {\\r\\n        /*width: 25%;*/\\r\\n        margin-left: 0;\\r\\n    }\\r\\n\\r\\n    .content-panel-container {\\r\\n        /*width: 25%;*/\\r\\n        margin-left: 0;\\r\\n    }\\r\\n\\r\\n    .request-progress-panel {\\r\\n        width: 25%;\\r\\n    }\\r\\n\\r\\n    #gtw-map {\\r\\n        width: 100vw;\\r\\n        /*width: 75%;\\r\\n        margin-left: 25%;*/\\r\\n    }\\r\\n\\r\\n    .gtw-container {\\r\\n        width: 25%;\\r\\n    }\\r\\n\\r\\n    .map-overlay {\\r\\n        width: 25%;\\r\\n        /*display: none;*/\\r\\n    }\\r\\n\\r\\n    .touch-keypad {\\r\\n        width: 25%;\\r\\n    }\\r\\n\\r\\n    .getting-started-panel {\\r\\n        /*width: 25%;*/\\r\\n    }\\r\\n\\r\\n    .desktop.half-map-panel.gtw-half-map {\\r\\n        display: block;\\r\\n    }\\r\\n\\r\\n    .desktop.half-map-container.gtw-half-map {\\r\\n        display: block;\\r\\n    }\\r\\n\\r\\n    .mobile.half-map-panel.gtw-half-map {\\r\\n        display: none;\\r\\n    }\\r\\n\\r\\n    .mobile.half-map-container.gtw-half-map {\\r\\n        display: none;\\r\\n    }\\r\\n}\\r\\n\\r\\n@media only screen and (max-width: 768px) {\\r\\n    .gtw-container nav {\\r\\n        margin-top: env(safe-area-inset-top);\\r\\n        background-color: unset;\\r\\n    }\\r\\n\\r\\n    .toast-stack-container {\\r\\n        margin-top: env(safe-area-inset-top);\\r\\n        margin-bottom: env(safe-area-inset-bottom);\\r\\n    }\\r\\n\\r\\n    .getting-started-panel {\\r\\n        padding-top: env(safe-area-inset-top);\\r\\n        padding-bottom: env(safe-area-inset-bottom);\\r\\n    }\\r\\n\\r\\n    .modal {\\r\\n        padding-top: env(safe-area-inset-top);\\r\\n        padding-bottom: env(safe-area-inset-bottom);\\r\\n    }\\r\\n\\r\\n    .mobile-split-container.gtw-half-map {\\r\\n        display: block;\\r\\n    }\\r\\n\\r\\n    .startup .progress-panel {\\r\\n        padding-bottom: env(safe-area-inset-bottom);\\r\\n    }\\r\\n\\r\\n    /*\\r\\n    body.gtw-half-map {\\r\\n        overflow-y: scroll;\\r\\n    }\\r\\n\\r\\n    #gtw-map {\\r\\n        display: none;\\r\\n    }\\r\\n    */\\r\\n\\r\\n    .map-overlay.gtw-half-map {\\r\\n        display: none;\\r\\n        /*margin-top: 50vh;\\r\\n        height: 50vh;*/\\r\\n    }\\r\\n\\r\\n    /*\\r\\n    #gtw-map.gtw-half-map {\\r\\n        height: 50vh;\\r\\n        display: block;\\r\\n    }\\r\\n    */\\r\\n\\r\\n    .desktop.half-map-panel.gtw-half-map {\\r\\n        display: none;\\r\\n    }\\r\\n\\r\\n    .desktop.half-map-container.gtw-half-map {\\r\\n        display: none;\\r\\n    }\\r\\n\\r\\n    .mobile.half-map-panel.gtw-half-map {\\r\\n        display: block;\\r\\n        /*height: 20vh;*/\\r\\n    }\\r\\n\\r\\n    .mobile.half-map-container.gtw-half-map {\\r\\n        display: block;\\r\\n        /*height: 30vh;*/\\r\\n        height: inherit;\\r\\n    }\\r\\n}\\r\\n\\r\\n/*\\r\\n@media only screen and (max-height: 768px) and (orientation: landscape) {\\r\\n    .landscape-notice {\\r\\n        display: block;\\r\\n    }\\r\\n}\\r\\n*/\\r\\n\\r\\n@media screen and (max-width: 470px) {\\r\\n    .startup h1 {\\r\\n        font-size: 10vw;\\r\\n    }\\r\\n}\\r\\n\\r\\n@media (prefers-color-scheme: dark) {\\r\\n    .map-overlay {\\r\\n        background-color: rgba(150, 150, 150, 0.8);\\r\\n    }\\r\\n\\r\\n    .mobile-split-container {\\r\\n        background-color: rgba(150, 150, 150, 0.8);\\r\\n    }\\r\\n\\r\\n    .list-group-item-light {\\r\\n        background-color: #dadada;\\r\\n    }\\r\\n    \\r\\n    #search-transit-text {\\r\\n        background-color: #ececec;\\r\\n    }\\r\\n\\r\\n    .btn, .btn-link, a {\\r\\n        color: #fff;\\r\\n    }\\r\\n\\r\\n    /*\\r\\n    .timeline-icon {\\r\\n        background: #a9a9a9;\\r\\n        color: #fff;\\r\\n    }\\r\\n\\r\\n    .timeline-icon.bg-light {\\r\\n        background-color: #a9a9a9!important;\\r\\n    }\\r\\n\\r\\n    .timeline-label {\\r\\n        background: #a9a9a9!important;\\r\\n    }\\r\\n\\r\\n    .timeline-label p{\\r\\n        color: #fff!important;\\r\\n    }\\r\\n    */\\r\\n\\r\\n    .startup {\\r\\n        background-color: #000;\\r\\n        color: #fff;\\r\\n    }\\r\\n\\r\\n    .build-version{\\r\\n        color: #fff;\\r\\n    }\\r\\n\\r\\n    .text-dark {\\r\\n        color: #fff!important;\\r\\n    }\\r\\n\\r\\n    #gettingStartedWizard {\\r\\n        background-color: #989898;\\r\\n    }\\r\\n\\r\\n    #gettingStartedWizard .nav-tabs{\\r\\n        border-bottom: unset;\\r\\n    }\\r\\n\\r\\n    #gettingStartedWizard li.active {\\r\\n        color: #ffffff!important;\\r\\n    }\\r\\n\\r\\n    #gettingStartedWizard li.done {\\r\\n        color: #cecece!important;\\r\\n    }\\r\\n\\r\\n    #gettingStartedWizard .step-content {\\r\\n        background-color: #989898;\\r\\n        color: #fff;\\r\\n    }\\r\\n\\r\\n    #gettingStartedWizard .sw-toolbar {\\r\\n        background-color: #989898;\\r\\n    }\\r\\n    \\r\\n}\", \"\"]);\n","var content = require(\"!!../node_modules/css-loader/dist/cjs.js!./timeline.css\");\n\nif (typeof content === 'string') {\n  content = [[module.id, content, '']];\n}\n\nvar options = {}\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = require(\"!../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\")(content, options);\n\nif (content.locals) {\n  module.exports = content.locals;\n}\n","exports = module.exports = require(\"../node_modules/css-loader/dist/runtime/api.js\")(false);\n// Module\nexports.push([module.id, \"\\r\\nimg {\\r\\n    vertical-align: middle;\\r\\n}\\r\\n\\r\\n.img-responsive {\\r\\n    display: block;\\r\\n    height: auto;\\r\\n    max-width: 100%;\\r\\n}\\r\\n\\r\\n.img-rounded {\\r\\n    border-radius: 3px;\\r\\n}\\r\\n\\r\\n.img-thumbnail {\\r\\n    background-color: #fff;\\r\\n    border: 1px solid #ededf0;\\r\\n    border-radius: 3px;\\r\\n    display: inline-block;\\r\\n    height: auto;\\r\\n    line-height: 1.428571429;\\r\\n    max-width: 100%;\\r\\n    moz-transition: all .2s ease-in-out;\\r\\n    o-transition: all .2s ease-in-out;\\r\\n    padding: 2px;\\r\\n    transition: all .2s ease-in-out;\\r\\n    webkit-transition: all .2s ease-in-out;\\r\\n}\\r\\n\\r\\n.img-circle {\\r\\n    border-radius: 50%;\\r\\n}\\r\\n\\r\\n.timeline-centered {\\r\\n    position: relative;\\r\\n    margin-bottom: 30px;\\r\\n}\\r\\n\\r\\n    .timeline-centered:before, .timeline-centered:after {\\r\\n        content: \\\" \\\";\\r\\n        display: table;\\r\\n    }\\r\\n\\r\\n    .timeline-centered:after {\\r\\n        clear: both;\\r\\n    }\\r\\n\\r\\n    .timeline-centered:before, .timeline-centered:after {\\r\\n        content: \\\" \\\";\\r\\n        display: table;\\r\\n    }\\r\\n\\r\\n    .timeline-centered:after {\\r\\n        clear: both;\\r\\n    }\\r\\n\\r\\n    .timeline-centered:before {\\r\\n        content: '';\\r\\n        position: absolute;\\r\\n        display: block;\\r\\n        width: 4px;\\r\\n        background: #f5f5f6;\\r\\n        /*left: 50%;*/\\r\\n        top: 20px;\\r\\n        bottom: 20px;\\r\\n        margin-left: 30px;\\r\\n    }\\r\\n\\r\\n    .timeline-centered .timeline-entry {\\r\\n        position: relative;\\r\\n        /*width: 50%;\\r\\n        float: right;*/\\r\\n        margin-top: 5px;\\r\\n        margin-left: 30px;\\r\\n        margin-bottom: 10px;\\r\\n        clear: both;\\r\\n    }\\r\\n\\r\\n        .timeline-centered .timeline-entry:before, .timeline-centered .timeline-entry:after {\\r\\n            content: \\\" \\\";\\r\\n            display: table;\\r\\n        }\\r\\n\\r\\n        .timeline-centered .timeline-entry:after {\\r\\n            clear: both;\\r\\n        }\\r\\n\\r\\n        .timeline-centered .timeline-entry:before, .timeline-centered .timeline-entry:after {\\r\\n            content: \\\" \\\";\\r\\n            display: table;\\r\\n        }\\r\\n\\r\\n        .timeline-centered .timeline-entry:after {\\r\\n            clear: both;\\r\\n        }\\r\\n\\r\\n        .timeline-centered .timeline-entry.begin {\\r\\n            margin-bottom: 0;\\r\\n        }\\r\\n\\r\\n        .timeline-centered .timeline-entry.left-aligned {\\r\\n            float: left;\\r\\n        }\\r\\n\\r\\n            .timeline-centered .timeline-entry.left-aligned .timeline-entry-inner {\\r\\n                margin-left: 0;\\r\\n                margin-right: -18px;\\r\\n            }\\r\\n\\r\\n                .timeline-centered .timeline-entry.left-aligned .timeline-entry-inner .timeline-time {\\r\\n                    left: auto;\\r\\n                    right: -100px;\\r\\n                    text-align: left;\\r\\n                }\\r\\n\\r\\n                .timeline-centered .timeline-entry.left-aligned .timeline-entry-inner .timeline-icon {\\r\\n                    float: right;\\r\\n                }\\r\\n\\r\\n                .timeline-centered .timeline-entry.left-aligned .timeline-entry-inner .timeline-label {\\r\\n                    margin-left: 0;\\r\\n                    margin-right: 70px;\\r\\n                }\\r\\n\\r\\n                    .timeline-centered .timeline-entry.left-aligned .timeline-entry-inner .timeline-label:after {\\r\\n                        left: auto;\\r\\n                        right: 0;\\r\\n                        margin-left: 0;\\r\\n                        margin-right: -9px;\\r\\n                        -moz-transform: rotate(180deg);\\r\\n                        -o-transform: rotate(180deg);\\r\\n                        -webkit-transform: rotate(180deg);\\r\\n                        -ms-transform: rotate(180deg);\\r\\n                        transform: rotate(180deg);\\r\\n                    }\\r\\n\\r\\n        .timeline-centered .timeline-entry .timeline-entry-inner {\\r\\n            position: relative;\\r\\n            margin-left: -20px;\\r\\n        }\\r\\n\\r\\n            .timeline-centered .timeline-entry .timeline-entry-inner:before, .timeline-centered .timeline-entry .timeline-entry-inner:after {\\r\\n                content: \\\" \\\";\\r\\n                display: table;\\r\\n            }\\r\\n\\r\\n            .timeline-centered .timeline-entry .timeline-entry-inner:after {\\r\\n                clear: both;\\r\\n            }\\r\\n\\r\\n            .timeline-centered .timeline-entry .timeline-entry-inner:before, .timeline-centered .timeline-entry .timeline-entry-inner:after {\\r\\n                content: \\\" \\\";\\r\\n                display: table;\\r\\n            }\\r\\n\\r\\n            .timeline-centered .timeline-entry .timeline-entry-inner:after {\\r\\n                clear: both;\\r\\n            }\\r\\n\\r\\n            .timeline-centered .timeline-entry .timeline-entry-inner .timeline-time {\\r\\n                position: absolute;\\r\\n                left: -100px;\\r\\n                text-align: right;\\r\\n                padding: 10px;\\r\\n                -webkit-box-sizing: border-box;\\r\\n                -moz-box-sizing: border-box;\\r\\n                box-sizing: border-box;\\r\\n            }\\r\\n\\r\\n                .timeline-centered .timeline-entry .timeline-entry-inner .timeline-time > span {\\r\\n                    display: block;\\r\\n                }\\r\\n\\r\\n                    .timeline-centered .timeline-entry .timeline-entry-inner .timeline-time > span:first-child {\\r\\n                        font-size: 15px;\\r\\n                        font-weight: bold;\\r\\n                    }\\r\\n\\r\\n                    .timeline-centered .timeline-entry .timeline-entry-inner .timeline-time > span:last-child {\\r\\n                        font-size: 12px;\\r\\n                    }\\r\\n\\r\\n            .timeline-centered .timeline-entry .timeline-entry-inner .timeline-icon {\\r\\n                background: #fff;\\r\\n                color: #737881;\\r\\n                display: block;\\r\\n                width: 40px;\\r\\n                height: 40px;\\r\\n                -webkit-background-clip: padding-box;\\r\\n                -moz-background-clip: padding;\\r\\n                background-clip: padding-box;\\r\\n                -webkit-border-radius: 20px;\\r\\n                -moz-border-radius: 20px;\\r\\n                border-radius: 20px;\\r\\n                text-align: center;\\r\\n                -moz-box-shadow: 0 0 0 5px #f5f5f6;\\r\\n                -webkit-box-shadow: 0 0 0 5px #f5f5f6;\\r\\n                box-shadow: 0 0 0 5px #f5f5f6;\\r\\n                line-height: 40px;\\r\\n                font-size: 15px;\\r\\n                float: left;\\r\\n            }\\r\\n\\r\\n                .timeline-centered .timeline-entry .timeline-entry-inner .timeline-icon.bg-primary {\\r\\n                    background-color: #303641;\\r\\n                    color: #fff;\\r\\n                }\\r\\n\\r\\n                .timeline-centered .timeline-entry .timeline-entry-inner .timeline-icon.bg-secondary {\\r\\n                    background-color: #ee4749;\\r\\n                    color: #fff;\\r\\n                }\\r\\n\\r\\n                .timeline-centered .timeline-entry .timeline-entry-inner .timeline-icon.bg-success {\\r\\n                    background-color: #00a651;\\r\\n                    color: #fff;\\r\\n                }\\r\\n\\r\\n                .timeline-centered .timeline-entry .timeline-entry-inner .timeline-icon.bg-info {\\r\\n                    background-color: #21a9e1;\\r\\n                    color: #fff;\\r\\n                }\\r\\n\\r\\n                .timeline-centered .timeline-entry .timeline-entry-inner .timeline-icon.bg-warning {\\r\\n                    background-color: #fad839;\\r\\n                    color: #fff;\\r\\n                }\\r\\n\\r\\n                .timeline-centered .timeline-entry .timeline-entry-inner .timeline-icon.bg-danger {\\r\\n                    background-color: #cc2424;\\r\\n                    color: #fff;\\r\\n                }\\r\\n\\r\\n            .timeline-centered .timeline-entry .timeline-entry-inner .timeline-label {\\r\\n                position: relative;\\r\\n                background: #f5f5f6;\\r\\n                padding: 1em;\\r\\n                margin-left: 60px;\\r\\n                -webkit-background-clip: padding-box;\\r\\n                -moz-background-clip: padding;\\r\\n                background-clip: padding-box;\\r\\n                -webkit-border-radius: 3px;\\r\\n                -moz-border-radius: 3px;\\r\\n                border-radius: 3px;\\r\\n            }\\r\\n\\r\\n                .timeline-centered .timeline-entry .timeline-entry-inner .timeline-label:after {\\r\\n                    content: '';\\r\\n                    display: block;\\r\\n                    position: absolute;\\r\\n                    width: 0;\\r\\n                    height: 0;\\r\\n                    border-style: solid;\\r\\n                    border-width: 9px 9px 9px 0;\\r\\n                    border-color: transparent #f5f5f6 transparent transparent;\\r\\n                    left: 0;\\r\\n                    top: 10px;\\r\\n                    margin-left: -9px;\\r\\n                }\\r\\n\\r\\n                .timeline-centered .timeline-entry .timeline-entry-inner .timeline-label h2, .timeline-centered .timeline-entry .timeline-entry-inner .timeline-label p {\\r\\n                    color: #737881;\\r\\n                    font-family: \\\"Noto Sans\\\",sans-serif;\\r\\n                    font-size: 12px;\\r\\n                    margin: 0;\\r\\n                    line-height: 1.428571429;\\r\\n                }\\r\\n\\r\\n                    .timeline-centered .timeline-entry .timeline-entry-inner .timeline-label p + p {\\r\\n                        margin-top: 15px;\\r\\n                    }\\r\\n\\r\\n                .timeline-centered .timeline-entry .timeline-entry-inner .timeline-label h2 {\\r\\n                    font-size: 16px;\\r\\n                }\\r\\n\\r\\n                    .timeline-centered .timeline-entry .timeline-entry-inner .timeline-label h2 button {\\r\\n                        color: #303641;\\r\\n                    }\\r\\n\\r\\n                    .timeline-centered .timeline-entry .timeline-entry-inner .timeline-label h2 span {\\r\\n                        -webkit-opacity: .6;\\r\\n                        -moz-opacity: .6;\\r\\n                        opacity: .6;\\r\\n                        -ms-filter: alpha(opacity=60);\\r\\n                        filter: alpha(opacity=60);\\r\\n                    }\\r\\n\", \"\"]);\n","// GTW Plugin Loader\r\n\r\nimport * as Misc from './gtw-misc';\r\nimport * as gtfs from './gtw-citydata-transit-gtfs';\r\nimport repos from './plugins/repository.json';\r\n\r\nexport var plugins = {};\r\n\r\nexport var installedPlugins = [];\r\n\r\nvar deprecatedPlugins = [\r\n    \"gtwp-kmb\"\r\n];\r\n\r\nexport function install(pkg, autoSave) {\r\n    if (isInstalled(pkg)) {\r\n        return false;\r\n    }\r\n    installedPlugins.push(pkg);\r\n    if (autoSave !== false){\r\n        save();\r\n    }\r\n    return true;\r\n}\r\n\r\nexport async function uninstall(pkg, autoSave) {\r\n    await gtfs.clearPackageDatabase(pkg);\r\n    var i;\r\n    for (i = 0; i < installedPlugins.length; i++){\r\n        if (installedPlugins[i] === pkg){\r\n            installedPlugins.splice(i, 1);\r\n            if (autoSave !== false) {\r\n                save();\r\n            }\r\n            return true;\r\n        }\r\n    }\r\n    return false;\r\n}\r\n\r\nexport function getPlugin(pkg) {\r\n    return plugins[pkg];\r\n}\r\n\r\nexport function isInstalled(pkg) {\r\n    for (var plugin of installedPlugins){\r\n        if (plugin === pkg){\r\n            return true;\r\n        }\r\n    }\r\n    return false;\r\n}\r\n\r\nexport function save() {\r\n    var localStorage = window.localStorage;\r\n    localStorage.setItem(\"gtw-plugins\", JSON.stringify(installedPlugins));\r\n    return true;\r\n}\r\n\r\nexport function load(pc) {\r\n    if (!localStorage){\r\n        console.error(\"Error: LocalStorage is not supported in this browser.\");\r\n        return;\r\n    }\r\n\r\n    var pluginsStr = localStorage.getItem(\"gtw-plugins\");\r\n\r\n    if (pluginsStr) {\r\n        installedPlugins = JSON.parse(pluginsStr);\r\n    }\r\n    \r\n    if (!installedPlugins || typeof installedPlugins.length !== \"number\"){\r\n        console.warn(\"Warning: Installed plugins JSON string is invalid. Resetting as empty.\");\r\n        save();\r\n    }\r\n    \r\n    var p;\r\n    var proms = [];\r\n    for (var installedPlugin of installedPlugins) {\r\n        if (deprecatedPlugins.includes(installedPlugin)) {\r\n            alert($.i18n(\"plugin-deprecated-auto-uninstall\", installedPlugin));\r\n            uninstall(installedPlugin);\r\n            continue;\r\n        }\r\n\r\n        const info = {\r\n            \"package\": installedPlugin,\r\n            status: 1,\r\n            msg: \"Not Enabled\"\r\n        };\r\n\r\n        if (repos[installedPlugin]){\r\n            proms.push(new Promise((resolve, reject) => {\r\n                import(`./plugins/${installedPlugin}/index.js`).then(function(mod) {\r\n                    var msg;\r\n                    if (!mod) {\r\n                        msg = $.i18n(\"plugin-error-no-module-returned\", installedPlugin);\r\n                        console.error(msg);\r\n                        info.status = -2;\r\n                        info.msg = msg;\r\n                    } else if (!mod.onload || typeof mod.onload !== \"function\") {\r\n                        msg = $.i18n(\"plugin-error-no-onload-function\", installedPlugin);\r\n                        console.error(msg);\r\n                        info.status = -3;\r\n                        info.msg = msg;\r\n                    } else {\r\n                        var promise = new Promise((resolve, reject) => {\r\n                            var status = mod.onload();\r\n                            if (status instanceof Promise) {\r\n                                status.then(resolve).catch(reject);\r\n                            } else {\r\n                                resolve(status);\r\n                            }\r\n                        });\r\n                        promise.then(function (status) {\r\n                            if (status) {\r\n                                info.status = 0;\r\n                                delete info.msg;\r\n                            } else {\r\n                                var msg = $.i18n(\"plugin-error-onload-function-error\", installedPlugin);\r\n                                console.error(msg);\r\n                                info.status = -4;\r\n                                info.msg = msg;\r\n                            }\r\n                            resolve();\r\n                        }).catch(reject);\r\n                    }\r\n                });\r\n            }));\r\n        } else {\r\n            info.status = -1;\r\n            info.msg = \"This plugin is not available in this version of GoToWhere.\";\r\n        }\r\n        plugins[installedPlugin] = info;\r\n    }\r\n    return Misc.allProgress(proms, pc);\r\n}","var map = {\n\t\"./en.json\": [\n\t\t191,\n\t\t43\n\t],\n\t\"./zh.json\": [\n\t\t192,\n\t\t44\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(function() {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn __webpack_require__.e(ids[1]).then(function() {\n\t\treturn __webpack_require__.t(id, 3);\n\t});\n}\nwebpackAsyncContext.keys = function webpackAsyncContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackAsyncContext.id = 162;\nmodule.exports = webpackAsyncContext;","module.exports = __webpack_public_path__ + \"1.3143549eae1b49940de8.worker.js\"","module.exports = __webpack_public_path__ + \"2.b6dfd31411fea68be1fe.worker.js\"","var map = {\n\t\"./gtwp-ctbnwfb/index.js\": [\n\t\t193,\n\t\t45\n\t],\n\t\"./gtwp-hktransit/index.js\": [\n\t\t194,\n\t\t46\n\t],\n\t\"./gtwp-kmblwb/index.js\": [\n\t\t195,\n\t\t47\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(function() {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn __webpack_require__.e(ids[1]).then(function() {\n\t\treturn __webpack_require__(id);\n\t});\n}\nwebpackAsyncContext.keys = function webpackAsyncContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackAsyncContext.id = 165;\nmodule.exports = webpackAsyncContext;","module.exports = __webpack_public_path__ + \"0.b76cc11f4701700919c3.worker.js\"","var map = {\n\t\"./gtw-map-googlemap\": [\n\t\t96,\n\t\t2\n\t],\n\t\"./gtw-map-googlemap.js\": [\n\t\t96,\n\t\t2\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(function() {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn __webpack_require__.e(ids[1]).then(function() {\n\t\treturn __webpack_require__(id);\n\t});\n}\nwebpackAsyncContext.keys = function webpackAsyncContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackAsyncContext.id = 184;\nmodule.exports = webpackAsyncContext;","var map = {\n\t\"./gtw-ui-modal-about\": [\n\t\t97,\n\t\t3\n\t],\n\t\"./gtw-ui-modal-about.js\": [\n\t\t97,\n\t\t3\n\t],\n\t\"./gtw-ui-modal-errorplugins\": [\n\t\t98,\n\t\t4\n\t],\n\t\"./gtw-ui-modal-errorplugins.js\": [\n\t\t98,\n\t\t4\n\t],\n\t\"./gtw-ui-modal-loading\": [\n\t\t99,\n\t\t5\n\t],\n\t\"./gtw-ui-modal-loading.js\": [\n\t\t99,\n\t\t5\n\t],\n\t\"./gtw-ui-modal-pluginclosedapi\": [\n\t\t100,\n\t\t6\n\t],\n\t\"./gtw-ui-modal-pluginclosedapi.js\": [\n\t\t100,\n\t\t6\n\t],\n\t\"./gtw-ui-modal-pluginmanager\": [\n\t\t101,\n\t\t0\n\t],\n\t\"./gtw-ui-modal-pluginmanager.js\": [\n\t\t101,\n\t\t0\n\t],\n\t\"./gtw-ui-modal-settings\": [\n\t\t102,\n\t\t7\n\t],\n\t\"./gtw-ui-modal-settings.js\": [\n\t\t102,\n\t\t7\n\t],\n\t\"./gtw-ui-modal-updated\": [\n\t\t103,\n\t\t8\n\t],\n\t\"./gtw-ui-modal-updated.js\": [\n\t\t103,\n\t\t8\n\t],\n\t\"./gtw-ui-modal-viewgtfsalerts\": [\n\t\t104,\n\t\t9\n\t],\n\t\"./gtw-ui-modal-viewgtfsalerts.js\": [\n\t\t104,\n\t\t9\n\t],\n\t\"./gtw-ui-modal-viewplugin\": [\n\t\t105,\n\t\t10\n\t],\n\t\"./gtw-ui-modal-viewplugin.js\": [\n\t\t105,\n\t\t10\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(function() {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn __webpack_require__.e(ids[1]).then(function() {\n\t\treturn __webpack_require__(id);\n\t});\n}\nwebpackAsyncContext.keys = function webpackAsyncContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackAsyncContext.id = 185;\nmodule.exports = webpackAsyncContext;","var map = {\n\t\"./modal-about-header.html\": [\n\t\t197,\n\t\t17\n\t],\n\t\"./modal-errorplugins-header.html\": [\n\t\t198,\n\t\t20\n\t],\n\t\"./modal-loading-header.html\": [\n\t\t199,\n\t\t23\n\t],\n\t\"./modal-pluginclosedapi-header.html\": [\n\t\t200,\n\t\t26\n\t],\n\t\"./modal-pluginmanager-header.html\": [\n\t\t201,\n\t\t29\n\t],\n\t\"./modal-settings-header.html\": [\n\t\t202,\n\t\t32\n\t],\n\t\"./modal-updated-header.html\": [\n\t\t203,\n\t\t35\n\t],\n\t\"./modal-viewgtfsalerts-header.html\": [\n\t\t204,\n\t\t38\n\t],\n\t\"./modal-viewplugin-header.html\": [\n\t\t205,\n\t\t41\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(function() {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn __webpack_require__.e(ids[1]).then(function() {\n\t\treturn __webpack_require__.t(id, 7);\n\t});\n}\nwebpackAsyncContext.keys = function webpackAsyncContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackAsyncContext.id = 186;\nmodule.exports = webpackAsyncContext;","var map = {\n\t\"./modal-about-body.html\": [\n\t\t206,\n\t\t15\n\t],\n\t\"./modal-errorplugins-body.html\": [\n\t\t207,\n\t\t18\n\t],\n\t\"./modal-loading-body.html\": [\n\t\t208,\n\t\t21\n\t],\n\t\"./modal-pluginclosedapi-body.html\": [\n\t\t209,\n\t\t24\n\t],\n\t\"./modal-pluginmanager-body.html\": [\n\t\t210,\n\t\t27\n\t],\n\t\"./modal-settings-body.html\": [\n\t\t211,\n\t\t30\n\t],\n\t\"./modal-updated-body.html\": [\n\t\t212,\n\t\t33\n\t],\n\t\"./modal-viewgtfsalerts-body.html\": [\n\t\t213,\n\t\t36\n\t],\n\t\"./modal-viewplugin-body.html\": [\n\t\t214,\n\t\t39\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(function() {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn __webpack_require__.e(ids[1]).then(function() {\n\t\treturn __webpack_require__.t(id, 7);\n\t});\n}\nwebpackAsyncContext.keys = function webpackAsyncContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackAsyncContext.id = 187;\nmodule.exports = webpackAsyncContext;","var map = {\n\t\"./modal-about-footer.html\": [\n\t\t215,\n\t\t16\n\t],\n\t\"./modal-errorplugins-footer.html\": [\n\t\t216,\n\t\t19\n\t],\n\t\"./modal-loading-footer.html\": [\n\t\t217,\n\t\t22\n\t],\n\t\"./modal-pluginclosedapi-footer.html\": [\n\t\t218,\n\t\t25\n\t],\n\t\"./modal-pluginmanager-footer.html\": [\n\t\t219,\n\t\t28\n\t],\n\t\"./modal-settings-footer.html\": [\n\t\t220,\n\t\t31\n\t],\n\t\"./modal-updated-footer.html\": [\n\t\t221,\n\t\t34\n\t],\n\t\"./modal-viewgtfsalerts-footer.html\": [\n\t\t222,\n\t\t37\n\t],\n\t\"./modal-viewplugin-footer.html\": [\n\t\t223,\n\t\t40\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(function() {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn __webpack_require__.e(ids[1]).then(function() {\n\t\treturn __webpack_require__.t(id, 7);\n\t});\n}\nwebpackAsyncContext.keys = function webpackAsyncContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackAsyncContext.id = 188;\nmodule.exports = webpackAsyncContext;","var map = {\n\t\"./gtw-ui-tab-transit\": [\n\t\t106,\n\t\t1\n\t],\n\t\"./gtw-ui-tab-transit.js\": [\n\t\t106,\n\t\t1\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(function() {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn __webpack_require__.e(ids[1]).then(function() {\n\t\treturn __webpack_require__(id);\n\t});\n}\nwebpackAsyncContext.keys = function webpackAsyncContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackAsyncContext.id = 189;\nmodule.exports = webpackAsyncContext;","//GTW Logging\r\n\r\nimport * as Settings from './gtw-settings';\r\n\r\nvar maxEntries = 1000;\r\n\r\nvar logEntries = [];\r\n\r\nvar jsTrace = console.trace;\r\nconsole.trace = function (msg) {\r\n    log(\"console\", msg, -1);\r\n};\r\n\r\nvar jsDebug = console.debug;\r\nconsole.debug = function (msg) {\r\n    log(\"console\", msg, -2);\r\n};\r\n\r\nvar jsInfo = console.log;\r\nconsole.log = function (msg) {\r\n    log(\"console\", msg, 0);\r\n};\r\n\r\nvar jsWarn = console.warn;\r\nconsole.warn = function (msg) {\r\n    log(\"console\", msg, 1);\r\n};\r\n\r\nvar jsError = console.error;\r\nconsole.error = function (msg) {\r\n    log(\"console\", msg, 2);\r\n};\r\n\r\nexport var printObject = true;\r\n\r\nexport function toConsole(msg, level) {\r\n    if (level === -2) {\r\n        jsTrace(msg);\r\n    } else if (level === -1) {\r\n        jsDebug(msg);\r\n    } else if (level === 0) {\r\n        jsInfo(msg);\r\n    } else if (level === 1) {\r\n        jsWarn(msg);\r\n    } else if (level === 2) {\r\n        jsError(msg);\r\n    }\r\n}\r\n\r\nexport function toLogger(tag, msg, time, level) {\r\n    if (logEntries.length >= maxEntries) {\r\n        logEntries.shift();\r\n    }\r\n    logEntries.push({\r\n        time: time,\r\n        msg: msg,\r\n        level: level\r\n    });\r\n\r\n    if (Settings.get(\"show_debug_msg\", false)) {\r\n        showToast(logEntries.length, tag, msg, time, level);\r\n    }\r\n}\r\n\r\nvar lastMsg = 0;\r\nvar lastTag = 0;\r\nvar lastLevel = 0;\r\nvar lastTime = 0;\r\n\r\nexport function showToast(id, tag, msg, time, level) {\r\n    if (level <= 0) {\r\n        return;\r\n    }\r\n\r\n    if (lastMsg === msg && lastTag === tag && lastLevel === level && time - lastTime < 7500) {\r\n        return;\r\n    }\r\n\r\n    lastTime = time;\r\n    lastMsg = msg;\r\n    lastTag = tag;\r\n    lastLevel = level;\r\n\r\n    var node = $(\"#gtw-toast-stack\");\r\n    var levelName = \"Unknown\";\r\n    var className = \"\";\r\n\r\n    if (level === -2) {\r\n        levelName = \"Trace\";\r\n    } else if (level === -1) {\r\n        levelName = \"Debug\";\r\n    } else if (level === 0) {\r\n        levelName = \"Info\";\r\n        className = \" text-primary\";\r\n    } else if (level === 1) {\r\n        levelName = \"Warning\";\r\n        className = \" text-warning\";\r\n    } else if (level === 2) {\r\n        levelName = \"Error\";\r\n        className = \" text-danger\";\r\n    }\r\n\r\n    var html =\r\n        \"<div class=\\\"toast\\\" role=\\\"alert\\\" log-entry-id=\\\"\" + id + \"\\\">\" +\r\n        \"    <div class=\\\"toast-header\\\">\" +\r\n        \"        <strong class=\\\"mr-auto\" + className + \"\\\">\" + levelName + \" (\" + tag + \")</strong>\" +\r\n        \"        <small class=\\\"text-muted\\\">\" + new Date(time).toLocaleString() + \"</small>\" +\r\n        \"        <button type=\\\"button\\\" class=\\\"ml-2 mb-1 close\\\" data-dismiss=\\\"toast\\\" aria-label=\\\"Close\\\"><span aria-hidden=\\\"true\\\">&times;</span></button>\" +\r\n        \"    </div>\" +\r\n        \"    <div class=\\\"toast-body\\\">\" + msg +\r\n        \"    </div>\" +\r\n        \"</div>\"\r\n        ;\r\n\r\n    if (node.children().length >= 3) {\r\n        node.children().each(function (i) {\r\n            if (i >= 2) {\r\n                $(this).toast('hide');\r\n            }\r\n        });\r\n    }\r\n\r\n    node.prepend(html);\r\n\r\n    var key = \".toast[log-entry-id='\" + id + \"']\";\r\n    $(key).on('hidden.bs.toast', function () {\r\n        $(this).remove();\r\n    });\r\n    $(key).toast({\r\n        animation: true,\r\n        autohide: true,\r\n        delay: 5000\r\n    });\r\n    $(key).toast('show');\r\n}\r\n\r\nexport function getEntries() {\r\n    return logEntries;\r\n}\r\n\r\nexport function log(tag = \"unknown\", msg, level = 0) {\r\n    var time = Date.now();\r\n\r\n    if (typeof msg === \"object\") {\r\n        if (printObject) {\r\n            toConsole(\"[\" + new Date(time).toLocaleString() + \"] [\" + tag + \"]\", level);\r\n            toConsole(msg, level);\r\n        } else {\r\n            var pmsg = JSON.stringify(msg);\r\n            toConsole(\"[\" + new Date(time).toLocaleString() + \"] [\" + tag + \"] \" + pmsg, level);\r\n        }\r\n    } else {\r\n        toConsole(\"[\" + new Date(time).toLocaleString() + \"] [\" + tag + \"] \" + msg, level);\r\n    }\r\n\r\n    toLogger(tag, msg, time, level);\r\n}\r\n\r\nexport function trace(tag, msg) {\r\n    log(tag, msg, -2);\r\n}\r\n\r\nexport function debug(tag, msg) {\r\n    log(tag, msg, -1);\r\n}\r\n\r\nexport function info(tag, msg) {\r\n    log(tag, msg, 0);\r\n}\r\n\r\nexport function warn(tag, msg) {\r\n    log(tag, msg, 1);\r\n}\r\n\r\nexport function error(tag, msg) {\r\n    log(tag, msg, 2);\r\n}","//GTW Map source code\r\n\r\nimport config from './gtw-config';\r\n\r\nexport var map = false;\r\n\r\nexport function init() {\r\n    return new Promise((resolve, reject) => {\r\n        import(`./gtw-map-${config.mapApi}`).then(function (m) {\r\n            map = m;\r\n            window.k = map;\r\n            map.init().then(function () {\r\n                resolve();\r\n            });\r\n        });\r\n    });\r\n}\r\n\r\nexport function setCenter(coords) {\r\n    return map.setCenter(coords);\r\n}\r\n\r\nexport function setZoom(zoom) {\r\n    return map.setZoom(zoom);\r\n}\r\n\r\nexport function addMarker(position, options) {\r\n    return map.addMarker(position, options);\r\n}\r\n\r\nexport function setMarkerPosition(markerId, position) {\r\n    return map.setMarkerPosition(markerId, position);\r\n}\r\n\r\nexport function lockMarker(markerId) {\r\n    return map.lockMarker(markerId);\r\n}\r\n\r\nexport function unlockMarker(markerId) {\r\n    return map.unlockMarker(markerId);\r\n}\r\n\r\nexport function removeMarker(markerId) {\r\n    return map.removeMarker(markerId);\r\n}\r\n\r\nexport function removeAllMarkers() {\r\n    return map.removeAllMarkers();\r\n}\r\n\r\nexport function addInfoWindow(markerId, content, open = false) {\r\n    return map.addInfoWindow(markerId, content, open);\r\n}\r\n\r\nexport function addPolyline(coords, strokeColor, strokeWeight, strokeOpacity = 1.0, geodesic = true) {\r\n    return map.addPolyline(coords, strokeColor, strokeWeight, strokeOpacity, geodesic);\r\n}\r\n\r\nexport function lockPolyline(polylineId) {\r\n    return map.lockPolyline(polylineId);\r\n}\r\n\r\nexport function unlockPolyline(polylineId) {\r\n    return map.unlockPolyline(polylineId);\r\n}\r\n\r\nexport function removePolyline(polylineId) {\r\n    return map.removePolyline(polylineId);\r\n}\r\n\r\nexport function removeAllPolylines() {\r\n    return map.removeAllPolylines();\r\n}\r\n\r\nexport function fitBounds(bounds) {\r\n    return map.fitBounds(bounds);\r\n}","//GTW UI\r\n\r\nimport * as Map from './gtw-map';\r\nimport * as PluginLoader from './gtw-pluginloader';\r\nimport * as Loc from './gtw-location';\r\nimport * as Event from './gtw-event';\r\n\r\nvar currentTabModule = false;\r\nvar currentModalModule = false;\r\n\r\n$(document).ready(function () {\r\n    $(\".header-links-plugins\").on(\"click\", function () {\r\n        showModal(\"pluginmanager\");\r\n    });\r\n    $(\".header-links-settings\").on(\"click\", function () {\r\n        showModal(\"settings\");\r\n    });\r\n    $(\".header-links-about\").on(\"click\", function () {\r\n        showModal(\"about\");\r\n    });\r\n    $(\".feedback-btn\").on(\"click\", function () {\r\n        window.open(\"https://forms.gle/nP9cp1V2rqhdqybv5\");\r\n    });\r\n});\r\n\r\n$(\".ui-tab\").on(\"click\", function () {\r\n    if ($(this).hasClass(\"btn-primary\")) {\r\n        return;\r\n    }\r\n    $(\".ui-tab\").removeClass(\"btn-primary\");\r\n    $(\".ui-tab\").removeClass(\"btn-link\");\r\n\r\n    var tab = $(this).attr(\"gtw-tab\");\r\n    $(this).addClass(\"btn-primary\");\r\n\r\n    $(\".ui-tab:not([gtw-tab='\" + tab + \"'])\").addClass(\"btn-link\");\r\n\r\n    showTab(tab);\r\n});\r\n\r\n$(\".btn\").on(\"click\", function () {\r\n    $(this).blur();\r\n});\r\n\r\n/*\r\n$(\".btn\").on(\"mouseup\", function () {\r\n    $(this).blur();\r\n});\r\n*/\r\n\r\n$(\".ui-half-map-back-btn\").on(\"click\", function () {\r\n    Event.dispatchEvent(Event.EVENTS.EVENT_UI_BACK);\r\n    Map.setCenter(Loc.getCurrentPosition());\r\n    Map.setZoom(16);\r\n    Map.removeAllMarkers();\r\n    Map.removeAllPolylines();\r\n    showPanel();\r\n});\r\n\r\nvar splitContainerPercent = 50;\r\n\r\n$(\".ui-pull-up-btn\").on(\"click\", function () {\r\n    if (splitContainerPercent >= 90) {\r\n        return;\r\n    }\r\n    splitContainerPercent += 10;\r\n    $(\".mobile-split-container\").css(\"height\", splitContainerPercent + \"%\");\r\n    adjustMargin();\r\n});\r\n\r\n$(\".ui-pull-down-btn\").on(\"click\", function () {\r\n    if (splitContainerPercent <= 10) {\r\n        return;\r\n    }\r\n    splitContainerPercent -= 10;\r\n    $(\".mobile-split-container\").css(\"height\", splitContainerPercent + \"%\");\r\n    adjustMargin();\r\n});\r\n\r\nvar darkMode = window.matchMedia && window.matchMedia(\"(prefers-color-scheme: dark)\").matches;\r\nif (darkMode) {\r\n    $(\".header nav\").removeClass(\"navbar-light\");\r\n    $(\".header nav\").addClass(\"navbar-dark\");\r\n}\r\n\r\nexport function init() {\r\n    if (Object.keys(PluginLoader.plugins).length === 0) {\r\n        gettingStarted();\r\n    }\r\n\r\n    showTab(\"transit\");\r\n    adjustMargin();\r\n    showPanel();\r\n}\r\n\r\nexport function showPanel() {\r\n    $(\".content-panel-container\").css(\"display\", \"inline-block\");\r\n    $(\".top-panel\").css(\"display\", \"block\");\r\n    $(\".header nav\").removeClass(\"gtw-half-map\");\r\n\r\n    $(\"body\").removeClass(\"gtw-half-map\");\r\n    $(\"#gtw-map\").removeClass(\"gtw-half-map\");\r\n    $(\".map-overlay\").removeClass(\"gtw-half-map\");\r\n    $(\".half-map-panel\").removeClass(\"gtw-half-map\");\r\n    $(\".half-map-container\").removeClass(\"gtw-half-map\");\r\n    $(\".mobile-split-container\").removeClass(\"gtw-half-map\");\r\n\r\n    //$(\".header nav\").addClass(\"bg-dark\");\r\n    //$(\".half-map-panel\").css(\"display\", \"none\");\r\n    //$(\".top-panel\").css(\"display\", \"block\");\r\n    //$(\".half-map-container\").css(\"display\", \"none\");\r\n    //$(\".map-overlay\").fadeIn(500);\r\n    adjustMargin();\r\n}\r\n\r\nexport function hidePanel() {\r\n    $(\".top-panel\").css(\"display\", \"none\");\r\n    $(\".content-panel-container\").css(\"display\", \"none\");\r\n    $(\".header nav\").addClass(\"gtw-half-map\");\r\n\r\n    //$(\"body\").addClass(\"gtw-half-map\");\r\n    $(\"#gtw-map\").addClass(\"gtw-half-map\");\r\n    $(\".map-overlay\").addClass(\"gtw-half-map\");\r\n    $(\".half-map-panel\").addClass(\"gtw-half-map\");\r\n    $(\".half-map-container\").addClass(\"gtw-half-map\");\r\n    $(\".mobile-split-container\").addClass(\"gtw-half-map\");\r\n\r\n    //$(\".half-map-panel\").css(\"display\", \"block\");\r\n    //$(\".half-map-container\").css(\"display\", \"block\");\r\n    //$(\".header nav\").removeClass(\"bg-dark\");\r\n    //$(\".map-overlay\").fadeOut(500);\r\n    adjustMargin();\r\n}\r\n\r\n/*\r\nexport function clearUp() {\r\n    Map.setCenter(Loc.getCurrentPosition());\r\n    Map.setZoom(16);\r\n    Map.removeAllMarkers();\r\n    Map.removeAllPolylines();\r\n\r\n    vars = {};\r\n    for (var key in timers) {\r\n        clearInterval(timers[key]);\r\n    }\r\n    timers = [];\r\n    $(\".tab-panel\").html(\"\");\r\n    $(\".content-panel-container\").html(\"\");\r\n}\r\n\r\nexport function modalClearUp() {\r\n    modalVars = {};\r\n    for (var timer of modalTimers) {\r\n        clearInterval(timer);\r\n    }\r\n}\r\n*/\r\n\r\nexport function showModal(layout, ...args) {\r\n    //nowUi = layout;\r\n    //previousUi = 0;\r\n    cleanUpModal();\r\n    loadModalLayout(layout, true).then(function () {\r\n        $(\".modal\").i18n();\r\n        import(`./gtw-ui-modal-${layout}`).then(function (module) {\r\n            currentModalModule = module;\r\n            module.enable.apply(this, args);\r\n        });\r\n    });\r\n}\r\n\r\nexport function loadModalLayout(layout, options = {}) {\r\n    const key = \"modal-\" + layout;\r\n\r\n    if (options === true) {\r\n        options = {};\r\n        options.backdrop = \"static\";\r\n        options.keyboard = false;\r\n    }\r\n    \r\n    var proms = [];\r\n    proms.push(import(`./ui/${key}-header.html`).then(function (mod) {\r\n        $(\".modal-header\").html(mod.default);\r\n    }));\r\n    proms.push(import(`./ui/${key}-body.html`).then(function (mod) {\r\n        $(\".modal-body\").html(mod.default);\r\n    }));\r\n    proms.push(import(`./ui/${key}-footer.html`).then(function (mod) {\r\n        $(\".modal-footer\").html(mod.default);\r\n    }));\r\n\r\n    var p = Promise.all(proms);\r\n    p.then(function () {\r\n        $(\".modal\").modal(options);\r\n    });\r\n    return p;\r\n}\r\n\r\nexport function hideModal() {\r\n    $(\".modal\").modal(\"hide\");\r\n    cleanUpModal();\r\n}\r\n\r\nexport function isModalShown() {\r\n    return ($(\".modal\").data('bs.modal') || {})._isShown;\r\n}\r\n\r\nexport function cleanUpModal() {\r\n    if (currentModalModule) {\r\n        currentModalModule.disable();\r\n        currentModalModule = false;\r\n    }\r\n}\r\n\r\nexport function cleanUpTab() {\r\n    if (currentTabModule) {\r\n        currentTabModule.disable();\r\n        currentTabModule = false;\r\n    }\r\n}\r\n\r\nexport function showTab(tab) {\r\n    cleanUpTab();\r\n    import(`./gtw-ui-tab-${tab}`).then(function (module) {\r\n        currentTabModule = module;\r\n        module.enable();\r\n    });\r\n}\r\n\r\nexport function gettingStarted() {\r\n    cleanUpTab();\r\n    cleanUpModal();\r\n    import(\"./gtw-ui-gettingstarted\").then(function (module) {\r\n        module.enable();\r\n    });\r\n}\r\n\r\n//\r\n// Available scripts\r\n//\r\n// Modal: updated, pluginclosedapi, errorplugins, viewplugin, pluginmanager, settings\r\n// Tab: transit\r\n//","//GTW CORS Handling\r\n\r\nimport xhook from 'xhook';\r\n\r\nconst CORS_PROTOCOL = \"https://\";\r\n\r\nexport var domains = {};\r\n\r\nexport function register(domain, allowCors = false) {\r\n    var config = {};\r\n    config.allowCors = allowCors;\r\n    domains[domain] = config;\r\n}\r\n\r\nxhook.before(function (request, callback) {\r\n    var Cors = require(\"./gtw-cors\");\r\n    var Settings = require(\"./gtw-settings\");\r\n\r\n    if (Settings.get(\"cors_check_bypass\", false)) {\r\n        callback();\r\n        return;\r\n    }\r\n\r\n    var cors = Cors.isCors(request.url);\r\n\r\n    if (cors) {\r\n        var host = Cors.extractHost(request.url);\r\n\r\n        if (!host || host === \"\" || host === \"___local___\") {\r\n            callback();\r\n            return;\r\n        }\r\n\r\n        var config = Cors.domains[host];\r\n        if (!config) {\r\n            console.error(\"gtw-cors: The request to \\\"\" + host + \"\\\" was dropped, because this cross-domain host was not registered before performing AJAX.\");\r\n            callback({\r\n                status: 403,\r\n                statusText: 'The request is dropped by GoToWhere because this host was not registered before performing AJAX.',\r\n                headers: {}\r\n            });\r\n            return;\r\n        }\r\n\r\n        if (config.allowCors) {\r\n            callback();\r\n            return;\r\n        }\r\n\r\n        if (Settings.get(\"use_cors_proxy\", true)) {\r\n            var proxy = Settings.get(\"cors_proxy_server\", \"https://cp1.gotowhere.ga/\");\r\n            if (proxy.startsWith(\"https://\") && proxy.endsWith(\"/\")) {\r\n                var index = request.url.indexOf(\"http://\");\r\n                var sindex = request.url.indexOf(\"https://\");\r\n                if (index !== -1 && sindex === -1) {\r\n                    request.url = proxy + request.url.substring(index + 7);\r\n                } else if (index === -1 && sindex !== -1) {\r\n                    request.url = proxy + request.url.substring(sindex + 8);\r\n                } else {\r\n                    console.error(\"gtw-cors: Invalid URL: \" + request.url);\r\n                    callback({\r\n                        status: 403,\r\n                        statusText: 'Invalid URL: ' + request.url,\r\n                        headers: {}\r\n                    });\r\n                    return;\r\n                }\r\n            } else {\r\n                console.error(\"gtw-cors: The provided CORS Proxy server is invalid! Please check if the server URL in the settings is correct!\");\r\n                callback({\r\n                    status: 403,\r\n                    statusText: 'The provided CORS Proxy server is invalid! Please check if the server URL in the settings is correct!.',\r\n                    headers: {}\r\n                });\r\n                return;\r\n            }\r\n        } else {\r\n            console.error(\"gtw-cors: The request was dropped because there are no proxy available to handle CORS requests.\");\r\n            callback({\r\n                status: 403,\r\n                statusText: 'The request was dropped because there are no proxy available to handle CORS requests.',\r\n                headers: {}\r\n            });\r\n            return;\r\n        }\r\n    }\r\n\r\n    callback();\r\n});\r\n\r\nexport function extractHost(url) {\r\n    if (!url.includes(\"://\")) {\r\n        return \"___local___\";\r\n    } else if (url.startsWith(\"file://\")) {\r\n        return \"___file___\";\r\n    }\r\n    var i = url.indexOf(\"://\");\r\n    var last = url.substring(i + 3);\r\n\r\n    i = last.indexOf(\"/\");\r\n    if (i === -1) {\r\n        i = last.length();\r\n    }\r\n    return last.substring(0, i);\r\n}\r\n\r\nexport function isCors(url) {\r\n    if (!url.startsWith(CORS_PROTOCOL)) {\r\n        return true;\r\n    }\r\n\r\n    var host = extractHost(url);\r\n\r\n    if (domains[host]) {\r\n        var config = domains[host];\r\n        if (config.allowCors) {\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n\r\n    return window.location.host !== host;\r\n}","//GTW Location Manager\r\n\r\nimport * as Map from './gtw-map';\r\nimport * as Event from './gtw-event';\r\n\r\nconst LOCATION_MANAGER_CONVENTION_KEY = \"openeta-location-convention\";\r\n\r\nconst CONVENTION_ASK_EVERYTIME = \"CONVENTION_ASK_EVERYTIME\";\r\nconst CONVENTION_CUSTOM_LOCATION = \"CONVENTION_CUSTOM_LOCATION\";\r\nconst CONVENTION_ASK_LOCATION_ACCESS = \"CONVENTION_ASK_LOCATION_ACCESS\";\r\nconst CONVENTION_DIRECT_LOCATION_ACCESS = \"CONVENTION_DIRECT_LOCATION_ACCESS\";\r\n\r\nexport var watchId = 0;\r\n\r\nexport var markerId = 0;\r\n\r\nexport var currentPosition = { lat: 22.2952296, lng: 114.1766577 };\r\n\r\nvar located = false;\r\n\r\nvar error = false;\r\n\r\nexport function getConvention() {\r\n    var localStorage = window.localStorage;\r\n    if (!localStorage || !localStorage.getItem(LOCATION_MANAGER_CONVENTION_KEY)) {\r\n        return CONVENTION_ASK_EVERYTIME;\r\n    }\r\n    return localStorage.getItem(LOCATION_MANAGER_CONVENTION_KEY);\r\n}\r\n\r\nexport function setConvention(convention) {\r\n    var localStorage = window.localStorage;\r\n    if (!localStorage) {\r\n        return;\r\n    }\r\n    localStorage.setItem(LOCATION_MANAGER_CONVENTION_KEY, convention);\r\n}\r\n\r\nexport function requestLocationAccess(successFunc = function () { }, errorFunc = function () { }) {\r\n    if (!navigator.geolocation) {\r\n        errorFunc(ERROR_NOT_SUPPORTED);\r\n        return;\r\n    }\r\n\r\n    var global = this;\r\n\r\n    navigator.geolocation.getCurrentPosition(function (position) {\r\n        located = true;\r\n        currentPosition = {\r\n            lat: position.coords.latitude,\r\n            lng: position.coords.longitude\r\n        };\r\n\r\n        Map.setCenter(currentPosition);\r\n        Map.setZoom(16);\r\n\r\n        markerId = Map.addMarker(currentPosition, {\r\n            icon: \"img/star.png\"\r\n        });\r\n        Map.lockMarker(markerId);\r\n\r\n        watchId = navigator.geolocation.watchPosition(\r\n            onPositionChangeSuccess,\r\n            onPositionChangeError,\r\n            {\r\n                enableHighAccuracy: false,\r\n                timeout: 5000,\r\n                maximumAge: 0\r\n            }\r\n        );\r\n        Event.dispatchEvent(Event.EVENTS.EVENT_LOCATION_SUCCESS);\r\n        successFunc(currentPosition);\r\n    }, function (err) {\r\n        located = false;\r\n        error = err;\r\n        Event.dispatchEvent(Event.EVENTS.EVENT_LOCATION_ERROR, err);\r\n        errorFunc(err);\r\n    }, { timeout: 10000 });\r\n}\r\n\r\nexport function isLocated() {\r\n    return located;\r\n}\r\n\r\nexport function isErrored() {\r\n    return error !== false;\r\n}\r\n\r\nexport function getError() {\r\n    return error;\r\n}\r\n\r\nexport function getCurrentPosition() {\r\n    return currentPosition;\r\n}\r\n\r\nexport function onPositionChangeSuccess(position) {\r\n    currentPosition = {\r\n        lat: position.coords.latitude,\r\n        lng: position.coords.longitude\r\n    };\r\n    located = true;\r\n    error = false;\r\n    Map.setMarkerPosition(markerId, currentPosition);\r\n    Event.dispatchEvent(Event.EVENTS.EVENT_LOCATION_CHANGE, currentPosition);\r\n}\r\n\r\nexport function onPositionChangeError(err) {\r\n    located = false;\r\n    error = err;\r\n    Event.dispatchEvent(Event.EVENTS.EVENT_LOCATION_ERROR, err);\r\n}","//GTW Database\r\nimport Dexie from 'dexie';\r\n\r\nexport var db = new Dexie(\"gtw-db\");\r\n\r\ndb.version(2).stores({\r\n    \"pluginStorage\": \"package\",\r\n    \"transitReference\": \"[package+provider]\"\r\n});\r\n\r\nexport async function putPluginStorage(pkg, data) {\r\n    var clone = Object.assign({}, data);\r\n    return await db[\"pluginStorage\"].put({\r\n        \"package\": pkg,\r\n        data: clone\r\n    });\r\n};\r\n\r\nexport async function getPluginStorage(pkg) {\r\n    return await db[\"pluginStorage\"].where(\"package\")\r\n        .equals(pkg).first();\r\n}\r\n\r\nexport async function getTransitReference(pkg, provider) {\r\n    return await db[\"transitReference\"].where(\"[package+provider]\")\r\n        .equals([pkg, provider]).first();\r\n}\r\n\r\nexport async function putTransitReference(data) {\r\n    if (!data[\"package\"] || !data[\"provider\"]) {\r\n        console.error(\"Error: Database missing package or provider parameter(s).\");\r\n        return;\r\n    }\r\n    return await db[\"transitReference\"].put(data);\r\n}","// GTW Language\r\n\r\nimport * as Settings from './gtw-settings';\r\n\r\nexport const languages = {\r\n    \"en\": \"English\",\r\n    \"zh\": \"\\u7e41\\u9ad4\\u4e2d\\u6587\"\r\n};\r\n\r\nexport function translatedString(transStr) {\r\n    var lang = getLanguage();\r\n    var locale = getLocale();\r\n\r\n    for (var trans of transStr.translation) {\r\n        if (trans.language === lang) {\r\n            return trans.text;\r\n        }\r\n    }\r\n\r\n    for (var trans of transStr.translation) {\r\n        if (trans.language === locale || trans.language.split(\"-\")[0] === locale) {\r\n            return trans.text;\r\n        }\r\n    }\r\n\r\n    for (var trans of transStr.translation) {\r\n        if (trans.language === \"en\") {\r\n            return trans.text;\r\n        }\r\n    }\r\n\r\n    return false;\r\n}\r\n\r\nexport function localizedKey(localizedObject, key) {\r\n    var lang = getLanguage();\r\n    var locale = getLocale();\r\n\r\n    var langKey = key + \"_\" + lang;\r\n    var localeKey = key + \"_\" + locale;\r\n    var enKey = key + \"_en\";\r\n\r\n    if (localizedObject[langKey]) {\r\n        return localizedObject[langKey];\r\n    }\r\n\r\n    if (localizedObject[localeKey]) {\r\n        return localizedObject[localeKey];\r\n    }\r\n\r\n    if (localizedObject[enKey]) {\r\n        return localizedObject[enKey];\r\n    }\r\n\r\n    if (localizedObject[key]) {\r\n        return localizedObject[key];\r\n    }\r\n    return false;\r\n}\r\n\r\nexport function getLanguage() {\r\n    return Settings.get(\"preferred_language\", \"en\");\r\n};\r\n\r\nexport function getLocale() {\r\n    return Settings.get(\"preferred_language\", \"en\").split(\"-\")[0];\r\n};\r\n\r\nexport function changeLanguage(locale) {\r\n    var found = false;\r\n    for (var x in languages) {\r\n        if (locale === x) {\r\n            found = true;\r\n            break;\r\n        }\r\n    }\r\n    if (!found) {\r\n        return false;\r\n    }\r\n\r\n    Settings.set(\"preferred_language\", locale);\r\n    Settings.save();\r\n    $.i18n().locale = locale;\r\n    return import(`./i18n/${locale}.json`).then(function (module) {\r\n        $.i18n().load(module.default, locale);\r\n        $(\"body\").i18n();\r\n    });\r\n}","//City Data: Transit ETA\r\nimport * as Misc from './gtw-misc';\r\nimport * as Database from './gtw-db';\r\nimport { transit_realtime } from 'gtfs-realtime-bindings';\r\n\r\nvar providers = [];\r\n\r\nvar cache = {};\r\n\r\nexport function clearCache() {\r\n    cache = {};\r\n}\r\n\r\nexport function timeDifference(a, b) {\r\n    var x = a.hr * 60 + a.min;\r\n    var y = b.hr * 60 + b.min;\r\n    return x - y;\r\n}\r\n\r\nexport function registerProvider(pkg, id, etaProviders, provider) {\r\n    if (!provider.fetchEta || typeof provider.fetchEta !== \"function\" ||\r\n        !provider.fetchDatabase || typeof provider.fetchDatabase !== \"function\" ||\r\n        !provider.checkDatabaseUpdate || typeof provider.checkDatabaseUpdate !== \"function\") {\r\n        throw new Error(\"Error: \" + id + \" does not contain fetchEta, fetchDatabase or checkDatabaseUpdate function!\");\r\n    }\r\n\r\n    provider.pkg = pkg;\r\n    provider.id = id;\r\n    provider.etaProviders = etaProviders;\r\n    provider.db = false;\r\n\r\n    if (typeof name === \"object\") {\r\n        provider[\"name\"] = name[\"default\"];\r\n        for (var key in name) {\r\n            provider[\"name_\" + key] = name[key];\r\n        }\r\n    } else {\r\n        provider.name = name;\r\n    }\r\n\r\n    providers.push(provider);\r\n}\r\n\r\nexport function unregisterProvider(pkg, id) {\r\n    var found = -1;\r\n    for (var i = 0; i < providers.length; i++) {\r\n        if (providers[i].pkg === pkg && providers[i].id === id) {\r\n            found = i;\r\n        }\r\n    }\r\n    providers.splice(found, 1);\r\n}\r\n\r\nexport function getProviders() {\r\n    return providers;\r\n}\r\n\r\nexport function getProvider(pkg, id) {\r\n    for (var provider of providers) {\r\n        if (provider.pkg === pkg && provider.id === id) {\r\n            return provider;\r\n        }\r\n    }\r\n    return false;\r\n}\r\n\r\nexport function getEtaProvider(etaProvider) {\r\n    for (var provider of providers) {\r\n        if (provider.etaProviders.includes(etaProvider)){\r\n            return provider;\r\n        }\r\n    }\r\n    return false;\r\n}\r\n\r\nexport async function fetchAllDatabase(pc) {\r\n    var db;\r\n    for (var provider of providers) {\r\n        db = await Database.getTransitReference(provider.pkg, provider.id);\r\n        if (!db) {\r\n            continue;\r\n        }\r\n        provider.db = db;\r\n    }\r\n\r\n    var needs = {};\r\n    for (var provider of providers) {\r\n        if (provider.db) {\r\n            console.log(\"has db \" + provider.id);\r\n            try {\r\n                var needed = await new Promise((resolve, reject) => {\r\n                    provider.checkDatabaseUpdate(resolve, reject, provider.db.version);\r\n                });\r\n                console.log(\"update: \" + provider.id + \" \" + needed);\r\n                needs[provider.id] = needed;\r\n            } catch (err) {\r\n                console.error(\"Error: Database check update for \" + provider.id + \" failed!\");\r\n                needs[provider.id] = false;\r\n            }\r\n        } else {\r\n            console.log(\"No db found for \" + provider.id);\r\n            needs[provider.id] = true;\r\n        }\r\n    }\r\n    console.log(needs);\r\n    for (var provider of providers) {\r\n        if (needs[provider.id]) {\r\n            try {\r\n                var data = await new Promise((resolve, reject) => {\r\n                    provider.fetchDatabase(resolve, reject);\r\n                });\r\n                if (!data[\"package\"] || !data[\"provider\"] || !data.version) {\r\n                    console.error(\"Error: Returned reference database is missing version, package or provider parameter(s) for \" + (data.provider ? data.provider : \"unknown provider\") + \".\");\r\n                    return;\r\n                }\r\n                provider.db = data;\r\n                await Database.putTransitReference(data);\r\n            } catch (err) {\r\n                console.error(\"Error: Database fetch for \" + provider.id + \" failed!\");\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nexport function fetchEta(opt) {\r\n    if (!opt.agency || !opt.route || !opt.trip || !opt.stopTimes || !opt.stop) {\r\n        console.error(\"Error: Fetch ETA missing agency, route, trip or stop parameter.\");\r\n        return false;\r\n    }\r\n    return new Promise((resolve, reject) => {\r\n        var proms = [];\r\n        var count = 0;\r\n        for (var providerId of opt.etaProviders) {\r\n            proms.push(new Promise((resolve, reject) => {\r\n                var provider = getEtaProvider(providerId);\r\n\r\n                if (!provider) {\r\n                    resolve();\r\n                    console.log(\"Could not find registered Transit ETA provider with name \\\"\" + providerId + \"\\\"\");\r\n                    return;\r\n                }\r\n\r\n                count++;\r\n\r\n                var key = providerId + \"-\" + opt.route[\"route_id\"] + \"-\" + opt.trip[\"trip_id\"] + \"-\" + opt.stop[\"stop_id\"];\r\n                var cached = cache[key];\r\n                var now = new Date();\r\n\r\n                if (cached && (now - cached.lastFetched) > 30000) {\r\n                    cached = false;\r\n                    delete cache[key];\r\n                }\r\n\r\n                if (!cached) {\r\n                    var global = this;\r\n                    var p = new Promise((resolve, reject) => {\r\n                        provider.fetchEta(resolve, reject, opt);\r\n                    });\r\n                    p.then(function (feed) {\r\n                        var obj = transit_realtime.FeedMessage.fromObject(feed);\r\n                        var result = transit_realtime.FeedMessage.verify(obj);\r\n                        if (result !== null) {\r\n                            console.error(\"Error: Returned feed is invalid: \" + result);\r\n                            return;\r\n                        }\r\n\r\n                        var time = new Date();\r\n\r\n                        cache[key] = {\r\n                            lastFetched: time.getTime(),\r\n                            feed: obj\r\n                        };\r\n\r\n                        resolve(obj);\r\n                    }).catch(function (err) {\r\n                        reject(opt, err);\r\n                    });\r\n                } else {\r\n                    resolve(cached.feed);\r\n                }\r\n            }));\r\n        }\r\n        Promise.all(proms).then(function (feeds) {\r\n            if (count > 0) {\r\n                var out = [];\r\n                for (var feed of feeds) {\r\n                    if (feed && feed.header && feed.entity) {\r\n                        out.push(feed);\r\n                    }\r\n                }\r\n                resolve({\r\n                    feeds: out,\r\n                    options: opt,\r\n                    code: 0\r\n                })\r\n            } else if (opt.etaProviders && opt.etaProviders.length > 0) {\r\n                resolve({\r\n                    code: -2,\r\n                    options: opt\r\n                });\r\n            } else {\r\n                resolve({\r\n                    code: -1,\r\n                    options: opt\r\n                });\r\n            }\r\n        }).catch(reject);\r\n    });\r\n}\r\n\r\nexport function getCache() {\r\n    return cache;\r\n}","//GTW Request Limiter\r\n\r\nexport var requests = [];\r\n\r\nexport var duration = 500;\r\n\r\nexport var running = false;\r\n\r\nexport function queue(func, args) {\r\n    if (typeof func !== \"function\") {\r\n        throw new TypeError(\"The variable must be a 'function'.\");\r\n    }\r\n    requests.push([func, args]);\r\n    return func;\r\n}\r\n\r\nexport function stack(func, args) {\r\n    if (typeof func !== \"function\") {\r\n        throw new TypeError(\"The variable must be a 'function'.\");\r\n    }\r\n    requests.unshift([func, args]);\r\n    return func;\r\n}\r\n\r\nexport function start() {\r\n    if (running) {\r\n        return;\r\n    }\r\n\r\n    running = true;\r\n    dispatch();\r\n}\r\n\r\nexport function dispatch() {\r\n    var next = requests.shift();\r\n    var global = this;\r\n\r\n    if (next && typeof next[0] === 'function') {\r\n        next[0].apply(null, next[1]);\r\n    }\r\n\r\n    if (running) {\r\n        setTimeout(function () {\r\n            dispatch();\r\n        }, duration);\r\n    }\r\n}\r\n\r\nexport function stop() {\r\n    running = false;\r\n}\r\n\r\nexport function clear() {\r\n    requests = [];\r\n}","//GTW Event Manager\r\n\r\nexport const EVENTS = {\r\n    EVENT_UI_BACK: \"EVENT_UI_BACK\",\r\n    EVENT_LOCATION_CHANGE: \"EVENT_LOCATION_CHANGE\",\r\n    EVENT_LOCATION_SUCCESS: \"EVENT_LOCATION_SUCCESS\",\r\n    EVENT_LOCATION_ERROR: \"EVENT_LOCATION_ERROR\"\r\n};\r\n\r\nvar eventListeners = {};\r\n\r\nexport function dispatchEvent(event, ...args) {\r\n    if (!eventListeners[event]) {\r\n        return;\r\n    }\r\n    for (var listener of eventListeners[event]) {\r\n        if (listener) {\r\n            listener.apply(this, args);\r\n        } else {\r\n            removeListener(listener);\r\n        }\r\n    }\r\n}\r\n\r\nexport function addListener(event, listener) {\r\n    if (!eventListeners[event]) {\r\n        eventListeners[event] = [];\r\n    }\r\n    eventListeners[event].push(listener);\r\n}\r\n\r\nexport function removeListener(event, listener) {\r\n    if (!eventListeners[event]) {\r\n        return;\r\n    }\r\n    var i = eventListeners[event].indexOf(listener);\r\n    if (i === -1) {\r\n        return;\r\n    }\r\n    eventListeners[event].splice(i, 1);\r\n}\r\n\r\nexport function removeAllListeners() {\r\n    eventListeners = {};\r\n}","import Dexie from 'dexie';\r\nimport * as Misc from './gtw-misc';\r\n\r\nexport var db = new Dexie(\"gtfs\");\r\n\r\nvar stopTimesValid = {};\r\n\r\ndb.version(1).stores({\r\n    \"versions\": \"[package+provider],[package+provider+version],package\",\r\n    \"agency\": \"[package+provider+agency_id],[package+provider],[package+provider+version],package\",\r\n    \"calendar\": \"[package+provider+service_id],[package+provider],[package+provider+version],package\",\r\n    \"calendar_dates\": \"[package+provider+service_id+date],[package+provider],[package+provider+service_id],[package+provider+version],package\",\r\n    \"frequencies\": \"[package+provider+trip_id],[package+provider],[package+provider+version],package\",\r\n    \"routes\": \"[package+provider+route_id],[package+provider],route_short_name,[package+provider+version],package\",\r\n    \"trips\": \"[package+provider+trip_id],[package+provider],[package+provider+route_id],[package+provider+route_id+service_id],[package+provider+path_id],[package+provider+version],package\",\r\n    \"stops\": \"[package+provider+stop_id],[package+provider],[package+provider+version],package\",\r\n    \"stop_times\": \"++id, [package+provider+trip_id], [package+provider+stop_id], [package+provider],[package+provider+version],package\",\r\n    \"stop_time_paths\": \"++id, [package+provider+path_id], [package+provider+stop_id], [package+provider],[package+provider+version],package\",\r\n    \"fare_attributes\": \"[package+provider+fare_id],[package+provider],[package+provider+version],package\",\r\n    \"fare_rules\": \"[package+provider+fare_id],[package+provider],[package+provider+version],package\",\r\n    \"stop_times_raw\": \"[package+provider],[package+provider+version],package\",\r\n    \"fare_attributes_raw\": \"[package+provider],[package+provider+version],package\",\r\n    \"fare_rules_raw\": \"[package+provider],[package+provider+version],package\"\r\n});\r\n\r\nvar STORES = [\r\n    \"versions\",\r\n    \"agency\",\r\n    \"calendar\",\r\n    \"calendar_dates\",\r\n    \"frequencies\",\r\n    \"routes\",\r\n    \"trips\",\r\n    \"stops\",\r\n    \"stop_times\",\r\n    \"stop_time_paths\",\r\n    \"fare_attributes\",\r\n    \"fare_rules\",\r\n    \"stop_times_raw\",\r\n    \"fare_attributes_raw\",\r\n    \"fare_rules_raw\"\r\n];\r\n\r\n//\r\n// Misc\r\n//\r\n\r\nexport async function validateDatabase(pkg, provider, version, map) {\r\n    var requiredRows;\r\n    var count;\r\n    for (var key in map) {\r\n        if (key === \"stop_times\" ||\r\n            key === \"fare_attributes\" ||\r\n            key === \"fare_rules\"\r\n        ) {\r\n            continue;\r\n        }\r\n        requiredRows = map[key];\r\n        count = await db[key].where(\"[package+provider+version]\")\r\n            .equals([pkg, provider, version]).count();\r\n        if (count !== requiredRows) {\r\n            console.warn(\"Warning: \" + pkg + \",\" + provider + \" \" + version + \" version database invalid at \" + key + \" with different rows: \" + count + \" (Required: \" + requiredRows + \")\");\r\n            return false;\r\n        }\r\n    }\r\n    return true;\r\n}\r\n\r\nexport async function clearDatabase(pkg, provider) {\r\n    for (var storeKey of STORES) {\r\n        await db[storeKey].where(\"[package+provider]\")\r\n            .equals([pkg, provider]).delete();\r\n    }\r\n}\r\n\r\nexport async function clearPackageDatabase(pkg) {\r\n    for (var storeKey of STORES) {\r\n        await db[storeKey].where(\"package\")\r\n            .equals(pkg).delete();\r\n    }\r\n}\r\n\r\nexport function selectAgencyStopName(agencyId, stopName) {\r\n    if (stopName.startsWith(\"\\\"\") && stopName.endsWith(\"\\\"\")) {\r\n        stopName = stopName.substr(1, stopName.length - 2);\r\n    }\r\n    var splits = stopName.split(\"|\");\r\n    var key = \"[\" + agencyId + \"] \";\r\n    for (var i = 0; i < splits.length; i++) {\r\n        if (splits[i].startsWith(key)) {\r\n            return splits[i].substr(key.length);\r\n        }\r\n    }\r\n    var val = splits[0];\r\n    var spaceIndex = val.indexOf(\"] \");\r\n    if (spaceIndex === -1) {\r\n        return val;\r\n    } else {\r\n        return val.substr(spaceIndex + 2);\r\n    }\r\n}\r\n\r\nexport async function getCurrentTrip(pkg, provider, routeId) {\r\n    var trips = await getTripsByRouteId(pkg, provider, routeId);\r\n    var freq;\r\n    for (var trip of trips) {\r\n        freq = getCurrentFrequency(pkg, provider, trip[\"trip_id\"]);\r\n        if (freq) {\r\n            return trip;\r\n        }\r\n    }\r\n    return false;\r\n}\r\n\r\nexport function timeToDate(timeStr) {\r\n    var splits = timeStr.split(\":\");\r\n    var date = new Date();\r\n    date.setHours(splits[0]);\r\n    date.setMinutes(splits[1]);\r\n    date.setSeconds(splits[2]);\r\n    return date;\r\n}\r\n\r\nexport function isCurrentFrequency(freq) {\r\n    var now = Date.now();\r\n\r\n    var startDate = timeToDate(freq[\"start_time\"]);\r\n    var endDate = timeToDate(freq[\"end_time\"]);\r\n\r\n    return now >= startDate.getTime() && now <= endDate.getTime();\r\n}\r\n\r\nexport async function getRoutePathFrequencies(pkg, provider, routeId, pathId) {\r\n    var trips = await getTripsByRouteId(pkg, provider, routeId);\r\n    var out = [];\r\n    var exist;\r\n    for (var trip of trips) {\r\n        if (trip[\"path_id\"] !== pathId) {\r\n            continue;\r\n        }\r\n        var freqs = await getFrequencies(pkg, provider, trip[\"trip_id\"]);\r\n        for (var freq of freqs) {\r\n            exist = false;\r\n            for (var outFreq of out) {\r\n                if (outFreq[\"start_time\"] === freq[\"start_time\"] &&\r\n                    outFreq[\"end_time\"] === freq[\"end_time\"] &&\r\n                    outFreq[\"headway_secs\"] === freq[\"headway_secs\"]) {\r\n                    exist = true;\r\n                    break;\r\n                }\r\n            }\r\n            if (!exist) {\r\n                out.push(freq);\r\n            }\r\n        }\r\n    }\r\n    return out;\r\n}\r\n\r\nexport async function getCurrentFrequency(pkg, provider, tripId) {\r\n    var freqs = await getFrequencies(pkg, provider, tripId);\r\n    var now = Date.now();\r\n    var startDate;\r\n    var endDate;\r\n    var splits;\r\n    for (var freq of freqs) {\r\n        if (isCurrentFrequency(freq)) {\r\n            return freq;\r\n        }\r\n    }\r\n    return false;\r\n}\r\n\r\nexport async function getFrequencies(pkg, provider, tripId) {\r\n    return await db[\"frequencies\"].where(\"[package+provider+trip_id]\")\r\n        .equals([pkg, provider, tripId]).toArray();\r\n}\r\n\r\nexport async function searchRoutes(query) {\r\n    return await db[\"routes\"].where(\"route_short_name\")\r\n        .startsWithIgnoreCase(query).toArray();\r\n}\r\n\r\nexport async function getAllRouteNames(offset, length, noDup) {\r\n    return new Promise((resolve, reject) => {\r\n        var out = [];\r\n        db[\"routes\"].filter(route => {\r\n            return route[\"route_short_name\"].length > offset;\r\n        }).each(route => {\r\n            var str = route[\"route_short_name\"].substr(offset, length);\r\n            if (!noDup || !out.includes(str)) {\r\n                out.push(str);\r\n            }\r\n        }).then(function () {\r\n            resolve(out);\r\n        });\r\n    });\r\n}\r\n\r\nexport async function searchNearbyStops(lat, lng, range, sorted = true) {\r\n    var stops = await db[\"stops\"].toArray();\r\n    var out = [];\r\n    stops.forEach(stop => {\r\n        var distance = Misc.geoDistance(lat, lng, stop[\"stop_lat\"], stop[\"stop_lon\"]);\r\n        if (distance <= range) {\r\n            out.push({\r\n                distance: distance,\r\n                stop: stop\r\n            });\r\n        }\r\n    });\r\n\r\n    if (sorted) {\r\n        out.sort((a, b) => {\r\n            return a.distance - b.distance;\r\n        });\r\n    }\r\n    return out;\r\n}\r\n\r\nexport function searchStopRoutes(pkg, provider, stopId) {\r\n    return new Promise((resolve, reject) => {\r\n        var pathIds = [];\r\n        var routeIds = [];\r\n        var routes = {};\r\n        var stopTimes = {};\r\n        var trips = {};\r\n        var st = Date.now();\r\n        return getStopTimePathsByStopId(pkg, provider, stopId).then(function (out) {\r\n            for (var stopTime of out) {\r\n                var pathId = stopTime[\"path_id\"];\r\n                pathIds.push([pkg, provider, pathId]);\r\n                stopTimes[pathId] = stopTime;\r\n            }\r\n            console.log(\"PATH DONE: \" + (Date.now() - st));\r\n        }).then(function () {\r\n            st = Date.now();\r\n            db[\"trips\"].where(\"[package+provider+path_id]\").anyOf(pathIds).each(trip => {\r\n                var routeId = trip[\"route_id\"];\r\n                trips[routeId] = trip;\r\n                routeIds.push([pkg, provider, routeId]);\r\n            }).then(function () {\r\n                console.log(\"EACH DONE: \" + (Date.now() - st));\r\n                st = Date.now();\r\n                db[\"routes\"].where(\"[package+provider+route_id]\").anyOf(routeIds).each(route => {\r\n                    var routeId = route[\"route_id\"];\r\n                    routes[routeId] = route;\r\n                }).then(function () {\r\n                    console.log(\"EACH2 DONE: \" + (Date.now() - st));\r\n                    resolve({\r\n                        routes: routes,\r\n                        trips: trips,\r\n                        stopTimes: stopTimes\r\n                    });\r\n                });\r\n            });\r\n        });\r\n    });\r\n}\r\n\r\n//\r\n// Getters\r\n//\r\n\r\nexport async function getAgencies() {\r\n    return await db[\"agency\"].toArray();\r\n}\r\n\r\nexport async function getAgency(pkg, provider, agencyId) {\r\n    return await db[\"agency\"].where(\"[package+provider+agency_id]\")\r\n        .equals([pkg, provider, agencyId]).first();\r\n}\r\n\r\nexport async function getRoute(pkg, provider, routeId) {\r\n    return await db[\"routes\"].where(\"[package+provider+route_id]\")\r\n        .equals([pkg, provider, routeId]).first();\r\n}\r\n\r\nexport async function getTrip(pkg, provider, tripId) {\r\n    return await db[\"trips\"].where(\"[package+provider+trip_id]\")\r\n        .equals([pkg, provider, tripId]).first();\r\n}\r\n\r\nexport async function getTripsByRouteId(pkg, provider, routeId) {\r\n    return await db[\"trips\"].where(\"[package+provider+route_id]\")\r\n        .equals([pkg, provider, routeId]).toArray();\r\n}\r\n\r\nexport async function getStop(pkg, provider, stopId) {\r\n    return await db[\"stops\"].where(\"[package+provider+stop_id]\")\r\n        .equals([pkg, provider, stopId]).first();\r\n}\r\n\r\nexport async function getCalendar(pkg, provider, serviceId) {\r\n    return await db[\"calendar\"].where(\"[package+provider+service_id]\")\r\n        .equals([pkg, provider, serviceId]).first();\r\n}\r\n\r\nexport async function getCalendarDates(pkg, provider, serviceId) {\r\n    return await db[\"calendar_dates\"].where(\"[package+provider+service_id]\")\r\n        .equals([pkg, provider, serviceId]).toArray();\r\n}\r\n\r\nexport async function getStopTimePathsByStopId(pkg, provider, stopId) {\r\n    return await db[\"stop_time_paths\"].where(\"[package+provider+stop_id]\")\r\n        .equals([pkg, provider, stopId]).sortBy(\"path_id\");\r\n}\r\n\r\nexport async function getStopTimePathByPathId(pkg, provider, pathId) {\r\n    return await db[\"stop_time_paths\"].where(\"[package+provider+path_id]\")\r\n        .equals([pkg, provider, pathId]).sortBy(\"stop_sequence\");\r\n}\r\n\r\nexport function getStopTimesByStopId(pkg, provider, stopId) {\r\n    return new Promise((resolve, reject) => {\r\n        if (isStopTimesValid(pkg, provider)) {\r\n            db[\"stop_times\"].where(\"[package+provider+stop_id]\")\r\n                .equals([pkg, provider, stopId]).sortBy(\"trip_id\").then(function (rows) {\r\n                    resolve(rows);\r\n                });\r\n        } else {\r\n            var worker = new Worker(\"./workers/stoptimes-raw-by-stop-id.worker.js\", { type: 'module' });\r\n            worker.postMessage({\r\n                pkg: pkg,\r\n                id: provider,\r\n                stopId: stopId\r\n            });\r\n            worker.addEventListener(\"message\", function (evt) {\r\n                var out = evt.data;\r\n                for (var datum of out) {\r\n                    datum[\"package\"] = pkg;\r\n                    datum[\"provider\"] = provider;\r\n                }\r\n                resolve(out);\r\n            });\r\n        }\r\n    });\r\n}\r\n\r\nexport function getStopTimesByTripId(pkg, provider, tripId) {\r\n    return new Promise((resolve, reject) => {\r\n        if (isStopTimesValid(pkg, provider)) {\r\n            db[\"stop_times\"].where(\"[package+provider+trip_id]\")\r\n                .equals([pkg, provider, tripId]).sortBy(\"stop_sequence\").then(function (rows) {\r\n                    resolve(rows);\r\n                });\r\n        } else {\r\n            var worker = new Worker(\"./workers/stoptimes-raw-by-trip-id.worker.js\", { type: 'module' });\r\n            worker.postMessage({\r\n                pkg: pkg,\r\n                id: provider,\r\n                tripId: tripId\r\n            });\r\n            worker.addEventListener(\"message\", function (evt) {\r\n                var out = evt.data;\r\n                for (var datum of out) {\r\n                    datum[\"package\"] = pkg;\r\n                    datum[\"provider\"] = provider;\r\n                }\r\n                resolve(out);\r\n            });\r\n        }\r\n    });\r\n}\r\n\r\nexport async function validateStopTimes(pkg, provider) {\r\n    var rawRowsArray = await db[\"stop_times_raw\"].where(\"[package+provider]\")\r\n        .equals([pkg, provider]).first();\r\n    var dbRows = await db[\"stop_times\"].where(\"[package+provider]\")\r\n        .equals([pkg, provider]).count();\r\n    return stopTimesValid[pkg + \",\" + provider] = rawRowsArray.rows.length === dbRows;\r\n}\r\n\r\nexport function isStopTimesValid(pkg, provider) {\r\n    return false;\r\n    return stopTimesValid[pkg + \",\" + provider];\r\n}\r\n","//GTW Settings\r\n\r\nconst SETTINGS_STORAGE_KEY = \"gtw-settings\";\r\n\r\nconst VALUE_TYPES = {\r\n    number: \"number\",\r\n    string: \"string\",\r\n    boolean: \"boolean\"\r\n};\r\n\r\nexport function getDefaultSettings() {\r\n    return [\r\n        {\r\n            key: \"preferred_language\",\r\n            type: \"string\",\r\n            name: $.i18n(\"settings-key-preferred-language\"),\r\n            desc: $.i18n(\"settings-key-preferred-language-desc\"),\r\n            def: \"en\",\r\n            checkfunc: function (val) {\r\n                var locales = require(\"./gtw-lang\").languages;\r\n                var found = false;\r\n                for (var locale in locales) {\r\n                    if (locale === val) {\r\n                        found = true;\r\n                        break;\r\n                    }\r\n                }\r\n                return found;\r\n            }\r\n        },\r\n        {\r\n            key: \"show_debug_msg\",\r\n            type: \"boolean\",\r\n            name: $.i18n(\"settings-key-show-debug-msg\"),\r\n            desc: $.i18n(\"settings-key-show-debug-msg-desc\"),\r\n            def: false\r\n        },\r\n        {\r\n            key: \"min_nearby_transit_range\",\r\n            type: \"number\",\r\n            name: $.i18n(\"settings-key-min-nearby-transit-search-range\"),\r\n            desc: $.i18n(\"settings-key-min-nearby-transit-search-range-desc\"),\r\n            def: 200,\r\n            checkfunc: function (val) {\r\n                var x = parseInt(val);\r\n                return !Number.isNaN(x) && x < 10000;\r\n            }\r\n        },\r\n        {\r\n            key: \"max_nearby_transit_to_display\",\r\n            type: \"number\",\r\n            name: $.i18n(\"settings-key-max-nearby-transit-to-be-displayed\"),\r\n            desc: $.i18n(\"settings-key-max-nearby-transit-to-be-displayed-desc\"),\r\n            def: 20,\r\n            checkfunc: function (val) {\r\n                var x = parseInt(val);\r\n                return !Number.isNaN(x) && x < 100;\r\n            }\r\n        },\r\n        {\r\n            key: \"use_cors_proxy\",\r\n            type: \"boolean\",\r\n            name: $.i18n(\"settings-key-use-cors-proxy\"),\r\n            desc: $.i18n(\"settings-key-use-cors-proxy-desc\"),\r\n            def: true\r\n        },\r\n        {\r\n            key: \"cors_proxy_server\",\r\n            type: \"string\",\r\n            name: $.i18n(\"settings-key-cors-proxy-server\"),\r\n            desc: $.i18n(\"settings-key-cors-proxy-server-desc\"),\r\n            def: \"https://cp1.gotowhere.ga/\",\r\n            checkfunc: function (val) {\r\n                return val.startsWith(\"https://\") && val.endsWith(\"/\")\r\n            }\r\n        },\r\n        {\r\n            key: \"cors_check_bypass\",\r\n            type: \"boolean\",\r\n            name: $.i18n(\"settings-key-cors-check-bypass\"),\r\n            desc: $.i18n(\"settings-key-cors-check-bypass-desc\"),\r\n            def: false\r\n        }\r\n    ];\r\n}\r\n\r\nexport var json = {};\r\n\r\nexport function get(key, def = false) {\r\n    var val = json[key];\r\n    if (typeof val === 'undefined') {\r\n        return def;\r\n    }\r\n    return val;\r\n}\r\n\r\nexport function set(key, val) {\r\n    json[key] = val;\r\n    return true;\r\n}\r\n\r\nexport function load() {\r\n    if (!localStorage) {\r\n        return false;\r\n    }\r\n    var t = localStorage.getItem(SETTINGS_STORAGE_KEY);\r\n\r\n    if (!t) {\r\n        return save();\r\n    }\r\n\r\n    var j = JSON.parse(t);\r\n\r\n    if (!j) {\r\n        return false;\r\n    }\r\n\r\n    json = j;\r\n    return true;\r\n}\r\n\r\nexport function save() {\r\n    if (!localStorage) {\r\n        return false;\r\n    }\r\n    localStorage.setItem(SETTINGS_STORAGE_KEY, JSON.stringify(json));\r\n    return true;\r\n}","//GTW Misc\r\n\r\nexport function geoDistance(lat1, lon1, lat2, lon2) {\r\n    var p = 0.017453292519943295;    // Math.PI / 180\r\n    var c = Math.cos;\r\n    var a = 0.5 - c((lat2 - lat1) * p) / 2 +\r\n        c(lat1 * p) * c(lat2 * p) *\r\n        (1 - c((lon2 - lon1) * p)) / 2;\r\n\r\n    return 12742 * Math.asin(Math.sqrt(a)); // 2 * R; R = 6371 km\r\n}\r\n\r\nexport function stringCompare(a, b) {\r\n    if (a.length < b.length) {\r\n        return -1;\r\n    } else if (a.length > b.length) {\r\n        return 1;\r\n    }\r\n    var i;\r\n    var ca;\r\n    var cb;\r\n    var len = a.length;\r\n    for (i = 0; i < len; i++) {\r\n        ca = a.charAt(i);\r\n        cb = b.charAt(i);\r\n        if (ca < cb) {\r\n            return -1;\r\n        } else if (ca > cb) {\r\n            return 1;\r\n        }\r\n    }\r\n    return 0;\r\n}\r\n\r\nexport function allProgress(proms, progress_cb) {\r\n    let d = 0;\r\n    progress_cb(0);\r\n    for (const p of proms) {\r\n        p.then(() => {\r\n            d++;\r\n            progress_cb((d * 100) / proms.length);\r\n        });\r\n    }\r\n    return Promise.all(proms);\r\n}\r\n\r\nexport function isSamePropertyValueInArray(array, name, value) {\r\n    for (var object of array) {\r\n        if (object[name] === value) {\r\n            return true;\r\n        }\r\n    }\r\n    return false;\r\n}\r\n\r\nexport function fillZero(number) {\r\n    return number < 10 ? (\"0\" + number) : number;\r\n}\r\n\r\nexport function similarity(s1, s2) {\r\n    var longer = s1;\r\n    var shorter = s2;\r\n    if (s1.length < s2.length) {\r\n        longer = s2;\r\n        shorter = s1;\r\n    }\r\n    var longerLength = longer.length;\r\n    if (longerLength == 0) {\r\n        return 1.0;\r\n    }\r\n    return (longerLength - editDistance(longer, shorter)) / parseFloat(longerLength);\r\n}\r\n\r\nexport function editDistance(s1, s2) {\r\n    s1 = s1.toLowerCase();\r\n    s2 = s2.toLowerCase();\r\n\r\n    var costs = new Array();\r\n    for (var i = 0; i <= s1.length; i++) {\r\n        var lastValue = i;\r\n        for (var j = 0; j <= s2.length; j++) {\r\n            if (i == 0)\r\n                costs[j] = j;\r\n            else {\r\n                if (j > 0) {\r\n                    var newValue = costs[j - 1];\r\n                    if (s1.charAt(i - 1) != s2.charAt(j - 1))\r\n                        newValue = Math.min(Math.min(newValue, lastValue),\r\n                            costs[j]) + 1;\r\n                    costs[j - 1] = lastValue;\r\n                    lastValue = newValue;\r\n                }\r\n            }\r\n        }\r\n        if (i > 0)\r\n            costs[s2.length] = lastValue;\r\n    }\r\n    return costs[s2.length];\r\n}","//City Data: Transit\r\nimport * as Misc from './gtw-misc';\r\nimport * as gtfs from './gtw-citydata-transit-gtfs';\r\nimport Dexie from 'dexie';\r\nimport Papa from 'papaparse';\r\nimport oboe from 'oboe';\r\nimport { db } from './gtw-citydata-transit-gtfs';\r\n\r\nvar providers = [];\r\nvar totalProms = [];\r\nvar dbVersions = {};\r\nvar dbZips = {};\r\nvar dbChunks = {};\r\nvar dbUpdateNeeded = {};\r\nvar dbMaps = {};\r\n\r\n//\r\n// Provider registration\r\n//\r\n\r\nexport function registerProvider(pkg, id, provider) {\r\n    if (!provider.fetchDatabase || typeof provider.fetchDatabase !== \"function\" ||\r\n        !provider.checkDatabaseUpdate || typeof provider.checkDatabaseUpdate !== \"function\") {\r\n        throw new Error(\"Error: \" + name + \" does not contain fetchDatabase or checkDatabaseUpdate function!\");\r\n    }\r\n\r\n    provider.pkg = pkg;\r\n    provider.id = id;\r\n    provider.db = false;\r\n\r\n    //provider.getRoute\r\n\r\n    //provider.getRouteById\r\n\r\n    //provider.getRoutes\r\n\r\n    providers.push(provider);\r\n}\r\n\r\nexport function unregisterProvider(id) {\r\n    var found = -1;\r\n    for (var i = 0; i < providers.length; i++) {\r\n        if (providers[i].id === id) {\r\n            found = i;\r\n        }\r\n    }\r\n    providers.splice(found, 1);\r\n}\r\n\r\nexport function getProviders() {\r\n    return providers;\r\n}\r\n\r\nexport function getProvider(id) {\r\n    for (var provider of providers) {\r\n        if (provider.id === id) {\r\n            return provider;\r\n        }\r\n    }\r\n    return false;\r\n}\r\n\r\n//\r\n// Database Update\r\n//\r\n\r\nexport function obtainDatabaseVersion(pc) {\r\n    console.log(\"Obtaining db version\");\r\n    var proms = [];\r\n    for (var provider of providers) {\r\n        //proms.push(new Promise((resolve, reject) => { resolve(false); }))\r\n        window.x = db;\r\n        proms.push(db[\"versions\"].where(\"[package+provider]\").equals([provider.pkg, provider.id]).first().then(function (row) {\r\n            if (row) {\r\n                var key = row[\"package\"] + \",\" + row[\"provider\"];\r\n                dbVersions[key] = row.version;\r\n                dbMaps[key] = row.map;\r\n            }\r\n        }));\r\n        /*\r\n        proms.push(dbGtfs.getVersion(provider.pkg, provider.id).then(function (ver) {\r\n            if (ver) {\r\n                var key = ver[\"package\"] + \",\" + ver[\"provider\"];\r\n                dbVersions[key] = ver.version;\r\n            }\r\n        }));\r\n        */\r\n    }\r\n    return Misc.allProgress(proms, pc);\r\n}\r\n\r\nexport function checkDatabaseUpdate(pc) {\r\n    console.log(\"DBVersions:\");\r\n    console.log(dbVersions);\r\n    var proms = [];\r\n    var p;\r\n    for (var provider of providers) {\r\n        var key = provider.pkg + \",\" + provider.id;\r\n        if (dbVersions[key]) {\r\n            p = new Promise((resolve, reject) => {\r\n                provider.checkDatabaseUpdate(resolve, reject, dbVersions[key]);\r\n            });\r\n            proms.push(p.then(function (update) {\r\n                dbUpdateNeeded[key] = update;\r\n            }).catch(function (err) {\r\n                console.error(\"Error: Promise rejected when checking update for \" + key + \".\");\r\n            }));\r\n        } else {\r\n            dbUpdateNeeded[key] = true;\r\n        }\r\n    }\r\n    return Misc.allProgress(proms, pc);\r\n}\r\n\r\nexport async function validateAllDatabase() {\r\n    var map;\r\n    var valid;\r\n    for (var provider of providers) {\r\n        var key = provider.pkg + \",\" + provider.id;\r\n        map = dbMaps[key];\r\n        if (!map) {\r\n            console.error(\"Error: GTFS database does not contain a map to validate! Forcing it to update!\");\r\n            dbUpdateNeeded[key] = true;\r\n            continue;\r\n        }\r\n        valid = await gtfs.validateDatabase(provider.pkg, provider.id, dbVersions[key], map);\r\n        if (!valid) {\r\n            console.warn(\"Warning: Invalid GTFS database compared with map! Forcing to update!\");\r\n            dbUpdateNeeded[key] = true;\r\n            continue;\r\n        }\r\n    }\r\n}\r\n\r\nexport function hasDatabaseUpdate() {\r\n    for (var key in dbUpdateNeeded) {\r\n        if (dbUpdateNeeded[key]) {\r\n            return true;\r\n        }\r\n    }\r\n    return false;\r\n}\r\n\r\nexport function downloadDatabase(pc) {\r\n    console.log(\"DBUpdateNeeded:\");\r\n    console.log(dbUpdateNeeded);\r\n    var proms = [];\r\n    var fdbp;\r\n    var p;\r\n    for (var provider of providers) {\r\n        var key = provider.pkg + \",\" + provider.id;\r\n        if (dbUpdateNeeded[key]) {\r\n            p = new Promise((resolve, reject) => {\r\n                provider.fetchDatabase(resolve, reject);\r\n            });\r\n            proms.push(p.then(function (zip) {\r\n                dbZips[key] = zip;\r\n            }));\r\n        }\r\n    }\r\n    return Misc.allProgress(proms, pc);\r\n}\r\n\r\nvar FILES = [\r\n    \"agency.json\",\r\n    \"calendar_dates.json\",\r\n    \"calendar.json\",\r\n    \"fare_attributes.json\",\r\n    \"fare_rules.json\",\r\n    \"frequencies.json\",\r\n    \"routes.json\",\r\n    \"stops.json\",\r\n    \"stop_time_paths.json\",\r\n    \"stop_times.json\",\r\n    \"trips.json\"\r\n];\r\n    \r\nexport function prepareUpdate(pc) {\r\n    console.log(\"DBZips:\");\r\n    console.log(dbZips);\r\n    var proms = [];\r\n    var p;\r\n    var zip;\r\n    for (var provider of providers) {\r\n        var key = provider.pkg + \",\" + provider.id;\r\n        if (dbZips[key]) {\r\n            zip = dbZips[key];\r\n            console.log(\"Preparing for update for key: \" + key);\r\n            if (!zip.files[\"version.json\"]) {\r\n                console.error(\"Error: Database returned from \" + key + \" does not contain a version file.\");\r\n                continue;\r\n            }\r\n\r\n            dbChunks[key] = [];\r\n            for (var file of FILES) {\r\n                if (zip.files[file]) {\r\n                    proms.push(zip.files[file].async(\"string\").then(function (str) {\r\n                        var obj = JSON.parse(str);\r\n                        obj.pkg = provider.pkg;\r\n                        obj.id = provider.id;\r\n                        console.log(obj);\r\n                        dbChunks[key].push(obj);\r\n                    }));\r\n                }\r\n            }\r\n\r\n            proms.push(zip.file(\"version.json\").async(\"string\").then(function (str) {\r\n                var json = JSON.parse(str);\r\n                json[\"package\"] = provider.pkg;\r\n                json[\"provider\"] = provider.id;\r\n                db.versions.put(json);\r\n            }));\r\n            proms.push(gtfs.clearDatabase(provider.pkg, provider.id));\r\n        }\r\n    }\r\n    return Misc.allProgress(proms, pc);\r\n}\r\n\r\n/*\r\nexport function readChunks(pc) {\r\n    return new Promise((resolve, reject) => {\r\n        var worker = new Worker(\"./workers/loaddb.worker.js\", { type: 'module' });\r\n\r\n        worker.postMessage({\r\n            chunks: dbChunks,\r\n            zips: dbZips\r\n        });\r\n\r\n        worker.addEventListener(\"message\", function (evt) {\r\n            console.log(evt);\r\n            var msg = evt.data;\r\n            if (msg.type === 0) {\r\n                resolve()\r\n            } else if (msg.type === 1) {\r\n                pc(msg.progress);\r\n            }\r\n        });\r\n    });\r\n}\r\n*/\r\nvar worker = false;\r\n\r\nexport function initializeWorker() {\r\n    worker = new Worker(\"./workers/loadgtfs.worker.js\", { type: 'module' });\r\n}\r\n\r\nexport function terminateWorker() {\r\n    worker.terminate();\r\n}\r\n\r\nexport function readChunks(dataType, pc) {\r\n    console.log(\"DBChunks:\");\r\n    console.log(dbChunks);\r\n    var proms = [];\r\n    var p;\r\n    var i;\r\n    var infos;\r\n    var zip;\r\n    for (var provider of providers) {\r\n        var key = provider.pkg + \",\" + provider.id;\r\n        zip = dbZips[key];\r\n        if (dbChunks[key]) {\r\n            infos = dbChunks[key];\r\n            for (const info of infos) {\r\n                if (dataType !== info.dataType) {\r\n                    continue;\r\n                }\r\n\r\n                proms.push(new Promise((resolve, reject) => {\r\n                    var chunk = \"\";\r\n                    var ps = [];\r\n                    console.log(\"Loading \" + info.dataType);\r\n                    zip.file(info.dataType + \"-chunk.json\").internalStream(\"string\")\r\n                        .on(\"data\", function (data) {\r\n                            chunk += data;\r\n                        })\r\n                        .on(\"error\", function (err) {\r\n                            console.log(\"ERROR\");\r\n                            reject(err);\r\n                        })\r\n                        .on(\"end\", function () {\r\n                            console.log(\"Chunk end\");\r\n                            worker.postMessage({\r\n                                type: 0,\r\n                                pkg: provider.pkg,\r\n                                id: provider.id,\r\n                                info: info,\r\n                                string: chunk\r\n                            });\r\n                            resolve();\r\n                        })\r\n                        .resume();\r\n                }));\r\n            }\r\n        }\r\n    }\r\n    return Misc.allProgress(proms, pc);\r\n}\r\n\r\nexport function waitToUpdate(pc) {\r\n    return new Promise((resolve, reject) => {\r\n        worker.addEventListener(\"message\", function ext(evt) {\r\n            var msg = evt.data;\r\n            if (msg.type === 0) {\r\n                console.log(\"Finish\");\r\n                worker.removeEventListener(\"message\", ext);\r\n                resolve();\r\n            } else if (msg.type === 1) {\r\n                pc(msg.progress);\r\n            } else if (msg.type === 2) {\r\n                var data = evt.data;\r\n                totalProms.push(db.putGtfs(data.pkg, data.id, data.info.dataType, data.result));\r\n            }\r\n        });\r\n        worker.postMessage({\r\n            type: 1\r\n        });\r\n    });\r\n}","//GTW Platform Configuration\r\n\r\nexport default {\r\n    //\r\n    // Default Map API\r\n    //\r\n    // The map to be used in the UI, you can use:\r\n    //   - auto (Experimental. Prefers Google Map, fallback to Open Street Map)\r\n    //   - googlemap (Recommended)\r\n    //   - openstreetmap\r\n    mapApi: \"googlemap\",\r\n\r\n    //\r\n    // Google Map API Key\r\n    //\r\n    // You have to create an API key from the Google Cloud Console to\r\n    // use Google Map features. The default one only works on the\r\n    // official server.\r\n    googleMapApiKey: \"AIzaSyAhU7FqH46IdF4RaHrBlABfkoFlHZeudFg\"\r\n};"],"sourceRoot":""}